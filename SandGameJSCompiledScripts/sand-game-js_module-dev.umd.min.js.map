{"version":3,"file":"sand-game-js_module-dev.umd.min.js","sources":["../src/gui/DomBuilder.js","../src/gui/action/Action.js","../src/gui/component/Component.js","../src/gui/component/ComponentButton.js","../src/core/rendering/Renderer.js","../src/core/rendering/RendererNull.js","../src/core/rendering/RendererInitializer.js","../src/core/rendering/RendererInitializerNull.js","../src/core/rendering/RenderingMode.js","../src/core/ElementHead.js","../src/core/rendering/RenderingModeElementType.js","../src/Assets.js","../src/core/rendering/RenderingModeHeatmap.js","../src/core/rendering/assets/heatmap.palette.png","../node_modules/file-saver/dist/FileSaver.min.js","../node_modules/fflate/esm/browser.js","../src/gui/action/ActionRecord.js","../src/gui/action/ActionScreenshot.js","../src/gui/action/ActionBenchmark.js","../src/gui/action/ActionFill.js","../src/gui/action/ActionsDev.js","../src/gui/action/ActionShowActiveChunks.js","../src/def/DevToolDefs.js","../src/gui/component/ComponentViewDevTools.js","../src/module-dev.js"],"sourcesContent":["// Sand Game JS; Patrik Harag, https://harag.cz; all rights reserved\r\n\r\n/**\r\n *\r\n * @version 2023-12-21\r\n * @author Patrik Harag\r\n */\r\nexport default class DomBuilder {\r\n\r\n    /**\r\n     *\r\n     * @param element {HTMLElement}\r\n     * @param content {null|string|Node|(null|string|Node)[]}\r\n     */\r\n    static addContent(element, content) {\r\n        if (content === null) {\r\n            // ignore\r\n        } else if (typeof content === 'string') {\r\n            element.textContent = content;\r\n        } else if (content instanceof Node) {\r\n            element.appendChild(content);\r\n        } else if (Array.isArray(content)) {\r\n            for (const item of content) {\r\n                if (item instanceof Node) {\r\n                    element.appendChild(item);\r\n                } else if (typeof item === 'string') {\r\n                    element.insertAdjacentText('beforeend', item);\r\n                } else if (item === null) {\r\n                    // ignore\r\n                } else {\r\n                    throw 'Content type not supported: ' + (typeof item);\r\n                }\r\n            }\r\n        } else {\r\n            throw 'Content type not supported: ' + (typeof content);\r\n        }\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param element {HTMLElement}\r\n     * @param content {null|string|Node|(Node|null)[]}\r\n     */\r\n    static setContent(element, content) {\r\n        element.innerHTML = '';\r\n        DomBuilder.addContent(element, content);\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param element {HTMLElement}\r\n     * @param attributes {object|null}\r\n     */\r\n    static putAttributes(element, attributes) {\r\n        for (const key in attributes) {\r\n            const value = attributes[key];\r\n            const type = typeof value;\r\n\r\n            if (type === 'string' || type === 'boolean' || type === 'number') {\r\n                element.setAttribute(key, value);\r\n            } else if (key === 'style' && type === 'object') {\r\n                Object.assign(element.style, value);\r\n            } else if (value === null) {\r\n                // ignore\r\n            } else {\r\n                throw 'Unsupported attribute type: ' + (typeof value);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param html {string}\r\n     * @return {HTMLElement}\r\n     */\r\n    static create(html) {\r\n        const template = document.createElement('template');\r\n        template.innerHTML = html.trim();\r\n        return template.content.firstElementChild;\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param name {string}\r\n     * @param attributes {object|null}\r\n     * @param content {null|string|HTMLElement|HTMLElement[]}\r\n     * @return {HTMLElement}\r\n     */\r\n    static element(name, attributes = null, content = null) {\r\n        const element = document.createElement(name);\r\n\r\n        // attributes\r\n        DomBuilder.putAttributes(element, attributes);\r\n\r\n        // content\r\n        DomBuilder.addContent(element, content);\r\n\r\n        return element;\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param attributes {object|null}\r\n     * @param content {null|string|HTMLElement|HTMLElement[]}\r\n     * @return {HTMLElement}\r\n     */\r\n    static div(attributes = null, content = null) {\r\n        return DomBuilder.element('div', attributes, content);\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param attributes {object|null}\r\n     * @param content {null|string|HTMLElement|HTMLElement[]}\r\n     * @return {HTMLElement}\r\n     */\r\n    static par(attributes = null, content = null) {\r\n        return DomBuilder.element('p', attributes, content);\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param text {string|null}\r\n     * @param attributes {object|null}\r\n     * @return {HTMLElement}\r\n     */\r\n    static span(text = null, attributes = null) {\r\n        return DomBuilder.element('span', attributes, text);\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param text {string}\r\n     * @param attributes {object|null}\r\n     * @param handler {function()}\r\n     * @return {HTMLElement}\r\n     */\r\n    static link(text, attributes = null, handler = null) {\r\n        const link = DomBuilder.element('a', attributes, text);\r\n        if (handler !== null) {\r\n            link.href = 'javascript:void(0)';\r\n            link.addEventListener('click', handler);\r\n        }\r\n        return link;\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param label {string|HTMLElement|HTMLElement[]}\r\n     * @param attributes {object|null}\r\n     * @param handler {function()}\r\n     * @return {HTMLElement}\r\n     */\r\n    static button(label, attributes = null, handler = null) {\r\n        if (attributes === null) {\r\n            attributes = {};\r\n        }\r\n        attributes['type'] = 'button';\r\n\r\n        const button = DomBuilder.element('button', attributes, label);\r\n        if (handler !== null) {\r\n            button.addEventListener('click', handler);\r\n        }\r\n        return button;\r\n    }\r\n\r\n    // bootstrap methods\r\n\r\n    /**\r\n     *\r\n     * @param bodyContent {string|HTMLElement}\r\n     * @return {HTMLElement}\r\n     */\r\n    static bootstrapAlertInfo(bodyContent) {\r\n        const alertDiv = DomBuilder.div({ class: 'alert alert-info alert-dismissible fade show', role: 'alert' });\r\n        DomBuilder.addContent(alertDiv, bodyContent);\r\n        alertDiv.append(DomBuilder.button(null, { type: 'button', class: 'btn-close', 'data-bs-dismiss': 'alert', 'aria-label': 'Close' }));\r\n        return alertDiv;\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param headerContent {string|HTMLElement|HTMLElement[]}\r\n     * @param bodyContent {string|HTMLElement|HTMLElement[]}\r\n     * @param attributes {object|null}\r\n     * @return {HTMLElement}\r\n     */\r\n    static bootstrapCard(headerContent, bodyContent, attributes = null) {\r\n        if (attributes === null) {\r\n            attributes = {};\r\n        }\r\n        if (attributes.class === undefined) {\r\n            attributes.class = 'card';\r\n        }\r\n\r\n        const card = DomBuilder.div(attributes);\r\n\r\n        if (headerContent) {\r\n            card.append(DomBuilder.div({ class: 'card-header' }, headerContent));\r\n        }\r\n\r\n        card.append(DomBuilder.div({ class: 'card-body' }, bodyContent));\r\n        return card;\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param title {string}\r\n     * @param collapsed {boolean}\r\n     * @param bodyContent {string|HTMLElement|HTMLElement[]}\r\n     * @return {HTMLElement}\r\n     */\r\n    static bootstrapCardCollapsable(title, collapsed, bodyContent) {\r\n        const id = 'collapsable_' + Math.floor(Math.random() * 999_999_999);\r\n\r\n        return DomBuilder.div({ class: 'card' }, [\r\n            DomBuilder.div({ class: 'card-header' }, [\r\n                DomBuilder.element('a', { class: 'card-link', 'data-bs-toggle': 'collapse', href: '#' + id}, title)\r\n            ]),\r\n            DomBuilder.div({ id: id, class: (collapsed ? 'collapse' : 'collapse show') }, [\r\n                DomBuilder.div({ class: 'card-body' }, bodyContent)\r\n            ])\r\n        ]);\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param content {string|HTMLElement}\r\n     * @param node {HTMLElement}\r\n     * @return {HTMLElement}\r\n     */\r\n    static bootstrapInitTooltip(content, node) {\r\n        if (window.bootstrap === undefined) {\r\n            console.error('Bootstrap library not available');\r\n            return node;\r\n        }\r\n\r\n        const old = new window.bootstrap.Tooltip(node);\r\n        if (old) {\r\n            old.dispose();\r\n        }\r\n\r\n        node.setAttribute('data-bs-toggle', 'tooltip');\r\n        node.setAttribute('data-bs-placement', 'top');\r\n        if (typeof content === 'object') {\r\n            node.setAttribute('data-bs-html', 'true');\r\n            node.setAttribute('title', content.innerHTML);\r\n        } else {\r\n            node.setAttribute('title', content);\r\n        }\r\n\r\n        new window.bootstrap.Tooltip(node);\r\n        return node;\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param text {string}\r\n     * @param checked {boolean}\r\n     * @param handler {function(boolean)}\r\n     * @return {HTMLElement}\r\n     */\r\n    static bootstrapSwitchButton(text, checked, handler = null) {\r\n        const id = 'switch-button_' + Math.floor(Math.random() * 999_999_999);\r\n\r\n        const switchInput = DomBuilder.element('input', {\r\n            type: 'checkbox',\r\n            id: id,\r\n            class: 'form-check-input',\r\n            role: 'switch',\r\n            checked: checked\r\n        });\r\n\r\n        const control = DomBuilder.div({ class: 'form-check form-switch' }, [\r\n            switchInput,\r\n            DomBuilder.element('label', { class: 'form-check-label', for: id }, text)\r\n        ]);\r\n\r\n        if (handler !== null) {\r\n            switchInput.addEventListener('click', () => {\r\n                handler(switchInput.checked);\r\n            });\r\n        }\r\n        return control;\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param labelContent {string|HTMLElement}\r\n     * @param buttonClass {string} e.g. btn-primary\r\n     * @param checked {boolean}\r\n     * @param handler {function(boolean)}\r\n     * @return {HTMLElement[]}\r\n     */\r\n    static bootstrapToggleButton(labelContent, buttonClass, checked, handler = null) {\r\n        const id = 'toggle-button_' + Math.floor(Math.random() * 999_999_999);\r\n\r\n        const nodeInput = DomBuilder.element('input', {\r\n            type: 'checkbox',\r\n            class: 'btn-check',\r\n            checked: checked,\r\n            id: id\r\n        });\r\n        const nodeLabel = DomBuilder.element('label', {\r\n            class: 'btn ' + buttonClass,\r\n            for: id\r\n        }, labelContent);\r\n\r\n        nodeInput.addEventListener('change', (e) => {\r\n            if (handler !== null) {\r\n                handler(nodeInput.checked);\r\n            }\r\n        });\r\n\r\n        return [nodeInput, nodeLabel];\r\n    }\r\n\r\n    static bootstrapTableBuilder() {\r\n        return new BootstrapTable();\r\n    }\r\n\r\n    static bootstrapDialogBuilder() {\r\n        return new BootstrapDialog();\r\n    }\r\n\r\n    static bootstrapToastBuilder() {\r\n        return new BootstrapToast();\r\n    }\r\n\r\n    static bootstrapSimpleFormBuilder() {\r\n        return new BootstrapSimpleForm();\r\n    }\r\n}\r\n\r\n/**\r\n *\r\n * @version 2023-12-21\r\n * @author Patrik Harag\r\n */\r\nclass BootstrapTable {\r\n\r\n    #tableBody = DomBuilder.element('tbody');\r\n\r\n    addRow(row) {\r\n        this.#tableBody.appendChild(row);\r\n    }\r\n\r\n    addRowBefore(row) {\r\n        this.#tableBody.insertBefore(row, this.#tableBody.firstChild);\r\n    }\r\n\r\n    createNode() {\r\n        const table = DomBuilder.element('table', { class: 'table table-striped' });\r\n        table.appendChild(this.#tableBody);\r\n\r\n        const tableResponsive = DomBuilder.div({ class: 'table-responsive' });\r\n        tableResponsive.appendChild(table);\r\n\r\n        return tableResponsive;\r\n    }\r\n}\r\n\r\n/**\r\n *\r\n * @version 2023-12-24\r\n * @author Patrik Harag\r\n */\r\nclass BootstrapDialog {\r\n\r\n    // will be removed after close\r\n    #persistent = false;\r\n\r\n    #additionalStyle = '';\r\n\r\n    #headerNode = null;\r\n    #bodyNode = null;\r\n    #footerNodeChildren = [];\r\n\r\n    #dialog = null;\r\n    #dialogBootstrap = null;\r\n\r\n\r\n    setPersistent(persistent) {\r\n        this.#persistent = persistent;\r\n    }\r\n\r\n    setSizeLarge() {\r\n        this.#additionalStyle = 'modal-lg';\r\n    }\r\n\r\n    setSizeExtraLarge() {\r\n        this.#additionalStyle = 'modal-xl';\r\n    }\r\n\r\n    setHeaderContent(headerNode) {\r\n        if (typeof headerNode === 'string') {\r\n            this.#headerNode = DomBuilder.element('strong', null, headerNode);\r\n        } else {\r\n            this.#headerNode = headerNode;\r\n        }\r\n    }\r\n\r\n    setBodyContent(bodyNode) {\r\n        this.#bodyNode = bodyNode;\r\n    }\r\n\r\n    addCloseButton(buttonText) {\r\n        const button = DomBuilder.element('button', { type: 'button', class: 'btn btn-secondary', 'data-bs-dismiss': 'modal' }, buttonText);\r\n        this.#footerNodeChildren.push(button);\r\n    }\r\n\r\n    addSubmitButton(buttonText, handler) {\r\n        const button = DomBuilder.element('button', { type: 'button', class: 'btn btn-primary', 'data-bs-dismiss': 'modal' }, buttonText);\r\n        button.addEventListener('click', handler);\r\n        this.#footerNodeChildren.push(button);\r\n    }\r\n\r\n    addButton(button) {\r\n        this.#footerNodeChildren.push(button);\r\n    }\r\n\r\n    show(dialogAnchor) {\r\n        if (window.bootstrap === undefined) {\r\n            console.error('Bootstrap library not available');\r\n            return;\r\n        }\r\n\r\n        if (this.#dialog === null) {\r\n            this.#dialog = DomBuilder.div({ class: 'modal fade', tabindex: '-1', role: 'dialog', 'aria-hidden': 'true' }, [\r\n                DomBuilder.div({ class: `modal-dialog modal-dialog-centered ${this.#additionalStyle}` }, [\r\n                    DomBuilder.div({ class: 'modal-content' }, [\r\n                        DomBuilder.div({ class: 'modal-header' }, this.#headerNode),\r\n                        DomBuilder.div({ class: 'modal-body' }, this.#bodyNode),\r\n                        DomBuilder.div({ class: 'modal-footer' }, this.#footerNodeChildren)\r\n                    ])\r\n                ])\r\n            ]);\r\n\r\n            // add into DOM\r\n            dialogAnchor.appendChild(this.#dialog);\r\n        }\r\n\r\n        this.#dialogBootstrap = new window.bootstrap.Modal(this.#dialog);\r\n\r\n        if (!this.#persistent) {\r\n            // remove from DOM after hide\r\n            this.#dialog.addEventListener('hidden.bs.modal', () => {\r\n                dialogAnchor.removeChild(this.#dialog);\r\n            });\r\n        }\r\n\r\n        this.#dialogBootstrap.show();\r\n    }\r\n\r\n    hide() {\r\n        if (this.#dialog !== null) {\r\n            this.#dialogBootstrap.hide();\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n *\r\n * @version 2023-12-22\r\n * @author Patrik Harag\r\n */\r\nclass BootstrapToast {\r\n\r\n    #headerNode = null;\r\n    #bodyNode = null;\r\n\r\n    #toast = null;\r\n    #toastBootstrap = null;\r\n\r\n    #dataDelay = 1000 * 60 * 60;  // ms\r\n\r\n    setHeaderContent(headerNode) {\r\n        if (typeof headerNode === 'string') {\r\n            headerNode = DomBuilder.element('strong', headerNode);\r\n        }\r\n        this.#headerNode = DomBuilder.span(headerNode, { class: 'me-auto' });\r\n    }\r\n\r\n    setBodyContent(bodyNode) {\r\n        this.#bodyNode = bodyNode;\r\n    }\r\n\r\n    setDelay(milliseconds) {\r\n        this.#dataDelay = milliseconds;\r\n    }\r\n\r\n    show(dialogAnchor) {\r\n        if (window.bootstrap === undefined) {\r\n            console.error('Bootstrap library not available');\r\n            return;\r\n        }\r\n\r\n        const wrapperAttributes = {\r\n            class: 'position-fixed bottom-0 right-0 p-3',\r\n            style: 'z-index: 5; right: 0; bottom: 0;'\r\n        };\r\n        const toastAttributes = {\r\n            class: 'toast hide',\r\n            role: 'alert',\r\n            'aria-live': 'assertive',\r\n            'aria-atomic': 'true',\r\n            'data-bs-delay': this.#dataDelay\r\n        };\r\n        const wrapper = DomBuilder.div(wrapperAttributes, [\r\n            this.#toast = DomBuilder.div(toastAttributes, [\r\n                DomBuilder.div({ class: 'toast-header' }, [\r\n                    this.#headerNode,\r\n                    DomBuilder.button('', {\r\n                        type: 'button',\r\n                        class: 'btn-close',\r\n                        'data-bs-dismiss': 'toast',\r\n                        'aria-label': 'Close'\r\n                    })\r\n                ]),\r\n                DomBuilder.div({ class: 'toast-body' }, [\r\n                    this.#bodyNode,\r\n\r\n                ])\r\n            ])\r\n        ]);\r\n\r\n        // add into DOM\r\n        dialogAnchor.append(wrapper);\r\n\r\n        this.#toastBootstrap = new window.bootstrap.Toast(this.#toast);\r\n\r\n        // remove from DOM after hide\r\n        this.#toast.addEventListener('hidden.bs.toast', () => {\r\n            dialogAnchor.removeChild(wrapper);\r\n        });\r\n\r\n        this.#toastBootstrap.show();\r\n    }\r\n\r\n    hide() {\r\n        if (this.#toast !== null) {\r\n            this.#toastBootstrap.hide();\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n *\r\n * @version 2023-12-22\r\n * @author Patrik Harag\r\n */\r\nclass BootstrapSimpleForm {\r\n\r\n    /** @type {{key:string,label:string,input:HTMLElement}[]} */\r\n    #formFields = [];\r\n    #submitButton = null;\r\n\r\n    addTextArea(label, key, initialValue = '', rows = 8) {\r\n        let input = DomBuilder.element('textarea', { class: 'form-control', rows: rows }, initialValue);\r\n        this.#formFields.push({\r\n            key: key,\r\n            label: label,\r\n            input: input\r\n        });\r\n        return input;\r\n    }\r\n\r\n    addInput(label, key, initialValue = '') {\r\n        let input = DomBuilder.element('input', { class: 'form-control' });\r\n        if (initialValue) {\r\n            input.value = initialValue;\r\n        }\r\n        this.#formFields.push({\r\n            key: key,\r\n            label: label,\r\n            input: input\r\n        });\r\n        return input;\r\n    }\r\n\r\n    addSubmitButton(text, handler) {\r\n        this.#submitButton = DomBuilder.button(text, { class: 'btn btn-primary' }, e => {\r\n            handler(this.getData());\r\n        });\r\n    }\r\n\r\n    createNode() {\r\n        let form = DomBuilder.element('form', { action: 'javascript:void(0);' });\r\n\r\n        for (let formField of this.#formFields) {\r\n            form.append(DomBuilder.div({ class: 'mb-3' }, [\r\n                DomBuilder.element('label', null, formField.label),\r\n                formField.input\r\n            ]));\r\n        }\r\n\r\n        if (this.#submitButton) {\r\n            form.append(this.#submitButton);\r\n        }\r\n\r\n        return form;\r\n    }\r\n\r\n    getData() {\r\n        let data = {};\r\n        for (let formField of this.#formFields) {\r\n            data[formField.key] = formField.input.value;\r\n        }\r\n        return data;\r\n    }\r\n}\r\n","// Sand Game JS; Patrik Harag, https://harag.cz; all rights reserved\r\n\r\n/**\r\n * @interface\r\n *\r\n * @author Patrik Harag\r\n * @version 2023-08-19\r\n */\r\nexport default class Action {\r\n\r\n    /**\r\n     *\r\n     * @param controller {Controller}\r\n     * @returns void\r\n     */\r\n    performAction(controller) {\r\n        throw 'Not implemented';\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param func {function(controller:Controller):void}\r\n     * @returns {ActionAnonymous}\r\n     */\r\n    static create(func) {\r\n        return new ActionAnonymous(func);\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param def {boolean}\r\n     * @param func {function(controller:Controller,v:boolean):void}\r\n     * @returns {ActionAnonymous}\r\n     */\r\n    static createToggle(def, func) {\r\n        let state = def;\r\n        return new ActionAnonymous(function (c) {\r\n            state = !state;\r\n            func(c, state);\r\n        });\r\n    }\r\n}\r\n\r\nclass ActionAnonymous extends Action {\r\n    #func;\r\n\r\n    constructor(func) {\r\n        super();\r\n        this.#func = func;\r\n    }\r\n\r\n    performAction(controller) {\r\n        this.#func(controller);\r\n    }\r\n}\r\n","// Sand Game JS; Patrik Harag, https://harag.cz; all rights reserved\r\n\r\n/**\r\n * @interface\r\n *\r\n * @author Patrik Harag\r\n * @version 2023-12-22\r\n */\r\nexport default class Component {\r\n\r\n    /**\r\n     *\r\n     * @param controller {Controller}\r\n     * @return {HTMLElement}\r\n     */\r\n    createNode(controller) {\r\n        throw 'Not implemented';\r\n    }\r\n}\r\n","// Sand Game JS; Patrik Harag, https://harag.cz; all rights reserved\r\n\r\nimport Component from \"./Component\";\r\nimport DomBuilder from \"../DomBuilder\";\r\nimport Action from \"../action/Action\";\r\n\r\n/**\r\n *\r\n * @author Patrik Harag\r\n * @version 2023-12-05\r\n */\r\nexport default class ComponentButton extends Component {\r\n\r\n    static CLASS_PRIMARY = 'btn-primary';\r\n    static CLASS_SECONDARY = 'btn-secondary';\r\n    static CLASS_INFO = 'btn-info';\r\n    static CLASS_SUCCESS = 'btn-success';\r\n    static CLASS_WARNING = 'btn-warning';\r\n    static CLASS_LIGHT = 'btn-light';\r\n\r\n    static CLASS_OUTLINE_PRIMARY = 'btn-outline-primary';\r\n    static CLASS_OUTLINE_SECONDARY = 'btn-outline-secondary';\r\n    static CLASS_OUTLINE_INFO = 'btn-outline-info';\r\n    static CLASS_OUTLINE_SUCCESS = 'btn-outline-success';\r\n    static CLASS_OUTLINE_WARNING = 'btn-outline-warning';\r\n    static CLASS_OUTLINE_LIGHT = 'btn-outline-light';\r\n\r\n\r\n    #label;\r\n    #action;\r\n    #cssClass;\r\n\r\n    /**\r\n     *\r\n     * @param label {string|HTMLElement|HTMLElement[]}\r\n     * @param cssClass {string|null}\r\n     * @param action {Action|function}\r\n     */\r\n    constructor(label, cssClass, action) {\r\n        super();\r\n        this.#label = label;\r\n        this.#action = (typeof action === \"function\" ? Action.create(action) : action);\r\n        this.#cssClass = (cssClass == null ? ComponentButton.CLASS_PRIMARY : cssClass);\r\n    }\r\n\r\n    createNode(controller) {\r\n        return DomBuilder.button(this.#label, { class: 'btn ' + this.#cssClass }, e => {\r\n            this.#action.performAction(controller);\r\n        });\r\n    }\r\n}\r\n","// Sand Game JS; Patrik Harag, https://harag.cz; all rights reserved\r\n\r\n/**\r\n * @interface\r\n *\r\n * @author Patrik Harag\r\n * @version 2023-08-27\r\n */\r\nexport default class Renderer {\r\n\r\n    trigger(x, y) {\r\n        throw 'Not implemented';\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param changedChunks {boolean[]}\r\n     * @return {void}\r\n     */\r\n    render(changedChunks) {\r\n        throw 'Not implemented';\r\n    }\r\n}\r\n","// Sand Game JS; Patrik Harag, https://harag.cz; all rights reserved\r\n\r\nimport Renderer from \"./Renderer\";\r\n\r\n/**\r\n * Null renderer. For testing purposes - to measure effects of rendering...\r\n *\r\n * @author Patrik Harag\r\n * @version 2023-10-11\r\n */\r\nexport default class RendererNull extends Renderer {\r\n\r\n    constructor() {\r\n        super();\r\n    }\r\n\r\n    trigger(x, y) {\r\n        // ignore\r\n    }\r\n\r\n    render(changedChunks) {\r\n        // ignore\r\n    }\r\n}","// Sand Game JS; Patrik Harag, https://harag.cz; all rights reserved\r\n\r\n/**\r\n * @interface\r\n *\r\n * @author Patrik Harag\r\n * @version 2024-05-25\r\n */\r\nexport default class RendererInitializer {\r\n\r\n    getContextType() {\r\n        throw 'Not implemented'\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param elementArea\r\n     * @param chunkSize\r\n     * @param context\r\n     * @return {Renderer}\r\n     */\r\n    initialize(elementArea, chunkSize, context) {\r\n        throw 'Not implemented'\r\n    }\r\n}\r\n","// Sand Game JS; Patrik Harag, https://harag.cz; all rights reserved\r\n\r\nimport RendererNull from \"./RendererNull\";\r\nimport RendererInitializer from \"./RendererInitializer\";\r\n\r\n/**\r\n *\r\n * @author Patrik Harag\r\n * @version 2024-04-06\r\n */\r\nexport default class RendererInitializerNull extends RendererInitializer {\r\n\r\n    constructor() {\r\n        super();\r\n    }\r\n\r\n    getContextType() {\r\n        return '2d';\r\n    }\r\n\r\n    initialize(elementArea, chunkSize, context) {\r\n        return new RendererNull();\r\n    }\r\n}","// Sand Game JS; Patrik Harag, https://harag.cz; all rights reserved\r\n\r\n/**\r\n * @author Patrik Harag\r\n * @version 2023-02-18\r\n */\r\nexport default class RenderingMode {\r\n\r\n    /**\r\n     * Element rendering function.\r\n     *\r\n     * Default implementation:\r\n     * <pre>\r\n     *     data[dataIndex] = ElementTail.getColorRed(elementTail);\r\n     *     data[dataIndex + 1] = ElementTail.getColorGreen(elementTail);\r\n     *     data[dataIndex + 2] = ElementTail.getColorBlue(elementTail);\r\n     * </pre>\r\n     *\r\n     * @param data\r\n     * @param dataIndex\r\n     * @param elementHead\r\n     * @param elementTail\r\n     */\r\n    apply(data, dataIndex, elementHead, elementTail) {\r\n        throw 'Not implemented'\r\n    }\r\n}","// Sand Game JS; Patrik Harag, https://harag.cz; all rights reserved\r\n\r\n/**\r\n * Tools for working with the element head.\r\n *\r\n * The element head structure: <code>0x[type][beh.][flags][temp.]</code> (32b)\r\n * <pre>\r\n *     | type class   3b  | type modifiers                 5b  |\r\n *     | behaviour             4b  | special               4b  |\r\n *     | heat modifiers index                              8b  |\r\n *     | temperature                                       8b  |\r\n * </pre>\r\n *\r\n * Type modifier for powder-like types: (5b)\r\n * <pre>\r\n *     | sliding  1b |  direction  1b  | momentum  3b  |\r\n * </pre>\r\n *\r\n * Type modifier for solid-like types: (5b)\r\n * <pre>\r\n *     | neighbourhood type  1b |  body id  4b  |\r\n * </pre>\r\n *\r\n * @author Patrik Harag\r\n * @version 2024-05-26\r\n */\r\nexport default class ElementHead {\r\n\r\n    static FIELD_TYPE_CLASS_SIZE = 3;  // bits\r\n    static TYPE_AIR = 0x0;\r\n    static TYPE_EFFECT = 0x1;\r\n    static TYPE_GAS = 0x2;\r\n    static TYPE_POWDER_FLOATING = 0x3;   // floating, not wet, can turn into wet\r\n    static TYPE_FLUID = 0x4;\r\n    static TYPE_POWDER = 0x5;  // not wet, can turn into wet\r\n    static TYPE_POWDER_WET = 0x6;  // wet\r\n    static TYPE_STATIC = 0x7;\r\n\r\n    static FIELD_TYPE_MODIFIERS_SIZE = 5;  // bits\r\n\r\n    static FIELD_BEHAVIOUR_SIZE = 4;  // bits\r\n    static BEHAVIOUR_NONE = 0x0;\r\n    static BEHAVIOUR_SOIL = 0x1;\r\n    static BEHAVIOUR_GRASS = 0x2;\r\n    static BEHAVIOUR_3 = 0x3;  // unused\r\n    static BEHAVIOUR_4 = 0x4;  // unused\r\n    static BEHAVIOUR_TREE = 0x5;\r\n    static BEHAVIOUR_TREE_ROOT = 0x6;\r\n    static BEHAVIOUR_TREE_TRUNK = 0x7;\r\n    static BEHAVIOUR_TREE_LEAF = 0x8;\r\n    static BEHAVIOUR_FIRE = 0x9;\r\n    static BEHAVIOUR_FIRE_SOURCE = 0xA;\r\n    static BEHAVIOUR_METEOR = 0xB;  // TODO: to entity?\r\n    static BEHAVIOUR_LIQUID = 0xC;\r\n    static BEHAVIOUR_ENTITY = 0xD;\r\n    static BEHAVIOUR_E = 0xE;\r\n    static BEHAVIOUR_F = 0xF;\r\n\r\n    static FIELD_SPECIAL_SIZE = 4;  // bits\r\n    static SPECIAL_LIQUID_WATER = 0;\r\n    static SPECIAL_LIQUID_LIGHT_OIL = 5;\r\n    static SPECIAL_LIQUID_HEAVY_MOLTEN = 10;\r\n\r\n    static FIELD_HMI_SIZE = 8;  // bits\r\n\r\n    static FIELD_TEMPERATURE_SIZE = 8;  // bits\r\n\r\n\r\n    static of(type8, behaviour8 = 0, modifiers8 = 0, temperature = 0) {\r\n        let value = temperature << 8;\r\n        value = (value | modifiers8) << 8;\r\n        value = (value | behaviour8) << 8;\r\n        value = value | type8;\r\n        return value;\r\n    }\r\n\r\n    static type8(typeClass, typeModifiers = 0) {\r\n        return typeClass | (typeModifiers << 3);\r\n    }\r\n\r\n    static type8Powder(typeClass, momentum = 0, sliding = 0, direction = 0) {\r\n        let value = momentum << 1;\r\n        value = (value | direction) << 1;\r\n        value = (value | sliding) << 3;\r\n        value = value | typeClass;\r\n        return value;\r\n    }\r\n\r\n    // TODO TYPE_FLUID: density, step size, ? viscosity, ? pressure\r\n    static type8Fluid(typeClass) {\r\n        return typeClass;\r\n    }\r\n\r\n    static type8Solid(typeClass, bodyId = 0, extendedNeighbourhood = true) {\r\n        let value = bodyId << 1;\r\n        value = (value | (extendedNeighbourhood ? 0 : 1)) << 3;\r\n        value = value | typeClass;\r\n        return value;\r\n    }\r\n\r\n    static behaviour8(behaviour = 0, special = 0) {\r\n        return behaviour | (special << 4);\r\n    }\r\n\r\n    static modifiers8(heatModIndex = 0) {\r\n        return heatModIndex;\r\n    }\r\n\r\n    // get methods\r\n\r\n    static getType(elementHead) {\r\n        return elementHead & 0x000000FF;\r\n    }\r\n\r\n    static getTypeClass(elementHead) {\r\n        return elementHead & 0x00000007;\r\n    }\r\n\r\n    static getTypeModifierPowderSliding(elementHead) {\r\n        return (elementHead >> 3) & 0x00000001;\r\n    }\r\n\r\n    static getTypeModifierPowderDirection(elementHead) {\r\n        return (elementHead >> 4) & 0x00000001;\r\n    }\r\n\r\n    static getTypeModifierPowderMomentum(elementHead) {\r\n        return (elementHead >> 5) & 0x00000007;\r\n    }\r\n\r\n    static getTypeModifierSolidNeighbourhoodType(elementHead) {\r\n        return (elementHead >> 3) & 0x00000001;\r\n    }\r\n\r\n    static getTypeModifierSolidBodyId(elementHead) {\r\n        return (elementHead >> 4) & 0x0000000F;\r\n    }\r\n\r\n    static getBehaviour(elementHead) {\r\n        return (elementHead >> 8) & 0x0000000F;\r\n    }\r\n\r\n    static getSpecial(elementHead) {\r\n        return (elementHead >> 12) & 0x0000000F;\r\n    }\r\n\r\n    static getHeatModIndex(elementHead) {\r\n        return (elementHead >> 16) & 0x000000FF;\r\n    }\r\n\r\n    static getTemperature(elementHead) {\r\n        return (elementHead >> 24) & 0x000000FF;\r\n    }\r\n\r\n    // set methods\r\n\r\n    static setType(elementHead, type) {\r\n        return (elementHead & 0xFFFFFF00) | type;\r\n    }\r\n\r\n    static setTypeClass(elementHead, type) {\r\n        return (elementHead & 0xFFFFFFF8) | type;\r\n    }\r\n\r\n    static setTypeModifierPowderSliding(elementHead, val) {\r\n        return (elementHead & 0xFFFFFFF7) | (val << 3);\r\n    }\r\n\r\n    static setTypeModifierPowderDirection(elementHead, val) {\r\n        return (elementHead & 0xFFFFFFEF) | (val << 4);\r\n    }\r\n\r\n    static setTypeModifierPowderMomentum(elementHead, val) {\r\n        return (elementHead & 0xFFFFFF1F) | (val << 5);\r\n    }\r\n\r\n    static setTypeModifierSolidNeighbourhoodType(elementHead, val) {\r\n        return (elementHead & 0xFFFFFFF7) | (val << 3);\r\n    }\r\n\r\n    static setTypeModifierSolidBodyId(elementHead, val) {\r\n        return (elementHead & 0xFFFFFF0F) | (val << 4);\r\n    }\r\n\r\n    static setBehaviour(elementHead, behaviour) {\r\n        return (elementHead & 0xFFFFF0FF) | (behaviour << 8);\r\n    }\r\n\r\n    static setSpecial(elementHead, special) {\r\n        return (elementHead & 0xFFFF0FFF) | (special << 12);\r\n    }\r\n\r\n    static setHeatModIndex(elementHead, heatModIndex) {\r\n        return (elementHead & 0xFF00FFFF) | (heatModIndex << 16);\r\n    }\r\n\r\n    static setTemperature(elementHead, temperature) {\r\n        return (elementHead & 0x00FFFFFF) | (temperature << 24);\r\n    }\r\n\r\n\r\n    // --- HEAT MODIFIERS ---\r\n\r\n    static #HEAT_MODS_COUNT = 16;\r\n    static #HEAT_MODS = Array(ElementHead.#HEAT_MODS_COUNT);\r\n\r\n    static #defHeatMods({i, conductiveIndex = 0.2, heatLossChanceTo10000 = 2500,\r\n                            flammableChanceTo10000 = 0, selfIgnitionChanceTo10000 = 0,\r\n                            flameHeat = 0, burnDownChanceTo10000 = 0,\r\n                            meltingTemperature = 0xFF + 1, meltingHMI = 0,\r\n                            hardeningTemperature = 0, hardeningHMI = 0}) {\r\n\r\n        const array = Array(10);\r\n        array[0] = conductiveIndex;\r\n        array[1] = heatLossChanceTo10000;\r\n        array[2] = flammableChanceTo10000;\r\n        array[3] = selfIgnitionChanceTo10000;\r\n        array[4] = flameHeat;\r\n        array[5] = burnDownChanceTo10000;\r\n        array[6] = meltingTemperature;\r\n        array[7] = meltingHMI;\r\n        array[8] = hardeningTemperature;\r\n        array[9] = hardeningHMI;\r\n\r\n        ElementHead.#HEAT_MODS[i] = array;\r\n        return i;\r\n    }\r\n\r\n    static HMI_DEFAULT = ElementHead.#defHeatMods({\r\n        i: 0\r\n        // default values\r\n    });\r\n\r\n    static HMI_CONDUCTIVE_1 = ElementHead.#defHeatMods({\r\n        i: 1,\r\n        conductiveIndex: 0.25,\r\n        heatLossChanceTo10000: 500\r\n    });\r\n\r\n    static HMI_CONDUCTIVE_2 = ElementHead.#defHeatMods({\r\n        i: 2,\r\n        conductiveIndex: 0.3,\r\n        heatLossChanceTo10000: 20\r\n    });\r\n\r\n    static HMI_CONDUCTIVE_3 = ElementHead.#defHeatMods({\r\n        i: 3,\r\n        conductiveIndex: 0.45,\r\n        heatLossChanceTo10000: 10\r\n    });\r\n\r\n    static HMI_GRASS_LIKE = ElementHead.#defHeatMods({\r\n        i: 4,\r\n        flammableChanceTo10000: 4500,\r\n        selfIgnitionChanceTo10000: 3,\r\n        flameHeat: 165,\r\n        burnDownChanceTo10000: 1000\r\n    });\r\n\r\n    static HMI_WOOD_LIKE = ElementHead.#defHeatMods({\r\n        i: 5,\r\n        flammableChanceTo10000: 100,\r\n        selfIgnitionChanceTo10000: 2,\r\n        flameHeat: 165,\r\n        burnDownChanceTo10000: 2\r\n    });\r\n\r\n    static HMI_LEAF_LIKE = ElementHead.#defHeatMods({\r\n        i: 6,\r\n        flammableChanceTo10000: 4500,\r\n        selfIgnitionChanceTo10000: 3,\r\n        flameHeat: 165,\r\n        burnDownChanceTo10000: 100\r\n    });\r\n\r\n    static HMI_METAL = ElementHead.#defHeatMods({\r\n        i: 7,\r\n        conductiveIndex: 0.45,\r\n        heatLossChanceTo10000: 10,\r\n        meltingTemperature: 200,\r\n        meltingHMI: 8\r\n    });\r\n\r\n    static HMI_MOLTEN = ElementHead.#defHeatMods({\r\n        i: 8,\r\n        conductiveIndex: 0.45,\r\n        heatLossChanceTo10000: 10,\r\n        hardeningTemperature: 150,\r\n        hardeningHMI: 7\r\n    });\r\n\r\n    static HMI_COAL = ElementHead.#defHeatMods({\r\n        i: 9,\r\n        conductiveIndex: 0.3,\r\n        heatLossChanceTo10000: 20,\r\n        flammableChanceTo10000: 500,\r\n        selfIgnitionChanceTo10000: 3,\r\n        flameHeat: 190,\r\n        burnDownChanceTo10000: 50\r\n    });\r\n\r\n    static HMI_THERMITE = ElementHead.#defHeatMods({\r\n        i: 10,\r\n        conductiveIndex: 0.45,\r\n        heatLossChanceTo10000: 10,\r\n        flammableChanceTo10000: 8000,\r\n        selfIgnitionChanceTo10000: 500,\r\n        flameHeat: 250,\r\n        burnDownChanceTo10000: 1000\r\n    });\r\n\r\n    static HMI_OIL = ElementHead.#defHeatMods({\r\n        i: 11,\r\n        conductiveIndex: 0.45,\r\n        heatLossChanceTo10000: 10,\r\n        flammableChanceTo10000: 10000,\r\n        selfIgnitionChanceTo10000: 2500,\r\n        flameHeat: 220,\r\n        burnDownChanceTo10000: 1000\r\n    });\r\n\r\n    static {\r\n        // fill missing definitions - bounds checking is not needed then...\r\n        for (let i = 0; i < ElementHead.#HEAT_MODS_COUNT; i++) {\r\n            if (ElementHead.#HEAT_MODS[i] === undefined) {\r\n                ElementHead.#defHeatMods(i);\r\n            }\r\n        }\r\n    }\r\n\r\n    // ---\r\n\r\n    static hmiToConductiveIndex(heatModIndex) {\r\n        return ElementHead.#HEAT_MODS[heatModIndex & 0xF][0];\r\n    }\r\n\r\n    static hmiToHeatLossChanceTo10000(heatModIndex) {\r\n        return ElementHead.#HEAT_MODS[heatModIndex & 0xF][1];\r\n    }\r\n\r\n    // how hard it is to ignite this element\r\n    static hmiToFlammableChanceTo10000(heatModIndex) {\r\n        return ElementHead.#HEAT_MODS[heatModIndex & 0xF][2];\r\n    }\r\n\r\n    // how hard it is to ignite this element\r\n    static hmiToSelfIgnitionChanceTo10000(heatModIndex) {\r\n        return ElementHead.#HEAT_MODS[heatModIndex & 0xF][3];\r\n    }\r\n\r\n    // how much heat this element produces while burning\r\n    static hmiToFlameHeat(heatModIndex) {\r\n        return ElementHead.#HEAT_MODS[heatModIndex & 0xF][4];\r\n    }\r\n\r\n    // how hard it is to burn down this element\r\n    static hmiToBurnDownChanceTo10000(heatModIndex) {\r\n        return ElementHead.#HEAT_MODS[heatModIndex & 0xF][5];\r\n    }\r\n\r\n    static hmiToMeltingTemperature(heatModIndex) {\r\n        return ElementHead.#HEAT_MODS[heatModIndex & 0xF][6];\r\n    }\r\n\r\n    static hmiToMeltingHMI(heatModIndex) {\r\n        return ElementHead.#HEAT_MODS[heatModIndex & 0xF][7];\r\n    }\r\n\r\n    static hmiToHardeningTemperature(heatModIndex) {\r\n        return ElementHead.#HEAT_MODS[heatModIndex & 0xF][8];\r\n    }\r\n\r\n    static hmiToHardeningHMI(heatModIndex) {\r\n        return ElementHead.#HEAT_MODS[heatModIndex & 0xF][9];\r\n    }\r\n}","// Sand Game JS; Patrik Harag, https://harag.cz; all rights reserved\r\n\r\nimport RenderingMode from \"./RenderingMode.js\";\r\nimport ElementHead from \"../ElementHead.js\";\r\n\r\n/**\r\n * @author Patrik Harag\r\n * @version 2023-08-18\r\n */\r\nexport default class RenderingModeElementType extends RenderingMode {\r\n\r\n    constructor() {\r\n        super();\r\n    }\r\n\r\n    #asColor(elementHead) {\r\n        switch (ElementHead.getTypeClass(elementHead)) {\r\n            case ElementHead.TYPE_AIR: return [255, 255, 255];\r\n            case ElementHead.TYPE_STATIC: return [0, 0, 0];\r\n            case ElementHead.TYPE_FLUID: return [0, 0, 255];\r\n            case ElementHead.TYPE_POWDER:\r\n            case ElementHead.TYPE_POWDER_WET:\r\n            case ElementHead.TYPE_POWDER_FLOATING:\r\n                if (ElementHead.getTypeModifierPowderSliding(elementHead) === 1) {\r\n                    if (ElementHead.getTypeModifierPowderDirection(elementHead) === 1) {\r\n                        return [232, 137, 70];\r\n                    } else {\r\n                        return [255, 0, 0];\r\n                    }\r\n                }\r\n                switch (ElementHead.getTypeClass(elementHead)) {\r\n                    case ElementHead.TYPE_POWDER: return [36, 163, 57];\r\n                    case ElementHead.TYPE_POWDER_WET: return [44, 122, 57];\r\n                    case ElementHead.TYPE_POWDER_FLOATING: return [16, 194, 45];\r\n                }\r\n                // fallthrough\r\n            default: return [255, 0, 125];\r\n        }\r\n    }\r\n\r\n    apply(data, dataIndex, elementHead, elementTail) {\r\n        const [r, g, b] = this.#asColor(elementHead);\r\n\r\n        data[dataIndex] = r;\r\n        data[dataIndex + 1] = g;\r\n        data[dataIndex + 2] = b;\r\n\r\n        return false;\r\n    }\r\n}","// Sand Game JS; Patrik Harag, https://harag.cz; all rights reserved\r\n\r\n/**\r\n *\r\n * @author Patrik Harag\r\n * @version 2023-12-09\r\n */\r\nexport default class Assets {\r\n\r\n    /**\r\n     *\r\n     * @param base64\r\n     * @param maxWidth {number|undefined}\r\n     * @param maxHeight {number|undefined}\r\n     * @returns {Promise<ImageData>}\r\n     */\r\n    static asImageData(base64, maxWidth=undefined, maxHeight=undefined) {\r\n        function countSize(imageWidth, imageHeight) {\r\n            let w = imageWidth;\r\n            let h = imageHeight;\r\n\r\n            if (maxWidth !== undefined && w > maxWidth) {\r\n                const wScale = w / maxWidth;\r\n                w = maxWidth;\r\n                h = h / wScale;\r\n            }\r\n            if (maxHeight !== undefined && h > maxHeight) {\r\n                const hScale = h / maxHeight;\r\n                h = maxHeight;\r\n                w = w / hScale;\r\n            }\r\n\r\n            return [Math.trunc(w), Math.trunc(h)];\r\n        }\r\n\r\n        return new Promise((resolve, reject) => {\r\n            try {\r\n                // http://stackoverflow.com/questions/3528299/get-pixel-color-of-base64-png-using-javascript\r\n                let image = new Image();\r\n                image.onload = () => {\r\n                    let canvas = document.createElement('canvas');\r\n                    let [w, h] = countSize(image.width, image.height);\r\n                    canvas.width = w;\r\n                    canvas.height = h;\r\n\r\n                    let context = canvas.getContext('2d');\r\n                    context.drawImage(image, 0, 0, canvas.width, canvas.height);\r\n\r\n                    let imageData = context.getImageData(0, 0, canvas.width, canvas.height);\r\n                    resolve(imageData);\r\n                };\r\n                image.onerror = () => {\r\n                    reject('Cannot load image');\r\n                };\r\n                image.src = base64;\r\n            } catch (e) {\r\n                reject(e);\r\n            }\r\n        });\r\n    }\r\n}","// Sand Game JS; Patrik Harag, https://harag.cz; all rights reserved\r\n\r\nimport RenderingMode from \"./RenderingMode.js\";\r\nimport ElementHead from \"../ElementHead.js\";\r\nimport Assets from \"../../Assets.js\";\r\n\r\nimport _ASSET_GRADIENT_RAINBOW from './assets/heatmap.palette.png'\r\n\r\n/**\r\n * @author Patrik Harag\r\n * @version 2023-08-14\r\n */\r\nexport default class RenderingModeHeatmap extends RenderingMode {\r\n\r\n    /** @type ImageData */\r\n    #gradientImageData = null;\r\n\r\n    constructor() {\r\n        super();\r\n        Assets.asImageData(_ASSET_GRADIENT_RAINBOW).then(d => this.#gradientImageData = d);\r\n    }\r\n\r\n    apply(data, dataIndex, elementHead, elementTail) {\r\n        if (this.#gradientImageData === null) {\r\n            // not loaded yet\r\n            return;\r\n        }\r\n\r\n        if (elementHead === 0x00) {\r\n            // background\r\n            data[dataIndex] = 0x00;\r\n            data[dataIndex + 1] = 0x00;\r\n            data[dataIndex + 2] = 0x00;\r\n        } else {\r\n            const temperature = ElementHead.getTemperature(elementHead);\r\n            const x = Math.trunc(temperature / (1 << ElementHead.FIELD_TEMPERATURE_SIZE) * this.#gradientImageData.width);\r\n            const gradIndex = x * 4;\r\n            data[dataIndex] = this.#gradientImageData.data[gradIndex];\r\n            data[dataIndex + 1] = this.#gradientImageData.data[gradIndex + 1];\r\n            data[dataIndex + 2] = this.#gradientImageData.data[gradIndex + 2];\r\n        }\r\n    }\r\n}","var img = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfQAAAABCAIAAACnnMvDAAAACXBIWXMAAAsTAAALEwEAmpwYAAABTUlEQVQ4T22QUZIjMQhDHzhH32PHYj/UZoiTLlcXloQQfsE/AF6QsM6/i4CABa9T5Kj5RPqfkL9s29y2l6e75lBff33Nx2h6AcfGxxP6ykjU+Exkw5m3YxqfbnPRucfPSFev1+p64rbqrm9NAif2xfYiPc5UCz5sixRLZLF2poDMylSmcilcLxkBMhShpBIlCirZiwoEGDz4U/tqxPqg1oMrqcEqkak2sW2g9WlrK2DiBsfQJ1JQi90ZAuLIEnmdwbrwXg+42ImggvpK8mQ+UTvMh//Fdh6D/Xrt1uITqc77/C2SUlRFKaVUpSpFbFKECAEgEGwo2CCog3Bwawy6qNNrZOJumV3XiIu98I4xRztMt7Smz1zkW3YtcmnMXtTPqK35yZ4RJd4bQELiLarYG4m9nwltsMe61/COY6rgfWa+x8xmO1FbWd91P5Lr/2afRpQBYZvbAAAAAElFTkSuQmCC\";\n  export default img;","(function(a,b){if(\"function\"==typeof define&&define.amd)define([],b);else if(\"undefined\"!=typeof exports)b();else{b(),a.FileSaver={exports:{}}.exports}})(this,function(){\"use strict\";function b(a,b){return\"undefined\"==typeof b?b={autoBom:!1}:\"object\"!=typeof b&&(console.warn(\"Deprecated: Expected third argument to be a object\"),b={autoBom:!b}),b.autoBom&&/^\\s*(?:text\\/\\S*|application\\/xml|\\S*\\/\\S*\\+xml)\\s*;.*charset\\s*=\\s*utf-8/i.test(a.type)?new Blob([\"\\uFEFF\",a],{type:a.type}):a}function c(a,b,c){var d=new XMLHttpRequest;d.open(\"GET\",a),d.responseType=\"blob\",d.onload=function(){g(d.response,b,c)},d.onerror=function(){console.error(\"could not download file\")},d.send()}function d(a){var b=new XMLHttpRequest;b.open(\"HEAD\",a,!1);try{b.send()}catch(a){}return 200<=b.status&&299>=b.status}function e(a){try{a.dispatchEvent(new MouseEvent(\"click\"))}catch(c){var b=document.createEvent(\"MouseEvents\");b.initMouseEvent(\"click\",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),a.dispatchEvent(b)}}var f=\"object\"==typeof window&&window.window===window?window:\"object\"==typeof self&&self.self===self?self:\"object\"==typeof global&&global.global===global?global:void 0,a=f.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),g=f.saveAs||(\"object\"!=typeof window||window!==f?function(){}:\"download\"in HTMLAnchorElement.prototype&&!a?function(b,g,h){var i=f.URL||f.webkitURL,j=document.createElement(\"a\");g=g||b.name||\"download\",j.download=g,j.rel=\"noopener\",\"string\"==typeof b?(j.href=b,j.origin===location.origin?e(j):d(j.href)?c(b,g,h):e(j,j.target=\"_blank\")):(j.href=i.createObjectURL(b),setTimeout(function(){i.revokeObjectURL(j.href)},4E4),setTimeout(function(){e(j)},0))}:\"msSaveOrOpenBlob\"in navigator?function(f,g,h){if(g=g||f.name||\"download\",\"string\"!=typeof f)navigator.msSaveOrOpenBlob(b(f,h),g);else if(d(f))c(f,g,h);else{var i=document.createElement(\"a\");i.href=f,i.target=\"_blank\",setTimeout(function(){e(i)})}}:function(b,d,e,g){if(g=g||open(\"\",\"_blank\"),g&&(g.document.title=g.document.body.innerText=\"downloading...\"),\"string\"==typeof b)return c(b,d,e);var h=\"application/octet-stream\"===b.type,i=/constructor/i.test(f.HTMLElement)||f.safari,j=/CriOS\\/[\\d]+/.test(navigator.userAgent);if((j||h&&i||a)&&\"undefined\"!=typeof FileReader){var k=new FileReader;k.onloadend=function(){var a=k.result;a=j?a:a.replace(/^data:[^;]*;/,\"data:attachment/file;\"),g?g.location.href=a:location=a,g=null},k.readAsDataURL(b)}else{var l=f.URL||f.webkitURL,m=l.createObjectURL(b);g?g.location=m:location.href=m,g=null,setTimeout(function(){l.revokeObjectURL(m)},4E4)}});f.saveAs=g.saveAs=g,\"undefined\"!=typeof module&&(module.exports=g)});\n\n//# sourceMappingURL=FileSaver.min.js.map","// DEFLATE is a complex format; to read this code, you should probably check the RFC first:\n// https://tools.ietf.org/html/rfc1951\n// You may also wish to take a look at the guide I made about this program:\n// https://gist.github.com/101arrowz/253f31eb5abc3d9275ab943003ffecad\n// Some of the following code is similar to that of UZIP.js:\n// https://github.com/photopea/UZIP.js\n// However, the vast majority of the codebase has diverged from UZIP.js to increase performance and reduce bundle size.\n// Sometimes 0 will appear where -1 would be more appropriate. This is because using a uint\n// is better for memory in most engines (I *think*).\nvar ch2 = {};\nvar wk = (function (c, id, msg, transfer, cb) {\n    var w = new Worker(ch2[id] || (ch2[id] = URL.createObjectURL(new Blob([\n        c + ';addEventListener(\"error\",function(e){e=e.error;postMessage({$e$:[e.message,e.code,e.stack]})})'\n    ], { type: 'text/javascript' }))));\n    w.onmessage = function (e) {\n        var d = e.data, ed = d.$e$;\n        if (ed) {\n            var err = new Error(ed[0]);\n            err['code'] = ed[1];\n            err.stack = ed[2];\n            cb(err, null);\n        }\n        else\n            cb(null, d);\n    };\n    w.postMessage(msg, transfer);\n    return w;\n});\n\n// aliases for shorter compressed code (most minifers don't do this)\nvar u8 = Uint8Array, u16 = Uint16Array, u32 = Uint32Array;\n// fixed length extra bits\nvar fleb = new u8([0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5, 0, /* unused */ 0, 0, /* impossible */ 0]);\n// fixed distance extra bits\n// see fleb note\nvar fdeb = new u8([0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10, 11, 11, 12, 12, 13, 13, /* unused */ 0, 0]);\n// code length index map\nvar clim = new u8([16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15]);\n// get base, reverse index map from extra bits\nvar freb = function (eb, start) {\n    var b = new u16(31);\n    for (var i = 0; i < 31; ++i) {\n        b[i] = start += 1 << eb[i - 1];\n    }\n    // numbers here are at max 18 bits\n    var r = new u32(b[30]);\n    for (var i = 1; i < 30; ++i) {\n        for (var j = b[i]; j < b[i + 1]; ++j) {\n            r[j] = ((j - b[i]) << 5) | i;\n        }\n    }\n    return [b, r];\n};\nvar _a = freb(fleb, 2), fl = _a[0], revfl = _a[1];\n// we can ignore the fact that the other numbers are wrong; they never happen anyway\nfl[28] = 258, revfl[258] = 28;\nvar _b = freb(fdeb, 0), fd = _b[0], revfd = _b[1];\n// map of value to reverse (assuming 16 bits)\nvar rev = new u16(32768);\nfor (var i = 0; i < 32768; ++i) {\n    // reverse table algorithm from SO\n    var x = ((i & 0xAAAA) >>> 1) | ((i & 0x5555) << 1);\n    x = ((x & 0xCCCC) >>> 2) | ((x & 0x3333) << 2);\n    x = ((x & 0xF0F0) >>> 4) | ((x & 0x0F0F) << 4);\n    rev[i] = (((x & 0xFF00) >>> 8) | ((x & 0x00FF) << 8)) >>> 1;\n}\n// create huffman tree from u8 \"map\": index -> code length for code index\n// mb (max bits) must be at most 15\n// TODO: optimize/split up?\nvar hMap = (function (cd, mb, r) {\n    var s = cd.length;\n    // index\n    var i = 0;\n    // u16 \"map\": index -> # of codes with bit length = index\n    var l = new u16(mb);\n    // length of cd must be 288 (total # of codes)\n    for (; i < s; ++i) {\n        if (cd[i])\n            ++l[cd[i] - 1];\n    }\n    // u16 \"map\": index -> minimum code for bit length = index\n    var le = new u16(mb);\n    for (i = 0; i < mb; ++i) {\n        le[i] = (le[i - 1] + l[i - 1]) << 1;\n    }\n    var co;\n    if (r) {\n        // u16 \"map\": index -> number of actual bits, symbol for code\n        co = new u16(1 << mb);\n        // bits to remove for reverser\n        var rvb = 15 - mb;\n        for (i = 0; i < s; ++i) {\n            // ignore 0 lengths\n            if (cd[i]) {\n                // num encoding both symbol and bits read\n                var sv = (i << 4) | cd[i];\n                // free bits\n                var r_1 = mb - cd[i];\n                // start value\n                var v = le[cd[i] - 1]++ << r_1;\n                // m is end value\n                for (var m = v | ((1 << r_1) - 1); v <= m; ++v) {\n                    // every 16 bit value starting with the code yields the same result\n                    co[rev[v] >>> rvb] = sv;\n                }\n            }\n        }\n    }\n    else {\n        co = new u16(s);\n        for (i = 0; i < s; ++i) {\n            if (cd[i]) {\n                co[i] = rev[le[cd[i] - 1]++] >>> (15 - cd[i]);\n            }\n        }\n    }\n    return co;\n});\n// fixed length tree\nvar flt = new u8(288);\nfor (var i = 0; i < 144; ++i)\n    flt[i] = 8;\nfor (var i = 144; i < 256; ++i)\n    flt[i] = 9;\nfor (var i = 256; i < 280; ++i)\n    flt[i] = 7;\nfor (var i = 280; i < 288; ++i)\n    flt[i] = 8;\n// fixed distance tree\nvar fdt = new u8(32);\nfor (var i = 0; i < 32; ++i)\n    fdt[i] = 5;\n// fixed length map\nvar flm = /*#__PURE__*/ hMap(flt, 9, 0), flrm = /*#__PURE__*/ hMap(flt, 9, 1);\n// fixed distance map\nvar fdm = /*#__PURE__*/ hMap(fdt, 5, 0), fdrm = /*#__PURE__*/ hMap(fdt, 5, 1);\n// find max of array\nvar max = function (a) {\n    var m = a[0];\n    for (var i = 1; i < a.length; ++i) {\n        if (a[i] > m)\n            m = a[i];\n    }\n    return m;\n};\n// read d, starting at bit p and mask with m\nvar bits = function (d, p, m) {\n    var o = (p / 8) | 0;\n    return ((d[o] | (d[o + 1] << 8)) >> (p & 7)) & m;\n};\n// read d, starting at bit p continuing for at least 16 bits\nvar bits16 = function (d, p) {\n    var o = (p / 8) | 0;\n    return ((d[o] | (d[o + 1] << 8) | (d[o + 2] << 16)) >> (p & 7));\n};\n// get end of byte\nvar shft = function (p) { return ((p + 7) / 8) | 0; };\n// typed array slice - allows garbage collector to free original reference,\n// while being more compatible than .slice\nvar slc = function (v, s, e) {\n    if (s == null || s < 0)\n        s = 0;\n    if (e == null || e > v.length)\n        e = v.length;\n    // can't use .constructor in case user-supplied\n    var n = new (v.BYTES_PER_ELEMENT == 2 ? u16 : v.BYTES_PER_ELEMENT == 4 ? u32 : u8)(e - s);\n    n.set(v.subarray(s, e));\n    return n;\n};\n/**\n * Codes for errors generated within this library\n */\nexport var FlateErrorCode = {\n    UnexpectedEOF: 0,\n    InvalidBlockType: 1,\n    InvalidLengthLiteral: 2,\n    InvalidDistance: 3,\n    StreamFinished: 4,\n    NoStreamHandler: 5,\n    InvalidHeader: 6,\n    NoCallback: 7,\n    InvalidUTF8: 8,\n    ExtraFieldTooLong: 9,\n    InvalidDate: 10,\n    FilenameTooLong: 11,\n    StreamFinishing: 12,\n    InvalidZipData: 13,\n    UnknownCompressionMethod: 14\n};\n// error codes\nvar ec = [\n    'unexpected EOF',\n    'invalid block type',\n    'invalid length/literal',\n    'invalid distance',\n    'stream finished',\n    'no stream handler',\n    ,\n    'no callback',\n    'invalid UTF-8 data',\n    'extra field too long',\n    'date not in range 1980-2099',\n    'filename too long',\n    'stream finishing',\n    'invalid zip data'\n    // determined by unknown compression method\n];\n;\nvar err = function (ind, msg, nt) {\n    var e = new Error(msg || ec[ind]);\n    e.code = ind;\n    if (Error.captureStackTrace)\n        Error.captureStackTrace(e, err);\n    if (!nt)\n        throw e;\n    return e;\n};\n// expands raw DEFLATE data\nvar inflt = function (dat, buf, st) {\n    // source length\n    var sl = dat.length;\n    if (!sl || (st && st.f && !st.l))\n        return buf || new u8(0);\n    // have to estimate size\n    var noBuf = !buf || st;\n    // no state\n    var noSt = !st || st.i;\n    if (!st)\n        st = {};\n    // Assumes roughly 33% compression ratio average\n    if (!buf)\n        buf = new u8(sl * 3);\n    // ensure buffer can fit at least l elements\n    var cbuf = function (l) {\n        var bl = buf.length;\n        // need to increase size to fit\n        if (l > bl) {\n            // Double or set to necessary, whichever is greater\n            var nbuf = new u8(Math.max(bl * 2, l));\n            nbuf.set(buf);\n            buf = nbuf;\n        }\n    };\n    //  last chunk         bitpos           bytes\n    var final = st.f || 0, pos = st.p || 0, bt = st.b || 0, lm = st.l, dm = st.d, lbt = st.m, dbt = st.n;\n    // total bits\n    var tbts = sl * 8;\n    do {\n        if (!lm) {\n            // BFINAL - this is only 1 when last chunk is next\n            final = bits(dat, pos, 1);\n            // type: 0 = no compression, 1 = fixed huffman, 2 = dynamic huffman\n            var type = bits(dat, pos + 1, 3);\n            pos += 3;\n            if (!type) {\n                // go to end of byte boundary\n                var s = shft(pos) + 4, l = dat[s - 4] | (dat[s - 3] << 8), t = s + l;\n                if (t > sl) {\n                    if (noSt)\n                        err(0);\n                    break;\n                }\n                // ensure size\n                if (noBuf)\n                    cbuf(bt + l);\n                // Copy over uncompressed data\n                buf.set(dat.subarray(s, t), bt);\n                // Get new bitpos, update byte count\n                st.b = bt += l, st.p = pos = t * 8, st.f = final;\n                continue;\n            }\n            else if (type == 1)\n                lm = flrm, dm = fdrm, lbt = 9, dbt = 5;\n            else if (type == 2) {\n                //  literal                            lengths\n                var hLit = bits(dat, pos, 31) + 257, hcLen = bits(dat, pos + 10, 15) + 4;\n                var tl = hLit + bits(dat, pos + 5, 31) + 1;\n                pos += 14;\n                // length+distance tree\n                var ldt = new u8(tl);\n                // code length tree\n                var clt = new u8(19);\n                for (var i = 0; i < hcLen; ++i) {\n                    // use index map to get real code\n                    clt[clim[i]] = bits(dat, pos + i * 3, 7);\n                }\n                pos += hcLen * 3;\n                // code lengths bits\n                var clb = max(clt), clbmsk = (1 << clb) - 1;\n                // code lengths map\n                var clm = hMap(clt, clb, 1);\n                for (var i = 0; i < tl;) {\n                    var r = clm[bits(dat, pos, clbmsk)];\n                    // bits read\n                    pos += r & 15;\n                    // symbol\n                    var s = r >>> 4;\n                    // code length to copy\n                    if (s < 16) {\n                        ldt[i++] = s;\n                    }\n                    else {\n                        //  copy   count\n                        var c = 0, n = 0;\n                        if (s == 16)\n                            n = 3 + bits(dat, pos, 3), pos += 2, c = ldt[i - 1];\n                        else if (s == 17)\n                            n = 3 + bits(dat, pos, 7), pos += 3;\n                        else if (s == 18)\n                            n = 11 + bits(dat, pos, 127), pos += 7;\n                        while (n--)\n                            ldt[i++] = c;\n                    }\n                }\n                //    length tree                 distance tree\n                var lt = ldt.subarray(0, hLit), dt = ldt.subarray(hLit);\n                // max length bits\n                lbt = max(lt);\n                // max dist bits\n                dbt = max(dt);\n                lm = hMap(lt, lbt, 1);\n                dm = hMap(dt, dbt, 1);\n            }\n            else\n                err(1);\n            if (pos > tbts) {\n                if (noSt)\n                    err(0);\n                break;\n            }\n        }\n        // Make sure the buffer can hold this + the largest possible addition\n        // Maximum chunk size (practically, theoretically infinite) is 2^17;\n        if (noBuf)\n            cbuf(bt + 131072);\n        var lms = (1 << lbt) - 1, dms = (1 << dbt) - 1;\n        var lpos = pos;\n        for (;; lpos = pos) {\n            // bits read, code\n            var c = lm[bits16(dat, pos) & lms], sym = c >>> 4;\n            pos += c & 15;\n            if (pos > tbts) {\n                if (noSt)\n                    err(0);\n                break;\n            }\n            if (!c)\n                err(2);\n            if (sym < 256)\n                buf[bt++] = sym;\n            else if (sym == 256) {\n                lpos = pos, lm = null;\n                break;\n            }\n            else {\n                var add = sym - 254;\n                // no extra bits needed if less\n                if (sym > 264) {\n                    // index\n                    var i = sym - 257, b = fleb[i];\n                    add = bits(dat, pos, (1 << b) - 1) + fl[i];\n                    pos += b;\n                }\n                // dist\n                var d = dm[bits16(dat, pos) & dms], dsym = d >>> 4;\n                if (!d)\n                    err(3);\n                pos += d & 15;\n                var dt = fd[dsym];\n                if (dsym > 3) {\n                    var b = fdeb[dsym];\n                    dt += bits16(dat, pos) & ((1 << b) - 1), pos += b;\n                }\n                if (pos > tbts) {\n                    if (noSt)\n                        err(0);\n                    break;\n                }\n                if (noBuf)\n                    cbuf(bt + 131072);\n                var end = bt + add;\n                for (; bt < end; bt += 4) {\n                    buf[bt] = buf[bt - dt];\n                    buf[bt + 1] = buf[bt + 1 - dt];\n                    buf[bt + 2] = buf[bt + 2 - dt];\n                    buf[bt + 3] = buf[bt + 3 - dt];\n                }\n                bt = end;\n            }\n        }\n        st.l = lm, st.p = lpos, st.b = bt, st.f = final;\n        if (lm)\n            final = 1, st.m = lbt, st.d = dm, st.n = dbt;\n    } while (!final);\n    return bt == buf.length ? buf : slc(buf, 0, bt);\n};\n// starting at p, write the minimum number of bits that can hold v to d\nvar wbits = function (d, p, v) {\n    v <<= p & 7;\n    var o = (p / 8) | 0;\n    d[o] |= v;\n    d[o + 1] |= v >>> 8;\n};\n// starting at p, write the minimum number of bits (>8) that can hold v to d\nvar wbits16 = function (d, p, v) {\n    v <<= p & 7;\n    var o = (p / 8) | 0;\n    d[o] |= v;\n    d[o + 1] |= v >>> 8;\n    d[o + 2] |= v >>> 16;\n};\n// creates code lengths from a frequency table\nvar hTree = function (d, mb) {\n    // Need extra info to make a tree\n    var t = [];\n    for (var i = 0; i < d.length; ++i) {\n        if (d[i])\n            t.push({ s: i, f: d[i] });\n    }\n    var s = t.length;\n    var t2 = t.slice();\n    if (!s)\n        return [et, 0];\n    if (s == 1) {\n        var v = new u8(t[0].s + 1);\n        v[t[0].s] = 1;\n        return [v, 1];\n    }\n    t.sort(function (a, b) { return a.f - b.f; });\n    // after i2 reaches last ind, will be stopped\n    // freq must be greater than largest possible number of symbols\n    t.push({ s: -1, f: 25001 });\n    var l = t[0], r = t[1], i0 = 0, i1 = 1, i2 = 2;\n    t[0] = { s: -1, f: l.f + r.f, l: l, r: r };\n    // efficient algorithm from UZIP.js\n    // i0 is lookbehind, i2 is lookahead - after processing two low-freq\n    // symbols that combined have high freq, will start processing i2 (high-freq,\n    // non-composite) symbols instead\n    // see https://reddit.com/r/photopea/comments/ikekht/uzipjs_questions/\n    while (i1 != s - 1) {\n        l = t[t[i0].f < t[i2].f ? i0++ : i2++];\n        r = t[i0 != i1 && t[i0].f < t[i2].f ? i0++ : i2++];\n        t[i1++] = { s: -1, f: l.f + r.f, l: l, r: r };\n    }\n    var maxSym = t2[0].s;\n    for (var i = 1; i < s; ++i) {\n        if (t2[i].s > maxSym)\n            maxSym = t2[i].s;\n    }\n    // code lengths\n    var tr = new u16(maxSym + 1);\n    // max bits in tree\n    var mbt = ln(t[i1 - 1], tr, 0);\n    if (mbt > mb) {\n        // more algorithms from UZIP.js\n        // TODO: find out how this code works (debt)\n        //  ind    debt\n        var i = 0, dt = 0;\n        //    left            cost\n        var lft = mbt - mb, cst = 1 << lft;\n        t2.sort(function (a, b) { return tr[b.s] - tr[a.s] || a.f - b.f; });\n        for (; i < s; ++i) {\n            var i2_1 = t2[i].s;\n            if (tr[i2_1] > mb) {\n                dt += cst - (1 << (mbt - tr[i2_1]));\n                tr[i2_1] = mb;\n            }\n            else\n                break;\n        }\n        dt >>>= lft;\n        while (dt > 0) {\n            var i2_2 = t2[i].s;\n            if (tr[i2_2] < mb)\n                dt -= 1 << (mb - tr[i2_2]++ - 1);\n            else\n                ++i;\n        }\n        for (; i >= 0 && dt; --i) {\n            var i2_3 = t2[i].s;\n            if (tr[i2_3] == mb) {\n                --tr[i2_3];\n                ++dt;\n            }\n        }\n        mbt = mb;\n    }\n    return [new u8(tr), mbt];\n};\n// get the max length and assign length codes\nvar ln = function (n, l, d) {\n    return n.s == -1\n        ? Math.max(ln(n.l, l, d + 1), ln(n.r, l, d + 1))\n        : (l[n.s] = d);\n};\n// length codes generation\nvar lc = function (c) {\n    var s = c.length;\n    // Note that the semicolon was intentional\n    while (s && !c[--s])\n        ;\n    var cl = new u16(++s);\n    //  ind      num         streak\n    var cli = 0, cln = c[0], cls = 1;\n    var w = function (v) { cl[cli++] = v; };\n    for (var i = 1; i <= s; ++i) {\n        if (c[i] == cln && i != s)\n            ++cls;\n        else {\n            if (!cln && cls > 2) {\n                for (; cls > 138; cls -= 138)\n                    w(32754);\n                if (cls > 2) {\n                    w(cls > 10 ? ((cls - 11) << 5) | 28690 : ((cls - 3) << 5) | 12305);\n                    cls = 0;\n                }\n            }\n            else if (cls > 3) {\n                w(cln), --cls;\n                for (; cls > 6; cls -= 6)\n                    w(8304);\n                if (cls > 2)\n                    w(((cls - 3) << 5) | 8208), cls = 0;\n            }\n            while (cls--)\n                w(cln);\n            cls = 1;\n            cln = c[i];\n        }\n    }\n    return [cl.subarray(0, cli), s];\n};\n// calculate the length of output from tree, code lengths\nvar clen = function (cf, cl) {\n    var l = 0;\n    for (var i = 0; i < cl.length; ++i)\n        l += cf[i] * cl[i];\n    return l;\n};\n// writes a fixed block\n// returns the new bit pos\nvar wfblk = function (out, pos, dat) {\n    // no need to write 00 as type: TypedArray defaults to 0\n    var s = dat.length;\n    var o = shft(pos + 2);\n    out[o] = s & 255;\n    out[o + 1] = s >>> 8;\n    out[o + 2] = out[o] ^ 255;\n    out[o + 3] = out[o + 1] ^ 255;\n    for (var i = 0; i < s; ++i)\n        out[o + i + 4] = dat[i];\n    return (o + 4 + s) * 8;\n};\n// writes a block\nvar wblk = function (dat, out, final, syms, lf, df, eb, li, bs, bl, p) {\n    wbits(out, p++, final);\n    ++lf[256];\n    var _a = hTree(lf, 15), dlt = _a[0], mlb = _a[1];\n    var _b = hTree(df, 15), ddt = _b[0], mdb = _b[1];\n    var _c = lc(dlt), lclt = _c[0], nlc = _c[1];\n    var _d = lc(ddt), lcdt = _d[0], ndc = _d[1];\n    var lcfreq = new u16(19);\n    for (var i = 0; i < lclt.length; ++i)\n        lcfreq[lclt[i] & 31]++;\n    for (var i = 0; i < lcdt.length; ++i)\n        lcfreq[lcdt[i] & 31]++;\n    var _e = hTree(lcfreq, 7), lct = _e[0], mlcb = _e[1];\n    var nlcc = 19;\n    for (; nlcc > 4 && !lct[clim[nlcc - 1]]; --nlcc)\n        ;\n    var flen = (bl + 5) << 3;\n    var ftlen = clen(lf, flt) + clen(df, fdt) + eb;\n    var dtlen = clen(lf, dlt) + clen(df, ddt) + eb + 14 + 3 * nlcc + clen(lcfreq, lct) + (2 * lcfreq[16] + 3 * lcfreq[17] + 7 * lcfreq[18]);\n    if (flen <= ftlen && flen <= dtlen)\n        return wfblk(out, p, dat.subarray(bs, bs + bl));\n    var lm, ll, dm, dl;\n    wbits(out, p, 1 + (dtlen < ftlen)), p += 2;\n    if (dtlen < ftlen) {\n        lm = hMap(dlt, mlb, 0), ll = dlt, dm = hMap(ddt, mdb, 0), dl = ddt;\n        var llm = hMap(lct, mlcb, 0);\n        wbits(out, p, nlc - 257);\n        wbits(out, p + 5, ndc - 1);\n        wbits(out, p + 10, nlcc - 4);\n        p += 14;\n        for (var i = 0; i < nlcc; ++i)\n            wbits(out, p + 3 * i, lct[clim[i]]);\n        p += 3 * nlcc;\n        var lcts = [lclt, lcdt];\n        for (var it = 0; it < 2; ++it) {\n            var clct = lcts[it];\n            for (var i = 0; i < clct.length; ++i) {\n                var len = clct[i] & 31;\n                wbits(out, p, llm[len]), p += lct[len];\n                if (len > 15)\n                    wbits(out, p, (clct[i] >>> 5) & 127), p += clct[i] >>> 12;\n            }\n        }\n    }\n    else {\n        lm = flm, ll = flt, dm = fdm, dl = fdt;\n    }\n    for (var i = 0; i < li; ++i) {\n        if (syms[i] > 255) {\n            var len = (syms[i] >>> 18) & 31;\n            wbits16(out, p, lm[len + 257]), p += ll[len + 257];\n            if (len > 7)\n                wbits(out, p, (syms[i] >>> 23) & 31), p += fleb[len];\n            var dst = syms[i] & 31;\n            wbits16(out, p, dm[dst]), p += dl[dst];\n            if (dst > 3)\n                wbits16(out, p, (syms[i] >>> 5) & 8191), p += fdeb[dst];\n        }\n        else {\n            wbits16(out, p, lm[syms[i]]), p += ll[syms[i]];\n        }\n    }\n    wbits16(out, p, lm[256]);\n    return p + ll[256];\n};\n// deflate options (nice << 13) | chain\nvar deo = /*#__PURE__*/ new u32([65540, 131080, 131088, 131104, 262176, 1048704, 1048832, 2114560, 2117632]);\n// empty\nvar et = /*#__PURE__*/ new u8(0);\n// compresses data into a raw DEFLATE buffer\nvar dflt = function (dat, lvl, plvl, pre, post, lst) {\n    var s = dat.length;\n    var o = new u8(pre + s + 5 * (1 + Math.ceil(s / 7000)) + post);\n    // writing to this writes to the output buffer\n    var w = o.subarray(pre, o.length - post);\n    var pos = 0;\n    if (!lvl || s < 8) {\n        for (var i = 0; i <= s; i += 65535) {\n            // end\n            var e = i + 65535;\n            if (e >= s) {\n                // write final block\n                w[pos >> 3] = lst;\n            }\n            pos = wfblk(w, pos + 1, dat.subarray(i, e));\n        }\n    }\n    else {\n        var opt = deo[lvl - 1];\n        var n = opt >>> 13, c = opt & 8191;\n        var msk_1 = (1 << plvl) - 1;\n        //    prev 2-byte val map    curr 2-byte val map\n        var prev = new u16(32768), head = new u16(msk_1 + 1);\n        var bs1_1 = Math.ceil(plvl / 3), bs2_1 = 2 * bs1_1;\n        var hsh = function (i) { return (dat[i] ^ (dat[i + 1] << bs1_1) ^ (dat[i + 2] << bs2_1)) & msk_1; };\n        // 24576 is an arbitrary number of maximum symbols per block\n        // 424 buffer for last block\n        var syms = new u32(25000);\n        // length/literal freq   distance freq\n        var lf = new u16(288), df = new u16(32);\n        //  l/lcnt  exbits  index  l/lind  waitdx  bitpos\n        var lc_1 = 0, eb = 0, i = 0, li = 0, wi = 0, bs = 0;\n        for (; i < s; ++i) {\n            // hash value\n            // deopt when i > s - 3 - at end, deopt acceptable\n            var hv = hsh(i);\n            // index mod 32768    previous index mod\n            var imod = i & 32767, pimod = head[hv];\n            prev[imod] = pimod;\n            head[hv] = imod;\n            // We always should modify head and prev, but only add symbols if\n            // this data is not yet processed (\"wait\" for wait index)\n            if (wi <= i) {\n                // bytes remaining\n                var rem = s - i;\n                if ((lc_1 > 7000 || li > 24576) && rem > 423) {\n                    pos = wblk(dat, w, 0, syms, lf, df, eb, li, bs, i - bs, pos);\n                    li = lc_1 = eb = 0, bs = i;\n                    for (var j = 0; j < 286; ++j)\n                        lf[j] = 0;\n                    for (var j = 0; j < 30; ++j)\n                        df[j] = 0;\n                }\n                //  len    dist   chain\n                var l = 2, d = 0, ch_1 = c, dif = (imod - pimod) & 32767;\n                if (rem > 2 && hv == hsh(i - dif)) {\n                    var maxn = Math.min(n, rem) - 1;\n                    var maxd = Math.min(32767, i);\n                    // max possible length\n                    // not capped at dif because decompressors implement \"rolling\" index population\n                    var ml = Math.min(258, rem);\n                    while (dif <= maxd && --ch_1 && imod != pimod) {\n                        if (dat[i + l] == dat[i + l - dif]) {\n                            var nl = 0;\n                            for (; nl < ml && dat[i + nl] == dat[i + nl - dif]; ++nl)\n                                ;\n                            if (nl > l) {\n                                l = nl, d = dif;\n                                // break out early when we reach \"nice\" (we are satisfied enough)\n                                if (nl > maxn)\n                                    break;\n                                // now, find the rarest 2-byte sequence within this\n                                // length of literals and search for that instead.\n                                // Much faster than just using the start\n                                var mmd = Math.min(dif, nl - 2);\n                                var md = 0;\n                                for (var j = 0; j < mmd; ++j) {\n                                    var ti = (i - dif + j + 32768) & 32767;\n                                    var pti = prev[ti];\n                                    var cd = (ti - pti + 32768) & 32767;\n                                    if (cd > md)\n                                        md = cd, pimod = ti;\n                                }\n                            }\n                        }\n                        // check the previous match\n                        imod = pimod, pimod = prev[imod];\n                        dif += (imod - pimod + 32768) & 32767;\n                    }\n                }\n                // d will be nonzero only when a match was found\n                if (d) {\n                    // store both dist and len data in one Uint32\n                    // Make sure this is recognized as a len/dist with 28th bit (2^28)\n                    syms[li++] = 268435456 | (revfl[l] << 18) | revfd[d];\n                    var lin = revfl[l] & 31, din = revfd[d] & 31;\n                    eb += fleb[lin] + fdeb[din];\n                    ++lf[257 + lin];\n                    ++df[din];\n                    wi = i + l;\n                    ++lc_1;\n                }\n                else {\n                    syms[li++] = dat[i];\n                    ++lf[dat[i]];\n                }\n            }\n        }\n        pos = wblk(dat, w, lst, syms, lf, df, eb, li, bs, i - bs, pos);\n        // this is the easiest way to avoid needing to maintain state\n        if (!lst && pos & 7)\n            pos = wfblk(w, pos + 1, et);\n    }\n    return slc(o, 0, pre + shft(pos) + post);\n};\n// CRC32 table\nvar crct = /*#__PURE__*/ (function () {\n    var t = new Int32Array(256);\n    for (var i = 0; i < 256; ++i) {\n        var c = i, k = 9;\n        while (--k)\n            c = ((c & 1) && -306674912) ^ (c >>> 1);\n        t[i] = c;\n    }\n    return t;\n})();\n// CRC32\nvar crc = function () {\n    var c = -1;\n    return {\n        p: function (d) {\n            // closures have awful performance\n            var cr = c;\n            for (var i = 0; i < d.length; ++i)\n                cr = crct[(cr & 255) ^ d[i]] ^ (cr >>> 8);\n            c = cr;\n        },\n        d: function () { return ~c; }\n    };\n};\n// Alder32\nvar adler = function () {\n    var a = 1, b = 0;\n    return {\n        p: function (d) {\n            // closures have awful performance\n            var n = a, m = b;\n            var l = d.length | 0;\n            for (var i = 0; i != l;) {\n                var e = Math.min(i + 2655, l);\n                for (; i < e; ++i)\n                    m += n += d[i];\n                n = (n & 65535) + 15 * (n >> 16), m = (m & 65535) + 15 * (m >> 16);\n            }\n            a = n, b = m;\n        },\n        d: function () {\n            a %= 65521, b %= 65521;\n            return (a & 255) << 24 | (a >>> 8) << 16 | (b & 255) << 8 | (b >>> 8);\n        }\n    };\n};\n;\n// deflate with opts\nvar dopt = function (dat, opt, pre, post, st) {\n    return dflt(dat, opt.level == null ? 6 : opt.level, opt.mem == null ? Math.ceil(Math.max(8, Math.min(13, Math.log(dat.length))) * 1.5) : (12 + opt.mem), pre, post, !st);\n};\n// Walmart object spread\nvar mrg = function (a, b) {\n    var o = {};\n    for (var k in a)\n        o[k] = a[k];\n    for (var k in b)\n        o[k] = b[k];\n    return o;\n};\n// worker clone\n// This is possibly the craziest part of the entire codebase, despite how simple it may seem.\n// The only parameter to this function is a closure that returns an array of variables outside of the function scope.\n// We're going to try to figure out the variable names used in the closure as strings because that is crucial for workerization.\n// We will return an object mapping of true variable name to value (basically, the current scope as a JS object).\n// The reason we can't just use the original variable names is minifiers mangling the toplevel scope.\n// This took me three weeks to figure out how to do.\nvar wcln = function (fn, fnStr, td) {\n    var dt = fn();\n    var st = fn.toString();\n    var ks = st.slice(st.indexOf('[') + 1, st.lastIndexOf(']')).replace(/\\s+/g, '').split(',');\n    for (var i = 0; i < dt.length; ++i) {\n        var v = dt[i], k = ks[i];\n        if (typeof v == 'function') {\n            fnStr += ';' + k + '=';\n            var st_1 = v.toString();\n            if (v.prototype) {\n                // for global objects\n                if (st_1.indexOf('[native code]') != -1) {\n                    var spInd = st_1.indexOf(' ', 8) + 1;\n                    fnStr += st_1.slice(spInd, st_1.indexOf('(', spInd));\n                }\n                else {\n                    fnStr += st_1;\n                    for (var t in v.prototype)\n                        fnStr += ';' + k + '.prototype.' + t + '=' + v.prototype[t].toString();\n                }\n            }\n            else\n                fnStr += st_1;\n        }\n        else\n            td[k] = v;\n    }\n    return [fnStr, td];\n};\nvar ch = [];\n// clone bufs\nvar cbfs = function (v) {\n    var tl = [];\n    for (var k in v) {\n        if (v[k].buffer) {\n            tl.push((v[k] = new v[k].constructor(v[k])).buffer);\n        }\n    }\n    return tl;\n};\n// use a worker to execute code\nvar wrkr = function (fns, init, id, cb) {\n    var _a;\n    if (!ch[id]) {\n        var fnStr = '', td_1 = {}, m = fns.length - 1;\n        for (var i = 0; i < m; ++i)\n            _a = wcln(fns[i], fnStr, td_1), fnStr = _a[0], td_1 = _a[1];\n        ch[id] = wcln(fns[m], fnStr, td_1);\n    }\n    var td = mrg({}, ch[id][1]);\n    return wk(ch[id][0] + ';onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage=' + init.toString() + '}', id, td, cbfs(td), cb);\n};\n// base async inflate fn\nvar bInflt = function () { return [u8, u16, u32, fleb, fdeb, clim, fl, fd, flrm, fdrm, rev, ec, hMap, max, bits, bits16, shft, slc, err, inflt, inflateSync, pbf, gu8]; };\nvar bDflt = function () { return [u8, u16, u32, fleb, fdeb, clim, revfl, revfd, flm, flt, fdm, fdt, rev, deo, et, hMap, wbits, wbits16, hTree, ln, lc, clen, wfblk, wblk, shft, slc, dflt, dopt, deflateSync, pbf]; };\n// gzip extra\nvar gze = function () { return [gzh, gzhl, wbytes, crc, crct]; };\n// gunzip extra\nvar guze = function () { return [gzs, gzl]; };\n// zlib extra\nvar zle = function () { return [zlh, wbytes, adler]; };\n// unzlib extra\nvar zule = function () { return [zlv]; };\n// post buf\nvar pbf = function (msg) { return postMessage(msg, [msg.buffer]); };\n// get u8\nvar gu8 = function (o) { return o && o.size && new u8(o.size); };\n// async helper\nvar cbify = function (dat, opts, fns, init, id, cb) {\n    var w = wrkr(fns, init, id, function (err, dat) {\n        w.terminate();\n        cb(err, dat);\n    });\n    w.postMessage([dat, opts], opts.consume ? [dat.buffer] : []);\n    return function () { w.terminate(); };\n};\n// auto stream\nvar astrm = function (strm) {\n    strm.ondata = function (dat, final) { return postMessage([dat, final], [dat.buffer]); };\n    return function (ev) { return strm.push(ev.data[0], ev.data[1]); };\n};\n// async stream attach\nvar astrmify = function (fns, strm, opts, init, id) {\n    var t;\n    var w = wrkr(fns, init, id, function (err, dat) {\n        if (err)\n            w.terminate(), strm.ondata.call(strm, err);\n        else {\n            if (dat[1])\n                w.terminate();\n            strm.ondata.call(strm, err, dat[0], dat[1]);\n        }\n    });\n    w.postMessage(opts);\n    strm.push = function (d, f) {\n        if (!strm.ondata)\n            err(5);\n        if (t)\n            strm.ondata(err(4, 0, 1), null, !!f);\n        w.postMessage([d, t = f], [d.buffer]);\n    };\n    strm.terminate = function () { w.terminate(); };\n};\n// read 2 bytes\nvar b2 = function (d, b) { return d[b] | (d[b + 1] << 8); };\n// read 4 bytes\nvar b4 = function (d, b) { return (d[b] | (d[b + 1] << 8) | (d[b + 2] << 16) | (d[b + 3] << 24)) >>> 0; };\nvar b8 = function (d, b) { return b4(d, b) + (b4(d, b + 4) * 4294967296); };\n// write bytes\nvar wbytes = function (d, b, v) {\n    for (; v; ++b)\n        d[b] = v, v >>>= 8;\n};\n// gzip header\nvar gzh = function (c, o) {\n    var fn = o.filename;\n    c[0] = 31, c[1] = 139, c[2] = 8, c[8] = o.level < 2 ? 4 : o.level == 9 ? 2 : 0, c[9] = 3; // assume Unix\n    if (o.mtime != 0)\n        wbytes(c, 4, Math.floor(new Date(o.mtime || Date.now()) / 1000));\n    if (fn) {\n        c[3] = 8;\n        for (var i = 0; i <= fn.length; ++i)\n            c[i + 10] = fn.charCodeAt(i);\n    }\n};\n// gzip footer: -8 to -4 = CRC, -4 to -0 is length\n// gzip start\nvar gzs = function (d) {\n    if (d[0] != 31 || d[1] != 139 || d[2] != 8)\n        err(6, 'invalid gzip data');\n    var flg = d[3];\n    var st = 10;\n    if (flg & 4)\n        st += d[10] | (d[11] << 8) + 2;\n    for (var zs = (flg >> 3 & 1) + (flg >> 4 & 1); zs > 0; zs -= !d[st++])\n        ;\n    return st + (flg & 2);\n};\n// gzip length\nvar gzl = function (d) {\n    var l = d.length;\n    return ((d[l - 4] | d[l - 3] << 8 | d[l - 2] << 16) | (d[l - 1] << 24)) >>> 0;\n};\n// gzip header length\nvar gzhl = function (o) { return 10 + ((o.filename && (o.filename.length + 1)) || 0); };\n// zlib header\nvar zlh = function (c, o) {\n    var lv = o.level, fl = lv == 0 ? 0 : lv < 6 ? 1 : lv == 9 ? 3 : 2;\n    c[0] = 120, c[1] = (fl << 6) | (fl ? (32 - 2 * fl) : 1);\n};\n// zlib valid\nvar zlv = function (d) {\n    if ((d[0] & 15) != 8 || (d[0] >>> 4) > 7 || ((d[0] << 8 | d[1]) % 31))\n        err(6, 'invalid zlib data');\n    if (d[1] & 32)\n        err(6, 'invalid zlib data: preset dictionaries not supported');\n};\nfunction AsyncCmpStrm(opts, cb) {\n    if (!cb && typeof opts == 'function')\n        cb = opts, opts = {};\n    this.ondata = cb;\n    return opts;\n}\n// zlib footer: -4 to -0 is Adler32\n/**\n * Streaming DEFLATE compression\n */\nvar Deflate = /*#__PURE__*/ (function () {\n    function Deflate(opts, cb) {\n        if (!cb && typeof opts == 'function')\n            cb = opts, opts = {};\n        this.ondata = cb;\n        this.o = opts || {};\n    }\n    Deflate.prototype.p = function (c, f) {\n        this.ondata(dopt(c, this.o, 0, 0, !f), f);\n    };\n    /**\n     * Pushes a chunk to be deflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Deflate.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            err(5);\n        if (this.d)\n            err(4);\n        this.d = final;\n        this.p(chunk, final || false);\n    };\n    return Deflate;\n}());\nexport { Deflate };\n/**\n * Asynchronous streaming DEFLATE compression\n */\nvar AsyncDeflate = /*#__PURE__*/ (function () {\n    function AsyncDeflate(opts, cb) {\n        astrmify([\n            bDflt,\n            function () { return [astrm, Deflate]; }\n        ], this, AsyncCmpStrm.call(this, opts, cb), function (ev) {\n            var strm = new Deflate(ev.data);\n            onmessage = astrm(strm);\n        }, 6);\n    }\n    return AsyncDeflate;\n}());\nexport { AsyncDeflate };\nexport function deflate(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return cbify(data, opts, [\n        bDflt,\n    ], function (ev) { return pbf(deflateSync(ev.data[0], ev.data[1])); }, 0, cb);\n}\n/**\n * Compresses data with DEFLATE without any wrapper\n * @param data The data to compress\n * @param opts The compression options\n * @returns The deflated version of the data\n */\nexport function deflateSync(data, opts) {\n    return dopt(data, opts || {}, 0, 0);\n}\n/**\n * Streaming DEFLATE decompression\n */\nvar Inflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates an inflation stream\n     * @param cb The callback to call whenever data is inflated\n     */\n    function Inflate(cb) {\n        this.s = {};\n        this.p = new u8(0);\n        this.ondata = cb;\n    }\n    Inflate.prototype.e = function (c) {\n        if (!this.ondata)\n            err(5);\n        if (this.d)\n            err(4);\n        var l = this.p.length;\n        var n = new u8(l + c.length);\n        n.set(this.p), n.set(c, l), this.p = n;\n    };\n    Inflate.prototype.c = function (final) {\n        this.d = this.s.i = final || false;\n        var bts = this.s.b;\n        var dt = inflt(this.p, this.o, this.s);\n        this.ondata(slc(dt, bts, this.s.b), this.d);\n        this.o = slc(dt, this.s.b - 32768), this.s.b = this.o.length;\n        this.p = slc(this.p, (this.s.p / 8) | 0), this.s.p &= 7;\n    };\n    /**\n     * Pushes a chunk to be inflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the final chunk\n     */\n    Inflate.prototype.push = function (chunk, final) {\n        this.e(chunk), this.c(final);\n    };\n    return Inflate;\n}());\nexport { Inflate };\n/**\n * Asynchronous streaming DEFLATE decompression\n */\nvar AsyncInflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates an asynchronous inflation stream\n     * @param cb The callback to call whenever data is deflated\n     */\n    function AsyncInflate(cb) {\n        this.ondata = cb;\n        astrmify([\n            bInflt,\n            function () { return [astrm, Inflate]; }\n        ], this, 0, function () {\n            var strm = new Inflate();\n            onmessage = astrm(strm);\n        }, 7);\n    }\n    return AsyncInflate;\n}());\nexport { AsyncInflate };\nexport function inflate(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return cbify(data, opts, [\n        bInflt\n    ], function (ev) { return pbf(inflateSync(ev.data[0], gu8(ev.data[1]))); }, 1, cb);\n}\n/**\n * Expands DEFLATE data with no wrapper\n * @param data The data to decompress\n * @param out Where to write the data. Saves memory if you know the decompressed size and provide an output buffer of that length.\n * @returns The decompressed version of the data\n */\nexport function inflateSync(data, out) {\n    return inflt(data, out);\n}\n// before you yell at me for not just using extends, my reason is that TS inheritance is hard to workerize.\n/**\n * Streaming GZIP compression\n */\nvar Gzip = /*#__PURE__*/ (function () {\n    function Gzip(opts, cb) {\n        this.c = crc();\n        this.l = 0;\n        this.v = 1;\n        Deflate.call(this, opts, cb);\n    }\n    /**\n     * Pushes a chunk to be GZIPped\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Gzip.prototype.push = function (chunk, final) {\n        Deflate.prototype.push.call(this, chunk, final);\n    };\n    Gzip.prototype.p = function (c, f) {\n        this.c.p(c);\n        this.l += c.length;\n        var raw = dopt(c, this.o, this.v && gzhl(this.o), f && 8, !f);\n        if (this.v)\n            gzh(raw, this.o), this.v = 0;\n        if (f)\n            wbytes(raw, raw.length - 8, this.c.d()), wbytes(raw, raw.length - 4, this.l);\n        this.ondata(raw, f);\n    };\n    return Gzip;\n}());\nexport { Gzip };\n/**\n * Asynchronous streaming GZIP compression\n */\nvar AsyncGzip = /*#__PURE__*/ (function () {\n    function AsyncGzip(opts, cb) {\n        astrmify([\n            bDflt,\n            gze,\n            function () { return [astrm, Deflate, Gzip]; }\n        ], this, AsyncCmpStrm.call(this, opts, cb), function (ev) {\n            var strm = new Gzip(ev.data);\n            onmessage = astrm(strm);\n        }, 8);\n    }\n    return AsyncGzip;\n}());\nexport { AsyncGzip };\nexport function gzip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return cbify(data, opts, [\n        bDflt,\n        gze,\n        function () { return [gzipSync]; }\n    ], function (ev) { return pbf(gzipSync(ev.data[0], ev.data[1])); }, 2, cb);\n}\n/**\n * Compresses data with GZIP\n * @param data The data to compress\n * @param opts The compression options\n * @returns The gzipped version of the data\n */\nexport function gzipSync(data, opts) {\n    if (!opts)\n        opts = {};\n    var c = crc(), l = data.length;\n    c.p(data);\n    var d = dopt(data, opts, gzhl(opts), 8), s = d.length;\n    return gzh(d, opts), wbytes(d, s - 8, c.d()), wbytes(d, s - 4, l), d;\n}\n/**\n * Streaming GZIP decompression\n */\nvar Gunzip = /*#__PURE__*/ (function () {\n    /**\n     * Creates a GUNZIP stream\n     * @param cb The callback to call whenever data is inflated\n     */\n    function Gunzip(cb) {\n        this.v = 1;\n        Inflate.call(this, cb);\n    }\n    /**\n     * Pushes a chunk to be GUNZIPped\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Gunzip.prototype.push = function (chunk, final) {\n        Inflate.prototype.e.call(this, chunk);\n        if (this.v) {\n            var s = this.p.length > 3 ? gzs(this.p) : 4;\n            if (s >= this.p.length && !final)\n                return;\n            this.p = this.p.subarray(s), this.v = 0;\n        }\n        if (final) {\n            if (this.p.length < 8)\n                err(6, 'invalid gzip data');\n            this.p = this.p.subarray(0, -8);\n        }\n        // necessary to prevent TS from using the closure value\n        // This allows for workerization to function correctly\n        Inflate.prototype.c.call(this, final);\n    };\n    return Gunzip;\n}());\nexport { Gunzip };\n/**\n * Asynchronous streaming GZIP decompression\n */\nvar AsyncGunzip = /*#__PURE__*/ (function () {\n    /**\n     * Creates an asynchronous GUNZIP stream\n     * @param cb The callback to call whenever data is deflated\n     */\n    function AsyncGunzip(cb) {\n        this.ondata = cb;\n        astrmify([\n            bInflt,\n            guze,\n            function () { return [astrm, Inflate, Gunzip]; }\n        ], this, 0, function () {\n            var strm = new Gunzip();\n            onmessage = astrm(strm);\n        }, 9);\n    }\n    return AsyncGunzip;\n}());\nexport { AsyncGunzip };\nexport function gunzip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return cbify(data, opts, [\n        bInflt,\n        guze,\n        function () { return [gunzipSync]; }\n    ], function (ev) { return pbf(gunzipSync(ev.data[0])); }, 3, cb);\n}\n/**\n * Expands GZIP data\n * @param data The data to decompress\n * @param out Where to write the data. GZIP already encodes the output size, so providing this doesn't save memory.\n * @returns The decompressed version of the data\n */\nexport function gunzipSync(data, out) {\n    return inflt(data.subarray(gzs(data), -8), out || new u8(gzl(data)));\n}\n/**\n * Streaming Zlib compression\n */\nvar Zlib = /*#__PURE__*/ (function () {\n    function Zlib(opts, cb) {\n        this.c = adler();\n        this.v = 1;\n        Deflate.call(this, opts, cb);\n    }\n    /**\n     * Pushes a chunk to be zlibbed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Zlib.prototype.push = function (chunk, final) {\n        Deflate.prototype.push.call(this, chunk, final);\n    };\n    Zlib.prototype.p = function (c, f) {\n        this.c.p(c);\n        var raw = dopt(c, this.o, this.v && 2, f && 4, !f);\n        if (this.v)\n            zlh(raw, this.o), this.v = 0;\n        if (f)\n            wbytes(raw, raw.length - 4, this.c.d());\n        this.ondata(raw, f);\n    };\n    return Zlib;\n}());\nexport { Zlib };\n/**\n * Asynchronous streaming Zlib compression\n */\nvar AsyncZlib = /*#__PURE__*/ (function () {\n    function AsyncZlib(opts, cb) {\n        astrmify([\n            bDflt,\n            zle,\n            function () { return [astrm, Deflate, Zlib]; }\n        ], this, AsyncCmpStrm.call(this, opts, cb), function (ev) {\n            var strm = new Zlib(ev.data);\n            onmessage = astrm(strm);\n        }, 10);\n    }\n    return AsyncZlib;\n}());\nexport { AsyncZlib };\nexport function zlib(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return cbify(data, opts, [\n        bDflt,\n        zle,\n        function () { return [zlibSync]; }\n    ], function (ev) { return pbf(zlibSync(ev.data[0], ev.data[1])); }, 4, cb);\n}\n/**\n * Compress data with Zlib\n * @param data The data to compress\n * @param opts The compression options\n * @returns The zlib-compressed version of the data\n */\nexport function zlibSync(data, opts) {\n    if (!opts)\n        opts = {};\n    var a = adler();\n    a.p(data);\n    var d = dopt(data, opts, 2, 4);\n    return zlh(d, opts), wbytes(d, d.length - 4, a.d()), d;\n}\n/**\n * Streaming Zlib decompression\n */\nvar Unzlib = /*#__PURE__*/ (function () {\n    /**\n     * Creates a Zlib decompression stream\n     * @param cb The callback to call whenever data is inflated\n     */\n    function Unzlib(cb) {\n        this.v = 1;\n        Inflate.call(this, cb);\n    }\n    /**\n     * Pushes a chunk to be unzlibbed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Unzlib.prototype.push = function (chunk, final) {\n        Inflate.prototype.e.call(this, chunk);\n        if (this.v) {\n            if (this.p.length < 2 && !final)\n                return;\n            this.p = this.p.subarray(2), this.v = 0;\n        }\n        if (final) {\n            if (this.p.length < 4)\n                err(6, 'invalid zlib data');\n            this.p = this.p.subarray(0, -4);\n        }\n        // necessary to prevent TS from using the closure value\n        // This allows for workerization to function correctly\n        Inflate.prototype.c.call(this, final);\n    };\n    return Unzlib;\n}());\nexport { Unzlib };\n/**\n * Asynchronous streaming Zlib decompression\n */\nvar AsyncUnzlib = /*#__PURE__*/ (function () {\n    /**\n     * Creates an asynchronous Zlib decompression stream\n     * @param cb The callback to call whenever data is deflated\n     */\n    function AsyncUnzlib(cb) {\n        this.ondata = cb;\n        astrmify([\n            bInflt,\n            zule,\n            function () { return [astrm, Inflate, Unzlib]; }\n        ], this, 0, function () {\n            var strm = new Unzlib();\n            onmessage = astrm(strm);\n        }, 11);\n    }\n    return AsyncUnzlib;\n}());\nexport { AsyncUnzlib };\nexport function unzlib(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return cbify(data, opts, [\n        bInflt,\n        zule,\n        function () { return [unzlibSync]; }\n    ], function (ev) { return pbf(unzlibSync(ev.data[0], gu8(ev.data[1]))); }, 5, cb);\n}\n/**\n * Expands Zlib data\n * @param data The data to decompress\n * @param out Where to write the data. Saves memory if you know the decompressed size and provide an output buffer of that length.\n * @returns The decompressed version of the data\n */\nexport function unzlibSync(data, out) {\n    return inflt((zlv(data), data.subarray(2, -4)), out);\n}\n// Default algorithm for compression (used because having a known output size allows faster decompression)\nexport { gzip as compress, AsyncGzip as AsyncCompress };\n// Default algorithm for compression (used because having a known output size allows faster decompression)\nexport { gzipSync as compressSync, Gzip as Compress };\n/**\n * Streaming GZIP, Zlib, or raw DEFLATE decompression\n */\nvar Decompress = /*#__PURE__*/ (function () {\n    /**\n     * Creates a decompression stream\n     * @param cb The callback to call whenever data is decompressed\n     */\n    function Decompress(cb) {\n        this.G = Gunzip;\n        this.I = Inflate;\n        this.Z = Unzlib;\n        this.ondata = cb;\n    }\n    /**\n     * Pushes a chunk to be decompressed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Decompress.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            err(5);\n        if (!this.s) {\n            if (this.p && this.p.length) {\n                var n = new u8(this.p.length + chunk.length);\n                n.set(this.p), n.set(chunk, this.p.length);\n            }\n            else\n                this.p = chunk;\n            if (this.p.length > 2) {\n                var _this_1 = this;\n                var cb = function () { _this_1.ondata.apply(_this_1, arguments); };\n                this.s = (this.p[0] == 31 && this.p[1] == 139 && this.p[2] == 8)\n                    ? new this.G(cb)\n                    : ((this.p[0] & 15) != 8 || (this.p[0] >> 4) > 7 || ((this.p[0] << 8 | this.p[1]) % 31))\n                        ? new this.I(cb)\n                        : new this.Z(cb);\n                this.s.push(this.p, final);\n                this.p = null;\n            }\n        }\n        else\n            this.s.push(chunk, final);\n    };\n    return Decompress;\n}());\nexport { Decompress };\n/**\n * Asynchronous streaming GZIP, Zlib, or raw DEFLATE decompression\n */\nvar AsyncDecompress = /*#__PURE__*/ (function () {\n    /**\n   * Creates an asynchronous decompression stream\n   * @param cb The callback to call whenever data is decompressed\n   */\n    function AsyncDecompress(cb) {\n        this.G = AsyncGunzip;\n        this.I = AsyncInflate;\n        this.Z = AsyncUnzlib;\n        this.ondata = cb;\n    }\n    /**\n     * Pushes a chunk to be decompressed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    AsyncDecompress.prototype.push = function (chunk, final) {\n        Decompress.prototype.push.call(this, chunk, final);\n    };\n    return AsyncDecompress;\n}());\nexport { AsyncDecompress };\nexport function decompress(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return (data[0] == 31 && data[1] == 139 && data[2] == 8)\n        ? gunzip(data, opts, cb)\n        : ((data[0] & 15) != 8 || (data[0] >> 4) > 7 || ((data[0] << 8 | data[1]) % 31))\n            ? inflate(data, opts, cb)\n            : unzlib(data, opts, cb);\n}\n/**\n * Expands compressed GZIP, Zlib, or raw DEFLATE data, automatically detecting the format\n * @param data The data to decompress\n * @param out Where to write the data. Saves memory if you know the decompressed size and provide an output buffer of that length.\n * @returns The decompressed version of the data\n */\nexport function decompressSync(data, out) {\n    return (data[0] == 31 && data[1] == 139 && data[2] == 8)\n        ? gunzipSync(data, out)\n        : ((data[0] & 15) != 8 || (data[0] >> 4) > 7 || ((data[0] << 8 | data[1]) % 31))\n            ? inflateSync(data, out)\n            : unzlibSync(data, out);\n}\n// flatten a directory structure\nvar fltn = function (d, p, t, o) {\n    for (var k in d) {\n        var val = d[k], n = p + k, op = o;\n        if (Array.isArray(val))\n            op = mrg(o, val[1]), val = val[0];\n        if (val instanceof u8)\n            t[n] = [val, op];\n        else {\n            t[n += '/'] = [new u8(0), op];\n            fltn(val, n, t, o);\n        }\n    }\n};\n// text encoder\nvar te = typeof TextEncoder != 'undefined' && /*#__PURE__*/ new TextEncoder();\n// text decoder\nvar td = typeof TextDecoder != 'undefined' && /*#__PURE__*/ new TextDecoder();\n// text decoder stream\nvar tds = 0;\ntry {\n    td.decode(et, { stream: true });\n    tds = 1;\n}\ncatch (e) { }\n// decode UTF8\nvar dutf8 = function (d) {\n    for (var r = '', i = 0;;) {\n        var c = d[i++];\n        var eb = (c > 127) + (c > 223) + (c > 239);\n        if (i + eb > d.length)\n            return [r, slc(d, i - 1)];\n        if (!eb)\n            r += String.fromCharCode(c);\n        else if (eb == 3) {\n            c = ((c & 15) << 18 | (d[i++] & 63) << 12 | (d[i++] & 63) << 6 | (d[i++] & 63)) - 65536,\n                r += String.fromCharCode(55296 | (c >> 10), 56320 | (c & 1023));\n        }\n        else if (eb & 1)\n            r += String.fromCharCode((c & 31) << 6 | (d[i++] & 63));\n        else\n            r += String.fromCharCode((c & 15) << 12 | (d[i++] & 63) << 6 | (d[i++] & 63));\n    }\n};\n/**\n * Streaming UTF-8 decoding\n */\nvar DecodeUTF8 = /*#__PURE__*/ (function () {\n    /**\n     * Creates a UTF-8 decoding stream\n     * @param cb The callback to call whenever data is decoded\n     */\n    function DecodeUTF8(cb) {\n        this.ondata = cb;\n        if (tds)\n            this.t = new TextDecoder();\n        else\n            this.p = et;\n    }\n    /**\n     * Pushes a chunk to be decoded from UTF-8 binary\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    DecodeUTF8.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            err(5);\n        final = !!final;\n        if (this.t) {\n            this.ondata(this.t.decode(chunk, { stream: true }), final);\n            if (final) {\n                if (this.t.decode().length)\n                    err(8);\n                this.t = null;\n            }\n            return;\n        }\n        if (!this.p)\n            err(4);\n        var dat = new u8(this.p.length + chunk.length);\n        dat.set(this.p);\n        dat.set(chunk, this.p.length);\n        var _a = dutf8(dat), ch = _a[0], np = _a[1];\n        if (final) {\n            if (np.length)\n                err(8);\n            this.p = null;\n        }\n        else\n            this.p = np;\n        this.ondata(ch, final);\n    };\n    return DecodeUTF8;\n}());\nexport { DecodeUTF8 };\n/**\n * Streaming UTF-8 encoding\n */\nvar EncodeUTF8 = /*#__PURE__*/ (function () {\n    /**\n     * Creates a UTF-8 decoding stream\n     * @param cb The callback to call whenever data is encoded\n     */\n    function EncodeUTF8(cb) {\n        this.ondata = cb;\n    }\n    /**\n     * Pushes a chunk to be encoded to UTF-8\n     * @param chunk The string data to push\n     * @param final Whether this is the last chunk\n     */\n    EncodeUTF8.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            err(5);\n        if (this.d)\n            err(4);\n        this.ondata(strToU8(chunk), this.d = final || false);\n    };\n    return EncodeUTF8;\n}());\nexport { EncodeUTF8 };\n/**\n * Converts a string into a Uint8Array for use with compression/decompression methods\n * @param str The string to encode\n * @param latin1 Whether or not to interpret the data as Latin-1. This should\n *               not need to be true unless decoding a binary string.\n * @returns The string encoded in UTF-8/Latin-1 binary\n */\nexport function strToU8(str, latin1) {\n    if (latin1) {\n        var ar_1 = new u8(str.length);\n        for (var i = 0; i < str.length; ++i)\n            ar_1[i] = str.charCodeAt(i);\n        return ar_1;\n    }\n    if (te)\n        return te.encode(str);\n    var l = str.length;\n    var ar = new u8(str.length + (str.length >> 1));\n    var ai = 0;\n    var w = function (v) { ar[ai++] = v; };\n    for (var i = 0; i < l; ++i) {\n        if (ai + 5 > ar.length) {\n            var n = new u8(ai + 8 + ((l - i) << 1));\n            n.set(ar);\n            ar = n;\n        }\n        var c = str.charCodeAt(i);\n        if (c < 128 || latin1)\n            w(c);\n        else if (c < 2048)\n            w(192 | (c >> 6)), w(128 | (c & 63));\n        else if (c > 55295 && c < 57344)\n            c = 65536 + (c & 1023 << 10) | (str.charCodeAt(++i) & 1023),\n                w(240 | (c >> 18)), w(128 | ((c >> 12) & 63)), w(128 | ((c >> 6) & 63)), w(128 | (c & 63));\n        else\n            w(224 | (c >> 12)), w(128 | ((c >> 6) & 63)), w(128 | (c & 63));\n    }\n    return slc(ar, 0, ai);\n}\n/**\n * Converts a Uint8Array to a string\n * @param dat The data to decode to string\n * @param latin1 Whether or not to interpret the data as Latin-1. This should\n *               not need to be true unless encoding to binary string.\n * @returns The original UTF-8/Latin-1 string\n */\nexport function strFromU8(dat, latin1) {\n    if (latin1) {\n        var r = '';\n        for (var i = 0; i < dat.length; i += 16384)\n            r += String.fromCharCode.apply(null, dat.subarray(i, i + 16384));\n        return r;\n    }\n    else if (td)\n        return td.decode(dat);\n    else {\n        var _a = dutf8(dat), out = _a[0], ext = _a[1];\n        if (ext.length)\n            err(8);\n        return out;\n    }\n}\n;\n// deflate bit flag\nvar dbf = function (l) { return l == 1 ? 3 : l < 6 ? 2 : l == 9 ? 1 : 0; };\n// skip local zip header\nvar slzh = function (d, b) { return b + 30 + b2(d, b + 26) + b2(d, b + 28); };\n// read zip header\nvar zh = function (d, b, z) {\n    var fnl = b2(d, b + 28), fn = strFromU8(d.subarray(b + 46, b + 46 + fnl), !(b2(d, b + 8) & 2048)), es = b + 46 + fnl, bs = b4(d, b + 20);\n    var _a = z && bs == 4294967295 ? z64e(d, es) : [bs, b4(d, b + 24), b4(d, b + 42)], sc = _a[0], su = _a[1], off = _a[2];\n    return [b2(d, b + 10), sc, su, fn, es + b2(d, b + 30) + b2(d, b + 32), off];\n};\n// read zip64 extra field\nvar z64e = function (d, b) {\n    for (; b2(d, b) != 1; b += 4 + b2(d, b + 2))\n        ;\n    return [b8(d, b + 12), b8(d, b + 4), b8(d, b + 20)];\n};\n// extra field length\nvar exfl = function (ex) {\n    var le = 0;\n    if (ex) {\n        for (var k in ex) {\n            var l = ex[k].length;\n            if (l > 65535)\n                err(9);\n            le += l + 4;\n        }\n    }\n    return le;\n};\n// write zip header\nvar wzh = function (d, b, f, fn, u, c, ce, co) {\n    var fl = fn.length, ex = f.extra, col = co && co.length;\n    var exl = exfl(ex);\n    wbytes(d, b, ce != null ? 0x2014B50 : 0x4034B50), b += 4;\n    if (ce != null)\n        d[b++] = 20, d[b++] = f.os;\n    d[b] = 20, b += 2; // spec compliance? what's that?\n    d[b++] = (f.flag << 1) | (c < 0 && 8), d[b++] = u && 8;\n    d[b++] = f.compression & 255, d[b++] = f.compression >> 8;\n    var dt = new Date(f.mtime == null ? Date.now() : f.mtime), y = dt.getFullYear() - 1980;\n    if (y < 0 || y > 119)\n        err(10);\n    wbytes(d, b, (y << 25) | ((dt.getMonth() + 1) << 21) | (dt.getDate() << 16) | (dt.getHours() << 11) | (dt.getMinutes() << 5) | (dt.getSeconds() >>> 1)), b += 4;\n    if (c != -1) {\n        wbytes(d, b, f.crc);\n        wbytes(d, b + 4, c < 0 ? -c - 2 : c);\n        wbytes(d, b + 8, f.size);\n    }\n    wbytes(d, b + 12, fl);\n    wbytes(d, b + 14, exl), b += 16;\n    if (ce != null) {\n        wbytes(d, b, col);\n        wbytes(d, b + 6, f.attrs);\n        wbytes(d, b + 10, ce), b += 14;\n    }\n    d.set(fn, b);\n    b += fl;\n    if (exl) {\n        for (var k in ex) {\n            var exf = ex[k], l = exf.length;\n            wbytes(d, b, +k);\n            wbytes(d, b + 2, l);\n            d.set(exf, b + 4), b += 4 + l;\n        }\n    }\n    if (col)\n        d.set(co, b), b += col;\n    return b;\n};\n// write zip footer (end of central directory)\nvar wzf = function (o, b, c, d, e) {\n    wbytes(o, b, 0x6054B50); // skip disk\n    wbytes(o, b + 8, c);\n    wbytes(o, b + 10, c);\n    wbytes(o, b + 12, d);\n    wbytes(o, b + 16, e);\n};\n/**\n * A pass-through stream to keep data uncompressed in a ZIP archive.\n */\nvar ZipPassThrough = /*#__PURE__*/ (function () {\n    /**\n     * Creates a pass-through stream that can be added to ZIP archives\n     * @param filename The filename to associate with this data stream\n     */\n    function ZipPassThrough(filename) {\n        this.filename = filename;\n        this.c = crc();\n        this.size = 0;\n        this.compression = 0;\n    }\n    /**\n     * Processes a chunk and pushes to the output stream. You can override this\n     * method in a subclass for custom behavior, but by default this passes\n     * the data through. You must call this.ondata(err, chunk, final) at some\n     * point in this method.\n     * @param chunk The chunk to process\n     * @param final Whether this is the last chunk\n     */\n    ZipPassThrough.prototype.process = function (chunk, final) {\n        this.ondata(null, chunk, final);\n    };\n    /**\n     * Pushes a chunk to be added. If you are subclassing this with a custom\n     * compression algorithm, note that you must push data from the source\n     * file only, pre-compression.\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    ZipPassThrough.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            err(5);\n        this.c.p(chunk);\n        this.size += chunk.length;\n        if (final)\n            this.crc = this.c.d();\n        this.process(chunk, final || false);\n    };\n    return ZipPassThrough;\n}());\nexport { ZipPassThrough };\n// I don't extend because TypeScript extension adds 1kB of runtime bloat\n/**\n * Streaming DEFLATE compression for ZIP archives. Prefer using AsyncZipDeflate\n * for better performance\n */\nvar ZipDeflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates a DEFLATE stream that can be added to ZIP archives\n     * @param filename The filename to associate with this data stream\n     * @param opts The compression options\n     */\n    function ZipDeflate(filename, opts) {\n        var _this_1 = this;\n        if (!opts)\n            opts = {};\n        ZipPassThrough.call(this, filename);\n        this.d = new Deflate(opts, function (dat, final) {\n            _this_1.ondata(null, dat, final);\n        });\n        this.compression = 8;\n        this.flag = dbf(opts.level);\n    }\n    ZipDeflate.prototype.process = function (chunk, final) {\n        try {\n            this.d.push(chunk, final);\n        }\n        catch (e) {\n            this.ondata(e, null, final);\n        }\n    };\n    /**\n     * Pushes a chunk to be deflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    ZipDeflate.prototype.push = function (chunk, final) {\n        ZipPassThrough.prototype.push.call(this, chunk, final);\n    };\n    return ZipDeflate;\n}());\nexport { ZipDeflate };\n/**\n * Asynchronous streaming DEFLATE compression for ZIP archives\n */\nvar AsyncZipDeflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates a DEFLATE stream that can be added to ZIP archives\n     * @param filename The filename to associate with this data stream\n     * @param opts The compression options\n     */\n    function AsyncZipDeflate(filename, opts) {\n        var _this_1 = this;\n        if (!opts)\n            opts = {};\n        ZipPassThrough.call(this, filename);\n        this.d = new AsyncDeflate(opts, function (err, dat, final) {\n            _this_1.ondata(err, dat, final);\n        });\n        this.compression = 8;\n        this.flag = dbf(opts.level);\n        this.terminate = this.d.terminate;\n    }\n    AsyncZipDeflate.prototype.process = function (chunk, final) {\n        this.d.push(chunk, final);\n    };\n    /**\n     * Pushes a chunk to be deflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    AsyncZipDeflate.prototype.push = function (chunk, final) {\n        ZipPassThrough.prototype.push.call(this, chunk, final);\n    };\n    return AsyncZipDeflate;\n}());\nexport { AsyncZipDeflate };\n// TODO: Better tree shaking\n/**\n * A zippable archive to which files can incrementally be added\n */\nvar Zip = /*#__PURE__*/ (function () {\n    /**\n     * Creates an empty ZIP archive to which files can be added\n     * @param cb The callback to call whenever data for the generated ZIP archive\n     *           is available\n     */\n    function Zip(cb) {\n        this.ondata = cb;\n        this.u = [];\n        this.d = 1;\n    }\n    /**\n     * Adds a file to the ZIP archive\n     * @param file The file stream to add\n     */\n    Zip.prototype.add = function (file) {\n        var _this_1 = this;\n        if (!this.ondata)\n            err(5);\n        // finishing or finished\n        if (this.d & 2)\n            this.ondata(err(4 + (this.d & 1) * 8, 0, 1), null, false);\n        else {\n            var f = strToU8(file.filename), fl_1 = f.length;\n            var com = file.comment, o = com && strToU8(com);\n            var u = fl_1 != file.filename.length || (o && (com.length != o.length));\n            var hl_1 = fl_1 + exfl(file.extra) + 30;\n            if (fl_1 > 65535)\n                this.ondata(err(11, 0, 1), null, false);\n            var header = new u8(hl_1);\n            wzh(header, 0, file, f, u, -1);\n            var chks_1 = [header];\n            var pAll_1 = function () {\n                for (var _i = 0, chks_2 = chks_1; _i < chks_2.length; _i++) {\n                    var chk = chks_2[_i];\n                    _this_1.ondata(null, chk, false);\n                }\n                chks_1 = [];\n            };\n            var tr_1 = this.d;\n            this.d = 0;\n            var ind_1 = this.u.length;\n            var uf_1 = mrg(file, {\n                f: f,\n                u: u,\n                o: o,\n                t: function () {\n                    if (file.terminate)\n                        file.terminate();\n                },\n                r: function () {\n                    pAll_1();\n                    if (tr_1) {\n                        var nxt = _this_1.u[ind_1 + 1];\n                        if (nxt)\n                            nxt.r();\n                        else\n                            _this_1.d = 1;\n                    }\n                    tr_1 = 1;\n                }\n            });\n            var cl_1 = 0;\n            file.ondata = function (err, dat, final) {\n                if (err) {\n                    _this_1.ondata(err, dat, final);\n                    _this_1.terminate();\n                }\n                else {\n                    cl_1 += dat.length;\n                    chks_1.push(dat);\n                    if (final) {\n                        var dd = new u8(16);\n                        wbytes(dd, 0, 0x8074B50);\n                        wbytes(dd, 4, file.crc);\n                        wbytes(dd, 8, cl_1);\n                        wbytes(dd, 12, file.size);\n                        chks_1.push(dd);\n                        uf_1.c = cl_1, uf_1.b = hl_1 + cl_1 + 16, uf_1.crc = file.crc, uf_1.size = file.size;\n                        if (tr_1)\n                            uf_1.r();\n                        tr_1 = 1;\n                    }\n                    else if (tr_1)\n                        pAll_1();\n                }\n            };\n            this.u.push(uf_1);\n        }\n    };\n    /**\n     * Ends the process of adding files and prepares to emit the final chunks.\n     * This *must* be called after adding all desired files for the resulting\n     * ZIP file to work properly.\n     */\n    Zip.prototype.end = function () {\n        var _this_1 = this;\n        if (this.d & 2) {\n            this.ondata(err(4 + (this.d & 1) * 8, 0, 1), null, true);\n            return;\n        }\n        if (this.d)\n            this.e();\n        else\n            this.u.push({\n                r: function () {\n                    if (!(_this_1.d & 1))\n                        return;\n                    _this_1.u.splice(-1, 1);\n                    _this_1.e();\n                },\n                t: function () { }\n            });\n        this.d = 3;\n    };\n    Zip.prototype.e = function () {\n        var bt = 0, l = 0, tl = 0;\n        for (var _i = 0, _a = this.u; _i < _a.length; _i++) {\n            var f = _a[_i];\n            tl += 46 + f.f.length + exfl(f.extra) + (f.o ? f.o.length : 0);\n        }\n        var out = new u8(tl + 22);\n        for (var _b = 0, _c = this.u; _b < _c.length; _b++) {\n            var f = _c[_b];\n            wzh(out, bt, f, f.f, f.u, -f.c - 2, l, f.o);\n            bt += 46 + f.f.length + exfl(f.extra) + (f.o ? f.o.length : 0), l += f.b;\n        }\n        wzf(out, bt, this.u.length, tl, l);\n        this.ondata(null, out, true);\n        this.d = 2;\n    };\n    /**\n     * A method to terminate any internal workers used by the stream. Subsequent\n     * calls to add() will fail.\n     */\n    Zip.prototype.terminate = function () {\n        for (var _i = 0, _a = this.u; _i < _a.length; _i++) {\n            var f = _a[_i];\n            f.t();\n        }\n        this.d = 2;\n    };\n    return Zip;\n}());\nexport { Zip };\nexport function zip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    var r = {};\n    fltn(data, '', r, opts);\n    var k = Object.keys(r);\n    var lft = k.length, o = 0, tot = 0;\n    var slft = lft, files = new Array(lft);\n    var term = [];\n    var tAll = function () {\n        for (var i = 0; i < term.length; ++i)\n            term[i]();\n    };\n    var cbd = function (a, b) {\n        mt(function () { cb(a, b); });\n    };\n    mt(function () { cbd = cb; });\n    var cbf = function () {\n        var out = new u8(tot + 22), oe = o, cdl = tot - o;\n        tot = 0;\n        for (var i = 0; i < slft; ++i) {\n            var f = files[i];\n            try {\n                var l = f.c.length;\n                wzh(out, tot, f, f.f, f.u, l);\n                var badd = 30 + f.f.length + exfl(f.extra);\n                var loc = tot + badd;\n                out.set(f.c, loc);\n                wzh(out, o, f, f.f, f.u, l, tot, f.m), o += 16 + badd + (f.m ? f.m.length : 0), tot = loc + l;\n            }\n            catch (e) {\n                return cbd(e, null);\n            }\n        }\n        wzf(out, o, files.length, cdl, oe);\n        cbd(null, out);\n    };\n    if (!lft)\n        cbf();\n    var _loop_1 = function (i) {\n        var fn = k[i];\n        var _a = r[fn], file = _a[0], p = _a[1];\n        var c = crc(), size = file.length;\n        c.p(file);\n        var f = strToU8(fn), s = f.length;\n        var com = p.comment, m = com && strToU8(com), ms = m && m.length;\n        var exl = exfl(p.extra);\n        var compression = p.level == 0 ? 0 : 8;\n        var cbl = function (e, d) {\n            if (e) {\n                tAll();\n                cbd(e, null);\n            }\n            else {\n                var l = d.length;\n                files[i] = mrg(p, {\n                    size: size,\n                    crc: c.d(),\n                    c: d,\n                    f: f,\n                    m: m,\n                    u: s != fn.length || (m && (com.length != ms)),\n                    compression: compression\n                });\n                o += 30 + s + exl + l;\n                tot += 76 + 2 * (s + exl) + (ms || 0) + l;\n                if (!--lft)\n                    cbf();\n            }\n        };\n        if (s > 65535)\n            cbl(err(11, 0, 1), null);\n        if (!compression)\n            cbl(null, file);\n        else if (size < 160000) {\n            try {\n                cbl(null, deflateSync(file, p));\n            }\n            catch (e) {\n                cbl(e, null);\n            }\n        }\n        else\n            term.push(deflate(file, p, cbl));\n    };\n    // Cannot use lft because it can decrease\n    for (var i = 0; i < slft; ++i) {\n        _loop_1(i);\n    }\n    return tAll;\n}\n/**\n * Synchronously creates a ZIP file. Prefer using `zip` for better performance\n * with more than one file.\n * @param data The directory structure for the ZIP archive\n * @param opts The main options, merged with per-file options\n * @returns The generated ZIP archive\n */\nexport function zipSync(data, opts) {\n    if (!opts)\n        opts = {};\n    var r = {};\n    var files = [];\n    fltn(data, '', r, opts);\n    var o = 0;\n    var tot = 0;\n    for (var fn in r) {\n        var _a = r[fn], file = _a[0], p = _a[1];\n        var compression = p.level == 0 ? 0 : 8;\n        var f = strToU8(fn), s = f.length;\n        var com = p.comment, m = com && strToU8(com), ms = m && m.length;\n        var exl = exfl(p.extra);\n        if (s > 65535)\n            err(11);\n        var d = compression ? deflateSync(file, p) : file, l = d.length;\n        var c = crc();\n        c.p(file);\n        files.push(mrg(p, {\n            size: file.length,\n            crc: c.d(),\n            c: d,\n            f: f,\n            m: m,\n            u: s != fn.length || (m && (com.length != ms)),\n            o: o,\n            compression: compression\n        }));\n        o += 30 + s + exl + l;\n        tot += 76 + 2 * (s + exl) + (ms || 0) + l;\n    }\n    var out = new u8(tot + 22), oe = o, cdl = tot - o;\n    for (var i = 0; i < files.length; ++i) {\n        var f = files[i];\n        wzh(out, f.o, f, f.f, f.u, f.c.length);\n        var badd = 30 + f.f.length + exfl(f.extra);\n        out.set(f.c, f.o + badd);\n        wzh(out, o, f, f.f, f.u, f.c.length, f.o, f.m), o += 16 + badd + (f.m ? f.m.length : 0);\n    }\n    wzf(out, o, files.length, cdl, oe);\n    return out;\n}\n/**\n * Streaming pass-through decompression for ZIP archives\n */\nvar UnzipPassThrough = /*#__PURE__*/ (function () {\n    function UnzipPassThrough() {\n    }\n    UnzipPassThrough.prototype.push = function (data, final) {\n        this.ondata(null, data, final);\n    };\n    UnzipPassThrough.compression = 0;\n    return UnzipPassThrough;\n}());\nexport { UnzipPassThrough };\n/**\n * Streaming DEFLATE decompression for ZIP archives. Prefer AsyncZipInflate for\n * better performance.\n */\nvar UnzipInflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates a DEFLATE decompression that can be used in ZIP archives\n     */\n    function UnzipInflate() {\n        var _this_1 = this;\n        this.i = new Inflate(function (dat, final) {\n            _this_1.ondata(null, dat, final);\n        });\n    }\n    UnzipInflate.prototype.push = function (data, final) {\n        try {\n            this.i.push(data, final);\n        }\n        catch (e) {\n            this.ondata(e, null, final);\n        }\n    };\n    UnzipInflate.compression = 8;\n    return UnzipInflate;\n}());\nexport { UnzipInflate };\n/**\n * Asynchronous streaming DEFLATE decompression for ZIP archives\n */\nvar AsyncUnzipInflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates a DEFLATE decompression that can be used in ZIP archives\n     */\n    function AsyncUnzipInflate(_, sz) {\n        var _this_1 = this;\n        if (sz < 320000) {\n            this.i = new Inflate(function (dat, final) {\n                _this_1.ondata(null, dat, final);\n            });\n        }\n        else {\n            this.i = new AsyncInflate(function (err, dat, final) {\n                _this_1.ondata(err, dat, final);\n            });\n            this.terminate = this.i.terminate;\n        }\n    }\n    AsyncUnzipInflate.prototype.push = function (data, final) {\n        if (this.i.terminate)\n            data = slc(data, 0);\n        this.i.push(data, final);\n    };\n    AsyncUnzipInflate.compression = 8;\n    return AsyncUnzipInflate;\n}());\nexport { AsyncUnzipInflate };\n/**\n * A ZIP archive decompression stream that emits files as they are discovered\n */\nvar Unzip = /*#__PURE__*/ (function () {\n    /**\n     * Creates a ZIP decompression stream\n     * @param cb The callback to call whenever a file in the ZIP archive is found\n     */\n    function Unzip(cb) {\n        this.onfile = cb;\n        this.k = [];\n        this.o = {\n            0: UnzipPassThrough\n        };\n        this.p = et;\n    }\n    /**\n     * Pushes a chunk to be unzipped\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Unzip.prototype.push = function (chunk, final) {\n        var _this_1 = this;\n        if (!this.onfile)\n            err(5);\n        if (!this.p)\n            err(4);\n        if (this.c > 0) {\n            var len = Math.min(this.c, chunk.length);\n            var toAdd = chunk.subarray(0, len);\n            this.c -= len;\n            if (this.d)\n                this.d.push(toAdd, !this.c);\n            else\n                this.k[0].push(toAdd);\n            chunk = chunk.subarray(len);\n            if (chunk.length)\n                return this.push(chunk, final);\n        }\n        else {\n            var f = 0, i = 0, is = void 0, buf = void 0;\n            if (!this.p.length)\n                buf = chunk;\n            else if (!chunk.length)\n                buf = this.p;\n            else {\n                buf = new u8(this.p.length + chunk.length);\n                buf.set(this.p), buf.set(chunk, this.p.length);\n            }\n            var l = buf.length, oc = this.c, add = oc && this.d;\n            var _loop_2 = function () {\n                var _a;\n                var sig = b4(buf, i);\n                if (sig == 0x4034B50) {\n                    f = 1, is = i;\n                    this_1.d = null;\n                    this_1.c = 0;\n                    var bf = b2(buf, i + 6), cmp_1 = b2(buf, i + 8), u = bf & 2048, dd = bf & 8, fnl = b2(buf, i + 26), es = b2(buf, i + 28);\n                    if (l > i + 30 + fnl + es) {\n                        var chks_3 = [];\n                        this_1.k.unshift(chks_3);\n                        f = 2;\n                        var sc_1 = b4(buf, i + 18), su_1 = b4(buf, i + 22);\n                        var fn_1 = strFromU8(buf.subarray(i + 30, i += 30 + fnl), !u);\n                        if (sc_1 == 4294967295) {\n                            _a = dd ? [-2] : z64e(buf, i), sc_1 = _a[0], su_1 = _a[1];\n                        }\n                        else if (dd)\n                            sc_1 = -1;\n                        i += es;\n                        this_1.c = sc_1;\n                        var d_1;\n                        var file_1 = {\n                            name: fn_1,\n                            compression: cmp_1,\n                            start: function () {\n                                if (!file_1.ondata)\n                                    err(5);\n                                if (!sc_1)\n                                    file_1.ondata(null, et, true);\n                                else {\n                                    var ctr = _this_1.o[cmp_1];\n                                    if (!ctr)\n                                        file_1.ondata(err(14, 'unknown compression type ' + cmp_1, 1), null, false);\n                                    d_1 = sc_1 < 0 ? new ctr(fn_1) : new ctr(fn_1, sc_1, su_1);\n                                    d_1.ondata = function (err, dat, final) { file_1.ondata(err, dat, final); };\n                                    for (var _i = 0, chks_4 = chks_3; _i < chks_4.length; _i++) {\n                                        var dat = chks_4[_i];\n                                        d_1.push(dat, false);\n                                    }\n                                    if (_this_1.k[0] == chks_3 && _this_1.c)\n                                        _this_1.d = d_1;\n                                    else\n                                        d_1.push(et, true);\n                                }\n                            },\n                            terminate: function () {\n                                if (d_1 && d_1.terminate)\n                                    d_1.terminate();\n                            }\n                        };\n                        if (sc_1 >= 0)\n                            file_1.size = sc_1, file_1.originalSize = su_1;\n                        this_1.onfile(file_1);\n                    }\n                    return \"break\";\n                }\n                else if (oc) {\n                    if (sig == 0x8074B50) {\n                        is = i += 12 + (oc == -2 && 8), f = 3, this_1.c = 0;\n                        return \"break\";\n                    }\n                    else if (sig == 0x2014B50) {\n                        is = i -= 4, f = 3, this_1.c = 0;\n                        return \"break\";\n                    }\n                }\n            };\n            var this_1 = this;\n            for (; i < l - 4; ++i) {\n                var state_1 = _loop_2();\n                if (state_1 === \"break\")\n                    break;\n            }\n            this.p = et;\n            if (oc < 0) {\n                var dat = f ? buf.subarray(0, is - 12 - (oc == -2 && 8) - (b4(buf, is - 16) == 0x8074B50 && 4)) : buf.subarray(0, i);\n                if (add)\n                    add.push(dat, !!f);\n                else\n                    this.k[+(f == 2)].push(dat);\n            }\n            if (f & 2)\n                return this.push(buf.subarray(i), final);\n            this.p = buf.subarray(i);\n        }\n        if (final) {\n            if (this.c)\n                err(13);\n            this.p = null;\n        }\n    };\n    /**\n     * Registers a decoder with the stream, allowing for files compressed with\n     * the compression type provided to be expanded correctly\n     * @param decoder The decoder constructor\n     */\n    Unzip.prototype.register = function (decoder) {\n        this.o[decoder.compression] = decoder;\n    };\n    return Unzip;\n}());\nexport { Unzip };\nvar mt = typeof queueMicrotask == 'function' ? queueMicrotask : typeof setTimeout == 'function' ? setTimeout : function (fn) { fn(); };\nexport function unzip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    var term = [];\n    var tAll = function () {\n        for (var i = 0; i < term.length; ++i)\n            term[i]();\n    };\n    var files = {};\n    var cbd = function (a, b) {\n        mt(function () { cb(a, b); });\n    };\n    mt(function () { cbd = cb; });\n    var e = data.length - 22;\n    for (; b4(data, e) != 0x6054B50; --e) {\n        if (!e || data.length - e > 65558) {\n            cbd(err(13, 0, 1), null);\n            return tAll;\n        }\n    }\n    ;\n    var lft = b2(data, e + 8);\n    if (lft) {\n        var c = lft;\n        var o = b4(data, e + 16);\n        var z = o == 4294967295 || c == 65535;\n        if (z) {\n            var ze = b4(data, e - 12);\n            z = b4(data, ze) == 0x6064B50;\n            if (z) {\n                c = lft = b4(data, ze + 32);\n                o = b4(data, ze + 48);\n            }\n        }\n        var fltr = opts && opts.filter;\n        var _loop_3 = function (i) {\n            var _a = zh(data, o, z), c_1 = _a[0], sc = _a[1], su = _a[2], fn = _a[3], no = _a[4], off = _a[5], b = slzh(data, off);\n            o = no;\n            var cbl = function (e, d) {\n                if (e) {\n                    tAll();\n                    cbd(e, null);\n                }\n                else {\n                    if (d)\n                        files[fn] = d;\n                    if (!--lft)\n                        cbd(null, files);\n                }\n            };\n            if (!fltr || fltr({\n                name: fn,\n                size: sc,\n                originalSize: su,\n                compression: c_1\n            })) {\n                if (!c_1)\n                    cbl(null, slc(data, b, b + sc));\n                else if (c_1 == 8) {\n                    var infl = data.subarray(b, b + sc);\n                    if (sc < 320000) {\n                        try {\n                            cbl(null, inflateSync(infl, new u8(su)));\n                        }\n                        catch (e) {\n                            cbl(e, null);\n                        }\n                    }\n                    else\n                        term.push(inflate(infl, { size: su }, cbl));\n                }\n                else\n                    cbl(err(14, 'unknown compression type ' + c_1, 1), null);\n            }\n            else\n                cbl(null, null);\n        };\n        for (var i = 0; i < c; ++i) {\n            _loop_3(i);\n        }\n    }\n    else\n        cbd(null, {});\n    return tAll;\n}\n/**\n * Synchronously decompresses a ZIP archive. Prefer using `unzip` for better\n * performance with more than one file.\n * @param data The raw compressed ZIP file\n * @param opts The ZIP extraction options\n * @returns The decompressed files\n */\nexport function unzipSync(data, opts) {\n    var files = {};\n    var e = data.length - 22;\n    for (; b4(data, e) != 0x6054B50; --e) {\n        if (!e || data.length - e > 65558)\n            err(13);\n    }\n    ;\n    var c = b2(data, e + 8);\n    if (!c)\n        return {};\n    var o = b4(data, e + 16);\n    var z = o == 4294967295 || c == 65535;\n    if (z) {\n        var ze = b4(data, e - 12);\n        z = b4(data, ze) == 0x6064B50;\n        if (z) {\n            c = b4(data, ze + 32);\n            o = b4(data, ze + 48);\n        }\n    }\n    var fltr = opts && opts.filter;\n    for (var i = 0; i < c; ++i) {\n        var _a = zh(data, o, z), c_2 = _a[0], sc = _a[1], su = _a[2], fn = _a[3], no = _a[4], off = _a[5], b = slzh(data, off);\n        o = no;\n        if (!fltr || fltr({\n            name: fn,\n            size: sc,\n            originalSize: su,\n            compression: c_2\n        })) {\n            if (!c_2)\n                files[fn] = slc(data, b, b + sc);\n            else if (c_2 == 8)\n                files[fn] = inflateSync(data.subarray(b, b + sc), new u8(su));\n            else\n                err(14, 'unknown compression type ' + c_2);\n        }\n    }\n    return files;\n}\n","// Sand Game JS; Patrik Harag, https://harag.cz; all rights reserved\r\n\r\nimport Action from \"./Action\";\r\nimport FileSaver from 'file-saver';\r\nimport { zipSync } from \"fflate\";\r\n\r\n/**\r\n *\r\n * @author Patrik Harag\r\n * @version 2024-02-02\r\n */\r\nexport default class ActionRecord extends Action {\r\n\r\n    #controllerHandlersRegistered = false;\r\n    #sandGameHandlersRegistered = false;\r\n\r\n    #zipData = null;\r\n\r\n    performAction(controller) {\r\n        if (!this.#controllerHandlersRegistered) {\r\n            controller.addOnBeforeClosed(() => {\r\n                if (this.#zipData !== null) {\r\n                    this.#stopRecording();\r\n                }\r\n            });\r\n            controller.addOnInitialized(sandGame => {\r\n                this.#sandGameHandlersRegistered = false;\r\n            })\r\n            this.#controllerHandlersRegistered = true;\r\n        }\r\n\r\n        if (this.#zipData === null) {\r\n            // start recording\r\n            this.#zipData = {};\r\n\r\n            if (!this.#sandGameHandlersRegistered) {\r\n                let processed = false;\r\n                let lastIteration = 0;\r\n                let frameInProgress = false;\r\n                controller.getSandGame().addOnProcessed((iteration) => {\r\n                    processed = true;\r\n                    lastIteration = iteration;\r\n                });\r\n                controller.getSandGame().addOnRendered(() => {\r\n                    if (this.#zipData !== null && processed && !frameInProgress) {\r\n                        frameInProgress = true;\r\n                        this.#addFrame(controller, lastIteration, () => frameInProgress = false);\r\n                        processed = false;\r\n                    }\r\n                });\r\n                this.#sandGameHandlersRegistered = true;\r\n            }\r\n        } else {\r\n            this.#stopRecording();\r\n        }\r\n    }\r\n\r\n    #addFrame(controller, iteration, completed) {\r\n        const canvas = controller.getCanvas();\r\n        if (canvas !== null) {\r\n            canvas.toBlob((blob) => {\r\n                blob.arrayBuffer().then(arrayBuffer => {\r\n                    const array = new Uint8Array(arrayBuffer);\r\n                    if (this.#zipData !== null) {\r\n                        this.#zipData[`iteration_${String(iteration).padStart(6, '0')}.png`] = array;\r\n                    }\r\n                }).finally(() => {\r\n                    completed();\r\n                })\r\n            });\r\n        }\r\n    }\r\n\r\n    #stopRecording() {\r\n        this.#download(this.#zipData, 'frames.zip');\r\n        this.#zipData = null;\r\n    }\r\n\r\n    #download(zipData, filename) {\r\n        const bytes = zipSync(zipData, { level: 0 });\r\n        FileSaver.saveAs(new Blob([bytes]), filename);\r\n    }\r\n}\r\n","// Sand Game JS; Patrik Harag, https://harag.cz; all rights reserved\r\n\r\nimport Action from \"./Action\";\r\nimport FileSaver from 'file-saver';\r\n\r\n/**\r\n *\r\n * @author Patrik Harag\r\n * @version 2023-11-20\r\n */\r\nexport default class ActionScreenshot extends Action {\r\n\r\n    performAction(controller) {\r\n        const canvas = controller.getCanvas();\r\n        if (canvas !== null) {\r\n            canvas.toBlob((blob) => {\r\n                FileSaver.saveAs(blob, this.#formatDate(new Date()) + '.png');\r\n            });\r\n        }\r\n    }\r\n\r\n    #formatDate(date) {\r\n        let dd = String(date.getDate()).padStart(2, '0');\r\n        let MM = String(date.getMonth() + 1).padStart(2, '0');  // January is 0!\r\n        let yyyy = date.getFullYear();\r\n\r\n        let hh = String(date.getHours()).padStart(2, '0');\r\n        let mm = String(date.getMinutes()).padStart(2, '0');\r\n\r\n        return `${yyyy}-${MM}-${dd}_${hh}-${mm}`;\r\n    }\r\n}\r\n","// Sand Game JS; Patrik Harag, https://harag.cz; all rights reserved\r\n\r\nimport Action from \"./Action\";\r\nimport DomBuilder from \"../DomBuilder\";\r\nimport FileSaver from 'file-saver';\r\n\r\n// Warning: dev tools only\r\n\r\nconst Scenes = window.SandGameJS.Scenes;\r\n\r\n/**\r\n *\r\n * @author Patrik Harag\r\n * @version 2024-05-25\r\n */\r\nexport default class ActionBenchmark extends Action {\r\n\r\n    performAction(controller) {\r\n        let benchmarkProvider = new BenchmarkProvider(controller, results => {\r\n            let dialog = DomBuilder.bootstrapDialogBuilder();\r\n            dialog.setHeaderContent('Benchmark results');\r\n            dialog.setBodyContent([\r\n                DomBuilder.par(null, 'IPS AVG: ' + results.ipsAvg.toFixed(2)),\r\n                DomBuilder.par(null, 'IPS MIN: ' + results.ipsMin)\r\n            ]);\r\n            dialog.addCloseButton('Close');\r\n            dialog.addButton(\r\n                DomBuilder.button('Download results', { type: 'button', class: 'btn btn-primary' }, e => {\r\n                    const data = JSON.stringify(results, null, '  ');\r\n                    const blob = new Blob([data], { type: 'application/json;charset=utf-8' });\r\n                    const date = this.#formatDate(new Date());\r\n                    FileSaver.saveAs(blob, `${date}.benchmark.json`);\r\n                })\r\n            );\r\n            dialog.show(controller.getDialogAnchor());\r\n        });\r\n        benchmarkProvider.start();\r\n    }\r\n\r\n    #formatDate(date) {\r\n        let dd = String(date.getDate()).padStart(2, '0');\r\n        let MM = String(date.getMonth() + 1).padStart(2, '0');  // January is 0!\r\n        let yyyy = date.getFullYear();\r\n\r\n        let hh = String(date.getHours()).padStart(2, '0');\r\n        let mm = String(date.getMinutes()).padStart(2, '0');\r\n\r\n        return `${yyyy}-${MM}-${dd}_${hh}-${mm}`;\r\n    }\r\n}\r\n\r\n/**\r\n *\r\n * @author Patrik Harag\r\n * @version 2023-04-29\r\n */\r\nclass BenchmarkProvider {\r\n\r\n    static WAITING_GAP = 300;\r\n\r\n    /** @type Controller */\r\n    #controller;\r\n\r\n    /** @type function */\r\n    #onFinish;\r\n\r\n    /**\r\n     *\r\n     * @param controller {Controller}\r\n     * @param onFinish {function({ipsAvg,ipsMin,benchmarks:{name,ipsAvg,ipsMin}[]})}\r\n     */\r\n    constructor(controller, onFinish) {\r\n        this.#controller = controller;\r\n        this.#onFinish = onFinish;\r\n    }\r\n\r\n    start() {\r\n        let scene = Scenes.custom('Benchmark', (s) => this.#benchmarkScene(s));\r\n        this.#controller.openScene(scene);\r\n        this.#controller.start();\r\n    }\r\n\r\n    #benchmarkScene(sandGame) {\r\n        const benchmarkResults = [];\r\n        const benchmarkQueue = [...BenchmarkProvider.BENCHMARKS];\r\n        let i = 0;\r\n        let waiting = BenchmarkProvider.WAITING_GAP;\r\n        let ipsSum = 0;\r\n        let ipsMin = Number.MAX_SAFE_INTEGER;\r\n        sandGame.addOnProcessed(() => {\r\n            if (waiting > 0) {\r\n                waiting--;\r\n                return;\r\n            }\r\n            if (benchmarkQueue.length === 0) {\r\n                return;\r\n            }\r\n\r\n            const benchmark = benchmarkQueue[0];\r\n            if (i === 0) {\r\n                console.log('Running benchmark: ' + benchmark.name);\r\n            }\r\n            benchmark.nextIteration(sandGame, i);\r\n            i++;\r\n            const ips = sandGame.getIterationsPerSecond();\r\n            ipsSum = ipsSum + ips;\r\n            ipsMin = Math.min(ipsMin, ips);\r\n\r\n            if (benchmark.iterations === i) {\r\n                const ipsAvg = ipsSum / benchmark.iterations;\r\n                benchmarkResults.push({\r\n                    name: benchmark.name,\r\n                    ipsAvg: ipsAvg,\r\n                    ipsMin: ipsMin\r\n                });\r\n\r\n                benchmarkQueue.shift();\r\n                i = 0;\r\n                ipsSum = 0;\r\n                ipsMin = Number.MAX_SAFE_INTEGER;\r\n                waiting = BenchmarkProvider.WAITING_GAP;\r\n\r\n                sandGame.graphics().fill(sandGame.getBrushCollection().byCodeName('air'));\r\n\r\n                if (benchmarkQueue.length === 0) {\r\n                    this.#onFinish(this.#finalizeResults(sandGame, benchmarkResults));\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    #finalizeResults(sandGame, benchmarkResults) {\r\n        const ipsSum = benchmarkResults.map(r => r.ipsAvg).reduce((a, b) => a + b, 0);\r\n        const ipsAvg = ipsSum / benchmarkResults.length;\r\n        const ipsMin = benchmarkResults.map(r => r.ipsMin).reduce((a, b) => Math.min(a, b), Number.MAX_SAFE_INTEGER);\r\n        return {\r\n            version: 1,\r\n            date: new Date().toString(),\r\n            ipsAvg: ipsAvg,\r\n            ipsMin: ipsMin,\r\n            benchmarks: benchmarkResults,\r\n            scene: {\r\n                width: sandGame.getWidth(),\r\n                height: sandGame.getHeight()\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    static #createBenchmark(name, iterations, nextIteration) {\r\n        if (iterations <= 0) {\r\n            throw 'Number of iterations must be a positive number';\r\n        }\r\n        return {\r\n            name: name,\r\n            iterations: iterations,\r\n            nextIteration: nextIteration\r\n        };\r\n    }\r\n\r\n    static BENCHMARKS = [\r\n        BenchmarkProvider.#createBenchmark('sand-fall-q', 500, function (sandGame, j) {\r\n            const sand = sandGame.getBrushCollection().byCodeName('sand');\r\n            sandGame.graphics().drawRectangle(0, 0, -1, 1, sand, true);\r\n        }),\r\n        BenchmarkProvider.#createBenchmark('sand-fall-s', 2000, function (sandGame, j) {\r\n            if (j % 10 === 0) {\r\n                const sand = sandGame.getBrushCollection().byCodeName('sand');\r\n                sandGame.graphics().drawRectangle(0, 0, -1, 1, sand, true);\r\n            }\r\n        }),\r\n        BenchmarkProvider.#createBenchmark('sand-fill', 1000, function (sandGame, j) {\r\n            if (j === 0) {\r\n                const sand = sandGame.getBrushCollection().byCodeName('sand');\r\n                sandGame.graphics().drawRectangle(0, 0, -1, -1, sand, true);\r\n            }\r\n        }),\r\n        BenchmarkProvider.#createBenchmark('soil-fall-q', 500, function (sandGame, j) {\r\n            const soil = sandGame.getBrushCollection().byCodeName('soil');\r\n            sandGame.graphics().drawRectangle(0, 0, -1, 1, soil, true);\r\n        }),\r\n        BenchmarkProvider.#createBenchmark('soil-fall-s', 2000, function (sandGame, j) {\r\n            if (j % 10 === 0) {\r\n                const soil = sandGame.getBrushCollection().byCodeName('soil');\r\n                sandGame.graphics().drawRectangle(0, 0, -1, 1, soil, true);\r\n            }\r\n        }),\r\n        BenchmarkProvider.#createBenchmark('soil-fill', 1000, function (sandGame, j) {\r\n            if (j === 0) {\r\n                const soil = sandGame.getBrushCollection().byCodeName('soil');\r\n                sandGame.graphics().drawRectangle(0, 0, -1, -1, soil, true);\r\n            }\r\n        }),\r\n        BenchmarkProvider.#createBenchmark('water-fall-q', 500, function (sandGame, j) {\r\n            const water = sandGame.getBrushCollection().byCodeName('water');\r\n            sandGame.graphics().drawRectangle(0, 0, -1, 1, water, true);\r\n        }),\r\n        BenchmarkProvider.#createBenchmark('water-fall-s', 2000, function (sandGame, j) {\r\n            if (j % 10 === 0) {\r\n                const water = sandGame.getBrushCollection().byCodeName('water');\r\n                sandGame.graphics().drawRectangle(0, 0, -1, 1, water, true);\r\n            }\r\n        }),\r\n        BenchmarkProvider.#createBenchmark('water-fill', 1000, function (sandGame, j) {\r\n            if (j === 0) {\r\n                const water = sandGame.getBrushCollection().byCodeName('water');\r\n                sandGame.graphics().drawRectangle(0, 0, -1, -1, water, true);\r\n            }\r\n        }),\r\n        BenchmarkProvider.#createBenchmark('sand-into-water', 1000, function (sandGame, j) {\r\n            if (j === 0) {\r\n                const sand = sandGame.getBrushCollection().byCodeName('sand');\r\n                const water = sandGame.getBrushCollection().byCodeName('water');\r\n                sandGame.graphics().drawRectangle(0, 0, -1, 31, sand, true);\r\n                sandGame.graphics().drawRectangle(0, 60, -1, -1, water, true);\r\n            }\r\n        }),\r\n        BenchmarkProvider.#createBenchmark('soil-into-water', 1000, function (sandGame, j) {\r\n            if (j === 0) {\r\n                const soil = sandGame.getBrushCollection().byCodeName('soil');\r\n                const water = sandGame.getBrushCollection().byCodeName('water');\r\n                sandGame.graphics().drawRectangle(0, 0, -1, 31, soil, true);\r\n                sandGame.graphics().drawRectangle(0, 60, -1, -1, water, true);\r\n            }\r\n        }),\r\n    ];\r\n}\r\n","// Sand Game JS; Patrik Harag, https://harag.cz; all rights reserved\r\n\r\nimport Action from \"./Action\";\r\n\r\n/**\r\n *\r\n * @author Patrik Harag\r\n * @version 2023-12-05\r\n */\r\nexport default class ActionFill extends Action {\r\n\r\n    performAction(controller) {\r\n        const sandGame = controller.getSandGame();\r\n        if (sandGame === null) {\r\n            return;\r\n        }\r\n        const primaryTool = controller.getToolManager().getPrimaryTool();\r\n        if (!primaryTool.isAreaModeEnabled()) {\r\n            return;\r\n        }\r\n        primaryTool.applyArea(0, 0, sandGame.getWidth(), sandGame.getHeight(), sandGame.graphics(), false);\r\n    }\r\n}\r\n","// Sand Game JS; Patrik Harag, https://harag.cz; all rights reserved\r\n\r\n// Warning: dev tools only\r\n\r\nconst BrushDefs = window.SandGameJS.BrushDefs;\r\n\r\n/**\r\n *\r\n * @author Patrik Harag\r\n * @version 2023-12-19\r\n */\r\nexport default class ActionsDev {\r\n\r\n    static ALL_MATERIALS = function (controller) {\r\n        let sandGame = controller.getSandGame();\r\n        if (sandGame === null) {\r\n            return;\r\n        }\r\n\r\n        const brushes = [\r\n            'ash',\r\n            'sand',\r\n            'soil',\r\n            'gravel',\r\n            'wall',\r\n            'rock',\r\n            'metal',\r\n            'wood',\r\n            'water'\r\n        ];\r\n\r\n        let segment = Math.ceil(sandGame.getWidth() / brushes.length);\r\n        for (let i = 0; i < brushes.length; i++) {\r\n            const brush = BrushDefs.byCodeName(brushes[i]);\r\n            sandGame.graphics().drawRectangle(i * segment, 0, (i + 1) * segment, -1, brush, true);\r\n        }\r\n    }\r\n\r\n    static TREE_SPAWN_TEST = function (controller) {\r\n        let sandGame = controller.getSandGame();\r\n        if (sandGame === null) {\r\n            return;\r\n        }\r\n\r\n        sandGame.graphics().fill(BrushDefs.AIR);\r\n\r\n        sandGame.layeredTemplate()\r\n                .layer(Math.trunc(sandGame.getHeight() / 2), false, BrushDefs.AIR)\r\n                .layer(1, true, BrushDefs.WALL)\r\n                .layer(10, true, BrushDefs.SOIL)\r\n                .grass();\r\n\r\n        sandGame.layeredTemplate()\r\n                .layer(1, true, BrushDefs.WALL)\r\n                .layer(10, true, BrushDefs.SOIL)\r\n                .grass();\r\n    }\r\n\r\n    static treeGrowTest(level = -1) {\r\n        return function (controller) {\r\n            let sandGame = controller.getSandGame();\r\n            if (sandGame === null) {\r\n                return;\r\n            }\r\n\r\n            sandGame.graphics().fill(BrushDefs.AIR);\r\n\r\n            let count = 8;\r\n            let segment = Math.trunc(sandGame.getWidth() / 8);\r\n\r\n            const template1 = sandGame.layeredTemplate();\r\n            template1.layer(Math.trunc(sandGame.getHeight() / 2), false, BrushDefs.AIR);\r\n            template1.layer(1, true, BrushDefs.WALL);\r\n            template1.layer(10, true, BrushDefs.SOIL);\r\n            for (let i = 0; i < 8; i++) {\r\n                template1.tree(Math.trunc((i + 0.5) * segment), i % count, level);\r\n            }\r\n            template1.grass();\r\n\r\n            const template2 = sandGame.layeredTemplate();\r\n            template2.layer(1, true, BrushDefs.WALL);\r\n            template2.layer(10, true, BrushDefs.SOIL);\r\n            for (let i = 0; i < 8; i++) {\r\n                template2.tree(Math.trunc((i + 0.5) * segment), (i + 8) % count, level);\r\n            }\r\n            template2.grass();\r\n        }\r\n    }\r\n}\r\n","// Sand Game JS; Patrik Harag, https://harag.cz; all rights reserved\r\n\r\nimport Action from \"./Action\";\r\n\r\n/**\r\n *\r\n * @author Patrik Harag\r\n * @version 2024-05-25\r\n */\r\nexport default class ActionShowActiveChunks extends Action {\r\n\r\n    static #MARKER_GROUP = 'chunk';\r\n\r\n    #registered = false;\r\n    #enabled = false;\r\n\r\n    performAction(controller) {\r\n        this.#enabled = !this.#enabled;  // toggle\r\n\r\n        if (!this.#registered) {\r\n            if (controller.getSandGame() !== null) {\r\n                const sandGame = controller.getSandGame();\r\n                sandGame.addOnRendered((changedChunks) => {\r\n                    this.#onRendered(controller, changedChunks);\r\n                });\r\n            }\r\n            controller.addOnInitialized(sandGame => {\r\n                sandGame.addOnRendered((changedChunks) => {\r\n                    this.#onRendered(controller, changedChunks);\r\n                });\r\n            });\r\n            this.#registered = true;\r\n        }\r\n    }\r\n\r\n    #onRendered(controller, changedChunks) {\r\n        if (this.#enabled) {\r\n            this.#highlightChunks(controller, changedChunks);\r\n        } else {\r\n            this.#highlightChunks(controller, null);\r\n        }\r\n    }\r\n\r\n    #highlightChunks(controller, changedChunks) {\r\n        this.#initIfNeeded(controller);\r\n        this.#update(controller, changedChunks);\r\n    }\r\n\r\n    #update(controller, changedChunks) {\r\n        const sandGame = controller.getSandGame();\r\n        const chunkSize = sandGame.getChunkSize();\r\n        const horChunkCount = Math.ceil(sandGame.getWidth() / chunkSize);\r\n        const verChunkCount = Math.ceil(sandGame.getHeight() / chunkSize);\r\n\r\n        const markers = sandGame.overlay().getMarkers(ActionShowActiveChunks.#MARKER_GROUP);\r\n        let highlighted = 0;\r\n\r\n        if (changedChunks === null) {\r\n            for (let cy = 0; cy < verChunkCount; cy++) {\r\n                for (let cx = 0; cx < horChunkCount; cx++) {\r\n                    const chunkIndex = cy * horChunkCount + cx;\r\n                    const marker = markers[chunkIndex];\r\n                    marker.setVisible(false);\r\n                }\r\n            }\r\n        } else {\r\n            for (let cy = 0; cy < verChunkCount; cy++) {\r\n                for (let cx = 0; cx < horChunkCount; cx++) {\r\n                    const chunkIndex = cy * horChunkCount + cx;\r\n                    const marker = markers[chunkIndex];\r\n                    if (changedChunks[chunkIndex]) {\r\n                        highlighted++;\r\n                        marker.setVisible(true);\r\n                    } else {\r\n                        marker.setVisible(false);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    #initIfNeeded(controller) {\r\n        const sandGame = controller.getSandGame();\r\n        const markers = sandGame.overlay().getMarkers(ActionShowActiveChunks.#MARKER_GROUP);\r\n\r\n        if (markers.length === 0) {\r\n            const chunkSize = sandGame.getChunkSize();\r\n            const horChunkCount = Math.ceil(sandGame.getWidth() / chunkSize);\r\n            const verChunkCount = Math.ceil(sandGame.getHeight() / chunkSize);\r\n\r\n            // chunks\r\n            for (let cy = 0; cy < verChunkCount; cy++) {\r\n                for (let cx = 0; cx < horChunkCount; cx++) {\r\n                    sandGame.overlay().createRectangleWH(cx * chunkSize, cy * chunkSize, chunkSize, chunkSize, {\r\n                        visible: false,\r\n                        group: ActionShowActiveChunks.#MARKER_GROUP,\r\n                        style: {\r\n                            outline: 'rgb(0, 255, 0) 1px solid',\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n\r\n            // label\r\n            sandGame.overlay().createRectangleWH(0, 0, 100, 20, {\r\n                visible: true,\r\n                group: ActionShowActiveChunks.#MARKER_GROUP,\r\n                style: {\r\n                    color: 'rgb(18,121,18)'\r\n                },\r\n                label: 'Chunks: ' + (horChunkCount * verChunkCount)\r\n            });\r\n        }\r\n    }\r\n}\r\n","// Sand Game JS; Patrik Harag, https://harag.cz; all rights reserved\r\n\r\n// Warning: dev tools only\r\n\r\nconst Tools = window.SandGameJS.Tools;\r\nconst ToolDefs = window.SandGameJS.ToolDefs;\r\nconst BrushDefs = window.SandGameJS.BrushDefs;\r\n\r\n/**\r\n *\r\n * @author Patrik Harag\r\n * @version 2024-05-25\r\n */\r\nexport default class DevToolDefs {\r\n\r\n    static DEFAULT_SIZE = 6;\r\n\r\n    static CATEGORY_NONE = undefined;\r\n    static CATEGORY_POWDER = 'powders';\r\n    static CATEGORY_FLUIDS = 'fluids';\r\n    static CATEGORY_SOLIDS = 'solids';\r\n    static CATEGORY_EFFECTS = 'effects';\r\n    static CATEGORY_BIOLOGICAL = 'biological';\r\n\r\n    /** @type Tool[] */\r\n    static TEST_TOOLS = [\r\n        Tools.pointBrushTool(BrushDefs.GRASS, {\r\n            codeName: 'grass',\r\n            displayName: 'Grass',\r\n            category: DevToolDefs.CATEGORY_BIOLOGICAL,\r\n        }),\r\n        Tools.pointBrushTool(BrushDefs.TREE, {\r\n            codeName: 'tree',\r\n            displayName: 'Tree',\r\n            category: DevToolDefs.CATEGORY_BIOLOGICAL,\r\n        }),\r\n        ToolDefs.BIRD,\r\n        ToolDefs.BUTTERFLY,\r\n        ToolDefs.FISH,\r\n        Tools.actionTool((x, y, graphics) => {\r\n            graphics.entities().assignWaypoint(x, y);\r\n        }, {\r\n            codeName: 'entity_waypoint',\r\n            displayName: 'Waypoint',\r\n            category: DevToolDefs.CATEGORY_BIOLOGICAL,\r\n        }),\r\n        Tools.roundBrushTool(BrushDefs.EFFECT_BURNT, DevToolDefs.DEFAULT_SIZE, {\r\n            codeName: 'effect_burnt',\r\n            displayName: 'Burnt',\r\n            category: DevToolDefs.CATEGORY_EFFECTS,\r\n        }),\r\n        Tools.roundBrushTool(BrushDefs.EFFECT_NOISE_SM, DevToolDefs.DEFAULT_SIZE, {\r\n            codeName: 'effect_noise_sm',\r\n            displayName: 'Noise SM',\r\n            category: DevToolDefs.CATEGORY_EFFECTS,\r\n        }),\r\n        Tools.roundBrushTool(BrushDefs.EFFECT_NOISE_MD, DevToolDefs.DEFAULT_SIZE, {\r\n            codeName: 'effect_noise_md',\r\n            displayName: 'Noise MD',\r\n            category: DevToolDefs.CATEGORY_EFFECTS,\r\n        }),\r\n        Tools.roundBrushTool(BrushDefs.EFFECT_NOISE_LG, DevToolDefs.DEFAULT_SIZE, {\r\n            codeName: 'effect_noise_lg',\r\n            displayName: 'Noise LG',\r\n            category: DevToolDefs.CATEGORY_EFFECTS,\r\n        }),\r\n        Tools.roundBrushTool(BrushDefs.EFFECT_TEMP_0, DevToolDefs.DEFAULT_SIZE, {\r\n            codeName: 'effect_temp_0',\r\n            displayName: 'Temp 0',\r\n            category: DevToolDefs.CATEGORY_EFFECTS,\r\n        }),\r\n        Tools.roundBrushTool(BrushDefs.EFFECT_TEMP_127, DevToolDefs.DEFAULT_SIZE, {\r\n            codeName: 'effect_temp_127',\r\n            displayName: 'Temp 127',\r\n            category: DevToolDefs.CATEGORY_EFFECTS,\r\n        }),\r\n        Tools.roundBrushTool(BrushDefs.EFFECT_TEMP_200, DevToolDefs.DEFAULT_SIZE, {\r\n            codeName: 'effect_temp_200',\r\n            displayName: 'Temp 200',\r\n            category: DevToolDefs.CATEGORY_EFFECTS,\r\n        }),\r\n        Tools.roundBrushTool(BrushDefs.EFFECT_TEMP_255, DevToolDefs.DEFAULT_SIZE, {\r\n            codeName: 'effect_temp_255',\r\n            displayName: 'Temp 255',\r\n            category: DevToolDefs.CATEGORY_EFFECTS,\r\n        }),\r\n        Tools.roundBrushTool(BrushDefs.ASH, DevToolDefs.DEFAULT_SIZE, {\r\n            codeName: 'ash',\r\n            displayName: 'Ash',\r\n            category: DevToolDefs.CATEGORY_POWDER,\r\n        })\r\n    ];\r\n\r\n    static _LIST = {};\r\n    static {\r\n        for (const tool of DevToolDefs.TEST_TOOLS) {\r\n            DevToolDefs._LIST[tool.getInfo().getCodeName()] = tool;\r\n        }\r\n    }\r\n\r\n    static byCodeName(codeName) {\r\n        const tool = DevToolDefs._LIST[codeName];\r\n        if (tool !== undefined) {\r\n            return tool;\r\n        }\r\n        return null;\r\n    }\r\n}\r\n","// Sand Game JS; Patrik Harag, https://harag.cz; all rights reserved\r\n\r\nimport DomBuilder from \"../DomBuilder\";\r\nimport Action from \"../action/Action\";\r\nimport Component from \"./Component\";\r\nimport ComponentButton from \"./ComponentButton\";\r\nimport RendererInitializerNull from \"../../core/rendering/RendererInitializerNull\";\r\nimport RenderingModeElementType from \"../../core/rendering/RenderingModeElementType\";\r\nimport RenderingModeHeatmap from \"../../core/rendering/RenderingModeHeatmap\";\r\nimport ActionRecord from \"../action/ActionRecord\";\r\nimport ActionScreenshot from \"../action/ActionScreenshot\";\r\nimport ActionBenchmark from \"../action/ActionBenchmark\";\r\nimport ActionFill from \"../action/ActionFill\";\r\nimport ActionsDev from \"../action/ActionsDev\";\r\nimport ActionShowActiveChunks from \"../action/ActionShowActiveChunks\";\r\nimport DevToolDefs from \"../../def/DevToolDefs\";\r\n\r\n// Warning: dev tools only\r\n\r\nconst RendererInitializerDefs = window.SandGameJS.RendererInitializerDefs;\r\nconst BrushDefs = window.SandGameJS.BrushDefs;\r\n\r\n/**\r\n *\r\n * @author Patrik Harag\r\n * @version 2024-05-25\r\n */\r\nexport default class ComponentViewDevTools extends Component {\r\n\r\n    createNode(controller) {\r\n        const BTN_SCENE = ComponentButton.CLASS_OUTLINE_SECONDARY;\r\n        const BTN_RENDERING = ComponentButton.CLASS_OUTLINE_INFO;\r\n        const BTN_TOOL = ComponentButton.CLASS_OUTLINE_PRIMARY;\r\n        const BTN_BRUSH = ComponentButton.CLASS_OUTLINE_SUCCESS;\r\n\r\n        let components = [\r\n            new ComponentButton(\"All materials\", BTN_SCENE, ActionsDev.ALL_MATERIALS),\r\n            new ComponentButton(\"Tree spawn\", BTN_SCENE, ActionsDev.TREE_SPAWN_TEST),\r\n            new ComponentButton(\"Tree grow\", BTN_SCENE, ActionsDev.treeGrowTest(0)),\r\n            new ComponentButton(\"Tree grown\", BTN_SCENE, ActionsDev.treeGrowTest(-1)),\r\n            new ComponentButton(\"Fill\", BTN_SCENE, new ActionFill()),\r\n\r\n            new ComponentButton(\"Benchmark\", BTN_TOOL, new ActionBenchmark()),\r\n            new ComponentButton(\"Record (start/stop)\", BTN_TOOL, new ActionRecord()),\r\n            new ComponentButton(\"Screenshot\", BTN_TOOL, new ActionScreenshot()),\r\n\r\n            new ComponentButton(\"Chunks\", BTN_RENDERING, new ActionShowActiveChunks()),\r\n            new ComponentButton(\"M/webgl\", BTN_RENDERING,\r\n                Action.create(c => c.setRendererInitializer(RendererInitializerDefs.canvasWebGL()))),\r\n            new ComponentButton(\"M/classic\", BTN_RENDERING,\r\n                Action.create(c => c.setRendererInitializer(RendererInitializerDefs.canvas2d(null)))),\r\n            new ComponentButton(\"M/heatmap\", BTN_RENDERING,\r\n                Action.create(c => c.setRendererInitializer(RendererInitializerDefs.canvas2d(new RenderingModeHeatmap())))),\r\n            new ComponentButton(\"M/type\", BTN_RENDERING,\r\n                Action.create(c => c.setRendererInitializer(RendererInitializerDefs.canvas2d(new RenderingModeElementType())))),\r\n            new ComponentButton(\"M/null\", BTN_RENDERING,\r\n                Action.create(c => c.setRendererInitializer(new RendererInitializerNull()))),\r\n            new ComponentButton(\"Pixelated\", BTN_RENDERING,\r\n                Action.createToggle(true, (c, v) => c.setCanvasImageRenderingStyle(v ? 'pixelated' : 'auto'))),\r\n        ];\r\n        for (let tool of DevToolDefs.TEST_TOOLS) {\r\n            let action = Action.create(c => c.getToolManager().setPrimaryTool(tool));\r\n            components.push(new ComponentButton(tool.getInfo().getDisplayName(), BTN_BRUSH, action));\r\n        }\r\n\r\n        let content = DomBuilder.div({ class: 'test-tools' }, []);\r\n        for (let component of components) {\r\n            content.append(component.createNode(controller));\r\n        }\r\n        return content;\r\n    }\r\n}\r\n","// Sand Game JS; Patrik Harag, https://harag.cz; all rights reserved\r\n\r\nimport ComponentViewDevTools from \"./gui/component/ComponentViewDevTools\";\r\n\r\n/**\r\n * Initialize component.\r\n *\r\n * @author Patrik Harag\r\n * @version 2024-05-25\r\n */\r\nexport function createComponent() {\r\n    return new ComponentViewDevTools();\r\n}\r\n"],"names":["DomBuilder","addContent","element","content","textContent","Node","appendChild","Array","isArray","item","insertAdjacentText","setContent","innerHTML","putAttributes","attributes","key","value","type","setAttribute","Object","assign","style","create","html","template","document","createElement","trim","firstElementChild","name","div","par","span","text","link","handler","href","addEventListener","button","label","bootstrapAlertInfo","bodyContent","alertDiv","class","role","append","bootstrapCard","headerContent","undefined","card","bootstrapCardCollapsable","title","collapsed","id","Math","floor","random","bootstrapInitTooltip","node","window","bootstrap","console","error","old","Tooltip","dispose","bootstrapSwitchButton","checked","switchInput","control","for","bootstrapToggleButton","labelContent","buttonClass","nodeInput","nodeLabel","e","bootstrapTableBuilder","BootstrapTable","bootstrapDialogBuilder","BootstrapDialog","bootstrapToastBuilder","BootstrapToast","bootstrapSimpleFormBuilder","BootstrapSimpleForm","tableBody","addRow","row","this","addRowBefore","insertBefore","firstChild","createNode","table","tableResponsive","persistent","additionalStyle","headerNode","bodyNode","footerNodeChildren","dialog","dialogBootstrap","setPersistent","setSizeLarge","setSizeExtraLarge","setHeaderContent","setBodyContent","addCloseButton","buttonText","push","addSubmitButton","addButton","show","dialogAnchor","tabindex","Modal","removeChild","hide","toast","toastBootstrap","dataDelay","setDelay","milliseconds","toastAttributes","wrapper","Toast","formFields","submitButton","addTextArea","initialValue","rows","input","addInput","getData","form","action","formField","data","Action","performAction","controller","func","ActionAnonymous","createToggle","def","state","c","constructor","super","Component","ComponentButton","static","cssClass","CLASS_PRIMARY","Renderer","trigger","x","y","render","changedChunks","RendererNull","RendererInitializer","getContextType","initialize","elementArea","chunkSize","context","RendererInitializerNull","RenderingMode","apply","dataIndex","elementHead","elementTail","ElementHead","of","type8","behaviour8","modifiers8","temperature","typeClass","typeModifiers","type8Powder","momentum","sliding","direction","type8Fluid","type8Solid","bodyId","extendedNeighbourhood","behaviour","special","heatModIndex","getType","getTypeClass","getTypeModifierPowderSliding","getTypeModifierPowderDirection","getTypeModifierPowderMomentum","getTypeModifierSolidNeighbourhoodType","getTypeModifierSolidBodyId","getBehaviour","getSpecial","getHeatModIndex","getTemperature","setType","setTypeClass","setTypeModifierPowderSliding","val","setTypeModifierPowderDirection","setTypeModifierPowderMomentum","setTypeModifierSolidNeighbourhoodType","setTypeModifierSolidBodyId","setBehaviour","setSpecial","setHeatModIndex","setTemperature","HEAT_MODS_COUNT","defHeatMods","i","conductiveIndex","heatLossChanceTo10000","flammableChanceTo10000","selfIgnitionChanceTo10000","flameHeat","burnDownChanceTo10000","meltingTemperature","meltingHMI","hardeningTemperature","hardeningHMI","array","HEAT_MODS","hmiToConductiveIndex","hmiToHeatLossChanceTo10000","hmiToFlammableChanceTo10000","hmiToSelfIgnitionChanceTo10000","hmiToFlameHeat","hmiToBurnDownChanceTo10000","hmiToMeltingTemperature","hmiToMeltingHMI","hmiToHardeningTemperature","hmiToHardeningHMI","RenderingModeElementType","asColor","TYPE_AIR","TYPE_STATIC","TYPE_FLUID","TYPE_POWDER","TYPE_POWDER_WET","TYPE_POWDER_FLOATING","r","g","b","Assets","asImageData","base64","maxWidth","maxHeight","Promise","resolve","reject","image","Image","onload","canvas","w","h","imageWidth","imageHeight","wScale","hScale","trunc","countSize","width","height","getContext","drawImage","imageData","getImageData","onerror","src","RenderingModeHeatmap","gradientImageData","then","d","gradIndex","FIELD_TEMPERATURE_SIZE","a","autoBom","warn","test","Blob","XMLHttpRequest","open","responseType","response","send","status","dispatchEvent","MouseEvent","createEvent","initMouseEvent","f","self","global","navigator","userAgent","saveAs","HTMLAnchorElement","prototype","URL","webkitURL","j","download","rel","origin","location","target","createObjectURL","setTimeout","revokeObjectURL","msSaveOrOpenBlob","body","innerText","HTMLElement","safari","FileReader","k","onloadend","result","replace","readAsDataURL","l","m","module","exports","u8","Uint8Array","u16","Uint16Array","u32","Uint32Array","fleb","fdeb","clim","freb","eb","start","_a","fl","revfl","revfd","rev","hMap","cd","mb","s","length","co","le","rvb","sv","r_1","v","flt","fdt","flm","fdm","shft","p","slc","n","BYTES_PER_ELEMENT","set","subarray","ec","err","ind","msg","nt","Error","code","captureStackTrace","wbits","o","wbits16","hTree","t","t2","slice","et","sort","i0","i1","i2","maxSym","tr","mbt","ln","dt","lft","cst","i2_1","i2_2","i2_3","max","lc","cl","cli","cln","cls","clen","cf","wfblk","out","pos","dat","wblk","final","syms","lf","df","li","bs","bl","dlt","mlb","_b","ddt","mdb","_c","lclt","nlc","_d","lcdt","ndc","lcfreq","_e","lct","mlcb","nlcc","lm","ll","dm","dl","flen","ftlen","dtlen","llm","lcts","it","clct","len","dst","deo","crct","Int32Array","crc","cr","dopt","opt","pre","post","st","lvl","plvl","lst","ceil","msk_1","prev","head","bs1_1","bs2_1","hsh","lc_1","wi","hv","imod","pimod","rem","ch_1","dif","maxn","min","maxd","ml","nl","mmd","md","ti","lin","din","dflt","level","mem","log","mrg","wbytes","deflateSync","opts","fltn","op","te","TextEncoder","td","TextDecoder","decode","stream","strToU8","str","latin1","ar_1","charCodeAt","encode","ar","ai","exfl","ex","wzh","fn","u","ce","extra","col","exl","os","flag","compression","Date","mtime","now","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","size","attrs","exf","zipSync","files","tot","file","com","comment","ms","oe","cdl","badd","wzf","ActionRecord","controllerHandlersRegistered","sandGameHandlersRegistered","zipData","addOnBeforeClosed","stopRecording","addOnInitialized","sandGame","processed","lastIteration","frameInProgress","getSandGame","addOnProcessed","iteration","addOnRendered","addFrame","completed","getCanvas","toBlob","blob","arrayBuffer","String","padStart","finally","filename","bytes","FileSaver","ActionScreenshot","formatDate","date","dd","MM","Scenes","SandGameJS","ActionBenchmark","BenchmarkProvider","results","ipsAvg","toFixed","ipsMin","JSON","stringify","getDialogAnchor","onFinish","scene","custom","benchmarkScene","openScene","benchmarkResults","benchmarkQueue","BENCHMARKS","waiting","WAITING_GAP","ipsSum","Number","MAX_SAFE_INTEGER","benchmark","nextIteration","ips","getIterationsPerSecond","iterations","shift","graphics","fill","getBrushCollection","byCodeName","finalizeResults","map","reduce","version","toString","benchmarks","getWidth","getHeight","createBenchmark","sand","drawRectangle","soil","water","ActionFill","primaryTool","getToolManager","getPrimaryTool","isAreaModeEnabled","applyArea","BrushDefs","ActionsDev","brushes","segment","brush","AIR","layeredTemplate","layer","WALL","SOIL","grass","treeGrowTest","template1","tree","template2","ActionShowActiveChunks","registered","enabled","onRendered","highlightChunks","initIfNeeded","update","getChunkSize","horChunkCount","verChunkCount","markers","overlay","getMarkers","MARKER_GROUP","cy","cx","setVisible","chunkIndex","marker","createRectangleWH","visible","group","outline","color","Tools","ToolDefs","DevToolDefs","pointBrushTool","GRASS","codeName","displayName","category","CATEGORY_BIOLOGICAL","TREE","BIRD","BUTTERFLY","FISH","actionTool","entities","assignWaypoint","roundBrushTool","EFFECT_BURNT","DEFAULT_SIZE","CATEGORY_EFFECTS","EFFECT_NOISE_SM","EFFECT_NOISE_MD","EFFECT_NOISE_LG","EFFECT_TEMP_0","EFFECT_TEMP_127","EFFECT_TEMP_200","EFFECT_TEMP_255","ASH","CATEGORY_POWDER","tool","TEST_TOOLS","_LIST","getInfo","getCodeName","RendererInitializerDefs","ComponentViewDevTools","BTN_SCENE","CLASS_OUTLINE_SECONDARY","BTN_RENDERING","CLASS_OUTLINE_INFO","BTN_TOOL","CLASS_OUTLINE_PRIMARY","BTN_BRUSH","CLASS_OUTLINE_SUCCESS","components","ALL_MATERIALS","TREE_SPAWN_TEST","setRendererInitializer","canvasWebGL","canvas2d","setCanvasImageRenderingStyle","setPrimaryTool","getDisplayName","component"],"mappings":"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"}