<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Sand Game JS</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
        rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
          integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
  <style>
      /* override xx-large breakpoint */
      @media (min-width: 1400px)  {
          .container {
              max-width: 1140px;
          }
      }
  </style>

  <script defer>/* Sand Game JS; Patrik Harag, https://harag.cz; all rights reserved */ ! function(e, t) {
    "object" == typeof exports && "undefined" != typeof module ? t(exports) : "function" == typeof define && define.amd ? define(["exports"], t) : t((e = "undefined" != typeof globalThis ? globalThis : e || self).SandGameJS = {})
}(this, (function(e) {
    "use strict";
    class t {
        static #e(e, t = 1400, n = 800) {
            let r;
            r = window.innerWidth <= 575 ? window.innerWidth : e.clientWidth;
            let i = Math.min(t, r),
                s = Math.min(n, Math.trunc(.7 * window.innerHeight));
            return i / s < .75 && (s = Math.trunc(i / .75)), {
                width: i,
                height: s
            }
        }
        static #t() {
            return navigator.maxTouchPoints || "ontouchstart" in document.documentElement ? 75e3 : window.screen.width >= 2560 && window.screen.height >= 1440 ? 2e5 : window.screen.width >= 2048 && window.screen.height >= 1080 ? 175e3 : window.screen.width >= 1920 && window.screen.height >= 1080 ? 15e4 : 125e3
        }
        static #n(e, t, n) {
            function r(n) {
                return Math.trunc(e * n) * Math.trunc(t * n)
            }
            return r(.75) < n ? .75 : r(.5) < n ? .5 : r(.375) < n ? .375 : .25
        }
        static determineOptimalSizes(e, n = void 0) {
            const r = void 0 !== n ? n.maxWidthPx : void 0,
                i = void 0 !== n ? n.maxHeightPx : void 0,
                {
                    width: s,
                    height: a
                } = t.#e(e, r, i),
                o = void 0 !== n ? n.scale : void 0;
            return {
                width: s,
                height: a,
                scale: void 0 === o ? t.#n(s, a, t.#t()) : o
            }
        }
    }
    class n {
        elementHead;
        elementTail;
        constructor(e = 0, t = 0) {
            this.elementHead = e, this.elementTail = t
        }
    }
    class r {
        static FIELD_TYPE_CLASS_SIZE = 3;
        static TYPE_AIR = 0;
        static TYPE_EFFECT = 1;
        static TYPE_GAS = 2;
        static TYPE_POWDER_FLOATING = 3;
        static TYPE_FLUID = 4;
        static TYPE_POWDER = 5;
        static TYPE_POWDER_WET = 6;
        static TYPE_STATIC = 7;
        static FIELD_TYPE_MODIFIERS_SIZE = 5;
        static FIELD_BEHAVIOUR_SIZE = 4;
        static BEHAVIOUR_NONE = 0;
        static BEHAVIOUR_SOIL = 1;
        static BEHAVIOUR_GRASS = 2;
        static BEHAVIOUR_FISH = 3;
        static BEHAVIOUR_FISH_BODY = 4;
        static BEHAVIOUR_TREE = 5;
        static BEHAVIOUR_TREE_ROOT = 6;
        static BEHAVIOUR_TREE_TRUNK = 7;
        static BEHAVIOUR_TREE_LEAF = 8;
        static BEHAVIOUR_FIRE = 9;
        static BEHAVIOUR_FIRE_SOURCE = 10;
        static BEHAVIOUR_METEOR = 11;
        static BEHAVIOUR_WATER = 12;
        static BEHAVIOUR_ENTITY = 13;
        static FIELD_SPECIAL_SIZE = 4;
        static FIELD_HMI_SIZE = 8;
        static FIELD_TEMPERATURE_SIZE = 8;
        static of (e, t = 0, n = 0, r = 0) {
            let i = r << 8;
            return i = (i | n) << 8, i = (i | t) << 8, i |= e, i
        }
        static type8(e, t = 0) {
            return e | t << 3
        }
        static type8Powder(e, t = 0, n = 0, r = 0) {
            let i = t << 1;
            return i = (i | r) << 1, i = (i | n) << 3, i |= e, i
        }
        static type8Fluid(e) {
            return e
        }
        static type8Solid(e, t = 0, n = !0) {
            let r = t << 1;
            return r = (r | (n ? 0 : 1)) << 3, r |= e, r
        }
        static behaviour8(e = 0, t = 0) {
            return e | t << 4
        }
        static modifiers8(e = 0) {
            return e
        }
        static getType(e) {
            return 255 & e
        }
        static getTypeClass(e) {
            return 7 & e
        }
        static getTypeModifierPowderSliding(e) {
            return e >> 3 & 1
        }
        static getTypeModifierPowderDirection(e) {
            return e >> 4 & 1
        }
        static getTypeModifierPowderMomentum(e) {
            return e >> 5 & 7
        }
        static getTypeModifierSolidNeighbourhoodType(e) {
            return e >> 3 & 1
        }
        static getTypeModifierSolidBodyId(e) {
            return e >> 4 & 15
        }
        static getBehaviour(e) {
            return e >> 8 & 15
        }
        static getSpecial(e) {
            return e >> 12 & 15
        }
        static getHeatModIndex(e) {
            return e >> 16 & 255
        }
        static getTemperature(e) {
            return e >> 24 & 255
        }
        static setType(e, t) {
            return 4294967040 & e | t
        }
        static setTypeClass(e, t) {
            return 4294967288 & e | t
        }
        static setTypeModifierPowderSliding(e, t) {
            return 4294967287 & e | t << 3
        }
        static setTypeModifierPowderDirection(e, t) {
            return 4294967279 & e | t << 4
        }
        static setTypeModifierPowderMomentum(e, t) {
            return 4294967071 & e | t << 5
        }
        static setTypeModifierSolidNeighbourhoodType(e, t) {
            return 4294967287 & e | t << 3
        }
        static setTypeModifierSolidBodyId(e, t) {
            return 4294967055 & e | t << 4
        }
        static setBehaviour(e, t) {
            return 4294963455 & e | t << 8
        }
        static setSpecial(e, t) {
            return 4294905855 & e | t << 12
        }
        static setHeatModIndex(e, t) {
            return 4278255615 & e | t << 16
        }
        static setTemperature(e, t) {
            return 16777215 & e | t << 24
        }
        static #r = 16;
        static #i = Array(r.#r);
        static #s({
            i: e,
            conductiveIndex: t = .2,
            heatLossChanceTo10000: n = 2500,
            flammableChanceTo10000: i = 0,
            selfIgnitionChanceTo10000: s = 0,
            flameHeat: a = 0,
            burnDownChanceTo10000: o = 0,
            meltingTemperature: l = 256,
            meltingHMI: h = 0,
            hardeningTemperature: c = 0,
            hardeningHMI: d = 0
        }) {
            const u = Array(10);
            return u[0] = t, u[1] = n, u[2] = i, u[3] = s, u[4] = a, u[5] = o, u[6] = l, u[7] = h, u[8] = c, u[9] = d, r.#i[e] = u, e
        }
        static HMI_DEFAULT = r.#s({
            i: 0
        });
        static HMI_CONDUCTIVE_1 = r.#s({
            i: 1,
            conductiveIndex: .25,
            heatLossChanceTo10000: 500
        });
        static HMI_CONDUCTIVE_2 = r.#s({
            i: 2,
            conductiveIndex: .3,
            heatLossChanceTo10000: 20
        });
        static HMI_CONDUCTIVE_3 = r.#s({
            i: 3,
            conductiveIndex: .45,
            heatLossChanceTo10000: 10
        });
        static HMI_GRASS_LIKE = r.#s({
            i: 4,
            flammableChanceTo10000: 4500,
            selfIgnitionChanceTo10000: 3,
            flameHeat: 165,
            burnDownChanceTo10000: 1e3
        });
        static HMI_WOOD_LIKE = r.#s({
            i: 5,
            flammableChanceTo10000: 100,
            selfIgnitionChanceTo10000: 2,
            flameHeat: 165,
            burnDownChanceTo10000: 2
        });
        static HMI_LEAF_LIKE = r.#s({
            i: 6,
            flammableChanceTo10000: 4500,
            selfIgnitionChanceTo10000: 3,
            flameHeat: 165,
            burnDownChanceTo10000: 100
        });
        static HMI_METAL = r.#s({
            i: 7,
            conductiveIndex: .45,
            heatLossChanceTo10000: 10,
            meltingTemperature: 200,
            meltingHMI: 8
        });
        static HMI_MOLTEN = r.#s({
            i: 8,
            conductiveIndex: .45,
            heatLossChanceTo10000: 10,
            hardeningTemperature: 150,
            hardeningHMI: 7
        });
        static HMI_COAL = r.#s({
            i: 9,
            conductiveIndex: .3,
            heatLossChanceTo10000: 20,
            flammableChanceTo10000: 500,
            selfIgnitionChanceTo10000: 3,
            flameHeat: 190,
            burnDownChanceTo10000: 50
        });
        static HMI_THERMITE = r.#s({
            i: 10,
            conductiveIndex: .45,
            heatLossChanceTo10000: 10,
            flammableChanceTo10000: 8e3,
            selfIgnitionChanceTo10000: 500,
            flameHeat: 250,
            burnDownChanceTo10000: 1e3
        });
        static {
            for (let e = 0; e < r.#r; e++) void 0 === r.#i[e] && r.#s(e)
        }
        static hmiToConductiveIndex(e) {
            return r.#i[15 & e][0]
        }
        static hmiToHeatLossChanceTo10000(e) {
            return r.#i[15 & e][1]
        }
        static hmiToFlammableChanceTo10000(e) {
            return r.#i[15 & e][2]
        }
        static hmiToSelfIgnitionChanceTo10000(e) {
            return r.#i[15 & e][3]
        }
        static hmiToFlameHeat(e) {
            return r.#i[15 & e][4]
        }
        static hmiToBurnDownChanceTo10000(e) {
            return r.#i[15 & e][5]
        }
        static hmiToMeltingTemperature(e) {
            return r.#i[15 & e][6]
        }
        static hmiToMeltingHMI(e) {
            return r.#i[15 & e][7]
        }
        static hmiToHardeningTemperature(e) {
            return r.#i[15 & e][8]
        }
        static hmiToHardeningHMI(e) {
            return r.#i[15 & e][9]
        }
    }
    class i {
        static DEFAULT = new i(106244033);
        static next(e) {
            let t = e + 1831565813;
            return t = Math.imul(t ^ t >>> 15, 1 | t), t ^= t + Math.imul(t ^ t >>> 7, 61 | t), ((t ^ t >>> 14) >>> 0) / 4294967296
        }
        #a;
        constructor(e) {
            this.#a = e
        }
        next() {
            let e = this.#a += 1831565813;
            return e = Math.imul(e ^ e >>> 15, 1 | e), e ^= e + Math.imul(e ^ e >>> 7, 61 | e), ((e ^ e >>> 14) >>> 0) / 4294967296
        }
        nextInt(e) {
            return Math.trunc(this.next() * e)
        }
        getState() {
            return this.#a
        }
    }
    class s {
        apply(e, t, n = void 0, r = void 0) {
            throw "Not implemented"
        }
    }
    class a extends s {
        #o;
        constructor(e) {
            super(), this.#o = e
        }
        apply(e, t, n, r) {
            if (this.#o.length > 1) {
                const s = (n || i.DEFAULT).nextInt(this.#o.length);
                return this.#o[s].apply(e, t, n, r)
            }
            if (1 === this.#o.length) {
                return this.#o[0].apply(e, t, n, r)
            }
            return null
        }
    }
    class o extends s {
        #l;
        constructor(e) {
            super(), this.#l = e
        }
        apply(e, t, n, r) {
            if (this.#l.length > 1) {
                const e = (n || i.DEFAULT).nextInt(this.#l.length);
                return this.#l[e]
            }
            return 1 === this.#l.length ? this.#l[0] : null
        }
    }
    class l extends s {
        #h;
        constructor(e) {
            super(), this.#h = e
        }
        _retrieveElement(e, t, n, r) {
            return void 0 !== this.#h ? this.#h.apply(e, t, n) : r
        }
    }
    class h {
        static BLUR_TYPE_NONE = 0;
        static BLUR_TYPE_BACKGROUND = 1;
        static BLUR_TYPE_1 = 2;
        static HEAT_EFFECT_NONE = 0;
        static HEAT_EFFECT_1 = 1;
        static HEAT_EFFECT_2 = 2;
        static HEAT_EFFECT_3 = 3;
        static of (e, t, n, r = h.BLUR_TYPE_NONE, i = 0, s = 0) {
            let a = 0;
            return a = (a | 3 & i) << 2, a = (a | 3 & s) << 2, a = (a | 3 & r) << 8, a = (a | 255 & e) << 8, a = (a | 255 & t) << 8, a |= 255 & n, a
        }
        static getColorRed(e) {
            return e >> 16 & 255
        }
        static getColorGreen(e) {
            return e >> 8 & 255
        }
        static getColorBlue(e) {
            return 255 & e
        }
        static getBlurType(e) {
            return e >> 24 & 3
        }
        static getBurntLevel(e) {
            return e >> 26 & 3
        }
        static getHeatEffect(e) {
            return e >> 28 & 3
        }
        static setColor(e, t, n, r) {
            return e = -256 & (e = -65281 & (e = -16711681 & e | t << 16) | n << 8) | r
        }
        static setBlurType(e, t) {
            return 4244635647 & e | t << 24
        }
        static setBurntLevel(e, t) {
            return 4093640703 & e | t << 26
        }
    }
    class c extends l {
        #c;
        #d;
        #u;
        constructor(e, t, n, r) {
            super(r), this.#c = e, this.#d = t, this.#u = n
        }
        apply(e, t, r, i) {
            const s = this._retrieveElement(e, t, r, i),
                a = h.setColor(s.elementTail, this.#c, this.#d, this.#u);
            return new n(s.elementHead, a)
        }
    }
    class d extends l {
        #m;
        constructor(e, t) {
            super(e), this.#m = "string" == typeof t ? t.split("\n").map((e => e.split(",").map(Number))) : t
        }
        apply(e, t, r, s) {
            const a = this._retrieveElement(e, t, r, s),
                o = (r || i.DEFAULT).nextInt(this.#m.length),
                [l, c, d] = this.#m[o],
                u = h.setColor(a.elementTail, l, c, d);
            return new n(a.elementHead, u)
        }
    }
    class u {
        static asImageData(e, t = void 0, n = void 0) {
            return new Promise(((r, i) => {
                try {
                    let s = new Image;
                    s.onload = () => {
                        let e = document.createElement("canvas"),
                            [i, a] = function(e, r) {
                                let i = e,
                                    s = r;
                                if (void 0 !== t && i > t) {
                                    const e = i / t;
                                    i = t, s /= e
                                }
                                if (void 0 !== n && s > n) {
                                    const e = s / n;
                                    s = n, i /= e
                                }
                                return [Math.trunc(i), Math.trunc(s)]
                            }(s.width, s.height);
                        e.width = i, e.height = a;
                        let o = e.getContext("2d");
                        o.drawImage(s, 0, 0, e.width, e.height);
                        let l = o.getImageData(0, 0, e.width, e.height);
                        r(l)
                    }, s.onerror = () => {
                        i("Cannot load image")
                    }, s.src = e
                } catch (e) {
                    i(e)
                }
            }))
        }
    }
    class m extends l {
        #E = null;
        constructor(e, t) {
            super(e), u.asImageData(t).then((e => this.#E = e))
        }
        apply(e, t, r, i) {
            const s = this._retrieveElement(e, t, r, i);
            if (null != this.#E) {
                const r = e % this.#E.width,
                    i = 4 * (t % this.#E.height * this.#E.width + r),
                    a = this.#E.data[i],
                    o = this.#E.data[i + 1],
                    l = this.#E.data[i + 2],
                    c = h.setColor(s.elementTail, a, o, l);
                return new n(s.elementHead, c)
            }
            return s
        }
    }
    const E = .5 * (Math.sqrt(3) - 1),
        g = (3 - Math.sqrt(3)) / 6,
        p = e => 0 | Math.floor(e),
        A = new Float64Array([1, 1, -1, 1, 1, -1, -1, -1, 1, 0, -1, 0, 1, 0, -1, 0, 0, 1, 0, -1, 0, 1, 0, -1]);

    function f(e = Math.random) {
        const t = function(e) {
                const t = 512,
                    n = new Uint8Array(t);
                for (let e = 0; e < t / 2; e++) n[e] = e;
                for (let r = 0; r < t / 2 - 1; r++) {
                    const t = r + ~~(e() * (256 - r)),
                        i = n[r];
                    n[r] = n[t], n[t] = i
                }
                for (let e = 256; e < t; e++) n[e] = n[e - 256];
                return n
            }(e),
            n = new Float64Array(t).map((e => A[e % 12 * 2])),
            r = new Float64Array(t).map((e => A[e % 12 * 2 + 1]));
        return function(e, i) {
            let s = 0,
                a = 0,
                o = 0;
            const l = (e + i) * E,
                h = p(e + l),
                c = p(i + l),
                d = (h + c) * g,
                u = e - (h - d),
                m = i - (c - d);
            let A, f;
            u > m ? (A = 1, f = 0) : (A = 0, f = 1);
            const T = u - A + g,
                C = m - f + g,
                R = u - 1 + 2 * g,
                y = m - 1 + 2 * g,
                S = 255 & h,
                w = 255 & c;
            let v = .5 - u * u - m * m;
            if (v >= 0) {
                const e = S + t[w];
                v *= v, s = v * v * (n[e] * u + r[e] * m)
            }
            let I = .5 - T * T - C * C;
            if (I >= 0) {
                const e = S + A + t[w + f];
                I *= I, a = I * I * (n[e] * T + r[e] * C)
            }
            let O = .5 - R * R - y * y;
            if (O >= 0) {
                const e = S + 1 + t[w + 1];
                O *= O, o = O * O * (n[e] * R + r[e] * y)
            }
            return 70 * (s + a + o)
        }
    }
    class T {
        static isVisualBurnApplicable(e) {
            const t = r.getTypeClass(e);
            return t > r.TYPE_FLUID || t === r.TYPE_POWDER_FLOATING
        }
        static visualBurn(e, t = 1, n = 3) {
            const r = h.getBurntLevel(e);
            if (r > 2) return e;
            let i = e,
                s = r + t;
            s = Math.min(s, n), s = Math.max(s, 0);
            const a = s - r;
            if (a > 0) {
                i = h.setBurntLevel(i, s);
                let t = h.getColorRed(e),
                    n = h.getColorGreen(e),
                    r = h.getColorBlue(e),
                    o = 1.8 - .5 * Math.random();
                a > 1 && (o *= 1.8 - .5 * Math.random()), a > 2 && (o *= 1.8 - .5 * Math.random()), t = Math.trunc(t / o), n = Math.trunc(n / o), r = Math.trunc(r / o), i = h.setColor(i, t, n, r)
            }
            return i
        }
        static visualNoiseProvider(e = 0) {
            if (Array.isArray(e)) {
                const t = e.map((e => {
                    const t = new i(e);
                    return f((() => t.next()))
                }));
                return new C(t)
            } {
                const t = new i(e),
                    n = f((() => t.next()));
                return new C([n])
            }
        }
    }
    class C {
        #g;
        constructor(e) {
            this.#g = e
        }
        visualNoise(e, t, n, r = 1, i = .5, s = .1, a = 0, o = 0, l = 0) {
            let c = ((0, this.#g[0])(t / r, n / r) + 1) / 2;
            if (c < i) return e;
            c = 1 / (1 - i) * (c - i);
            const d = 1 - c * s;
            let u = h.getColorRed(e),
                m = h.getColorGreen(e),
                E = h.getColorBlue(e);
            return u = Math.trunc(u * d) + a * (1 - d), m = Math.trunc(m * d) + o * (1 - d), E = Math.trunc(E * d) + l * (1 - d), h.setColor(e, u, m, E)
        }
        visualNoiseCombined(e, t, n, r, i = 0, s = 0, a = 0) {
            let o = 0;
            for (let e = 0; e < r.length; e++) {
                const {
                    factor: i,
                    threshold: s,
                    force: a
                } = r[e];
                let l = ((0, this.#g[e % this.#g.length])(t / i, n / i) + 1) / 2;
                l < s ? l = 0 : (l = 1 / (1 - s) * (l - s), l *= a, o += l)
            }
            o = Math.min(o, 1);
            const l = 1 - o;
            let c = h.getColorRed(e),
                d = h.getColorGreen(e),
                u = h.getColorBlue(e);
            return c = Math.trunc(c * l) + i * (1 - l), d = Math.trunc(d * l) + s * (1 - l), u = Math.trunc(u * l) + a * (1 - l), h.setColor(e, c, d, u)
        }
    }
    class R extends l {
        #c;
        #d;
        #u;
        #p;
        #A;
        constructor(e, t, n, r, i) {
            super(e), this.#p = t, this.#c = n, this.#d = r, this.#u = i, Array.isArray(t) ? this.#A = T.visualNoiseProvider(t.map((e => e.seed))) : this.#A = T.visualNoiseProvider(t.seed)
        }
        apply(e, t, r, i) {
            const s = this._retrieveElement(e, t, r, i),
                a = this.#p,
                o = this.#c,
                l = this.#d,
                h = this.#u;
            let c;
            if (Array.isArray(a)) c = this.#A.visualNoiseCombined(s.elementTail, e, t, a, o, l, h);
            else {
                const n = a.factor,
                    r = a.threshold,
                    i = a.force;
                c = this.#A.visualNoise(s.elementTail, e, t, n, r, i, o, l, h)
            }
            return new n(s.elementHead, c)
        }
    }
    class y extends l {
        #m;
        #f;
        #T = 0;
        #C = 1;
        #R = 0;
        constructor(e, t, n) {
            super(e), this.#m = t, this.#f = n
        }
        apply(e, t, r, i) {
            const s = this._retrieveElement(e, t, r, i);
            if (0 === this.#m.length) return s;
            const [a, o, l] = this.#m[this.#T];
            this.#m.length > 1 && (this.#R += 1, this.#R >= this.#f && (this.#R = 0, this.#T += this.#C, this.#T < 0 ? (this.#C = 1, this.#T = 1) : this.#T >= this.#m.length && (this.#C = -1, this.#T = this.#m.length - 2)));
            const c = h.setColor(s.elementTail, a, o, l);
            return new n(s.elementHead, c)
        }
    }
    class S extends l {
        #y;
        constructor(e, t) {
            super(e), this.#y = t
        }
        apply(e, t, r, i) {
            const s = this._retrieveElement(e, t, r, i);
            let a = h.getColorRed(s.elementTail),
                o = h.getColorGreen(s.elementTail),
                l = h.getColorBlue(s.elementTail);
            a += r.nextInt(this.#y) * (0 === r.nextInt(2) ? 1 : -1), o += r.nextInt(this.#y) * (0 === r.nextInt(2) ? 1 : -1), l += r.nextInt(this.#y) * (0 === r.nextInt(2) ? 1 : -1), a = Math.max(0, Math.min(255, a)), o = Math.max(0, Math.min(255, o)), l = Math.max(0, Math.min(255, l));
            const c = h.setColor(s.elementTail, a, o, l);
            return new n(s.elementHead, c)
        }
    }
    class w extends s {
        #S;
        constructor(e) {
            super(), this.#S = e
        }
        apply(e, t, n, r) {
            return this.#S(e, t, n, r)
        }
    }
    class v extends s {
        static #w = function(e, t) {
            return !1
        };
        #v;
        #I = 0;
        #O = 0;
        constructor(e = v.#w) {
            super(), this.#v = e
        }
        apply(e, t, n, r) {
            return this.#O++, null !== r && this.#v(r.elementHead, r.elementTail) && this.#I++, null
        }
        getPositives() {
            return this.#I
        }
        getTotal() {
            return this.#O
        }
        reset() {
            this.#O = 0, this.#I = 0
        }
    }
    class I {
        static and(e, t) {
            return function(n, r) {
                return e(n, r) && t(n, r)
            }
        }
        static or(e, t) {
            return function(n, r) {
                return e(n, r) || t(n, r)
            }
        }
        static not(e) {
            return function(t, n) {
                return !e(t, n)
            }
        }
        static TRUE = function(e, t) {
            return !0
        };
        static IS_AIR = function(e, t) {
            return r.getTypeClass(e) === r.TYPE_AIR
        };
        static IS_EFFECT = function(e, t) {
            return r.getTypeClass(e) === r.TYPE_EFFECT
        };
        static IS_GAS = function(e, t) {
            return r.getTypeClass(e) === r.TYPE_GAS
        };
        static IS_FLUID = function(e, t) {
            return r.getTypeClass(e) === r.TYPE_FLUID
        };
        static IS_WATER = function(e, t) {
            return r.getBehaviour(e) === r.BEHAVIOUR_WATER && r.getTypeClass(e) === r.TYPE_FLUID
        };
        static IS_POWDER = function(e, t) {
            const n = r.getTypeClass(e);
            return n === r.TYPE_POWDER || n === r.TYPE_POWDER_FLOATING || n === r.TYPE_POWDER_WET
        };
        static IS_SAND = function(e, t) {
            return !!I.IS_POWDER(e, t) && (0 === r.getBehaviour(e) && 6 === r.getTypeModifierPowderMomentum(e))
        };
        static IS_SOIL = function(e, t) {
            if (I.IS_POWDER(e, t)) {
                return r.getBehaviour(e) === r.BEHAVIOUR_SOIL
            }
            return !1
        };
        static IS_GRAVEL = function(e, t) {
            return !!I.IS_POWDER(e, t) && (0 === r.getBehaviour(e) && 3 === r.getTypeModifierPowderMomentum(e))
        };
        static IS_STATIC = function(e, t) {
            return r.getTypeClass(e) === r.TYPE_STATIC
        };
        static IS_SOLID_BODY = function(e, t) {
            return r.getTypeClass(e) === r.TYPE_STATIC && r.getTypeModifierSolidBodyId(e) > 0
        };
        static IS_ENTITY = function(e, t) {
            return r.getBehaviour(e) === r.BEHAVIOUR_ENTITY
        };
        static IS_BIOMASS = function(e, t) {
            const n = r.getBehaviour(e);
            return n === r.BEHAVIOUR_GRASS || n === r.BEHAVIOUR_TREE || n === r.BEHAVIOUR_TREE_LEAF || n === r.BEHAVIOUR_TREE_TRUNK || n === r.BEHAVIOUR_TREE_ROOT || n === r.BEHAVIOUR_ENTITY
        };
        static IS_TREE_PART = function(e, t) {
            const n = r.getBehaviour(e);
            return n === r.BEHAVIOUR_TREE || n === r.BEHAVIOUR_TREE_LEAF || n === r.BEHAVIOUR_TREE_TRUNK || n === r.BEHAVIOUR_TREE_ROOT
        }
    }
    class O extends l {
        constructor(e) {
            super(e)
        }
        apply(e, t, i, s) {
            const a = this._retrieveElement(e, t, i, s);
            if (null === a) return null;
            const o = r.getHeatModIndex(a.elementHead);
            if (r.hmiToMeltingTemperature(o) < 1 << r.FIELD_TEMPERATURE_SIZE) {
                let e = a.elementHead;
                e = r.setHeatModIndex(e, r.hmiToMeltingHMI(o)), e = r.setType(e, r.TYPE_FLUID);
                let t = h.setBlurType(a.elementTail, h.BLUR_TYPE_1);
                return new n(e, t)
            }
            return a
        }
    }
    class b extends l {
        #b;
        #M;
        constructor(e, t, n) {
            super(n), this.#b = e, this.#M = t
        }
        apply(e, t, i, s) {
            const a = this._retrieveElement(e, t, i, s);
            let o = a.elementHead;
            const l = r.type8Solid(r.TYPE_STATIC, this.#b, this.#M);
            return o = r.setType(o, l), new n(o, a.elementTail)
        }
    }
    class M extends l {
        constructor(e) {
            super(e)
        }
        apply(e, t, i, s) {
            const a = this._retrieveElement(e, t, i, s);
            if (null === a) return null;
            if (r.getBehaviour(a.elementHead) === r.BEHAVIOUR_FIRE_SOURCE) {
                const e = r.setBehaviour(a.elementHead, r.BEHAVIOUR_NONE);
                return new n(e, a.elementTail)
            }
            return null
        }
    }
    class N {
        static #N(e) {
            return e.split("\n").filter((e => "" !== e.trim())).map((e => e.split(",").map(Number)))
        }
        static counting(e) {
            return new v(e)
        }
        static custom(e) {
            return new w(e)
        }
        static random(e) {
            let t;
            for (let r of e)
                if (r instanceof n) {
                    if (!0 === t) throw "Mixing Element and Brush instances";
                    t = !1
                } else {
                    if (!(r instanceof s)) throw "Element or Brush instances expected";
                    if (!1 === t) throw "Mixing Element and Brush instances";
                    t = !0
                } return t ? new a(e) : new o(e)
        }
        static color(e = 0, t = 0, n = 0, r = void 0) {
            return new c(e, t, n, r)
        }
        static colorTexture(e, t = void 0) {
            return new m(t, e)
        }
        static colorPaletteRandom(e, t = void 0) {
            return "string" == typeof e && (e = N.#N(e)), new d(t, e)
        }
        static colorPaletteCyclic(e, t = 1, n = void 0) {
            return "string" == typeof e && (e = N.#N(e)), new y(n, e, t)
        }
        static colorRandomize(e, t = void 0) {
            return new S(t, e)
        }
        static colorNoise(e, t = void 0, n = void 0, r = void 0, i = void 0) {
            return new R(i, e, t, n, r)
        }
        static withIntensity(e, t) {
            return N.custom(((n, r, s, a) => (s || i.DEFAULT).next() < e ? t.apply(n, r, s, a) : null))
        }
        static gentle(e) {
            return N.conditional(I.IS_AIR, e)
        }
        static conditional(e, t) {
            return N.custom(((n, r, i, s) => null === s ? null : e(s.elementHead, s.elementTail) ? t.apply(n, r, i, s) : null))
        }
        static temperature(e) {
            return N.custom(((t, i, s, a) => {
                if (null === a) return null;
                const o = r.setTemperature(a.elementHead, 255 & e);
                return new n(o, a.elementTail)
            }))
        }
        static temperatureOrBrush(e, t) {
            return N.custom(((i, s, a, o) => {
                if (null === o) return t.apply(i, s, a, null);
                switch (r.getTypeClass(o.elementHead)) {
                    case r.TYPE_AIR:
                    case r.TYPE_EFFECT:
                        return t.apply(i, s, a, o);
                    case r.TYPE_POWDER:
                    case r.TYPE_POWDER_WET:
                    case r.TYPE_POWDER_FLOATING:
                    case r.TYPE_FLUID:
                    case r.TYPE_GAS:
                    case r.TYPE_STATIC:
                        const l = r.setTemperature(o.elementHead, 255 & e);
                        return new n(l, o.elementTail);
                    default:
                        return t.apply(i, s, a, null)
                }
            }))
        }
        static concat(e, t) {
            return N.custom(((n, r, i, s) => {
                const a = e.apply(n, r, i, s),
                    o = t.apply(n, r, i, null !== a ? a : s);
                return null !== o ? o : a
            }))
        }
        static join(e) {
            return N.custom(((t, n, r, i) => {
                let s = i;
                for (let i of e) {
                    const e = i.apply(t, n, r, s);
                    null !== e && (s = e)
                }
                return s
            }))
        }
        static molten(e) {
            return new O(e)
        }
        static extinguished(e) {
            return new M(e)
        }
        static toSolidBody(e, t = void 0, n = void 0) {
            return new b(e, t, n)
        }
    }
    class x {
        static NOT_DEFINED = new x;
        #x;
        constructor(e = {}) {
            this.#x = e
        }
        derive(e) {
            const t = {};
            return Object.assign(t, this.#x), Object.assign(t, e), new x(t)
        }
        getCategory() {
            return this.#x.category
        }
        getDisplayName() {
            return this.#x.displayName
        }
        getCodeName() {
            return this.#x.codeName
        }
        getBadgeStyle() {
            return this.#x.badgeStyle
        }
    }
    class D {
        getWidth() {
            throw "Not implemented"
        }
        getHeight() {
            throw "Not implemented"
        }
    }
    class B {
        #x;
        constructor(e = x.NOT_DEFINED) {
            this.#x = e
        }
        getInfo() {
            return this.#x
        }
        hasCursor() {
            return !1
        }
        createCursor() {
            return null
        }
        isRepeatingEnabled() {
            return !1
        }
        applyPoint(e, t, n, r) {}
        isLineModeEnabled() {
            return !1
        }
        onDragStart(e, t, n, r) {}
        onDragEnd(e, t, n, r) {}
        applyStroke(e, t, n, r, i, s) {}
        isAreaModeEnabled() {
            return !1
        }
        applyArea(e, t, n, r, i, s) {}
        applySpecial(e, t, n, r) {}
        isSecondaryActionEnabled() {
            return !1
        }
        applySecondaryAction(e, t, n, r) {}
    }
    class _ extends B {
        #D;
        #B;
        constructor(e, t, n) {
            super(e), this.#D = t, this.#B = n
        }
        getBrush() {
            return this.#D
        }
        isLineModeEnabled() {
            return !0
        }
        isAreaModeEnabled() {
            return !0
        }
        isRepeatingEnabled() {
            return !0
        }
        applyPoint(e, t, n, r) {
            this.applyStroke(e, t, e, t, n, r)
        }
        applyStroke(e, t, n, r, i, s) {
            const a = this.#_(s);
            i.drawLine(e, t, n, r, this.#B, a, !0)
        }
        applyArea(e, t, n, r, i, s) {
            const a = this.#_(s);
            i.drawRectangle(e, t, n, r, a)
        }
        applySpecial(e, t, n, r) {
            const i = this.#_(r);
            n.floodFill(e, t, i, 1)
        }
        #_(e) {
            let t = this.#D;
            return e && (t = N.gentle(t)), t
        }
    }
    class H extends B {
        #D;
        #H = N.conditional(I.IS_STATIC, N.toSolidBody(2, !1));
        #B;
        #U = !1;
        #P = [];
        constructor(e, t, n) {
            super(e), this.#D = t, this.#B = n
        }
        getBrush() {
            return this.#D
        }
        isLineModeEnabled() {
            return !0
        }
        isAreaModeEnabled() {
            return !0
        }
        isRepeatingEnabled() {
            return !1
        }
        applyPoint(e, t, n, r) {}
        applyStroke(e, t, n, r, i, s) {
            const a = this.#_(s);
            i.drawLine(e, t, n, r, this.#B, a, !0)
        }
        applyArea(e, t, n, r, i, s) {
            const a = this.#_(s);
            i.drawRectangle(e, t, n, r, a)
        }
        applySpecial(e, t, n, r) {
            const i = this.#_(r);
            n.floodFill(e, t, i, 1)
        }
        onDragStart(e, t, n, r) {
            this.#U = !0
        }
        onDragEnd(e, t, n, r) {
            this.#U = !1;
            for (const [e, t] of this.#P) n.draw(e, t, this.#H);
            this.#P = []
        }
        #_(e) {
            let t = this.#D;
            return e && (t = N.gentle(t)), this.#U ? N.custom(((e, i, s, a) => {
                const o = t.apply(e, i, s, a);
                if (null !== o) {
                    const t = r.setType(o.elementHead, r.TYPE_STATIC);
                    return this.#P.push([e, i]), new n(t, o.elementTail)
                }
                return null
            })) : t
        }
    }
    class U extends B {
        #F;
        constructor(e, t) {
            super(e), this.#F = t
        }
        applyPoint(e, t, n, r) {
            for (const {
                    dx: r,
                    dy: i,
                    brush: s
                }
                of this.#F) n.draw(e + r, t + i, s)
        }
    }
    class P extends B {
        #L;
        #k;
        #Y;
        constructor(e, t, n, r) {
            super(e), this.#L = t, this.#k = n, this.#Y = r
        }
        applyPoint(e, t, n, r) {
            const s = Math.trunc(t / 4);
            e < s + 10 ? n.draw(e + s, 1, this.#Y) : e > n.getWidth() - s - 10 ? n.draw(e - s, 1, this.#k) : e < n.getWidth() / 2 ? i.DEFAULT.next() < .8 ? n.draw(e + s, 1, this.#Y) : n.draw(e, 1, this.#L) : i.DEFAULT.next() < .8 ? n.draw(e - s, 1, this.#k) : n.draw(e, 1, this.#L)
        }
    }
    class F {
        static TRANSPARENT_ELEMENT = new n(4294967295, 4294967295);
        static LITTLE_ENDIAN = !0;
        static create(e, t, n) {
            let r = new DataView(new ArrayBuffer(e * t * 4)),
                i = new DataView(new ArrayBuffer(e * t * 4)),
                s = new F(e, t, r, i);
            for (let e = 0; e < s.#W; e++)
                for (let t = 0; t < s.#V; t++) s.setElement(t, e, n);
            return s
        }
        static from(e, t, n, r) {
            return new F(e, t, new DataView(n), new DataView(r))
        }
        #V;
        #W;
        #G;
        #z;
        constructor(e, t, n, r) {
            this.#V = e, this.#W = t, this.#G = n, this.#z = r
        }
        isValidPosition(e, t) {
            return !(e < 0 || t < 0) && !(e >= this.#V || t >= this.#W)
        }
        setElement(e, t, n) {
            null !== n && this.setElementHeadAndTail(e, t, n.elementHead, n.elementTail)
        }
        setElementHeadAndTail(e, t, n, r) {
            const i = 4 * (this.#V * t + e);
            this.#G.setUint32(i, n, F.LITTLE_ENDIAN), this.#z.setUint32(i, r, F.LITTLE_ENDIAN)
        }
        setElementHead(e, t, n) {
            const r = 4 * (this.#V * t + e);
            this.#G.setUint32(r, n, F.LITTLE_ENDIAN)
        }
        setElementTail(e, t, n) {
            const r = 4 * (this.#V * t + e);
            this.#z.setUint32(r, n, F.LITTLE_ENDIAN)
        }
        getElement(e, t) {
            const r = 4 * (this.#V * t + e),
                i = this.#G.getUint32(r, F.LITTLE_ENDIAN),
                s = this.#z.getUint32(r, F.LITTLE_ENDIAN);
            return new n(i, s)
        }
        getElementHead(e, t) {
            const n = 4 * (this.#V * t + e);
            return this.#G.getUint32(n, F.LITTLE_ENDIAN)
        }
        getElementHeadOrNull(e, t) {
            return this.isValidPosition(e, t) ? this.getElementHead(e, t) : null
        }
        getElementTail(e, t) {
            const n = 4 * (this.#V * t + e);
            return this.#z.getUint32(n, F.LITTLE_ENDIAN)
        }
        getElementTailOrNull(e, t) {
            return this.isValidPosition(e, t) ? this.getElementTail(e, t) : null
        }
        swap(e, t, n, r) {
            const i = this.getElementHead(e, t),
                s = this.getElementHead(n, r);
            this.setElementHead(n, r, i), this.setElementHead(e, t, s);
            const a = this.getElementTail(e, t),
                o = this.getElementTail(n, r);
            this.setElementTail(n, r, a), this.setElementTail(e, t, o)
        }
        getDataHeads() {
            return this.#G.buffer
        }
        getDataTails() {
            return this.#z.buffer
        }
        getWidth() {
            return this.#V
        }
        getHeight() {
            return this.#W
        }
    }
    class L extends D {
        #K;
        constructor(e) {
            super(), this.#K = e
        }
        getWidth() {
            return this.#K.getWidth()
        }
        getHeight() {
            return this.#K.getHeight()
        }
        getElementArea() {
            return this.#K
        }
    }
    class k extends B {
        static asElementArea(e) {
            return e.createElementArea(k.DEFAULT_W, k.DEFAULT_H, F.TRANSPARENT_ELEMENT)
        }
        static DEFAULT_W = 30;
        static DEFAULT_H = 30;
        #K;
        #X;
        #q;
        constructor(e, t, n, r) {
            super(e), this.#K = t, this.#X = n, this.#q = r
        }
        applyPoint(e, t, n, r) {
            const i = this.#K,
                s = e - Math.trunc(i.getWidth() / 2),
                a = t - Math.trunc(i.getHeight() / 2);
            let o = N.custom(((e, t) => {
                const n = i.getElement(e - s, t - a);
                return n.elementHead !== F.TRANSPARENT_ELEMENT.elementHead && n.elementTail !== F.TRANSPARENT_ELEMENT.elementTail ? n : null
            }));
            r && (o = N.gentle(o));
            for (let e = 0; e < i.getWidth() && s + e < n.getWidth(); e++) {
                const t = s + e;
                if (!(t < 0))
                    for (let e = 0; e < i.getHeight() && a + e < n.getHeight(); e++) {
                        const r = a + e;
                        r < 0 || n.draw(t, r, o)
                    }
            }
            for (const e of this.#X) {
                const t = Object.assign({}, e);
                "number" == typeof t.x && (t.x += s), "number" == typeof t.y && (t.y += a), n.entities().insertEntity(t)
            }
            void 0 !== this.#q && this.#q()
        }
        hasCursor() {
            return !0
        }
        createCursor() {
            return new L(this.#K)
        }
    }
    class Y extends B {
        #J;
        #j;
        #q;
        constructor(e, t, n) {
            super(e), this.#J = t, this.#q = n, this.#Z()
        }
        #Z() {
            if (void 0 === this.#J.length || 0 === this.#J.length) throw "Scenes not set";
            const e = i.DEFAULT.nextInt(this.#J.length),
                t = this.#J[e],
                n = k.asElementArea(t),
                r = t.createEntities(),
                s = null !== r ? r : [];
            this.#j = new k(this.getInfo(), n, s, this.#q)
        }
        applyPoint(e, t, n, r) {
            this.#j.applyPoint(e, t, n, r), this.#Z()
        }
        hasCursor() {
            return !0
        }
        createCursor() {
            return this.#j.createCursor()
        }
    }
    class W extends B {
        #Q;
        constructor(e, t) {
            super(e), this.#Q = t
        }
        applyPoint(e, t, n, r) {
            this.#Q(e, t, n, r)
        }
    }
    class V extends n {
        x;
        y;
        constructor(e, t, n, r) {
            super(n, r), this.x = e, this.y = t
        }
    }
    class G {
        static NEIGHBOURHOOD_VON_NEUMANN = 0;
        static NEIGHBOURHOOD_MOORE = 1;
        static NEIGHBOURHOOD_SOLID_BODY = 2;
        #K;
        #$;
        #ee;
        constructor(e, t = G.NEIGHBOURHOOD_VON_NEUMANN, n) {
            this.#K = e, this.#ee = t, this.#$ = n
        }
        #te() {
            return this.#ee === G.NEIGHBOURHOOD_SOLID_BODY ? 255 : 4071
        }
        paint(e, t, n) {
            const i = this.#te(),
                s = this.#ne(this.#K.getElementHead(e, t)) & i,
                a = this.#K.getWidth(),
                o = new Set,
                l = [];
            let h = e + t * a;
            do {
                let e = h % a,
                    t = Math.trunc(h / a);
                if (o.has(h)) continue;
                this.#$.draw(e, t, n), o.add(h), this.#re(e, t - 1, i, s, o, l), this.#re(e + 1, t, i, s, o, l), this.#re(e, t + 1, i, s, o, l), this.#re(e - 1, t, i, s, o, l);
                let c = !1;
                if (this.#ee === G.NEIGHBOURHOOD_MOORE) c = !0;
                else if (this.#ee === G.NEIGHBOURHOOD_SOLID_BODY) {
                    const n = this.#K.getElementHead(e, t);
                    0 === r.getTypeModifierSolidNeighbourhoodType(n) && (c = !0)
                }
                c && (this.#re(e + 1, t + 1, i, s, o, l), this.#re(e + 1, t - 1, i, s, o, l), this.#re(e - 1, t + 1, i, s, o, l), this.#re(e - 1, t - 1, i, s, o, l))
            } while (null != (h = l.pop()))
        }
        #re(e, t, n, r, i, s) {
            const a = this.#K.getWidth(),
                o = this.#K.getHeight();
            if (e < 0 || t < 0) return;
            if (e >= a || t >= o) return;
            if (!this.#ie(e, t, n, r)) return;
            const l = e + t * a;
            i.has(l) || s.push(l)
        }
        #ie(e, t, n, r) {
            let i = this.#K.getElementHead(e, t);
            return i = this.#ne(i), (i & n) === r
        }
        #ne(e) {
            return r.getTypeClass(e) === r.TYPE_POWDER_WET && (e = r.setTypeClass(e, r.TYPE_POWDER)), e
        }
    }
    class z {
        static copyNonSolidElements(e, t = null) {
            const n = [];
            return e(N.custom(((e, i, s, a) => function(e) {
                const t = r.getTypeClass(e);
                return t > r.TYPE_AIR && t < r.TYPE_STATIC
            }(a.elementHead) ? (n.push(new V(e, i, a.elementHead, a.elementTail)), t) : null))), n
        }
        static copySolidBodies(e, t, n, i) {
            const s = [];
            return e(N.custom(((e, a, o, l) => {
                if (r.getTypeClass(l.elementHead) === r.TYPE_STATIC && 0 !== r.getTypeModifierSolidBodyId(l.elementHead)) {
                    const r = z.copySolidBody(e, a, t, n, i);
                    for (const e of r) s.push(e)
                }
                return null
            }))), s
        }
        static copySolidBody(e, t, n, r, i = null) {
            const s = [],
                a = N.custom(((e, t, n, r) => (s.push(new V(e, t, r.elementHead, r.elementTail)), null)));
            if (n.floodFill(e, t, a, G.NEIGHBOURHOOD_SOLID_BODY), s.length > r) return [];
            for (let e of s) n.draw(e.x, e.y, i);
            return s
        }
        static copyEntities(e, t, n) {
            const r = [],
                i = [];
            return e(N.custom(((e, s, a, o) => {
                for (const a of t.entities().getAt(e, s))
                    if (a.isActive()) {
                        const [e, t] = a.extract(n, 0, 0);
                        i.push(e), r.push(...t)
                    } return null
            }))), [i, r]
        }
        static trimmed(e, t) {
            if (0 === e.length) return [null, null];
            let n = Number.MAX_VALUE,
                r = Number.MIN_VALUE,
                i = Number.MAX_VALUE,
                s = Number.MIN_VALUE;
            for (const t of e) n = Math.min(n, t.x), r = Math.max(r, t.x), i = Math.min(i, t.y), s = Math.max(s, t.y);
            const a = r - n + 1,
                o = s - i + 1,
                l = F.create(a, o, F.TRANSPARENT_ELEMENT);
            for (const t of e) {
                const e = t.x - n,
                    r = t.y - i;
                l.setElement(e, r, t)
            }
            for (let e of t) "number" == typeof e.x && (e.x -= n), "number" == typeof e.y && (e.y -= i);
            return [l, t]
        }
    }
    class K extends B {
        #B;
        #se;
        #ae = null;
        constructor(e, t, n) {
            super(e), this.#B = t, this.#se = n
        }
        applyPoint(e, t, n, r) {
            null === this.#ae ? this.#ae = this.#oe(e, t, n) : (this.#ae.applyPoint(e, t, n, r), this.#ae = null)
        }
        onDragStart(e, t, n, r) {}
        onDragEnd(e, t, n, r) {
            null !== this.#ae && (this.#ae.applyPoint(e, t, n, r), this.#ae = null)
        }
        #oe(e, t, n) {
            const [r, i] = this.#le(e, t, n);
            return null !== r ? new k(new x, r, i) : null
        }
        #le(e, t, n) {
            const r = n.getDefaults().getDefaultElement(),
                i = r => n.drawLine(e, t, e, t, this.#B, r, !0),
                s = [];
            s.push(...z.copyNonSolidElements(i, r)), s.push(...z.copySolidBodies(i, n, this.#se, r));
            const [a, o] = z.copyEntities(i, n, r);
            return s.push(...o), z.trimmed(s, a)
        }
        isAreaModeEnabled() {
            return !0
        }
        applyArea(e, t, n, r, i, s) {
            this.#ae = this.#he(e, t, n, r, i)
        }
        #he(e, t, n, r, i) {
            const [s, a] = this.#ce(e, t, n, r, i);
            return null !== s ? new k(new x, s, a) : null
        }
        #ce(e, t, n, i, s) {
            const a = Math.abs(e - n) + 1,
                o = Math.abs(t - i) + 1,
                l = F.create(a, o, F.TRANSPARENT_ELEMENT),
                h = [],
                c = s.getDefaults().getDefaultElement();
            let d = !0;
            const u = N.custom(((a, o, u, m) => {
                for (const n of s.entities().getAt(a, o))
                    if (n.isActive()) {
                        const [r] = n.extract(c, e, t);
                        h.push(r)
                    } if (r.getTypeClass(m.elementHead) > r.TYPE_AIR) {
                    let r = a - Math.min(e, n),
                        s = o - Math.min(t, i);
                    return l.setElement(r, s, m), d = !1, c
                }
                return null
            }));
            return s.drawRectangle(e, t, n, i, u, !1), d ? null : [l, h]
        }
        isSecondaryActionEnabled() {
            return null !== this.#ae
        }
        applySecondaryAction(e, t, n, r) {
            this.#ae = null
        }
        hasCursor() {
            return null !== this.#ae
        }
        createCursor() {
            return null !== this.#ae ? this.#ae.createCursor() : null
        }
    }
    class X extends B {
        #de;
        constructor(e, t) {
            super(e), this.#de = t
        }
        getTools() {
            return this.#de
        }
    }
    class q extends B {
        #ue;
        constructor(e, t) {
            super(e), this.#ue = t
        }
        getTemplateDefinitions() {
            return this.#ue
        }
    }
    class J extends B {
        #Q;
        constructor(e, t) {
            super(e), this.#Q = t
        }
        getHandler() {
            return this.#Q
        }
    }
    class j {
        static OPT_CYCLES_PER_SECOND = 120;
        static OPT_FRAMES_PER_SECOND = 60;
        getIteration() {
            throw "Not implemented"
        }
        getDefaults() {
            throw "Not implemented"
        }
        isFallThroughEnabled() {
            throw "Not implemented"
        }
        isErasingEnabled() {
            throw "Not implemented"
        }
        trigger(e, t) {
            throw "Not implemented"
        }
        triggerSolidCreated(e, t, n) {
            throw "Not implemented"
        }
    }
    class Z {
        elementArea;
        random;
        processorContext;
        entityManager;
        constructor(e, t, n, r) {
            this.elementArea = e, this.random = t, this.processorContext = n, this.entityManager = r
        }
    }
    class Q extends B {
        #me;
        #Ee;
        constructor(e, t) {
            super(e), this.#me = t, this.#ge()
        }
        #ge() {
            const e = F.create(1, 1, F.TRANSPARENT_ELEMENT),
                t = i.DEFAULT,
                n = new j,
                r = new Z(e, t, n);
            this.#Ee = this.#me({}, r)
        }
        applyPoint(e, t, n, r) {
            const i = this.#Ee.serialize();
            i.x = e, i.y = t, n.entities().insertEntity(i), this.#ge()
        }
        hasCursor() {
            return !0
        }
        createCursor() {
            const [e, t] = this.#Ee.countMaxBoundaries(), n = F.TRANSPARENT_ELEMENT, r = F.create(e + 4, t + 4, n), s = Math.trunc(r.getWidth() / 2), a = Math.trunc(r.getHeight() / 2);
            return this.#Ee.paint(s, a, r, i.DEFAULT), new L(r)
        }
    }
    class $ {
        static #x(e) {
            if (e instanceof x) return e;
            if (void 0 === e) return x.NOT_DEFINED;
            if ("object" == typeof e) return new x(e);
            throw "Incorrect tool info type: " + typeof e
        }
        static roundBrushTool(e, t, n) {
            return new _($.#x(n), e, t)
        }
        static roundBrushToolForSolidBody(e, t, n) {
            return new H($.#x(n), e, t)
        }
        static pointBrushTool(e, t) {
            return new U($.#x(t), [{
                dx: 0,
                dy: 0,
                brush: e
            }])
        }
        static multiPointBrushTool(e, t) {
            return new U($.#x(t), e)
        }
        static meteorTool(e, t, n, r) {
            return new P($.#x(r), e, t, n)
        }
        static insertScenesTool(e, t, n) {
            if (1 === e.length) {
                const r = e[0],
                    i = k.asElementArea(r),
                    s = r.createEntities(),
                    a = null !== s ? s : [];
                return new k($.#x(n), i, a, t)
            }
            return new Y($.#x(n), e, t)
        }
        static actionTool(e, t) {
            return new W($.#x(t), e)
        }
        static globalActionTool(e, t) {
            return new J($.#x(t), e)
        }
        static moveTool(e, t, n) {
            return new K($.#x(n), e, t)
        }
        static templateSelectionTool(e, t) {
            return new q($.#x(t), e)
        }
        static selectionTool(e, t) {
            return new X($.#x(t), e)
        }
        static insertEntityTool(e, t) {
            return new Q($.#x(t), e)
        }
        static grouping(e, t) {
            const n = [],
                r = {};
            for (const i of e) {
                const e = i.getInfo().getCategory();
                if (void 0 !== e && void 0 !== t[e]) {
                    let t = r[e];
                    void 0 === t && (t = [], r[e] = t, n.push(t)), t.push(i)
                } else n.push(i)
            }
            const i = [];
            for (const e of n)
                if (Array.isArray(e)) {
                    const n = e[0].getInfo().getCategory(),
                        r = t[n];
                    i.push($.selectionTool(e, $.#x({
                        displayName: r.displayName,
                        codeName: "category_" + n,
                        badgeStyle: r.badgeStyle
                    })))
                } else i.push(e);
            return i
        }
    }
    var ee = [{
            entriesCount: 310,
            entries: [
                [0, -1, 4],
                [0, 1, 1],
                [0, 2, 1],
                [0, 3, 1],
                [0, 4, 1],
                [0, 5, 1],
                [0, 6, 1],
                [0, 7, 1],
                [0, 8, 1],
                [0, 9, 1],
                [0, 10, 1],
                [0, 11, 1],
                [0, 12, 1],
                [0, 13, 1],
                [0, 14, 1],
                [0, 15, 1],
                [0, 16, 1],
                [0, 17, 1],
                [-1, 17, 1],
                [0, 18, 1],
                [1, 18, 1],
                [2, 18, 1],
                [3, 19, 1],
                [4, 20, 1],
                [5, 21, 2],
                [0, 19, 1],
                [0, 20, 1],
                [0, 21, 1],
                [0, 22, 1],
                [0, 23, 1],
                [-1, 23, 1],
                [-2, 23, 1],
                [-3, 24, 1],
                [-4, 25, 1],
                [-5, 25, 1],
                [-6, 25, 1],
                [-7, 25, 2],
                [0, 24, 1],
                [1, 25, 1],
                [1, 26, 1],
                [1, 27, 1],
                [2, 28, 1],
                [3, 29, 1],
                [4, 30, 1],
                [5, 30, 2],
                [0, 28, 1],
                [0, 29, 1],
                [-1, 30, 1, [
                    [-2, 31, 1],
                    [-3, 31, 1],
                    [-4, 31, 2],
                    [-2, 32, 1],
                    [-1, 33, 1],
                    [-1, 34, 1],
                    [0, 35, 1],
                    [0, 36, 2]
                ]],
                [1, -1, 4],
                [1, 0, 1],
                [1, 1, 1],
                [1, 2, 1],
                [1, 3, 1],
                [1, 4, 1],
                [1, 5, 1],
                [1, 6, 1],
                [1, 7, 1],
                [1, 8, 1],
                [1, 9, 1],
                [1, 10, 1],
                [1, 11, 1],
                [1, 12, 1],
                [1, 13, 1],
                [1, 14, 1],
                [1, 15, 1],
                [1, 16, 1],
                [1, 17, 1],
                [2, 19, 1],
                [1, 19, 1],
                [1, 20, 1],
                [1, 21, 1],
                [1, 22, 1],
                [1, 23, 1],
                [1, 24, 1],
                [2, 25, 1],
                [2, 26, 1],
                [2, 27, 1],
                [1, 28, 1],
                [1, 29, 1],
                [1, 30, 1],
                [1, 31, 1],
                [2, 32, 1],
                [2, 33, 1],
                [2, 34, 1],
                [3, 34, 1],
                [3, 35, 1],
                [4, 35, 1],
                [5, 35, 1],
                [6, 36, 1, [
                    [7, 36, 1],
                    [8, 37, 1],
                    [8, 38, 2],
                    [9, 38, 1],
                    [10, 39, 1],
                    [11, 39, 1],
                    [12, 40, 1],
                    [13, 40, 1],
                    [14, 40, 1],
                    [15, 40, 1],
                    [16, 40, 2]
                ]],
                [3, 36, 1],
                [3, 37, 1],
                [4, 38, 1],
                [5, 39, 1, [
                    [6, 40, 1],
                    [6, 41, 1],
                    [6, 42, 1],
                    [7, 43, 1],
                    [8, 44, 2]
                ]],
                [2, 38, 1, [
                    [1, 39, 1],
                    [0, 39, 1],
                    [-1, 40, 1],
                    [-2, 40, 1],
                    [-2, 41, 2],
                    [-3, 41, 1],
                    [-4, 41, 1],
                    [-5, 42, 1],
                    [-6, 42, 1],
                    [-7, 43, 1],
                    [-8, 43, 1],
                    [-9, 43, 2]
                ]],
                [3, 20, 1],
                [4, 21, 1],
                [5, 21, 2],
                [5, 22, 1],
                [6, 23, 1],
                [7, 24, 1],
                [8, 25, 1],
                [8, 26, 2],
                [9, 26, 1, []],
                [-1, -1, 4],
                [-1, 0, 1],
                [-1, 1, 1],
                [-1, 2, 1],
                [-1, 3, 1],
                [-1, 4, 1],
                [-1, 5, 1],
                [-1, 6, 1],
                [-1, 7, 1],
                [-1, 8, 1],
                [-1, 9, 1],
                [-1, 10, 1],
                [-1, 11, 1],
                [-1, 12, 1],
                [-1, 13, 1],
                [-1, 14, 1],
                [-1, 15, 1],
                [-1, 16, 1],
                [-1, 24, 1],
                [-2, 25, 1],
                [-3, 26, 1],
                [-4, 27, 1],
                [-5, 27, 1],
                [-6, 28, 1],
                [-7, 29, 1],
                [-8, 30, 1],
                [-9, 31, 1],
                [-10, 31, 1, [
                    [-9, 32, 1],
                    [-9, 33, 1],
                    [-9, 34, 1],
                    [-9, 35, 1],
                    [-8, 36, 1],
                    [-7, 36, 1],
                    [-6, 36, 1],
                    [-5, 37, 2],
                    [-8, 37, 1],
                    [-7, 38, 1],
                    [-7, 39, 1],
                    [-6, 40, 1],
                    [-6, 41, 1],
                    [-9, 38, 1],
                    [-10, 38, 2]
                ]],
                [9, 27, 1],
                [10, 28, 1],
                [11, 29, 1],
                [12, 30, 1],
                [13, 31, 1],
                [13, 32, 1],
                [14, 33, 2],
                [10, 30, 1],
                [10, 31, 1],
                [9, 32, 1],
                [8, 33, 2],
                [12, 41, 1],
                [12, 42, 1],
                [13, 43, 1],
                [13, 44, 1],
                [13, 45, 1],
                [14, 46, 2],
                [-6, 43, 1],
                [-5, 44, 1],
                [-4, 44, 1],
                [-3, 45, 1],
                [-2, 46, 1],
                [-1, 46, 1],
                [0, 47, 1],
                [1, 48, 1],
                [2, 48, 1],
                [3, 48, 2],
                [-3, 47, 2],
                [-2, -1, 4],
                [-2, 0, 1],
                [-2, 1, 1],
                [-2, 2, 1],
                [-2, 3, 1],
                [-2, 4, 1],
                [-2, 5, 1],
                [-2, 6, 1],
                [-2, 7, 1],
                [-2, 8, 1],
                [-2, 9, 1],
                [-2, 10, 1],
                [-2, 11, 1],
                [-2, 12, 1],
                [-2, 13, 1],
                [-2, 14, 1],
                [-2, 15, 1],
                [-2, 16, 1],
                [-2, 17, 1],
                [-1, 18, 1],
                [-1, 19, 1],
                [-1, 20, 1],
                [-1, 21, 1],
                [-1, 22, 1],
                [-2, 24, 1],
                [-3, 25, 1],
                [-4, 26, 1],
                [-5, 26, 1],
                [-6, 27, 1],
                [-7, 28, 1],
                [-8, 29, 1],
                [-9, 30, 1],
                [-10, 30, 2],
                [-10, 31, 1, [
                    [-11, 32, 1],
                    [-12, 32, 1],
                    [-13, 33, 1],
                    [-14, 34, 1],
                    [-15, 35, 1],
                    [-16, 35, 1],
                    [-17, 35, 2],
                    [-14, 36, 1],
                    [-14, 37, 1],
                    [-14, 38, 1],
                    [-14, 39, 1],
                    [-15, 40, 1],
                    [-15, 41, 1],
                    [-16, 41, 2],
                    [-15, 42, 1],
                    [-15, 43, 1, [
                        [-16, 44, 1],
                        [-16, 45, 1],
                        [-15, 45, 1],
                        [-14, 46, 1],
                        [-13, 46, 1],
                        [-12, 47, 1],
                        [-12, 48, 2],
                        [-11, 48, 1],
                        [-10, 49, 1],
                        [-9, 49, 1],
                        [-8, 50, 1],
                        [-7, 51, 1],
                        [-6, 52, 2],
                        [-16, 46, 1],
                        [-16, 47, 1],
                        [-17, 48, 1],
                        [-17, 49, 1],
                        [-18, 50, 2]
                    ]]
                ]],
                [4, 39, 1],
                [4, 40, 1],
                [4, 41, 1],
                [4, 42, 1],
                [3, 42, 1],
                [4, 43, 1],
                [5, 44, 1],
                [5, 45, 1],
                [5, 46, 1],
                [6, 47, 1],
                [7, 48, 1],
                [8, 49, 1],
                [8, 50, 2],
                [5, 48, 1, [
                    [4, 49, 1],
                    [3, 50, 1],
                    [2, 51, 1],
                    [1, 52, 1],
                    [1, 53, 1],
                    [0, 53, 2],
                    [0, 54, 1],
                    [0, 55, 1],
                    [0, 56, 1],
                    [1, 57, 1],
                    [2, 57, 1],
                    [3, 57, 1],
                    [4, 58, 2],
                    [-1, 57, 1],
                    [-2, 57, 1],
                    [-3, 58, 1],
                    [-4, 59, 2]
                ]],
                [2, 43, 2]
            ]
        }, {
            entriesCount: 319,
            entries: [
                [0, -1, 4],
                [0, 1, 1],
                [0, 2, 1],
                [0, 3, 1],
                [0, 4, 1],
                [0, 5, 1],
                [0, 6, 1],
                [0, 7, 1],
                [0, 8, 1],
                [0, 9, 1],
                [0, 10, 1],
                [0, 11, 1],
                [0, 12, 1],
                [0, 13, 1],
                [0, 14, 1],
                [0, 15, 1],
                [0, 16, 1],
                [0, 17, 1],
                [0, 18, 1],
                [-1, 18, 1],
                [-2, 18, 1],
                [-3, 19, 1],
                [-4, 20, 1],
                [-5, 21, 2],
                [0, 19, 1],
                [0, 20, 1],
                [0, 21, 1],
                [0, 22, 1],
                [0, 23, 1],
                [1, 23, 1],
                [2, 23, 1],
                [3, 24, 1],
                [4, 25, 1],
                [5, 25, 1],
                [6, 25, 1],
                [7, 25, 2],
                [0, 24, 1],
                [-1, 25, 1],
                [-1, 26, 1],
                [-1, 27, 1],
                [0, 28, 1],
                [0, 29, 1],
                [1, 30, 1, [
                    [2, 31, 1],
                    [3, 31, 1],
                    [4, 31, 2],
                    [2, 32, 1],
                    [1, 33, 1],
                    [1, 34, 1],
                    [0, 35, 1],
                    [0, 36, 2]
                ]],
                [-2, 28, 1],
                [-3, 29, 1],
                [-4, 30, 1],
                [-5, 30, 2],
                [-1, -1, 4],
                [-1, 0, 1],
                [-1, 1, 1],
                [-1, 2, 1],
                [-1, 3, 1],
                [-1, 4, 1],
                [-1, 5, 1],
                [-1, 6, 1],
                [-1, 7, 1],
                [-1, 8, 1],
                [-1, 9, 1],
                [-1, 10, 1],
                [-1, 11, 1],
                [-1, 12, 1],
                [-1, 13, 1],
                [-1, 14, 1],
                [-1, 15, 1],
                [-1, 16, 1],
                [-1, 17, 1],
                [-1, 19, 1],
                [-2, 19, 1],
                [-1, 20, 1],
                [-1, 21, 1],
                [-1, 22, 1],
                [-1, 23, 1],
                [-1, 24, 1],
                [-2, 25, 1],
                [-2, 26, 1],
                [-2, 27, 1],
                [-1, 28, 1],
                [-1, 29, 1],
                [-1, 30, 1],
                [-1, 31, 1],
                [-2, 32, 1],
                [-2, 33, 1],
                [-2, 34, 1],
                [-3, 34, 1],
                [-3, 35, 1],
                [-4, 35, 1],
                [-5, 35, 1],
                [-6, 36, 1, [
                    [-7, 36, 1],
                    [-8, 37, 1],
                    [-9, 38, 1],
                    [-9, 39, 2],
                    [-10, 39, 1],
                    [-11, 39, 1],
                    [-12, 40, 1],
                    [-13, 40, 1],
                    [-14, 40, 1],
                    [-15, 40, 1],
                    [-16, 40, 2]
                ]],
                [-3, 36, 1],
                [-3, 37, 1],
                [-2, 38, 1, [
                    [-1, 39, 1],
                    [0, 39, 1],
                    [1, 40, 1],
                    [2, 40, 1],
                    [3, 41, 1],
                    [4, 41, 1],
                    [5, 42, 1],
                    [6, 42, 1],
                    [7, 43, 1],
                    [8, 43, 1],
                    [9, 44, 2],
                    [3, 42, 2],
                    [-2, 40, 2]
                ]],
                [-4, 38, 1],
                [-5, 39, 1, [
                    [-6, 40, 1],
                    [-6, 41, 1],
                    [-6, 42, 1],
                    [-7, 43, 1],
                    [-7, 44, 2]
                ]],
                [-3, 20, 1],
                [-4, 21, 1],
                [-5, 21, 2],
                [-5, 22, 1],
                [-6, 23, 1],
                [-7, 24, 1],
                [-8, 25, 1],
                [-8, 26, 2],
                [-9, 26, 1, []],
                [1, -1, 4],
                [1, 0, 1],
                [1, 1, 1],
                [1, 2, 1],
                [1, 3, 1],
                [1, 4, 1],
                [1, 5, 1],
                [1, 6, 1],
                [1, 7, 1],
                [1, 8, 1],
                [1, 9, 1],
                [1, 10, 1],
                [1, 11, 1],
                [1, 12, 1],
                [1, 13, 1],
                [1, 14, 1],
                [1, 15, 1],
                [1, 16, 1],
                [1, 17, 1],
                [1, 18, 1],
                [1, 19, 1],
                [1, 24, 1],
                [2, 25, 1],
                [3, 26, 1],
                [4, 27, 1],
                [5, 27, 1],
                [6, 28, 1],
                [7, 29, 1],
                [8, 30, 1],
                [9, 31, 1],
                [9, 32, 1],
                [9, 33, 1],
                [9, 34, 1],
                [8, 34, 2],
                [9, 35, 1],
                [8, 36, 1],
                [7, 36, 1],
                [6, 36, 1],
                [5, 37, 2],
                [8, 37, 1],
                [9, 38, 1],
                [7, 38, 1],
                [7, 39, 1],
                [6, 40, 1],
                [6, 41, 1],
                [-9, 27, 1],
                [-10, 28, 1],
                [-11, 29, 1],
                [-12, 30, 1],
                [-13, 31, 1],
                [-13, 32, 1],
                [-14, 33, 2],
                [-12, 41, 1],
                [-12, 42, 1],
                [-13, 43, 1],
                [-13, 44, 1],
                [-13, 45, 1],
                [-14, 46, 2],
                [6, 43, 1],
                [5, 44, 1],
                [4, 44, 1],
                [3, 45, 1],
                [2, 45, 1],
                [1, 45, 1],
                [0, 45, 2],
                [1, 46, 1],
                [0, 47, 1],
                [-1, 48, 1],
                [-2, 48, 1],
                [-3, 48, 2],
                [4, 46, 1],
                [5, 47, 2],
                [2, -1, 4],
                [2, 0, 1],
                [2, 1, 1],
                [2, 2, 1],
                [2, 3, 1],
                [2, 4, 1],
                [2, 5, 1],
                [2, 6, 1],
                [2, 7, 1],
                [2, 8, 1],
                [2, 9, 1],
                [2, 10, 1],
                [2, 11, 1],
                [2, 12, 1],
                [2, 13, 1],
                [2, 14, 1],
                [2, 15, 1],
                [2, 16, 1],
                [2, 17, 1],
                [2, 18, 1],
                [2, 19, 1],
                [2, 20, 1],
                [1, 20, 1],
                [1, 21, 1],
                [1, 22, 1],
                [2, 24, 1],
                [3, 25, 1],
                [4, 26, 1],
                [5, 26, 1],
                [6, 27, 1],
                [7, 28, 1],
                [8, 29, 1],
                [9, 30, 1],
                [10, 30, 2],
                [10, 31, 1],
                [11, 32, 1],
                [12, 33, 1],
                [13, 34, 1],
                [14, 35, 1],
                [15, 35, 1],
                [16, 35, 2],
                [14, 36, 1],
                [14, 37, 1],
                [14, 38, 1],
                [14, 39, 1],
                [15, 40, 1],
                [15, 41, 1],
                [16, 41, 2],
                [8, 38, 1],
                [9, 39, 1],
                [10, 40, 1],
                [11, 40, 1],
                [12, 41, 1],
                [12, 42, 1],
                [13, 43, 1],
                [14, 44, 1],
                [15, 45, 1],
                [16, 46, 1],
                [16, 47, 1],
                [17, 48, 1],
                [17, 49, 1],
                [18, 50, 2],
                [14, 46, 1],
                [13, 46, 1],
                [12, 47, 1],
                [12, 48, 2],
                [11, 48, 1],
                [10, 49, 1],
                [9, 49, 1],
                [8, 50, 1],
                [7, 51, 1],
                [6, 52, 2],
                [-4, 39, 1],
                [-5, 39, 1, [
                    [-4, 40, 1],
                    [-4, 41, 1],
                    [-4, 42, 1],
                    [-4, 43, 1],
                    [-5, 44, 1],
                    [-5, 45, 1],
                    [-5, 46, 1],
                    [-6, 47, 1],
                    [-6, 48, 1],
                    [-6, 49, 1],
                    [-6, 50, 1],
                    [-7, 50, 2],
                    [-6, 51, 1],
                    [-7, 52, 1],
                    [-8, 52, 1],
                    [-9, 53, 1],
                    [-9, 54, 1],
                    [-10, 55, 2]
                ]],
                [-2, 49, 1],
                [-2, 50, 1],
                [-2, 51, 1],
                [-2, 52, 1],
                [-1, 53, 1],
                [-1, 54, 1],
                [0, 54, 2],
                [-1, 55, 1],
                [0, 56, 1],
                [1, 56, 1],
                [2, 57, 1],
                [3, 58, 2],
                [-2, 56, 1],
                [-3, 56, 1],
                [-4, 56, 1],
                [-5, 57, 2]
            ]
        }, {
            entriesCount: 269,
            entries: [
                [0, -1, 4],
                [0, 1, 1],
                [0, 2, 1],
                [0, 3, 1],
                [0, 4, 1],
                [0, 5, 1],
                [0, 6, 1],
                [0, 7, 1],
                [0, 8, 1],
                [0, 9, 1],
                [0, 10, 1],
                [0, 11, 1],
                [0, 12, 1],
                [0, 13, 1],
                [0, 14, 1],
                [0, 15, 1],
                [0, 16, 1],
                [0, 17, 1],
                [0, 18, 1],
                [0, 19, 1],
                [0, 20, 1, [
                    [-1, 20, 1],
                    [0, 21, 1],
                    [1, 21, 1],
                    [2, 22, 1],
                    [2, 23, 1],
                    [3, 24, 1],
                    [3, 25, 1],
                    [2, 25, 2],
                    [4, 26, 1],
                    [5, 27, 1],
                    [6, 28, 1],
                    [7, 28, 1],
                    [8, 29, 1],
                    [9, 30, 1],
                    [10, 31, 1],
                    [11, 32, 2],
                    [3, 27, 1],
                    [3, 28, 1],
                    [3, 29, 1],
                    [2, 30, 1],
                    [1, 31, 1],
                    [0, 31, 2],
                    [0, 22, 1],
                    [0, 23, 1],
                    [-1, 24, 1],
                    [-2, 25, 1],
                    [-2, 26, 1],
                    [-3, 27, 1],
                    [-4, 28, 1],
                    [-5, 29, 1],
                    [-6, 29, 2],
                    [-5, 30, 1],
                    [-6, 31, 1],
                    [-7, 31, 1],
                    [-8, 31, 1],
                    [-9, 32, 1],
                    [-10, 32, 1],
                    [-11, 33, 2],
                    [-2, 21, 1],
                    [-3, 22, 1],
                    [-4, 23, 1],
                    [-5, 23, 2]
                ]],
                [1, -1, 4],
                [1, 0, 1],
                [1, 1, 1],
                [1, 2, 1],
                [1, 3, 1],
                [1, 4, 1],
                [1, 5, 1],
                [1, 6, 1],
                [1, 7, 1],
                [1, 8, 1],
                [1, 9, 1],
                [1, 10, 1],
                [1, 11, 1],
                [1, 12, 1],
                [1, 13, 1],
                [1, 14, 1],
                [1, 15, 1],
                [1, 16, 1],
                [1, 17, 1],
                [1, 18, 1],
                [1, 19, 1],
                [1, 20, 1],
                [0, 20, 1, [
                    [-1, 21, 1],
                    [-1, 22, 1],
                    [-1, 23, 1]
                ]],
                [-1, 25, 1],
                [-1, 26, 1],
                [-1, 27, 1],
                [-2, 27, 1],
                [-3, 28, 1],
                [-4, 29, 1],
                [0, 28, 1, [
                    [1, 29, 1],
                    [1, 30, 1],
                    [2, 31, 1],
                    [3, 32, 1],
                    [3, 33, 1],
                    [3, 34, 1],
                    [4, 35, 1],
                    [4, 36, 1],
                    [4, 37, 1],
                    [3, 37, 2],
                    [0, 31, 2]
                ]],
                [-5, 31, 1],
                [-5, 32, 1],
                [-5, 33, 1],
                [-6, 34, 1, [
                    [-7, 35, 1],
                    [-8, 36, 1],
                    [-8, 37, 2],
                    [-9, 37, 1],
                    [-10, 38, 1],
                    [-10, 39, 1],
                    [-11, 40, 1],
                    [-12, 41, 1],
                    [-11, 42, 2]
                ]],
                [-1, -1, 4],
                [-1, 0, 1],
                [-1, 1, 1],
                [-1, 2, 1],
                [-1, 3, 1],
                [-1, 4, 1],
                [-1, 5, 1],
                [-1, 6, 1],
                [-1, 7, 1],
                [-1, 8, 1],
                [-1, 9, 1],
                [-1, 10, 1],
                [-1, 11, 1],
                [-1, 12, 1],
                [-1, 13, 1],
                [-1, 14, 1],
                [-1, 15, 1],
                [-1, 16, 1],
                [-1, 17, 1],
                [-1, 18, 1],
                [-1, 19, 1],
                [0, 20, 1, []],
                [2, 21, 1],
                [3, 22, 1],
                [3, 23, 1],
                [4, 24, 1],
                [4, 25, 1],
                [5, 26, 1],
                [6, 27, 1],
                [6, 29, 1],
                [6, 30, 1],
                [7, 31, 1],
                [7, 32, 1],
                [7, 33, 1],
                [8, 34, 1],
                [8, 35, 1],
                [8, 36, 1],
                [8, 37, 1],
                [9, 37, 2],
                [8, 38, 1],
                [8, 39, 1],
                [9, 40, 1],
                [9, 41, 1],
                [9, 42, 1],
                [10, 43, 2],
                [-4, 34, 1],
                [-4, 35, 1],
                [-4, 36, 1],
                [-4, 37, 1],
                [-3, 38, 1],
                [-2, 38, 2],
                [-3, 39, 1],
                [-3, 40, 1],
                [-3, 41, 1],
                [-3, 42, 1],
                [-2, 42, 1],
                [-1, 42, 1],
                [0, 43, 1],
                [1, 43, 1],
                [2, 43, 1],
                [3, 44, 2],
                [-3, 43, 1],
                [-4, 44, 2],
                [2, -1, 4],
                [2, 0, 1],
                [2, 1, 1],
                [2, 2, 1],
                [2, 3, 1],
                [2, 4, 1],
                [-2, 5, 1],
                [-2, 6, 1],
                [-2, 7, 1],
                [-2, 8, 1],
                [-2, 9, 1],
                [-2, 10, 1],
                [-2, 11, 1],
                [-2, 12, 1],
                [2, 13, 1],
                [2, 14, 1],
                [2, 15, 1],
                [2, 16, 1],
                [2, 17, 1],
                [2, 18, 1],
                [2, 19, 1],
                [2, 20, 1],
                [-5, 27, 1],
                [-6, 27, 1],
                [-7, 28, 1],
                [-8, 28, 1],
                [-9, 29, 1],
                [-10, 29, 1],
                [-11, 29, 1],
                [-12, 29, 1],
                [-13, 29, 1],
                [-14, 29, 2],
                [-14, 30, 1],
                [-15, 31, 1],
                [-15, 32, 1],
                [-16, 33, 1],
                [-16, 34, 1],
                [-17, 35, 1],
                [-17, 36, 1],
                [-18, 37, 2],
                [-6, 29, 2],
                [9, 34, 1],
                [10, 35, 1],
                [11, 35, 1],
                [12, 36, 1],
                [13, 37, 1],
                [14, 37, 1],
                [15, 38, 1],
                [16, 38, 1],
                [17, 38, 2],
                [-5, 38, 1],
                [-6, 39, 1],
                [-6, 40, 1],
                [-7, 41, 1],
                [-7, 42, 1],
                [-8, 43, 1],
                [-8, 44, 1],
                [-9, 45, 1],
                [-9, 46, 1],
                [-8, 47, 2],
                [-10, 47, 1],
                [-10, 48, 1],
                [-11, 49, 1],
                [-11, 50, 1],
                [-12, 51, 2],
                [7, 39, 1],
                [7, 40, 1],
                [6, 41, 1],
                [6, 42, 1],
                [6, 43, 1],
                [6, 44, 1],
                [5, 45, 1],
                [5, 46, 1],
                [5, 47, 1],
                [4, 47, 1],
                [5, 48, 1],
                [5, 49, 1],
                [4, 50, 1],
                [3, 51, 2],
                [3, 48, 1],
                [2, 48, 1],
                [1, 48, 1],
                [0, 48, 1],
                [-1, 49, 1],
                [-2, 49, 1],
                [-3, 49, 2]
            ]
        }, {
            entriesCount: 268,
            entries: [
                [0, -1, 4],
                [0, 1, 1],
                [0, 2, 1],
                [0, 3, 1],
                [0, 4, 1],
                [0, 5, 1],
                [0, 6, 1],
                [0, 7, 1],
                [0, 8, 1],
                [0, 9, 1],
                [0, 10, 1],
                [0, 11, 1],
                [0, 12, 1],
                [0, 13, 1],
                [0, 14, 1],
                [0, 15, 1],
                [0, 16, 1],
                [0, 17, 1],
                [0, 18, 1],
                [0, 19, 1],
                [0, 20, 1, [
                    [1, 20, 1],
                    [2, 21, 1],
                    [3, 22, 1],
                    [4, 23, 1],
                    [5, 23, 2],
                    [0, 21, 1],
                    [-1, 21, 1],
                    [0, 22, 1],
                    [0, 23, 1],
                    [1, 24, 1],
                    [2, 25, 1],
                    [2, 26, 1],
                    [3, 27, 1],
                    [4, 28, 1],
                    [5, 29, 1],
                    [6, 29, 2],
                    [5, 30, 1],
                    [6, 31, 1],
                    [7, 31, 1],
                    [8, 31, 1],
                    [9, 32, 1],
                    [10, 32, 1],
                    [11, 33, 2],
                    [-2, 22, 1],
                    [-2, 23, 1],
                    [-3, 24, 1],
                    [-3, 25, 1],
                    [-2, 25, 2],
                    [-4, 26, 1],
                    [-3, 27, 1],
                    [-3, 28, 1],
                    [-3, 29, 1],
                    [-2, 30, 1],
                    [-1, 31, 1],
                    [0, 31, 2],
                    [-5, 27, 1],
                    [-6, 28, 1],
                    [-7, 28, 1],
                    [-8, 29, 1],
                    [-9, 30, 1],
                    [-10, 31, 1],
                    [-11, 31, 1],
                    [-12, 31, 1],
                    [-13, 31, 2]
                ]],
                [-1, -1, 4],
                [-1, 0, 1],
                [-1, 1, 1],
                [-1, 2, 1],
                [-1, 3, 1],
                [-1, 4, 1],
                [-1, 5, 1],
                [-1, 6, 1],
                [-1, 7, 1],
                [-1, 8, 1],
                [-1, 9, 1],
                [-1, 10, 1],
                [-1, 11, 1],
                [-1, 12, 1],
                [-1, 13, 1],
                [-1, 14, 1],
                [-1, 15, 1],
                [-1, 16, 1],
                [-1, 17, 1],
                [-1, 18, 1],
                [-1, 19, 1],
                [-1, 20, 1],
                [0, 20, 1, [
                    [1, 21, 1],
                    [1, 22, 1],
                    [1, 23, 1]
                ]],
                [1, 25, 1],
                [1, 26, 1],
                [2, 27, 1],
                [3, 28, 1],
                [4, 29, 1],
                [4, 30, 1],
                [5, 31, 1],
                [5, 32, 1],
                [5, 33, 1],
                [6, 34, 1, [
                    [7, 35, 1],
                    [8, 36, 1],
                    [8, 37, 2],
                    [9, 37, 1],
                    [10, 38, 1],
                    [10, 39, 1],
                    [11, 40, 1],
                    [12, 41, 2]
                ]],
                [-4, 27, 1],
                [-4, 28, 1],
                [-4, 29, 1],
                [-4, 30, 1],
                [-4, 31, 1],
                [-3, 32, 1],
                [-3, 33, 1],
                [-3, 34, 1],
                [-3, 35, 1],
                [-3, 36, 1],
                [-3, 37, 2],
                [1, -1, 4],
                [1, 0, 1],
                [1, 1, 1],
                [1, 2, 1],
                [1, 3, 1],
                [1, 4, 1],
                [1, 5, 1],
                [1, 6, 1],
                [1, 7, 1],
                [1, 8, 1],
                [1, 9, 1],
                [1, 10, 1],
                [1, 11, 1],
                [1, 12, 1],
                [1, 13, 1],
                [1, 14, 1],
                [1, 15, 1],
                [1, 16, 1],
                [1, 17, 1],
                [1, 18, 1],
                [1, 19, 1],
                [0, 20, 1, []],
                [-2, 21, 1],
                [-3, 22, 1],
                [-3, 23, 1],
                [-4, 24, 1],
                [-4, 25, 1],
                [-5, 26, 1],
                [-6, 27, 1],
                [-6, 29, 1],
                [-6, 30, 1],
                [-7, 31, 1],
                [-7, 32, 1],
                [-7, 33, 1],
                [-8, 34, 1],
                [-8, 35, 1],
                [-8, 36, 1],
                [-8, 37, 1],
                [-9, 37, 2],
                [-8, 38, 1],
                [-8, 39, 1],
                [-9, 40, 1],
                [-9, 41, 1],
                [-9, 42, 1],
                [-10, 43, 2],
                [4, 34, 1],
                [4, 35, 1],
                [4, 36, 1],
                [4, 37, 1],
                [3, 38, 1],
                [2, 38, 2],
                [3, 39, 1],
                [3, 40, 1],
                [3, 41, 1],
                [3, 42, 1],
                [2, 42, 1],
                [1, 42, 1],
                [0, 43, 1],
                [-1, 43, 1],
                [-2, 43, 1],
                [-3, 44, 2],
                [3, 43, 1],
                [4, 44, 2],
                [-2, -1, 4],
                [-2, 0, 1],
                [-2, 1, 1],
                [-2, 2, 1],
                [-2, 3, 1],
                [-2, 4, 1],
                [-2, 5, 1],
                [-2, 6, 1],
                [-2, 7, 1],
                [-2, 8, 1],
                [-2, 9, 1],
                [-2, 10, 1],
                [-2, 11, 1],
                [-2, 12, 1],
                [-2, 13, 1],
                [-2, 14, 1],
                [-2, 15, 1],
                [-2, 16, 1],
                [-2, 17, 1],
                [-2, 18, 1],
                [-2, 19, 1],
                [-2, 20, 1],
                [6, 25, 1],
                [5, 25, 1],
                [4, 25, 1],
                [3, 25, 1],
                [7, 26, 1],
                [8, 26, 1],
                [9, 27, 1],
                [10, 27, 1],
                [11, 27, 2],
                [11, 28, 1],
                [12, 28, 1],
                [13, 29, 1],
                [14, 30, 1],
                [15, 31, 1],
                [16, 31, 2],
                [15, 32, 1],
                [16, 33, 1],
                [16, 34, 1],
                [17, 35, 1],
                [17, 36, 1],
                [17, 37, 2],
                [-9, 34, 1],
                [-10, 35, 1],
                [-11, 35, 1],
                [-12, 36, 1],
                [-13, 37, 1],
                [-14, 37, 1],
                [-15, 38, 1],
                [-16, 39, 2],
                [5, 38, 1],
                [6, 39, 1],
                [6, 40, 1],
                [7, 41, 1],
                [7, 42, 1],
                [8, 43, 1],
                [8, 44, 1],
                [9, 45, 1],
                [9, 46, 1],
                [10, 47, 1],
                [10, 48, 1],
                [11, 49, 1],
                [11, 50, 1],
                [12, 51, 2],
                [8, 47, 2],
                [-7, 39, 1],
                [-7, 40, 1],
                [-6, 41, 1],
                [-6, 42, 1],
                [-6, 43, 1],
                [-6, 44, 1],
                [-5, 45, 1],
                [-5, 46, 1],
                [-5, 47, 1],
                [-5, 48, 1],
                [-4, 49, 1],
                [-3, 49, 1],
                [-2, 49, 1],
                [-1, 49, 1],
                [0, 49, 1],
                [1, 49, 1],
                [2, 49, 2],
                [-4, 50, 1],
                [-5, 51, 2]
            ]
        }, {
            entriesCount: 169,
            entries: [
                [0, -1, 4],
                [0, 1, 1],
                [0, 2, 1],
                [0, 3, 1],
                [0, 4, 1],
                [0, 5, 1],
                [0, 6, 1],
                [0, 7, 1],
                [0, 8, 1],
                [0, 9, 1],
                [0, 10, 1],
                [0, 11, 1],
                [0, 12, 1],
                [0, 13, 1],
                [0, 14, 1],
                [0, 15, 1],
                [0, 16, 1],
                [0, 17, 1],
                [0, 18, 1],
                [0, 19, 1],
                [0, 20, 1, [
                    [-1, 20, 1],
                    [0, 21, 1],
                    [1, 21, 1],
                    [2, 22, 1],
                    [2, 23, 1],
                    [3, 24, 1],
                    [3, 25, 1],
                    [3, 26, 1],
                    [4, 27, 1],
                    [4, 28, 1],
                    [4, 29, 2],
                    [0, 22, 1],
                    [0, 23, 1],
                    [0, 24, 2],
                    [-2, 21, 1],
                    [-3, 22, 1],
                    [-4, 23, 1],
                    [-4, 24, 1],
                    [-5, 25, 1],
                    [-6, 26, 2]
                ]],
                [1, -1, 4],
                [1, 0, 1],
                [1, 1, 1],
                [1, 2, 1],
                [1, 3, 1],
                [1, 4, 1],
                [1, 5, 1],
                [1, 6, 1],
                [1, 7, 1],
                [1, 8, 1],
                [1, 9, 1],
                [1, 10, 1],
                [1, 11, 1],
                [1, 12, 1],
                [1, 13, 1],
                [1, 14, 1],
                [1, 15, 1],
                [1, 16, 1],
                [1, 17, 1],
                [1, 18, 1],
                [1, 19, 1],
                [1, 20, 1],
                [0, 20, 1, [
                    [-1, 21, 1],
                    [-1, 22, 1],
                    [-1, 23, 1],
                    [-1, 24, 1],
                    [0, 24, 2],
                    [-2, 25, 1],
                    [-2, 26, 1],
                    [-2, 27, 1],
                    [-2, 28, 1],
                    [-3, 29, 1],
                    [-4, 30, 1],
                    [-5, 30, 1],
                    [-4, 31, 1],
                    [-4, 32, 1],
                    [-3, 33, 1],
                    [-2, 34, 1],
                    [-2, 35, 1],
                    [-1, 36, 1],
                    [0, 36, 1],
                    [1, 36, 2],
                    [-5, 33, 2],
                    [-6, 31, 1],
                    [-7, 31, 1],
                    [-8, 31, 1],
                    [-9, 31, 1],
                    [-10, 31, 2]
                ]],
                [-1, -1, 4],
                [-1, 0, 1],
                [-1, 1, 1],
                [-1, 2, 1],
                [-1, 3, 1],
                [-1, 4, 1],
                [-1, 5, 1],
                [-1, 6, 1],
                [-1, 7, 1],
                [-1, 8, 1],
                [-1, 9, 1],
                [-1, 10, 1],
                [-1, 11, 1],
                [-1, 12, 1],
                [-1, 13, 1],
                [-1, 14, 1],
                [-1, 15, 1],
                [-1, 16, 1],
                [-1, 17, 1],
                [-1, 18, 1],
                [-1, 19, 1],
                [0, 20, 1, []],
                [-5, 24, 1],
                [-6, 24, 1],
                [-7, 24, 1],
                [-8, 24, 1],
                [-9, 24, 1],
                [-10, 24, 1],
                [-11, 24, 2],
                [6, 25, 1],
                [5, 25, 1],
                [4, 25, 1],
                [7, 26, 1],
                [8, 26, 1],
                [9, 26, 2],
                [-1, 25, 1],
                [-1, 26, 1],
                [-1, 27, 1],
                [-1, 28, 1],
                [0, 28, 1],
                [1, 29, 1],
                [2, 30, 1],
                [3, 31, 1],
                [4, 32, 1],
                [5, 32, 1],
                [6, 33, 1],
                [7, 33, 1],
                [8, 34, 1],
                [9, 34, 2],
                [5, 34, 1],
                [5, 35, 1],
                [5, 36, 1],
                [5, 37, 1],
                [5, 38, 1],
                [6, 39, 2],
                [-1, 29, 1],
                [-1, 30, 1],
                [-1, 31, 1],
                [-1, 32, 1],
                [-1, 33, 1],
                [-1, 34, 1],
                [-1, 35, 1],
                [-3, 35, 1],
                [-4, 36, 1],
                [-5, 37, 1],
                [-6, 38, 1],
                [-7, 39, 2],
                [-1, 37, 1],
                [-1, 38, 1],
                [-1, 39, 1],
                [-1, 40, 1],
                [-2, 40, 1],
                [-1, 41, 1],
                [-1, 42, 2],
                [-3, 41, 1],
                [-4, 42, 1],
                [-5, 42, 1],
                [-6, 43, 1],
                [-7, 43, 2]
            ]
        }, {
            entriesCount: 73,
            entries: [
                [0, -1, 4],
                [0, 1, 1],
                [0, 2, 1],
                [0, 3, 1],
                [0, 4, 1],
                [0, 5, 1],
                [0, 6, 1],
                [0, 7, 1],
                [0, 8, 1],
                [0, 9, 1],
                [0, 10, 1],
                [0, 11, 1],
                [0, 12, 1],
                [0, 13, 1],
                [0, 14, 1],
                [-1, 14, 1, [
                    [-2, 14, 1],
                    [-3, 14, 1],
                    [-4, 15, 1],
                    [-5, 16, 2],
                    [0, 15, 1],
                    [0, 16, 1],
                    [0, 17, 1],
                    [0, 18, 1],
                    [1, 18, 1, [
                        [2, 18, 1],
                        [3, 19, 1],
                        [4, 20, 1],
                        [5, 20, 2],
                        [0, 19, 1],
                        [-1, 20, 1],
                        [-1, 21, 1],
                        [-1, 22, 1],
                        [0, 23, 1],
                        [0, 24, 1],
                        [1, 25, 1],
                        [2, 26, 1],
                        [3, 26, 1],
                        [4, 26, 2],
                        [-1, 25, 1],
                        [-1, 26, 1],
                        [-1, 27, 1],
                        [-1, 28, 1],
                        [0, 29, 1],
                        [0, 30, 1],
                        [0, 31, 2],
                        [-2, 23, 1],
                        [-3, 24, 1],
                        [-4, 25, 1],
                        [-5, 25, 2]
                    ]]
                ]],
                [1, -1, 4],
                [1, 0, 1],
                [1, 1, 1],
                [1, 2, 1],
                [1, 3, 1],
                [1, 4, 1],
                [1, 5, 1],
                [1, 6, 1],
                [1, 7, 1],
                [1, 8, 1],
                [1, 9, 1],
                [1, 10, 1],
                [1, 11, 1],
                [1, 12, 1],
                [1, 13, 1],
                [1, 14, 1],
                [1, 15, 1],
                [1, 16, 1],
                [1, 17, 1],
                [1, 18, 1, []],
                [0, 20, 1],
                [0, 21, 1],
                [0, 22, 1]
            ]
        }, {
            entriesCount: 60,
            entries: [
                [0, -1, 4],
                [0, 1, 1],
                [0, 2, 1],
                [0, 3, 1],
                [0, 4, 1],
                [0, 5, 1],
                [0, 6, 1],
                [0, 7, 1],
                [0, 8, 1],
                [0, 9, 1],
                [0, 10, 1],
                [0, 11, 1],
                [0, 12, 1],
                [0, 13, 1],
                [0, 14, 1],
                [0, 15, 1],
                [-1, 15, 1],
                [0, 16, 1],
                [0, 17, 1],
                [1, 18, 1],
                [2, 19, 1],
                [3, 20, 1],
                [4, 20, 2],
                [1, 20, 1],
                [0, 21, 1],
                [0, 22, 1],
                [-1, 22, 1],
                [-2, 23, 1],
                [-3, 24, 2],
                [1, 23, 1],
                [2, 24, 1],
                [2, 25, 1],
                [3, 26, 2],
                [-2, 16, 1],
                [-3, 17, 1],
                [-3, 18, 1],
                [-3, 19, 2],
                [1, -1, 4],
                [1, 0, 1],
                [1, 1, 1],
                [1, 2, 1],
                [1, 3, 1],
                [1, 4, 1],
                [-1, 4, 1],
                [-1, 5, 1],
                [-1, 6, 1],
                [-1, 7, 1],
                [-1, 8, 1],
                [-1, 9, 1],
                [-1, 10, 1],
                [1, 10, 1],
                [1, 11, 1],
                [1, 12, 1],
                [1, 13, 1],
                [1, 14, 1],
                [1, 15, 1],
                [1, 16, 1],
                [1, 17, 1],
                [0, 18, 1],
                [1, 19, 1]
            ]
        }, {
            entriesCount: 55,
            entries: [
                [0, -1, 4],
                [0, 1, 1],
                [0, 2, 1],
                [0, 3, 1],
                [0, 4, 1],
                [0, 5, 1],
                [0, 6, 1],
                [0, 7, 1],
                [-1, 7, 1],
                [-1, 8, 1],
                [-1, 9, 1],
                [-1, 10, 1],
                [-1, 11, 1],
                [-1, 12, 1],
                [-1, 13, 1],
                [-1, 14, 1],
                [-1, 15, 1],
                [0, 15, 1, [
                    [1, 16, 1],
                    [2, 17, 1],
                    [3, 18, 2],
                    [-1, 16, 1],
                    [-1, 17, 1],
                    [-1, 18, 1],
                    [-1, 19, 1],
                    [-1, 20, 1],
                    [-1, 21, 1],
                    [-1, 22, 1],
                    [0, 23, 1],
                    [1, 24, 1],
                    [2, 25, 2],
                    [-2, 23, 1],
                    [-3, 24, 1],
                    [-4, 25, 2]
                ]],
                [-2, 15, 1, [
                    [-3, 16, 1],
                    [-4, 17, 1],
                    [-5, 18, 2]
                ]],
                [-1, -1, 4],
                [-1, 0, 1],
                [-1, 1, 1],
                [-1, 2, 1],
                [-1, 3, 1],
                [-1, 4, 1],
                [-1, 5, 1],
                [-1, 6, 1],
                [-2, 7, 1],
                [-2, 8, 1],
                [-2, 9, 1],
                [-2, 10, 1],
                [-2, 11, 1],
                [-2, 12, 1],
                [-2, 13, 1],
                [-2, 14, 1],
                [-2, 15, 1, []]
            ]
        }],
        te = [{
            entriesCount: 49,
            entries: [
                [1, 0, 3, [
                    [2, 0, 3],
                    [1, -1, 3],
                    [2, -1, 3],
                    [3, 0, 3],
                    [2, 1, 3],
                    [3, -1, 3],
                    [3, 1, 3],
                    [4, 0, 3],
                    [3, -2, 3],
                    [3, 2, 3],
                    [4, 1, 3],
                    [4, -2, 3]
                ]],
                [-1, 0, 3, [
                    [-2, 0, 3],
                    [-3, 0, 3],
                    [-2, 1, 3],
                    [-2, -1, 3],
                    [-3, 1, 3],
                    [-3, -1, 3],
                    [-4, 0, 3],
                    [-2, 2, 3],
                    [-3, 2, 3],
                    [-2, 3, 3]
                ]],
                [0, -1, 3, [
                    [-1, -1, 3],
                    [0, -2, 3],
                    [-1, -2, 3],
                    [0, -3, 3],
                    [1, -2, 3],
                    [-2, -2, 3],
                    [-1, -3, 3],
                    [1, -3, 3],
                    [2, -2, 3],
                    [2, -3, 3],
                    [3, -3, 3]
                ]],
                [0, 1, 3, [
                    [1, 1, 3],
                    [-1, 1, 3],
                    [0, 2, 3],
                    [1, 2, 3],
                    [-1, 2, 3],
                    [0, 3, 3],
                    [2, 2, 3],
                    [1, 3, 3],
                    [2, 3, 3],
                    [1, 4, 3],
                    [3, 3, 3],
                    [2, 4, 3]
                ]]
            ]
        }, {
            entriesCount: 55,
            entries: [
                [0, -1, 3, [
                    [0, -2, 3],
                    [-1, -1, 3],
                    [0, -3, 3],
                    [-1, -2, 3],
                    [1, -2, 3],
                    [-1, -3, 3],
                    [1, -3, 3],
                    [-2, -2, 3],
                    [2, -2, 3]
                ]],
                [-1, 0, 3, [
                    [-2, 0, 3],
                    [-2, -1, 3],
                    [-3, 0, 3],
                    [-3, -1, 3],
                    [-4, 0, 3],
                    [-3, 1, 3],
                    [-4, -1, 3],
                    [-3, -2, 3],
                    [-4, 1, 3],
                    [-3, 2, 3],
                    [-4, -2, 3]
                ]],
                [1, 0, 3, [
                    [1, -1, 3],
                    [1, 1, 3],
                    [2, 0, 3],
                    [2, -1, 3],
                    [2, 1, 3],
                    [3, 0, 3],
                    [3, -1, 3],
                    [3, 1, 3],
                    [4, 0, 3],
                    [4, -1, 3],
                    [3, -2, 3],
                    [4, 1, 3],
                    [5, 0, 3],
                    [5, -1, 3],
                    [4, -2, 3]
                ]],
                [0, 1, 3, [
                    [0, 2, 3],
                    [-1, 1, 3],
                    [1, 2, 3],
                    [-1, 2, 3],
                    [0, 3, 3],
                    [-2, 1, 3],
                    [2, 2, 3],
                    [1, 3, 3],
                    [-2, 2, 3],
                    [-1, 3, 3],
                    [0, 4, 3],
                    [2, 3, 3],
                    [3, 2, 3],
                    [1, 4, 3],
                    [-1, 4, 3],
                    [0, 5, 3]
                ]]
            ]
        }, {
            entriesCount: 82,
            entries: [
                [-1, 0, 3, [
                    [-2, 0, 3],
                    [-2, 1, 3],
                    [-3, 0, 3],
                    [-3, 1, 3],
                    [-4, 0, 3],
                    [-3, -1, 3],
                    [-4, 1, 3],
                    [-4, -1, 3],
                    [-5, 0, 3],
                    [-5, 1, 3],
                    [-4, 2, 3],
                    [-5, -1, 3],
                    [-4, -2, 3],
                    [-6, 0, 3],
                    [-5, 2, 3],
                    [-6, 1, 3],
                    [-4, 3, 3],
                    [-5, 3, 3]
                ]],
                [0, 1, 3, [
                    [0, 2, 3],
                    [-1, 1, 3],
                    [1, 1, 3],
                    [-1, 2, 3],
                    [1, 2, 3],
                    [0, 3, 3],
                    [-2, 2, 3],
                    [-1, 3, 3],
                    [1, 3, 3],
                    [2, 2, 3],
                    [0, 4, 3],
                    [-2, 3, 3],
                    [-1, 4, 3],
                    [1, 4, 3],
                    [2, 3, 3],
                    [0, 5, 3],
                    [3, 3, 3],
                    [0, 6, 3],
                    [3, 4, 3]
                ]],
                [0, -1, 3, [
                    [1, -1, 3],
                    [0, -2, 3],
                    [-1, -1, 3],
                    [1, -2, 3],
                    [-1, -2, 3],
                    [0, -3, 3],
                    [-2, -1, 3],
                    [2, -2, 3],
                    [1, -3, 3],
                    [-1, -3, 3],
                    [-2, -2, 3],
                    [0, -4, 3],
                    [2, -3, 3],
                    [-1, -4, 3],
                    [-3, -2, 3],
                    [3, -3, 3],
                    [4, -3, 3]
                ]],
                [1, 0, 3, [
                    [2, 0, 3],
                    [3, 0, 3],
                    [2, 1, 3],
                    [2, -1, 3],
                    [3, 1, 3],
                    [3, -1, 3],
                    [4, 0, 3],
                    [4, 1, 3],
                    [3, 2, 3],
                    [4, -1, 3],
                    [3, -2, 3],
                    [5, 0, 3],
                    [4, 2, 3],
                    [5, 1, 3],
                    [5, -1, 3],
                    [4, -2, 3],
                    [6, 0, 3],
                    [4, 3, 3],
                    [6, -1, 3],
                    [7, 0, 3],
                    [4, 4, 3],
                    [7, -1, 3],
                    [5, 4, 3],
                    [4, 5, 3]
                ]]
            ]
        }, {
            entriesCount: 63,
            entries: [
                [1, 0, 3, [
                    [2, 0, 3],
                    [2, 1, 3],
                    [2, -1, 3],
                    [3, 0, 3],
                    [3, 1, 3],
                    [3, -1, 3],
                    [4, 0, 3],
                    [4, 1, 3],
                    [4, -1, 3],
                    [3, -2, 3],
                    [5, 0, 3],
                    [5, 1, 3],
                    [5, -1, 3],
                    [6, 0, 3]
                ]],
                [0, -1, 3, [
                    [-1, -1, 3],
                    [0, -2, 3],
                    [1, -1, 3],
                    [-2, -1, 3],
                    [-1, -2, 3],
                    [0, -3, 3],
                    [1, -2, 3],
                    [-2, -2, 3],
                    [-1, -3, 3],
                    [1, -3, 3],
                    [2, -2, 3],
                    [-3, -2, 3],
                    [2, -3, 3]
                ]],
                [0, 1, 3, [
                    [1, 1, 3],
                    [-1, 1, 3],
                    [0, 2, 3],
                    [1, 2, 3],
                    [-1, 2, 3],
                    [0, 3, 3],
                    [2, 2, 3],
                    [1, 3, 3],
                    [-1, 3, 3],
                    [-2, 2, 3],
                    [3, 2, 3],
                    [-2, 3, 3],
                    [-1, 4, 3],
                    [-3, 2, 3],
                    [-3, 3, 3],
                    [-2, 4, 3],
                    [-4, 2, 3],
                    [-4, 3, 3]
                ]],
                [-1, 0, 3, [
                    [-2, 0, 3],
                    [-2, 1, 3],
                    [-3, 0, 3],
                    [-3, 1, 3],
                    [-3, -1, 3],
                    [-4, 0, 3],
                    [-4, 1, 3],
                    [-4, -1, 3],
                    [-5, 0, 3],
                    [-5, 1, 3],
                    [-5, -1, 3],
                    [-6, 0, 3],
                    [-6, 1, 3],
                    [-5, 2, 3]
                ]]
            ]
        }, {
            entriesCount: 48,
            entries: [
                [-1, 0, 3, [
                    [-1, -1, 3],
                    [-2, 0, 3],
                    [-2, -1, 3],
                    [-3, 0, 3],
                    [-3, -1, 3],
                    [-4, 0, 3],
                    [-3, 1, 3],
                    [-4, -1, 3],
                    [-3, -2, 3],
                    [-4, 1, 3],
                    [-3, -3, 3]
                ]],
                [0, -1, 3, [
                    [1, -1, 3],
                    [0, -2, 3],
                    [1, -2, 3],
                    [0, -3, 3],
                    [-1, -2, 3],
                    [2, -2, 3],
                    [0, -4, 3],
                    [-1, -3, 3],
                    [-2, -2, 3],
                    [2, -3, 3],
                    [-1, -4, 3],
                    [-2, -3, 3]
                ]],
                [0, 1, 3, [
                    [0, 2, 3],
                    [-1, 1, 3],
                    [1, 2, 3],
                    [0, 3, 3],
                    [-1, 2, 3],
                    [-2, 1, 3],
                    [-1, 3, 3],
                    [-2, 2, 3],
                    [-3, 2, 3]
                ]],
                [1, 0, 3, [
                    [1, 1, 3],
                    [2, 0, 3],
                    [2, 1, 3],
                    [3, 0, 3],
                    [2, -1, 3],
                    [3, 1, 3],
                    [2, 2, 3],
                    [4, 0, 3],
                    [3, -1, 3],
                    [4, 1, 3],
                    [3, 2, 3],
                    [5, 1, 3]
                ]]
            ]
        }, {
            entriesCount: 57,
            entries: [
                [0, 1, 3, [
                    [1, 1, 3],
                    [0, 2, 3],
                    [1, 2, 3],
                    [-1, 2, 3],
                    [0, 3, 3],
                    [1, 3, 3],
                    [2, 2, 3],
                    [-1, 3, 3],
                    [0, 4, 3],
                    [2, 3, 3],
                    [1, 4, 3],
                    [-1, 4, 3],
                    [-2, 3, 3],
                    [0, 5, 3],
                    [3, 3, 3],
                    [2, 4, 3],
                    [-1, 5, 3],
                    [3, 4, 3]
                ]],
                [-1, 0, 3, [
                    [-2, 0, 3],
                    [-1, -1, 3],
                    [-1, 1, 3],
                    [-2, 1, 3],
                    [-3, 0, 3],
                    [-2, -1, 3],
                    [-2, 2, 3],
                    [-3, 1, 3],
                    [-3, -1, 3],
                    [-2, -2, 3]
                ]],
                [0, -1, 3, [
                    [0, -2, 3],
                    [-1, -2, 3],
                    [0, -3, 3],
                    [1, -2, 3],
                    [-1, -3, 3],
                    [1, -3, 3],
                    [0, -4, 3],
                    [-1, -4, 3],
                    [-2, -3, 3],
                    [2, -3, 3],
                    [1, -4, 3],
                    [0, -5, 3],
                    [-2, -4, 3],
                    [-1, -5, 3],
                    [3, -3, 3],
                    [2, -4, 3],
                    [1, -5, 3],
                    [3, -4, 3]
                ]],
                [1, 0, 3, [
                    [1, -1, 3],
                    [2, 0, 3],
                    [2, -1, 3],
                    [3, 0, 3],
                    [2, 1, 3],
                    [2, -2, 3],
                    [3, 1, 3]
                ]]
            ]
        }, {
            entriesCount: 86,
            entries: [
                [0, 1, 3, [
                    [0, 2, 3],
                    [-1, 1, 3],
                    [0, 3, 3],
                    [1, 2, 3],
                    [-1, 2, 3],
                    [1, 3, 3],
                    [-1, 3, 3],
                    [2, 2, 3],
                    [-2, 2, 3],
                    [2, 3, 3],
                    [-2, 3, 3],
                    [-3, 2, 3]
                ]],
                [1, 0, 3, [
                    [1, 1, 3],
                    [2, 0, 3],
                    [2, 1, 3],
                    [3, 0, 3],
                    [3, 1, 3],
                    [3, -1, 3],
                    [4, 0, 3],
                    [4, 1, 3],
                    [3, 2, 3],
                    [4, -1, 3],
                    [5, 0, 3],
                    [4, 2, 3],
                    [4, -2, 3],
                    [5, -1, 3],
                    [5, -2, 3],
                    [4, -3, 3],
                    [6, -1, 3],
                    [5, -3, 3],
                    [6, -2, 3],
                    [4, -4, 3],
                    [7, -1, 3],
                    [6, -3, 3],
                    [5, -4, 3],
                    [7, -2, 3],
                    [4, -5, 3],
                    [5, -5, 3]
                ]],
                [-1, 0, 3, [
                    [-2, 0, 3],
                    [-1, -1, 3],
                    [-3, 0, 3],
                    [-2, 1, 3],
                    [-2, -1, 3],
                    [-4, 0, 3],
                    [-3, -1, 3],
                    [-3, 1, 3],
                    [-2, -2, 3],
                    [-4, 1, 3],
                    [-4, -1, 3],
                    [-3, -2, 3],
                    [-4, -2, 3],
                    [-3, -3, 3],
                    [-4, -3, 3],
                    [-5, -2, 3],
                    [-4, -4, 3],
                    [-5, -3, 3],
                    [-5, -4, 3],
                    [-6, -3, 3],
                    [-6, -4, 3]
                ]],
                [0, -1, 3, [
                    [1, -1, 3],
                    [0, -2, 3],
                    [1, -2, 3],
                    [2, -1, 3],
                    [-1, -2, 3],
                    [0, -3, 3],
                    [1, -3, 3],
                    [2, -2, 3],
                    [-1, -3, 3],
                    [1, -4, 3],
                    [2, -3, 3],
                    [3, -2, 3],
                    [-1, -4, 3],
                    [-2, -3, 3],
                    [2, -4, 3],
                    [3, -3, 3],
                    [-2, -4, 3],
                    [-1, -5, 3],
                    [2, -5, 3],
                    [-2, -5, 3],
                    [-3, -4, 3],
                    [-3, -5, 3],
                    [-2, -6, 3]
                ]]
            ]
        }, {
            entriesCount: 41,
            entries: [
                [1, 0, 3, [
                    [2, 0, 3],
                    [1, 1, 3],
                    [3, 0, 3],
                    [2, 1, 3],
                    [2, -1, 3],
                    [3, 1, 3],
                    [3, -1, 3],
                    [4, 0, 3],
                    [2, 2, 3],
                    [4, 1, 3],
                    [3, -2, 3],
                    [4, -2, 3]
                ]],
                [-1, 0, 3, [
                    [-2, 0, 3],
                    [-3, 0, 3],
                    [-2, 1, 3],
                    [-3, 1, 3],
                    [-4, 1, 3],
                    [-4, 2, 3]
                ]],
                [0, 1, 3, [
                    [0, 2, 3],
                    [-1, 1, 3],
                    [-1, 2, 3],
                    [-1, 3, 3],
                    [-2, 2, 3],
                    [-2, 3, 3],
                    [-3, 2, 3],
                    [-2, 4, 3],
                    [-3, 3, 3],
                    [-3, 4, 3]
                ]],
                [0, -1, 3, [
                    [0, -2, 3],
                    [1, -1, 3],
                    [-1, -1, 3],
                    [-1, -2, 3],
                    [1, -2, 3],
                    [2, -2, 3],
                    [2, -3, 3],
                    [3, -3, 3],
                    [3, -4, 3]
                ]]
            ]
        }, {
            entriesCount: 47,
            entries: [
                [0, 1, 3, [
                    [0, 2, 3],
                    [1, 1, 3],
                    [1, 2, 3],
                    [-1, 2, 3],
                    [1, 3, 3],
                    [2, 2, 3],
                    [-2, 2, 3]
                ]],
                [-1, 0, 3, [
                    [-1, -1, 3],
                    [-1, 1, 3],
                    [-2, 0, 3],
                    [-2, -1, 3],
                    [-2, 1, 3],
                    [-3, 0, 3],
                    [-3, -1, 3],
                    [-3, 1, 3],
                    [-4, 0, 3],
                    [-4, -1, 3],
                    [-4, 1, 3],
                    [-5, 0, 3],
                    [-5, 1, 3]
                ]],
                [0, -1, 3, [
                    [1, -1, 3],
                    [0, -2, 3],
                    [1, -2, 3],
                    [-1, -2, 3],
                    [0, -3, 3],
                    [1, -3, 3],
                    [2, -2, 3],
                    [2, -3, 3],
                    [3, -2, 3],
                    [2, -4, 3],
                    [3, -3, 3],
                    [4, -2, 3],
                    [3, -4, 3]
                ]],
                [1, 0, 3, [
                    [2, 0, 3],
                    [2, 1, 3],
                    [2, -1, 3],
                    [3, 0, 3],
                    [3, 1, 3],
                    [3, -1, 3],
                    [4, 0, 3],
                    [4, -1, 3],
                    [5, 0, 3],
                    [5, -1, 3]
                ]]
            ]
        }];
    class ne {
        static TREE_TRUNK_TEMPLATES = ee;
        static TREE_CLUSTER_TEMPLATES = te
    }
    var re = "94,70,42\n109,82,53";
    class ie {
        static NONE = N.custom((() => null));
        static _TEST_SOLID = N.random([new n(r.of(r.type8(r.TYPE_STATIC)), h.of(255, 0, 125))]);
        static _TEST_AIR = N.random([new n(r.of(r.type8(r.TYPE_AIR)), h.of(255, 0, 125))]);
        static AIR = N.random([new n(r.of(r.type8(r.TYPE_AIR)), h.of(255, 255, 255, h.BLUR_TYPE_BACKGROUND))]);
        static WALL = N.colorPaletteRandom("55,55,55\n57,57,57", N.random([new n(r.of(r.type8(r.TYPE_STATIC), r.behaviour8(0), r.modifiers8(r.HMI_CONDUCTIVE_1)), h.of(0, 0, 0, h.BLUR_TYPE_NONE, h.HEAT_EFFECT_2))]));
        static ROCK = N.join([N.random([new n(r.of(r.type8(r.type8Solid(r.TYPE_STATIC, 1, !1)), r.behaviour8(), r.modifiers8(r.HMI_CONDUCTIVE_1)), h.of(155, 155, 155, h.BLUR_TYPE_NONE, h.HEAT_EFFECT_2))]), N.colorNoise([{
            seed: 40,
            factor: 60,
            threshold: .4,
            force: .9
        }, {
            seed: 41,
            factor: 30,
            threshold: .4,
            force: .9
        }, {
            seed: 42,
            factor: 15,
            threshold: .4,
            force: .5
        }, {
            seed: 43,
            factor: 3,
            threshold: .1,
            force: .1
        }], 79, 69, 63), N.colorNoise([{
            seed: 51,
            factor: 30,
            threshold: .4,
            force: .9
        }, {
            seed: 52,
            factor: 15,
            threshold: .4,
            force: .5
        }, {
            seed: 53,
            factor: 3,
            threshold: .1,
            force: .1
        }], 55, 48, 46), N.colorNoise([{
            seed: 61,
            factor: 30,
            threshold: .4,
            force: .9
        }, {
            seed: 62,
            factor: 15,
            threshold: .4,
            force: .5
        }, {
            seed: 63,
            factor: 3,
            threshold: .1,
            force: .1
        }], 33, 29, 28)]);
        static METAL = N.join([N.random([new n(r.of(r.type8(r.type8Solid(r.TYPE_STATIC, 2, !1)), r.behaviour8(), r.modifiers8(r.HMI_METAL)), h.of(155, 155, 155, h.BLUR_TYPE_NONE, h.HEAT_EFFECT_3))]), N.colorNoise([{
            seed: 40,
            factor: 40,
            threshold: .4,
            force: .75
        }, {
            seed: 40,
            factor: 20,
            threshold: .5,
            force: .4
        }, {
            seed: 40,
            factor: 10,
            threshold: .4,
            force: .2
        }, {
            seed: 40,
            factor: 5,
            threshold: .4,
            force: .1
        }], 135, 135, 135), N.colorNoise([{
            seed: 41,
            factor: 10,
            threshold: .4,
            force: .4
        }, {
            seed: 41,
            factor: 6,
            threshold: .3,
            force: .3
        }, {
            seed: 41,
            factor: 4,
            threshold: .5,
            force: .3
        }], 130, 130, 130)]);
        static METAL_MOLTEN = N.join([ie.METAL, N.temperature(180), N.molten()]);
        static SAND = N.colorPaletteRandom("214,212,154\n214,212,154\n214,212,154\n214,212,154\n225,217,171\n225,217,171\n225,217,171\n225,217,171\n203,201,142\n203,201,142\n203,201,142\n203,201,142\n195,194,134\n195,194,134\n218,211,165\n218,211,165\n223,232,201\n186,183,128", N.custom(((e, t, i) => {
            const s = i.nextInt(100) < 60 ? r.TYPE_POWDER : r.TYPE_POWDER_WET,
                a = r.of(r.type8Powder(s, 6), r.behaviour8(), r.modifiers8(r.HMI_CONDUCTIVE_2)),
                o = h.of(0, 0, 0, h.BLUR_TYPE_1, h.HEAT_EFFECT_2);
            return new n(a, o)
        })));
        static SOIL = N.colorPaletteRandom("142,104,72\n142,104,72\n142,104,72\n142,104,72\n142,104,72\n142,104,72\n114,81,58\n114,81,58\n114,81,58\n114,81,58\n114,81,58\n114,81,58\n82,64,30\n82,64,30\n82,64,30\n177,133,87\n177,133,87\n177,133,87\n102,102,102", N.custom(((e, t, i) => {
            const s = i.nextInt(100) < 40 ? r.TYPE_POWDER : r.TYPE_POWDER_WET,
                a = r.of(r.type8Powder(s, 5), r.behaviour8(r.BEHAVIOUR_SOIL), r.modifiers8(r.HMI_CONDUCTIVE_1)),
                o = h.of(0, 0, 0, h.BLUR_TYPE_1, h.HEAT_EFFECT_1);
            return new n(a, o)
        })));
        static GRAVEL = N.colorPaletteRandom("97,94,88\n111,110,106\n117,116,112\n117,117,113\n120,118,115\n104,102,97\n113,112,107\n129,128,125\n124,124,121\n81,80,75\n80,76,69\n123,119,111\n105,104,99\n84,82,78\n77,74,69\n91,88,82\n68,65,60\n79,75,69\n85,82,77\n98,94,88\n105,102,96\n104,97,86\n60,55,47\n93,89,81", N.custom(((e, t, i) => {
            const s = i.nextInt(100) < 20 ? r.TYPE_POWDER : r.TYPE_POWDER_WET,
                a = r.of(r.type8Powder(s, 3), r.behaviour8(), r.modifiers8(r.HMI_CONDUCTIVE_2)),
                o = h.of(0, 0, 0, h.BLUR_TYPE_1, h.HEAT_EFFECT_2);
            return new n(a, o)
        })));
        static COAL = N.colorPaletteRandom("31,31,31\n46,44,41\n13,13,13\n17,17,15", N.custom(((e, t, i) => {
            const s = i.nextInt(100) < 40 ? r.TYPE_POWDER : r.TYPE_POWDER_WET,
                a = r.of(r.type8Powder(s, 4), r.behaviour8(), r.modifiers8(r.HMI_COAL)),
                o = h.of(0, 0, 0, h.BLUR_TYPE_1, h.HEAT_EFFECT_2, 3);
            return new n(a, o)
        })));
        static THERMITE = N.colorPaletteRandom("137,86,89\n137,86,89\n137,86,89\n137,86,89\n137,86,89\n137,86,89\n125,70,72\n125,70,72\n147,93,96\n147,93,96\n138,84,86\n138,84,86\n118,72,75\n118,72,75\n101,61,65\n151,104,106", N.custom(((e, t, i) => {
            const s = i.nextInt(100) < 60 ? r.TYPE_POWDER : r.TYPE_POWDER_WET,
                a = r.of(r.type8Powder(s, 5), r.behaviour8(), r.modifiers8(r.HMI_THERMITE)),
                o = h.of(0, 0, 0, h.BLUR_TYPE_1, h.HEAT_EFFECT_2, 3);
            return new n(a, o)
        })));
        static WATER = N.colorPaletteRandom("4,135,186\n5,138,189", N.random([new n(r.of(r.type8Fluid(r.TYPE_FLUID), r.behaviour8(r.BEHAVIOUR_WATER), r.modifiers8(r.HMI_CONDUCTIVE_3)), h.of(0, 0, 0, h.BLUR_TYPE_1, h.HEAT_EFFECT_NONE))]));
        static STEAM = N.colorPaletteRandom("147,182,217\n163,188,212", N.random([new n(r.of(r.type8Fluid(r.TYPE_GAS), r.behaviour8(r.BEHAVIOUR_WATER), r.modifiers8(r.HMI_CONDUCTIVE_3)), h.of(0, 0, 0, h.BLUR_TYPE_1, h.HEAT_EFFECT_NONE))]));
        static GRASS = N.random([new n(r.of(r.type8Powder(r.TYPE_POWDER, 0), r.behaviour8(r.BEHAVIOUR_GRASS, 5), r.modifiers8(r.HMI_GRASS_LIKE)), h.of(56, 126, 38, h.BLUR_TYPE_1, h.HEAT_EFFECT_1)), new n(r.of(r.type8Powder(r.TYPE_POWDER, 0), r.behaviour8(r.BEHAVIOUR_GRASS, 3), r.modifiers8(r.HMI_GRASS_LIKE)), h.of(46, 102, 31, h.BLUR_TYPE_1, h.HEAT_EFFECT_1)), new n(r.of(r.type8Powder(r.TYPE_POWDER, 0), r.behaviour8(r.BEHAVIOUR_GRASS, 4), r.modifiers8(r.HMI_GRASS_LIKE)), h.of(72, 130, 70, h.BLUR_TYPE_1, h.HEAT_EFFECT_1))]);
        static TREE = N.colorPaletteRandom(re, N.custom(((e, t, i) => {
            let s = i.nextInt(ne.TREE_TRUNK_TEMPLATES.length);
            return new n(r.of(r.type8(r.type8Solid(r.TYPE_STATIC, 3)), r.behaviour8(r.BEHAVIOUR_TREE, s), r.modifiers8(r.HMI_WOOD_LIKE)), h.of(0, 0, 0, h.BLUR_TYPE_NONE, h.HEAT_EFFECT_1))
        })));
        static TREE_ROOT = N.colorPaletteRandom("75,54,31\n67,53,38", N.random([new n(r.of(r.type8(r.type8Solid(r.TYPE_STATIC, 3)), r.behaviour8(r.BEHAVIOUR_TREE_ROOT, 8), r.modifiers8(r.HMI_WOOD_LIKE)), h.of(0, 0, 0, h.BLUR_TYPE_NONE, h.HEAT_EFFECT_1)), new n(r.of(r.type8(r.type8Solid(r.TYPE_STATIC, 3)), r.behaviour8(r.BEHAVIOUR_TREE_ROOT, 5), r.modifiers8(r.HMI_WOOD_LIKE)), h.of(0, 0, 0, h.BLUR_TYPE_NONE, h.HEAT_EFFECT_1))]));
        static TREE_WOOD = N.colorPaletteRandom("133,108,80\n124,97,67", N.random([new n(r.of(r.type8(r.type8Solid(r.TYPE_STATIC, 3)), r.behaviour8(r.BEHAVIOUR_TREE_TRUNK, 0), r.modifiers8(r.HMI_WOOD_LIKE)), h.of(0, 0, 0, h.BLUR_TYPE_NONE, h.HEAT_EFFECT_1))]));
        static TREE_WOOD_DARK = N.colorPaletteRandom(re, N.random([new n(r.of(r.type8(r.type8Solid(r.TYPE_STATIC, 3)), r.behaviour8(r.BEHAVIOUR_TREE_TRUNK, 0), r.modifiers8(r.HMI_WOOD_LIKE)), h.of(0, 0, 0, h.BLUR_TYPE_NONE, h.HEAT_EFFECT_1))]));
        static TREE_LEAF_LIGHTER = N.colorPaletteRandom("128,137,79\n128,137,79\n128,137,79\n128,137,79\n128,137,79\n141,149,91\n141,149,91\n117,128,71\n99,110,65\n111,123,68\n121,132,73\n111,123,74", N.random([new n(r.of(r.type8(r.type8Solid(r.TYPE_STATIC, 3)), r.behaviour8(r.BEHAVIOUR_TREE_LEAF, 0), r.modifiers8(r.HMI_LEAF_LIKE)), h.of(0, 0, 0, h.BLUR_TYPE_NONE, h.HEAT_EFFECT_1))]));
        static TREE_LEAF_DARKER = N.colorPaletteRandom("74,86,47\n74,86,47\n74,86,47\n74,86,47\n68,77,40\n68,77,40\n68,77,40\n70,82,42\n70,82,42\n70,82,42\n72,82,46\n72,82,46\n78,90,48\n78,90,48\n95,106,60\n88,100,57\n66,74,36\n66,67,35\n76,87,52\n86,100,53\n75,89,47", N.random([new n(r.of(r.type8(r.type8Solid(r.TYPE_STATIC, 3)), r.behaviour8(r.BEHAVIOUR_TREE_LEAF, 0), r.modifiers8(r.HMI_LEAF_LIKE)), h.of(0, 0, 0, h.BLUR_TYPE_NONE, h.HEAT_EFFECT_1))]));
        static #pe = r.of(r.type8(r.TYPE_EFFECT), r.behaviour8(r.BEHAVIOUR_FIRE, 0));
        static FIRE = N.random([new n(r.setTemperature(ie.#pe, 255), h.of(249, 219, 30)), new n(r.setTemperature(ie.#pe, 255), h.of(249, 219, 30)), new n(r.setTemperature(ie.#pe, 120), h.of(249, 219, 30))]);
        static ASH = N.colorPaletteRandom("131,131,131\n131,131,131\n131,131,131\n131,131,131\n131,131,131\n131,131,131\n135,135,135\n135,135,135\n135,135,135\n135,135,135\n135,135,135\n135,135,135\n145,145,145\n145,145,145\n145,145,145\n145,145,145\n145,145,145\n145,145,145\n148,148,148\n148,148,148\n148,148,148\n148,148,148\n148,148,148\n148,148,148\n160,160,160\n160,160,160\n160,160,160\n160,160,160\n160,160,160\n160,160,160\n114,114,114\n193,193,193", N.custom(((e, t, i) => {
            const s = i.nextInt(100) < 80 ? r.TYPE_POWDER : r.TYPE_POWDER_WET,
                a = r.of(r.type8Powder(s, 6), r.behaviour8(), r.modifiers8(r.HMI_CONDUCTIVE_2)),
                o = h.of(0, 0, 0, h.BLUR_TYPE_1, h.HEAT_EFFECT_2, 3);
            return new n(a, o)
        })));
        static METEOR = N.random([new n(r.of(r.type8(r.TYPE_STATIC), r.behaviour8(r.BEHAVIOUR_METEOR, 0)), h.of(249, 219, 30))]);
        static METEOR_FROM_LEFT = N.random([new n(r.of(r.type8(r.TYPE_STATIC), r.behaviour8(r.BEHAVIOUR_METEOR, 2)), h.of(249, 219, 30))]);
        static METEOR_FROM_RIGHT = N.random([new n(r.of(r.type8(r.TYPE_STATIC), r.behaviour8(r.BEHAVIOUR_METEOR, 4)), h.of(249, 219, 30))]);
        static EFFECT_BURNT = N.custom(((e, t, r, i) => {
            if (T.isVisualBurnApplicable(i.elementHead)) {
                if (h.getBurntLevel(i.elementTail) < 3) return new n(i.elementHead, T.visualBurn(i.elementTail, 1))
            }
            return null
        }));
        static EFFECT_NOISE_LG = N.colorNoise({
            seed: 0,
            factor: 40,
            threshold: .5,
            force: .25
        });
        static EFFECT_NOISE_MD = N.colorNoise({
            seed: 0,
            factor: 10,
            threshold: .5,
            force: .25
        });
        static EFFECT_NOISE_SM = N.colorNoise({
            seed: 0,
            factor: 4,
            threshold: .5,
            force: .25
        });
        static EFFECT_TEMP_0 = N.temperature(0);
        static EFFECT_TEMP_127 = N.temperature(127);
        static EFFECT_TEMP_200 = N.temperature(200);
        static EFFECT_TEMP_255 = N.temperature(255);
        static EFFECT_WET = N.custom(((e, t, i, s) => {
            if (null !== s) {
                if (r.getTypeClass(s.elementHead) === r.TYPE_POWDER) {
                    const e = r.setTypeClass(s.elementHead, r.TYPE_POWDER_WET);
                    return new n(e, s.elementTail)
                }
                return s
            }
            return null
        }));
        static EFFECT_MOLTEN = N.molten();
        static EFFECT_EXTINGUISH = N.extinguished();
        static _LIST = {
            none: ie.NONE,
            air: ie.AIR,
            ash: ie.ASH,
            sand: ie.SAND,
            soil: ie.SOIL,
            gravel: ie.GRAVEL,
            wall: ie.WALL,
            rock: ie.ROCK,
            metal: ie.METAL,
            metal_molten: ie.METAL_MOLTEN,
            wood: ie.TREE_WOOD,
            water: ie.WATER,
            steam: ie.STEAM,
            grass: ie.GRASS,
            tree: ie.TREE,
            tree_wood: ie.TREE_WOOD,
            tree_wood_dark: ie.TREE_WOOD_DARK,
            tree_leaf: ie.TREE_LEAF_LIGHTER,
            tree_leaf_dark: ie.TREE_LEAF_DARKER,
            tree_root: ie.TREE_ROOT,
            fire: ie.FIRE,
            meteor: ie.METEOR,
            meteor_l: ie.METEOR_FROM_LEFT,
            meteor_r: ie.METEOR_FROM_RIGHT,
            effect_temp_0: ie.EFFECT_TEMP_0,
            effect_temp_127: ie.EFFECT_TEMP_127,
            effect_temp_200: ie.EFFECT_TEMP_200,
            effect_temp_255: ie.EFFECT_TEMP_255,
            effect_burnt: ie.EFFECT_BURNT,
            effect_wet: ie.EFFECT_WET,
            effect_molten: ie.EFFECT_MOLTEN,
            effect_extinguished: ie.EFFECT_EXTINGUISH
        };
        static byCodeName(e) {
            const t = ie._LIST[e];
            return void 0 !== t ? t : null
        }
    }
    class se {
        static ROCK_SM = {
            info: {
                displayName: "Small Rock",
                category: "template",
                icon: {
                    imageData: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAAwCAYAAAChS3wfAAAACXBIWXMAAAsTAAALEwEAmpwYAAADaUlEQVRoQ+2WO28cRQCAv5l93p69do5zTsQFBkehiJBRhKAxSNBRUCSFqfgBNEgRoqBLmS4lFIiKBv8BuiChoGBCZBxjiBDGTmHs6OLHPbzv2aEgAXtpswvS7tftp5mR5tPM7prUHLMo6kYToCjqRhOgKOpGE6Ao6kYToCjqRhOgKOpGE6Ao6kYToCjKZunKOzrNQhA5bW8Cr91hZeUOa+sboji2CioN8Mbrr+ooHpGpFKUihsMhz81N0eudYwH0fxGh1ADLy8v20tJS8uRZ6pzx8QgpQUqNEHCw36fddnl+bp619Y2T0yuh1AAnN3/t2kcvf3/7O5I0QqmUOEnIlSQYP8Sf7JDnioWXLlZ+CkoNcJJHu/3VVy5d4v79n+n3+xgYJGGCSlP8mWc5ODpiZrpTnFY6lQUYj0b4/gRtb5IDeYRKwRQSAcRhhFYKAby1uKhv3rpV2SmoLECWZQTBMVPTU+zs7JKoFNOw0TJjPBqQCxACkiyt9CpUFsBtuYxGI3q9cxhCkOcKyzCRQhBGEU7LRWuNlJIz/nRxemlUEuC9d69oISTBccDho31c1yUcB6gsQxqSluOgtCZOEjrdswzHo8pOQSUBTNOk232GJAwxDEm322VvZxdpSAwMAIQQQE6mUkzLYn6+ms9iJQEMNG3Xw3Ud0jjCtW0mJlpkSqMSdWpsFEW4XovNzc1TvixKD/Dxhx/o33/7Fa0z8lwRBSFZlnG212NwNGSYjP4eKzTEQUDb8+hMTvPJjRtz71+9uv3Pak+f0gOs3f2BbrfDvdV1ZmdnsaRNFEVYloNpOgRRH8txCIKILMtwWi2ODg4ZByGffv7ZFlDqe6D0APuHAzzPJQgitra3iOMYlWX4/jSDwQDf97FtmzCMkaaJ1jlCmOR5zr31X0rdPFQQYGVtQwAa4Pz5F3BTxfaDBxiWQxBHoCVBnBAEAa7XwnJamIaN7Xp8df363NuXL2+fXvHpUnoA+CvCm4uL+o+HhwB4Ez5KC6RpEccxpjBxvRYzMz329vrc/em2ALj57Ten1imDSgIAfP349/a1hYvamzxDloNpuxiWQxzHvHjhAl98uVz6kS9SWYAnPL4S/+LO6o9FVQmVB/i/0QQoirrRBCiKutEEKIq60QQoirrRBCiKutEEKIq60QQoirrxJ1JCV8S5Z+TMAAAAAElFTkSuQmCC"
                }
            },
            action: {
                type: "random-template",
                actions: [{
                    type: "image-template",
                    imageData: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAATCAYAAACdkl3yAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC7UlEQVQ4T62UPW9cRRiFn5k793Pt682yzoq4wOAoFBEyihA0Bgk6CoqkMBU/gAYpQhR0KdOlhAJRpcF/gC5IKCiYEBnHGCKEsVMYO9rY3t27vp8zdyjAa6+ddJzyaM6j94zeGcX/JHXaAFi89oGtdAaiphFNEDVaLC/fZ3VtXZw+e6QzoHfeftPmRYI2FcbkDAYDXpqdotO5wDzY58HU0tKSt7i4WB4Z0tYMDxOkBCktQsD+XpdGI+Dl2TlW19ZP5kdSJyE3bnz2+k/3fqSscoypKMqS2kjS4RPiyRZ1bZh/7fIzpxqr9nSnu/LGlSs8evQb3W4XB4cyKzFVRTz9Ivu9HtPN1snISGOgYZIQxxM0okn2ZQ9TgRISARRZjjUGAby3sGDv3L07NtUYSGtNmh4y1Zxie3uH0lQox8NKzTDpUwsQAkpdnak4BgrCgCRJ6HQu4AhBXRtcRyGFIMtz/DDAWouUknNx82T0GPTRh9esEJL0MOXg6R5BEJANU4zWSEcS+j7GWoqypNU+z2CYjE01AimlaLdfoMwyHEfSbrfZ3d5BOhIHBwAhBFCjTYVyXebmjtdhBHKwNIKIIPCpipzA85iYCNHGYkpzdAyAPM8JopCNjY2RpwA+//QT+9eff2Ctpq4NeZqhteZ8p0O/N2BQJqOAsFCkKY0oojXZ5Itbt2Y/vn59SwGsPviZdrvFw5U1ZmZmcKVHnue4ro9SPmnexfV90jRHa40fhvT2DximGV9+/dUmIBTA3kGfKApI05zNrU2KosBoTRw36ff7xHGM53lkWYFUCmtrhFDUdc3Dtd+PL3t5dV0AFuDixVcIKsPW48c4rk9a5GAlaVGSpilBFOL6Icrx8IKIb2/enH3/6tV/qx3B3l1YsH8/OQAgmogxViCVS1EUKKEIopDp6Q67u10e/HpPANz54Xvg1EJ+99/avzV/2UaT59A1KC/AcX2KouDVS5e4/c3SmQcLz/iPYFT1jO6v/HLaGukfK6ZXUFEV3tAAAAAASUVORK5CYII=",
                    brush: "rock",
                    threshold: 50,
                    randomFlipHorizontally: !0
                }, {
                    type: "image-template",
                    imageData: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAALCAYAAACQy8Z9AAAACXBIWXMAAAsTAAALEwEAmpwYAAAB6klEQVQoU7WSzU4TURiGnzNz5qfTMkEMaFkg0XgXbePCcAWscKXeSG+GRAVvgLgw6J4ASwKr0kCBTmf6M2dmzum4aKhQY1z57M57zvfkTb4j+Q/IxWCRVqNZKjVmefkJtVqVMAzR2lAUOZ/3vorF9/AXaavRLAE8zyHPc4SwiOOYm5sbpLSZ3Xm0Gs1yOIw5Oj55JJ9LW41m+XRlhSxP0dpgjKYoCqS08TwPYzSTyexs25KyLBkOY+r15xwdnzx0zqT3zZIkQTqzJq7rYts2taDKZDxmkqYk05hBP8KREum52LYkSRLetJrl98Mf87YSYL1eZ5KmZFnG0lIVAK0LsixDKYXruqyurvJsbY1Op0OeF0yyFKUUWhcEQZWtrbflwcE3MZcCVHwfKW3G4xFhGOJ5NaR02NzYoNPpcHnZpdfrkRc5QgiwBI4jUUohhCBKBrx++ao8uzgXEuDT3hfx8f2HsuL75IUiDEOMmTIYRJyenNLrXSOEhTaaqTEIYSGwwALf99HaUA2qjOIRj5qqPGNj8wXRXZ9u94rrq2uGoyFRPyKoBjjSwbZsUpUDhnc7O3a73Z7ezz9kLt3d3RXb29ulyQtu726pVAKifkR9fZ3Dn7+XcE+73V6M5jz6p/v7+38Mn12cL0b/5Bf4ONku8uljuAAAAABJRU5ErkJggg==",
                    brush: "rock",
                    threshold: 50,
                    randomFlipHorizontally: !0,
                    randomFlipVertically: !0
                }, {
                    type: "image-template",
                    imageData: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAASCAYAAABfJS4tAAAACXBIWXMAAAsTAAALEwEAmpwYAAADFklEQVQ4T7XUz2ucRRzH8fc8z+zMs88++yvG1GRrhUKLWOKhxTZYqeBBinrwUr34X4l4lyLoqQcFxZLakJb+sF7ExkAuSmh2m/3R7JN95vk9HpYkVkJsDn6Ow3xfDDMfRvI/Rf574ahceuuiPTH/Ckop4shQrwdsbm4CMBgMefzHmtjb+0LwtWvXrNaa4XafJEkYDQakacZoOMSVEsdxmJubY2Fh3t5cXhZwCHz50kWrtQZgYhLuP3wgJuMQ/ZICYH7uBOrkqxRZxsbGBtJxMcagqh5PnmztO/vwB1fftzWvSmQMVc9DCMG8Upx7/awd7jxjNwyx1rKzs4MrJVpKTp16jbW1NVrtFiaOcR2HxTfO2d8e/y4kTO9u1B8Sex5SCl6eaSOEi+/7rK+vI5XCWovWinD8jLIsGQwGaK1pNAPKMqe0lloQYK09OHEYhniug680eZLxtNslTQsAlFK4rkteFNRrAXFkyPJ8OuxKhBCEYYiu+vh+jTiOD+A3Fxfpd7fob/XwfR+bQxD4AGitkLoCgC1yZmfaJFlKq9HEdV1MmlD1PIKgxqDfx1XTvRKg2+sx6j2l3WphjKEoCiITAyVe1SOODMJ1sNbSarWZnZ1lYmKstRSjEYXOUUpRlCVSTBsnAX5euS3eu3zFRvEuwquw8ugXcfXKuzbcDTFJhhCCdr3O9vY2Qgji2JDlGdJ1SbOYWuCTJAnNZpOFkx1W7947aMXynZX9cgP8sHJbLF04b+M4RimF79c4fbrOeDwmtwWeVyUIakRJTKfT4c7qXc6cOctX178+vMf/zL1Hv4qlC+dtsyIZ704QQiCES7PeJM9z/vpzk6DZoLvVo9Fu41Tc/dkjYTjApZQsdDoUZUGcJoQ7YxzHwUSGSTSZVq/R2J/7Txim+GeffmK7vS6TKMJxHMqyxHEcsjTFcVzaszN8/sWXx/srAK5/8634+KMPbUVWSNOUNEuxpUVrjTERt26sPvdGLwwD3Pjue/HO20tWCEHQaLAzHHJr9XlwL8eCAbKsRCmXH3+6eSi4l2PD9x8+OBLcy99QElUk8fCpxwAAAABJRU5ErkJggg==",
                    brush: "rock",
                    threshold: 50,
                    randomFlipHorizontally: !0
                }]
            }
        };
        static ROCK_MD = {
            info: {
                displayName: "Medium Rock",
                category: "template",
                icon: {
                    imageData: "data:image/png;base64,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"
                }
            },
            action: {
                type: "random-template",
                actions: [{
                    type: "image-template",
                    imageData: "data:image/png;base64,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",
                    brush: "rock",
                    threshold: 50,
                    randomFlipHorizontally: !0
                }, {
                    type: "image-template",
                    imageData: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACoAAAAUCAYAAAD7s6+GAAAACXBIWXMAAAsTAAALEwEAmpwYAAAGYUlEQVRIS9XWW4jc5hnG8f/oOCNpjrvrnfEu6w3BdkJCsONCa0raJD1AoAE7JS49uE0CLTUmNFtyXdyb1BSHuL0p9KKmLKW5CCQ93ZS0DSTg1HbsTWx317U9Hu96jzOagzTSaD6NpF44WbxZt2nSQNvnSu8rIf34eKVPCv8nUd7f+Djy/UPfTgbxzeNiqcgPf/Tj1MYrPnw+NuhPn3/+idrFt08AhD2fpZVlogjmq7DvCw8n2XyO6Zde+cjgD4Se+NkLk08emqq9Vx858kxh8cKV1nt1Lj+MCAXVCzOYZoZCNoeqqWwtb6G+ZnNxbo5s1iLodtn/xc8lAC//8U8fGrwJ+qufv7DrjVf/fA6gMDxMbXYWIAVw+GuPJa3qErquE0URhqaiyQkFI4umaSCl0DWZtdUViqUSI8MF7t91D3NzlxmtlCkWh7lSvcojn92b5AslXvzNH/5tsALw9KHvJuOjWxB9jwsz71Aeq2AaJsQJlmXyg8NPJa1Wk7vu2km9Ued67TrFUhHiBDmV4LkdlHwePZOh3bRxnTZdz8XImsiKQqmUp91u0vVcJBmGhoo0mg32P/JgYuULTL/4wSOhAJTyBXRVYxD0SCXgez6O4+C7HlE0QNd1tm/fTrvdptVsYZoGqqIiJeC6Lpl0hiQFs3OzSEoK07JwvS5hLFir27g9H0WWMXNZ4hgGCaiaggj7XL58ib2fuDc5eebCv8QqAJqmkYoTVpdWWF6ZZ9u2CRaXVnG7LpUto4xWxrBbHebn57Ftm0KhgB8IhoeH0fQMlbFxVupr6KaFoiuEUYiRz7K6sgqaghppJElMIPr4fg9ZU5AlmUazgev2yFp5Hv7M3mRsbIzpX790W/DNFS0W7zjz5qlrTsem0epwY/mvjIyMICkqSUqi1w8BsHIFDCtLFA+4XruOrKpURkdZs236oaAwVCIQPfq9AcsLi3RcB0lSkGUFWZIYBCGyqqGpGhkjjW23UGQN13VpdVwcx+HTn7w/+dY3D+7+zuGpmU3QQ1NTta8feJyhSoV226bbcchoKjt27iAUAkmGVrNFFEdMbpvE7Xbw/S4Ne41BJFBVlaGhEkgp/nZxjn4UYrc6aKpGLmcQDWL8sI8Qgu077sRxHLpOH10zadSdmxBdIxyEdLs+vzjxy3Off/ABXn3t9fXVXX/rt4xtxXc6pA2DiYkJyuURLNOiulbFymaRlRRLC8uUSgVc1yWbtSiXywRBgKqqLCwtocgqW7aWmb04R1o3sHJ57rvnXsIwpNvz8TyPJJYR/RghBEEgyOcLtFpNen4PVVFJkoR2u0MUxTyw91PJ6yffTG2ATkxMPnT+7Om/jIyMsLwwTxjGSJJCpVym3+8DUClvJegJFFnFMnOk02lAwvd8xraO43sB128sYNttMpZBJm1w9eo1VE1D13V0RUdRVDRFR/QEcZjQCwLSaYMoSej1+siyTLFY5OTpsxtmdR06NTX12hPf+CqqIhPHEfV6nSSJKRSKpFIJzWaTsbExJFnCMi2iaIDjdBFCoKgatt1GlhTWVhvk80X6oSCTMdF1HUmSiKOYQRzRaDSw7SZCCDyvi6yq9Pt9NE2jUChwZuZ8iqu1W4g3s+GDv2fPnv1vnXzj5XK5QhiG1Ot1oigmlyuQzeZ55+3z3Ld7F67nE8cxYhDhdD08z2dychtXqjWC3gAja9JxuzSbHYJAMBhEJEkCwOrqCoaRAcA0LYQYICMTiYgv7fuyeWbm/K2k9WyAPj317CtPfeUxMpaJaVpomkaj0SSOoVqtMj4+ju/3cJwuq6sr+J5PFMekZIkbS8sIMUA3TCYn76TXE4RCsNzpkE6nCYVAUWWCXkAcvfvHAhw48Pju544fnwE4cuTIev/92bSFjo6Osrwwj223yefzbJuYwLQsOm2XMIq5Ur1GKiWj6RmGRkYJgoC206Hd6eB5Puko4fTZt9BUFc/zEEKAlCIKQ0QI8436htl77vjxW8t/mk3QHXfvuGNhYeFarjSE3WwShiHtS3/HUHUG/ZDa4iLZrEWxWOL3v/3d+kN3370zMS0DgFQQ8+i+fQ+hKLWjR4/Wlmx7/f4fNZugTx6aqj37zPc4feoUmYxBSpJpNts03z1/aX7htjvHudlLG/pHjx27tfyPswkKcOz4T1IHDx5Mpqenb4v6b+S2UID/JSTAPwB2TvQFACDmHAAAAABJRU5ErkJggg==",
                    brush: "rock",
                    threshold: 50,
                    randomFlipHorizontally: !0,
                    randomFlipVertically: !0
                }, {
                    type: "image-template",
                    imageData: "data:image/png;base64,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",
                    brush: "rock",
                    threshold: 50,
                    randomFlipHorizontally: !0,
                    randomFlipVertically: !0
                }, {
                    type: "image-template",
                    imageData: "data:image/png;base64,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",
                    brush: "rock",
                    threshold: 50,
                    randomFlipHorizontally: !0,
                    randomFlipVertically: !0
                }, {
                    type: "image-template",
                    imageData: "data:image/png;base64,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",
                    brush: "rock",
                    threshold: 50,
                    randomFlipHorizontally: !0
                }, {
                    type: "image-template",
                    imageData: "data:image/png;base64,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",
                    brush: "rock",
                    threshold: 50,
                    randomFlipHorizontally: !0,
                    randomFlipVertically: !0
                }]
            }
        };
        static ROCK_LG = {
            info: {
                displayName: "Large Rock",
                category: "template",
                icon: {
                    imageData: "data:image/png;base64,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"
                }
            },
            action: {
                type: "random-template",
                actions: [{
                    type: "image-template",
                    imageData: "data:image/png;base64,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",
                    brush: "rock",
                    threshold: 50
                }, {
                    type: "image-template",
                    imageData: "data:image/png;base64,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",
                    brush: "rock",
                    threshold: 50,
                    randomFlipHorizontally: !0
                }]
            }
        };
        static CABIN = {
            info: {
                displayName: "Cabin",
                category: "template"
            },
            action: {
                type: "image-template",
                imageData: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC4AAAAkCAYAAAD2IghRAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAFcUlEQVRYR82Y3W4TRxTHf7vetb2Osd2AY18kogqpKkETSC7sUEEAqep9L7jhEfoYfYA+BqqUN6hUKNyUQgnioxcVigOqIR84ITHGG3u9M73YzHr9tXZIgP5udj1n9sx/Zs7MmbHBR2Jp6YpsNBrEYjHu3r2jdduPitFdcFQKhaKMRCIIITCjJq5wKRYXpXBdHvz14Ng6cGzCFxcvSiklZtRESsne3h5CCPSITjqdRkqDQqEodV3n3r0/Ojrww/ffyWjcwjRNIhqsr67x66NHoZ08kvCrV69JIQQArnABqO5VAZg91fDrPduuIqUkeSKJrutcvrwkTdPk1q3fNAApdVxNx2jYtAwTDc9nGB8k/NKly9JxHFzXE4sWFNwCXBJWEoBkMsY3bAMRnlZqaJpGOp2m6TQpFhclQHlnh7NGlpZpEDUMNEIHGzik8Pn5BRkxImi6hhk1/XDQNK1HcCrlPROWQa3mvc+eqgHw5I1A13VS6RS6piOiJk/WN4jHY3w1cRLDjDOMocILhaJ0HAdN00ilUriuy9udtwghuJCTgDfqSrAiYRnU7RZRa4x8zivb2PSec9kaEOHx1luklEQMgy8yGVzh8uzf9fZMhjBQ+MWL30p73yYej2NZFltbW+zv7wP4goNi1Qgr6nYLgN2dPb9M1UkmY9RqDc5PeDMAksdb28RiMVKpFFJKLlyYl/F4vGchK3qEFwpF2Wg2MAyDdCpNpVJBCMF8Xo1ChIRlkc9lfHGHRddN8jnLnwHgoBOCv3dcHMchm80ipGB2dk5alsX9+392dMAXfuXKVbm/v080GsWMmlSrVYQQnJ9wgHYo5HMZ9QmZ8bT/Dt7oqrLgSHfXU+RzELXGAGja79nY3OXcuFoH2+i6TjrjfVssLsp4PM6dO79rAEahUJQArutimIa/4OayLuAykT1JrdboEKxo2u+7i0YuUwQ7mM9l2Nj0QmmOXcDlaWUPNDiRSuEKl0KhKKUQGG6rhSsFTsvBaTrMZZu+I4CtN9sAlF6oePz41O12W7OnvBB9WqliRk2EK7xBfrjy0I+dG9fOyukvJ/2PwFtkCatnKXwG1rl5+4mvtUfRxubuwZTtAt60qWrK9qlRWoL0CK/btY6wqNs1tt607Z8yZDqJdPzqEa52j7ptk7CsLuunJaihbtsdth7h7TDpzV7BvTszng7dLRT9pnl03I6wDdIjPMigbAid21gY3T5GJWEZlF7UBia5UOFBNjY3uosAyOfy3UUjcVR/ocLVQSkznubnX/pfv3768WvZXaYyaPAJXnip95u3/wn1NywMQ4Urwpw07ff+dKqOQjuU1DNhGSOFl/I3LHeEWw8YFGfQaRu1Xhij1gsVHrXGiFrhCzFhGf5BKXjI6mbQAawfg3wECRUeDINB1O0WdbstJExUmC3I7s7e0UJlmOiPybC2Q4VXq7WRLwxqYQ4aqaBtmL+EZfRNOkH6t3JAKpUc2ohC1QurH2YLUrdb5HOZ0HNRqPDg9vZ/I1S42lUAblzrTTQw2g7Qj2H+wnIHDBEeTAbdFwxFdwIKI1hvFH9hhLd0wCiO4HjrDRuEcCsfHgqHYadSASA5ZnXc+sMYKnyYg+MgOda+sHS3l7AMqt7fkh30CC+9KPd9/1y0NQy4ui0tLcnGeBYpJeVymcnJSXRdR9O802epVOLMmTM4jkO5XGZqaopIxHOmaRpS9t0kBqL8qj9Ng5RKJaanpwFotVq8evWKqakprl8/J5eXlzU4ED4/Py+r1Srv3r1DSommabx8+RLw/ihSjp8/fw6AlJK1tTUOy8zMTMdAqM7qus7k5CSvX7/m9OnTzMzM4Louq6ur/rerq6vous7CwoJcWVnR/gMS6rip19cCIwAAAABJRU5ErkJggg==",
                brush: "wood",
                threshold: 50,
                randomFlipHorizontally: !0
            }
        };
        static SAND_CASTLE = {
            info: {
                displayName: "Sand Castle",
                category: "template"
            },
            action: {
                type: "image-template",
                imageData: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAAOCAIAAACtuNvgAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAB5UlEQVQoz1XPy04UURAG4Ko6t+6eGRkl0dGFLly5cOv7+AY+itEVCStDfBg1JhICbCQIiAmCc6FP97mXi9EJXZtK/sqXqkJmhv91/PktM7x49QaGdXm4x0pnZ5++fL1OaDM7P9xTciyFPjv4cNecfNsNXNq+db7bjP6x7193gm+ZgtYm39l/9OW9QIyu7RZXRCJEu87luuWcfAqCBI4m2S83rGqmSjYo+8RBCIopDpjSejJ9kktw3UKresNyDq1tkaCutr1bNM10wLgU2/8uIIiZVLVh3t4KIgAjuDeqRlSD33rf3c7n7B0i9N31yf7OOp9OtsfjSVOJ5eImINjuarDtwfaz7Nu2W6ZUtBzZdnV6sAfF5ZRzSYXTw9lzSiUgDdhq+ROZiFDryvteG/3j9Hz2eAqcYvKVHvlu7r1HMoMjjW6kFjFGH3pTVecXNyH4s4s5AxOqEJ2WtRSKsx8w26+8d1LKVLK1rTENQ/ZuRUjj5p5UCjAT4mRrNmBaGYGaGaaTR3XdWLtS0milS4JbO/fe9a6PzDEsTvd3AQCZ+ejTu7oaMRdEijGQaUK3ICRCAYBAzBliDve3Zi4scyopR/nr+CMAh9gJKQVr57sGBQNoo4Gxd50RlaxlA+M/y0sSJiUrSf0F+OQcr89DEA8AAAAASUVORK5CYII=",
                brush: "sand",
                threshold: 1
            }
        }
    }
    class ae {
        static #Ae(e, t) {
            const n = [];
            for (let r = 0; r < e.length; r++) {
                const [i, s] = e[r], [a, o] = t[r];
                i === a && s === o || n.push([
                    [i, s],
                    [a, o]
                ])
            }
            return n
        }
        static #fe(e) {
            const t = [];
            for (let n = 0; n < e.length; n++) t.push(ae.#Ae(e[n], e[n + 1 < e.length ? n + 1 : 0]));
            return t
        }
        static createCyclic(e) {
            const t = ae.#fe(e);
            let n = Number.MAX_VALUE,
                r = Number.MAX_VALUE,
                i = Number.MIN_VALUE,
                s = Number.MIN_VALUE;
            for (let t of e)
                for (let [e, a] of t) n = Math.min(n, e), r = Math.min(r, a), i = Math.max(i, e), s = Math.max(s, a);
            const a = [];
            for (let t of e) a.push(new oe(t, n, i, r, s));
            return new ae(e, a, t, n, i, r, s)
        }
        #Te;
        #Ce;
        #Re;
        #ye;
        #Se;
        #we;
        #ve;
        constructor(e, t, n, r, i, s, a) {
            this.#Te = e, this.#Ce = t, this.#Re = n, this.#ye = r, this.#Se = i, this.#we = s, this.#ve = a
        }
        getStates() {
            return this.#Te
        }
        getStatesCount() {
            return this.#Te.length
        }
        getMasks() {
            return this.#Ce
        }
        getTransitions() {
            return this.#Re
        }
        getMinX() {
            return this.#ye
        }
        getMaxX() {
            return this.#Se
        }
        getMinY() {
            return this.#we
        }
        getMaxY() {
            return this.#ve
        }
    }
    class oe {
        #ye;
        #Se;
        #we;
        #ve;
        #Ie;
        constructor(e, t, n, r, i) {
            this.#ye = t, this.#Se = n, this.#we = r, this.#ve = i;
            const s = Math.abs(t) + 1 + n,
                a = Math.abs(r) + 1 + i,
                o = new Uint8Array(s * a);
            for (const [t, n] of e) {
                o[t - this.#ye + s * (n - this.#we)] = 1
            }
            this.#Ie = o
        }
        matches(e, t) {
            if (e < this.#ye || t < this.#we || e > this.#Se || t > this.#ve) return !1;
            const n = Math.abs(this.#ye) + 1 + this.#Se,
                r = e - this.#ye + n * (t - this.#we);
            return 1 === this.#Ie[r]
        }
    }
    class le {
        static isElementFallingHeavy(e) {
            if (null === e) return !1;
            const t = r.getTypeClass(e);
            if (t === r.TYPE_POWDER || t === r.TYPE_POWDER_WET) return !0;
            if (t === r.TYPE_STATIC) {
                if (r.getBehaviour(e) === r.BEHAVIOUR_ENTITY) return !1;
                if (r.getTypeModifierSolidBodyId(e) > 0) return !0
            }
            return !1
        }
        static isElementLight(e) {
            if (null === e) return !1;
            return r.getTypeClass(e) <= r.TYPE_GAS
        }
        static isElementWater(e) {
            if (null === e) return !1;
            return r.getTypeClass(e) === r.TYPE_FLUID
        }
        static isElementEntity(e) {
            if (null === e) return !1;
            return r.getBehaviour(e) === r.BEHAVIOUR_ENTITY
        }
    }
    class he {
        getType() {
            throw "Not implemented"
        }
        getX() {
            throw "Not implemented"
        }
        getY() {
            throw "Not implemented"
        }
        isActive() {
            throw "Not implemented"
        }
        serialize() {
            throw "Not implemented"
        }
        initialize() {
            throw "Not implemented"
        }
        performBeforeProcessing() {
            throw "Not implemented"
        }
        performAfterProcessing() {
            throw "Not implemented"
        }
        extract(e, t, n) {
            throw "Not implemented"
        }
        paint(e, t, n, r) {
            throw "Not implemented"
        }
        countMaxBoundaries() {
            throw "Not implemented"
        }
    }
    class ce extends he {
        _elementArea;
        _random;
        _processorContext;
        _stateDefinition;
        _brush;
        _areaBoundary;
        _type;
        _iteration = 0;
        _x = 0;
        _y = 0;
        _waypoint = null;
        _state = 0;
        _stuck = 0;
        constructor(e, t, n, r, i) {
            super(), this._type = e, this._stateDefinition = n, this._brush = r, this._areaBoundary = 2 * (Math.abs(this._stateDefinition.getMinX() - this._stateDefinition.getMaxX()) + 1), this._elementArea = i.elementArea, this._random = i.random, this._processorContext = i.processorContext, void 0 !== t.iteration ? this._iteration = t.iteration : this._iteration = this._random.nextInt(this._stateDefinition.getStatesCount()), void 0 !== t.x && (this._x = t.x), void 0 !== t.y && (this._y = t.y), void 0 !== t.state ? this._state = t.state : this._state = this._random.nextInt(this._stateDefinition.getStatesCount()), void 0 !== t.stuck && (this._stuck = t.stuck)
        }
        _checkIsSpace(e) {
            throw "Not implemented"
        }
        performBeforeProcessing() {
            return -1 !== this._state
        }
        performAfterProcessing() {
            return -1 !== this._state
        }
        serialize() {
            return {
                entity: this._type,
                iteration: this._iteration,
                x: this._x,
                y: this._y,
                state: this._state,
                stuck: this._stuck
            }
        }
        getType() {
            return this._type
        }
        getX() {
            return this._x
        }
        getY() {
            return this._y
        }
        assignWaypoint(e, t) {
            this._waypoint = {
                x: e,
                y: t,
                stuck: 0
            }
        }
        unassignWaypoint() {
            this._waypoint = null
        }
        isActive() {
            return -1 !== this._state
        }
        initialize() {
            this.paint(this._x, this._y, this._elementArea, this._random)
        }
        _incrementState() {
            const e = this._x,
                t = this._y,
                n = this._stateDefinition.getTransitions()[this._state];
            let r = !0;
            for (const [
                    [i, s],
                    [a, o]
                ] of n)
                if (!this._elementArea.isValidPosition(e + i, t + s) || !this._checkIsSpaceAt(e + a, t + o)) {
                    r = !1;
                    break
                } if (r) {
                for (const [
                        [r, i],
                        [s, a]
                    ] of n) this._elementArea.swap(e + r, t + i, e + s, t + a);
                this._stuck = 0, this._state++, this._state === this._stateDefinition.getStates().length && (this._state = 0)
            } else this._stuck++
        }
        _moveRandom(e) {
            const t = this._random.nextInt(3) - 1,
                n = this._random.nextInt(3) - 1;
            return this._move(t, n, e)
        }
        _moveInWaypointDirection(e) {
            let t = this._waypoint.x - this._x,
                n = 0;
            t > 0 ? n += 1 : t < 0 && (n -= 1);
            let r = this._waypoint.y - this._y,
                i = 0;
            r > 0 ? i += 1 : r < 0 && (i -= 1);
            this._move(n, i, e) ? this._waypoint.stuck = 0 : this._waypoint.stuck++
        }
        _move(e, t, n) {
            const r = this._x,
                i = this._y,
                s = this.#Oe(r, i, e, t, n);
            if (null !== s) {
                const [e, t] = s;
                return this.#be(this._stateDefinition.getStates()[this._state], r, i, e, t), this._x = e, this._y = t, !0
            }
            return !1
        }
        #Oe(e, t, n, r, i) {
            if (e + n < this._areaBoundary && n < 0 && (n = 0), e + n > this._elementArea.getWidth() - this._areaBoundary && n > 0 && (n = 0), t + r < this._areaBoundary && r < 0 && (r = 0), t + r > this._elementArea.getHeight() - this._areaBoundary && r > 0 && (r = 0), 0 === n && 0 === r) return null;
            if (n > 0 || n < 0)
                for (let s = this._stateDefinition.getMinY() - i; s <= this._stateDefinition.getMaxY() + i; s++)
                    if (!this._checkIsSpaceAt(e + 5 * n, t + r + s)) {
                        n = 0;
                        break
                    } if (r > 0 || r < 0)
                for (let s = this._stateDefinition.getMinX() - i; s <= this._stateDefinition.getMaxX() + i; s++)
                    if (!this._checkIsSpaceAt(e + n + s, t + 5 * r)) {
                        r = 0;
                        break
                    } if (0 === n && 0 === r) return null;
            const s = this._stateDefinition.getMasks()[this._state];
            for (const [i, a] of this._stateDefinition.getStates()[this._state])
                if (s.matches(n + i, r + a));
                else if (!this._checkIsSpaceAt(e + n + i, t + r + a)) return null;
            return [e + n, t + r]
        }
        _moveForced(e, t) {
            const n = this._x,
                r = this._y,
                i = this.#Me(n, r, e, t);
            if (null !== i) {
                const [e, t] = i;
                return this.#be(this._stateDefinition.getStates()[this._state], n, r, e, t), this._x = e, this._y = t, !0
            }
            return !1
        }
        #Me(e, t, n, i) {
            if (e + n < 0 && n < 0 && (n = 0), e + n > this._elementArea.getWidth() && n > 0 && (n = 0), t + i < 0 && i < 0 && (i = 0), t + i > this._elementArea.getHeight() && i > 0 && (i = 0), 0 === n && 0 === i) return null;
            for (const [s, a] of this._stateDefinition.getStates()[this._state]) {
                const o = e + s + n,
                    l = t + a + i,
                    h = this._elementArea.getElementHeadOrNull(o, l);
                if (null === h) return null;
                if (r.getBehaviour(h) !== r.BEHAVIOUR_ENTITY && r.getTypeClass(h) > r.TYPE_FLUID) return null
            }
            return [e + n, t + i]
        }
        _checkIsSpaceAt(e, t) {
            const n = this._elementArea.getElementHeadOrNull(e, t);
            return null !== n && this._checkIsSpace(n)
        }
        #be(e, t, n, r, i) {
            const s = [...e];
            r > t ? s.sort(((e, t) => t[0] - e[0])) : r < t && s.sort(((e, t) => e[0] - t[0])), i > n ? s.sort(((e, t) => t[1] - e[1])) : i < n && s.sort(((e, t) => e[1] - t[1]));
            for (const [e, a] of s) this._elementArea.swap(t + e, n + a, r + e, i + a)
        }
        _kill() {
            const e = this._x,
                t = this._y;
            for (const [n, i] of this._stateDefinition.getStates()[this._state]) {
                const s = e + n,
                    a = t + i,
                    o = this._elementArea.getElementHeadOrNull(s, a);
                if (null === o) continue;
                if (r.getBehaviour(o) !== r.BEHAVIOUR_ENTITY) continue;
                let l = o;
                l = r.setType(l, r.type8Solid(r.TYPE_STATIC, 4, !0)), l = r.setBehaviour(l, r.BEHAVIOUR_NONE), l = r.setSpecial(l, 0), this._elementArea.setElementHead(s, a, l)
            }
            return this._state = -1, !1
        }
        paint(e, t, n, r) {
            for (const [i, s] of this._stateDefinition.getStates()[this._state]) {
                const a = e + i,
                    o = t + s;
                if (!n.isValidPosition(a, o)) continue;
                const l = this._brush.apply(i, s, r);
                n.setElement(a, o, l)
            }
        }
        extract(e, t, n) {
            const i = this._x,
                s = this._y,
                a = [];
            for (const [t, n] of this._stateDefinition.getStates()[this._state]) {
                const o = i + t,
                    l = s + n,
                    h = this._elementArea.getElementHeadOrNull(o, l);
                if (null === h) continue;
                if (r.getBehaviour(h) !== r.BEHAVIOUR_ENTITY) continue;
                const c = this._elementArea.getElementTail(o, l);
                a.push(new V(o, l, h, c)), this._elementArea.setElement(o, l, e)
            }
            const o = this.serialize();
            return o.x -= t, o.y -= n, this._state = -1, [o, a]
        }
        countMaxBoundaries() {
            return [Math.abs(this._stateDefinition.getMinX() - this._stateDefinition.getMaxX()) + 1, Math.abs(this._stateDefinition.getMinY() - this._stateDefinition.getMaxY()) + 1]
        }
    }
    class de extends ce {
        static #Ne = 10;
        static #xe = 15;
        constructor(e, t, n, r, i) {
            super(e, t, n, r, i)
        }
        _checkIsSpace(e) {
            return !(r.getTypeClass(e) > r.TYPE_GAS) && r.getBehaviour(e) !== r.BEHAVIOUR_FIRE
        }
        performAfterProcessing() {
            this._iteration++;
            let e = -1 !== this._state,
                t = !1;
            if (e) {
                const [n, r] = this.#De();
                e = n, t = r
            }
            if (e)
                if (t) {
                    const e = this._random.nextInt(3) - 1,
                        t = 1;
                    this._moveForced(e, t)
                } else this._iteration % 11 == 0 && (null !== this._waypoint ? (10 === this._waypoint.stuck && (this._waypoint.stuck = -20), this._waypoint.stuck >= 0 ? this._moveInWaypointDirection(2) : (this._waypoint.stuck++, this._moveRandom(2))) : this._moveRandom(2));
            return e && this._stateDefinition.getStatesCount() > 1 && this._iteration % 10 == 0 && this._incrementState(), e
        }
        #De() {
            const e = this._x,
                t = this._y,
                n = this._stateDefinition.getStates()[this._state];
            let i = !1,
                s = 0;
            for (const [a, o] of n) {
                const n = e + a,
                    l = t + o,
                    h = this._elementArea.getElementHeadOrNull(n, l);
                if (null === h) return [this._kill(), !1];
                if (r.getBehaviour(h) !== r.BEHAVIOUR_ENTITY) return [this._kill(), !1];
                s += r.getTemperature(h), this._elementArea.setElementHead(n, l, r.setSpecial(h, 0)), i || (i = le.isElementFallingHeavy(this._elementArea.getElementHeadOrNull(n, l - 1)))
            }
            return s / n.length > de.#Ne || this._stuck > de.#xe ? [this._kill(), !1] : [!0, i]
        }
    }
    class ue extends ce {
        static #Ne = 10;
        static #xe = 1e3;
        constructor(e, t, n, r, i) {
            super(e, t, n, r, i)
        }
        _checkIsSpace(e) {
            return r.getTypeClass(e) === r.TYPE_FLUID
        }
        performAfterProcessing() {
            this._iteration++;
            let e = -1 !== this._state,
                t = !1;
            if (e) {
                const [n, r] = this.#De();
                e = n, t = r
            }
            return e && (t ? this._moveForced(0, 1) : this._iteration % 14 == 0 && (null !== this._waypoint ? (3 === this._waypoint.stuck && (this._waypoint.stuck = -10), this._waypoint.stuck >= 0 ? this._moveInWaypointDirection(1) : (this._waypoint.stuck++, this._moveRandom(1))) : this._moveRandom(1))), e && this._stateDefinition.getStatesCount() > 1 && this._iteration % 10 == 0 && this._incrementState(), e
        }
        #De() {
            const e = this._x,
                t = this._y,
                n = this._stateDefinition.getStates()[this._state];
            let i = !1,
                s = !0,
                a = !0,
                o = !0,
                l = !0,
                h = 0;
            for (const [c, d] of n) {
                const n = e + c,
                    u = t + d,
                    m = this._elementArea.getElementHeadOrNull(n, u);
                if (null === m) return [this._kill(), !1];
                if (r.getBehaviour(m) !== r.BEHAVIOUR_ENTITY) return [this._kill(), !1];
                if (h += r.getTemperature(m), this._elementArea.setElementHead(n, u, r.setSpecial(m, 0)), !i || s || a) {
                    const e = this._elementArea.getElementHeadOrNull(n, u - 1);
                    i || (i = le.isElementFallingHeavy(e)), s && (s = le.isElementLight(e)), a && (a = le.isElementWater(e) || le.isElementEntity(e))
                }
                if (o || l) {
                    const e = this._elementArea.getElementHeadOrNull(n, u + 1);
                    o && (o = le.isElementLight(e)), l && (l = le.isElementWater(e) || le.isElementEntity(e))
                }
            }
            if (h / n.length > ue.#Ne) return [this._kill(), !1];
            if (a && l || this._stuck++, this._stuck > ue.#xe) return [this._kill(), !1];
            return [!0, i || o || s && l]
        }
    }
    class me {
        static #Be = ae.createCyclic([
            [
                [0, 0],
                [1, -1],
                [-1, -1],
                [2, -1],
                [-2, -1],
                [3, -1],
                [-3, -1]
            ],
            [
                [0, 0],
                [1, -1],
                [-1, -1],
                [2, -1],
                [-2, -1],
                [3, -2],
                [-3, -2]
            ],
            [
                [0, 0],
                [1, -1],
                [-1, -1],
                [2, -2],
                [-2, -2],
                [3, -2],
                [-3, -2]
            ],
            [
                [0, 0],
                [1, -1],
                [-1, -1],
                [2, -2],
                [-2, -2],
                [3, -1],
                [-3, -1]
            ],
            [
                [0, 0],
                [1, -1],
                [-1, -1],
                [2, -1],
                [-2, -1],
                [3, -1],
                [-3, -1]
            ],
            [
                [0, 0],
                [1, -1],
                [-1, -1],
                [2, 0],
                [-2, 0],
                [3, 0],
                [-3, 0]
            ],
            [
                [0, 0],
                [1, -1],
                [-1, -1],
                [2, 0],
                [-2, 0],
                [3, 1],
                [-3, 1]
            ],
            [
                [0, 0],
                [1, -1],
                [-1, -1],
                [2, 0],
                [-2, 0],
                [3, 0],
                [-3, 0]
            ]
        ]);
        static #_e = N.custom(((e, t) => {
            const i = Math.abs(e) < 2 ? h.BLUR_TYPE_NONE : h.BLUR_TYPE_1;
            return new n(r.of(r.type8(r.TYPE_STATIC), r.behaviour8(r.BEHAVIOUR_ENTITY, 0), r.modifiers8(r.HMI_CONDUCTIVE_1)), h.of(0, 0, 0, i))
        }));
        static birdFactory(e, t) {
            return new de("bird", e, me.#Be, me.#_e, t)
        }
        static #He = ae.createCyclic([
            [
                [0, 0],
                [1, -1],
                [-1, -1]
            ],
            [
                [0, 0],
                [1, -1],
                [-1, -1]
            ],
            [
                [0, 0],
                [1, 0],
                [-1, 0]
            ],
            [
                [0, 0],
                [1, 1],
                [-1, 1]
            ],
            [
                [0, 0],
                [1, 1],
                [-1, 1]
            ]
        ]);
        static #Ue = N.custom(((e, t) => {
            const i = 0 === Math.abs(e) ? h.BLUR_TYPE_NONE : h.BLUR_TYPE_1,
                s = 0 === Math.abs(e) ? 0 : 200;
            return new n(r.of(r.type8(r.TYPE_STATIC), r.behaviour8(r.BEHAVIOUR_ENTITY, 0), r.modifiers8(r.HMI_CONDUCTIVE_1)), h.of(s, 0, 0, i))
        }));
        static butterflyFactory(e, t) {
            return new de("butterfly", e, me.#He, me.#Ue, t)
        }
        static #Pe = ae.createCyclic([
            [
                [0, 0],
                [1, 0]
            ]
        ]);
        static #Fe = N.custom(((e, t) => new n(r.of(r.type8(r.TYPE_STATIC), r.behaviour8(r.BEHAVIOUR_ENTITY, 0), r.modifiers8(r.HMI_CONDUCTIVE_1)), h.of(0, 0, 0, h.BLUR_TYPE_NONE))));
        static fishFactory(e, t) {
            return new ue("fish", e, me.#Pe, me.#Fe, t)
        }
        static findFactoryByEntityType(e) {
            switch (e) {
                case "bird":
                    return me.birdFactory;
                case "butterfly":
                    return me.butterflyFactory;
                case "fish":
                    return me.fishFactory
            }
            return null
        }
    }
    class Ee {
        static DEFAULT_SIZE = 6;
        static CATEGORY_NONE = void 0;
        static CATEGORY_POWDER = "powders";
        static CATEGORY_FLUIDS = "fluids";
        static CATEGORY_SOLIDS = "solids";
        static CATEGORY_EFFECTS = "effects";
        static CATEGORY_BIOLOGICAL = "biological";
        static DEFAULT_CATEGORY_DEFINITIONS = {};
        static {
            Ee.DEFAULT_CATEGORY_DEFINITIONS[Ee.CATEGORY_POWDER] = {
                displayName: "Powders",
                badgeStyle: {
                    backgroundColor: "#b7a643"
                }
            }, Ee.DEFAULT_CATEGORY_DEFINITIONS[Ee.CATEGORY_FLUIDS] = {
                displayName: "Fluids",
                badgeStyle: {
                    backgroundColor: "#0487ba"
                }
            }, Ee.DEFAULT_CATEGORY_DEFINITIONS[Ee.CATEGORY_SOLIDS] = {
                displayName: "Solids",
                badgeStyle: {
                    backgroundColor: "#656565"
                }
            }, Ee.DEFAULT_CATEGORY_DEFINITIONS[Ee.CATEGORY_EFFECTS] = {
                displayName: "Effects",
                badgeStyle: {
                    backgroundColor: "#ff5900"
                }
            }
            , Ee.DEFAULT_CATEGORY_DEFINITIONS[Ee.CATEGORY_BIOLOGICAL] = {
                displayName: "Biological",
                badgeStyle: {
                    backgroundColor: "#000000"
                }
            }}
        static NONE = $.actionTool((() => {}), new x({
            codeName: "none",
            displayName: "None",
            category: Ee.CATEGORY_NONE
        }));
        static ERASE = $.roundBrushTool(ie.AIR, Ee.DEFAULT_SIZE, new x({
            codeName: "erase",
            displayName: "Erase",
            category: Ee.CATEGORY_NONE,
            badgeStyle: {
                backgroundColor: "#e6e6e6",
                color: "black"
            }
        }));
        static MOVE = $.moveTool(13, 2048, new x({
            codeName: "move",
            displayName: "Move",
            category: Ee.CATEGORY_NONE,
            badgeStyle: {
                backgroundColor: "#e6e6e6",
                color: "black"
            }
        }));
        static FLIP_VERTICALLY = $.globalActionTool((e => {
            e.graphics().flipVertically()
        }), new x({
            codeName: "flip_vertically",
            displayName: "Flip Vertically",
            category: Ee.CATEGORY_NONE,
            badgeStyle: {
                backgroundColor: "#e6e6e6",
                color: "black"
            }
        }));
        static SAND = $.roundBrushTool(ie.SAND, Ee.DEFAULT_SIZE, new x({
            codeName: "sand",
            displayName: "Sand",
            category: Ee.CATEGORY_POWDER,
            badgeStyle: {
                backgroundColor: "#b7a643"
            }
        }));
        static SOIL = $.roundBrushTool(ie.SOIL, Ee.DEFAULT_SIZE, new x({
            codeName: "soil",
            displayName: "Soil",
            category: Ee.CATEGORY_POWDER,
            badgeStyle: {
                backgroundColor: "#8e6848"
            }
        }));
        static GRAVEL = $.roundBrushTool(ie.GRAVEL, Ee.DEFAULT_SIZE, new x({
            codeName: "gravel",
            displayName: "Gravel",
            category: Ee.CATEGORY_POWDER,
            badgeStyle: {
                backgroundColor: "#656565"
            }
        }));
        static COAL = $.roundBrushTool(ie.COAL, Ee.DEFAULT_SIZE, new x({
            codeName: "coal",
            displayName: "Coal",
            category: Ee.CATEGORY_POWDER,
            badgeStyle: {
                backgroundColor: "#343434"
            }
        }));
        static THERMITE = $.roundBrushTool(ie.THERMITE, Ee.DEFAULT_SIZE, new x({
            codeName: "thermite",
            displayName: "Thermite",
            category: Ee.CATEGORY_POWDER,
            badgeStyle: {
                backgroundColor: "#914e47"
            }
        }));
        static WALL = $.roundBrushTool(ie.WALL, Ee.DEFAULT_SIZE, new x({
            codeName: "wall",
            displayName: "Wall",
            category: Ee.CATEGORY_SOLIDS,
            badgeStyle: {
                backgroundColor: "#383838"
            }
        }));
        static ROCK = $.roundBrushTool(ie.ROCK, Ee.DEFAULT_SIZE, new x({
            codeName: "rock",
            displayName: "Rock",
            category: Ee.CATEGORY_SOLIDS,
            badgeStyle: {
                backgroundColor: "#383838"
            }
        }));
        static ROCK_TEMPLATES = $.templateSelectionTool([se.ROCK_SM, se.ROCK_MD, se.ROCK_LG], new x({
            codeName: "rock_templates",
            displayName: "Rock",
            category: Ee.CATEGORY_SOLIDS,
            badgeStyle: {
                backgroundColor: "#383838"
            }
        }));
        static WOOD = $.roundBrushTool(ie.TREE_WOOD, Ee.DEFAULT_SIZE, new x({
            codeName: "wood",
            displayName: "Wood",
            category: Ee.CATEGORY_SOLIDS,
            badgeStyle: {
                backgroundColor: "#573005"
            }
        }));
        static METAL = $.roundBrushToolForSolidBody(ie.METAL, Ee.DEFAULT_SIZE, new x({
            codeName: "metal",
            displayName: "Metal",
            category: Ee.CATEGORY_SOLIDS,
            badgeStyle: {
                backgroundColor: "#7c7c7c"
            }
        }));
        static METAL_MOLTEN = $.roundBrushTool(ie.METAL_MOLTEN, Ee.DEFAULT_SIZE, new x({
            codeName: "metal_molten",
            displayName: "M. Metal",
            category: Ee.CATEGORY_FLUIDS,
            badgeStyle: {
                backgroundColor: "#e67d00"
            }
        }));
        static WATER = $.roundBrushTool(ie.WATER, Ee.DEFAULT_SIZE, new x({
            codeName: "water",
            displayName: "Water",
            category: Ee.CATEGORY_FLUIDS,
            badgeStyle: {
                backgroundColor: "#0487ba"
            }
        }));
        static FIRE = $.roundBrushTool(N.temperatureOrBrush(50, ie.FIRE), Ee.DEFAULT_SIZE, new x({
            codeName: "fire",
            displayName: "Fire",
            category: Ee.CATEGORY_EFFECTS,
            badgeStyle: {
                backgroundColor: "#ff5900"
            }
        }));
        static METEOR = $.meteorTool(ie.METEOR, ie.METEOR_FROM_LEFT, ie.METEOR_FROM_RIGHT, new x({
            codeName: "meteor",
            displayName: "Meteor",
            category: Ee.CATEGORY_EFFECTS,
            badgeStyle: {
                backgroundColor: "#ff5900"
            }
        }));
        static EFFECT_TEMP_MINUS = $.roundBrushTool(N.concat(ie.EFFECT_TEMP_0, ie.EFFECT_EXTINGUISH), Ee.DEFAULT_SIZE, new x({
            codeName: "effect_temp_minus",
            displayName: "°C −",
            category: Ee.CATEGORY_EFFECTS,
            badgeStyle: {
                backgroundColor: "#63cffa"
            }
        }));
        static EFFECT_TEMP_PLUS = $.roundBrushTool(ie.EFFECT_TEMP_200, Ee.DEFAULT_SIZE, new x({
            codeName: "effect_temp_plus",
            displayName: "°C +",
            category: Ee.CATEGORY_EFFECTS,
            badgeStyle: {
                backgroundColor: "#fa9b4e"
            }
        }));
        static EFFECT_TEMP_PLUS2 = $.roundBrushTool(ie.EFFECT_TEMP_255, Ee.DEFAULT_SIZE, new x({
            codeName: "effect_temp_plus2",
            displayName: "°C ⧺",
            category: Ee.CATEGORY_EFFECTS,
            badgeStyle: {
                backgroundColor: "#fa9b4e"
            }
        }));
        static BIRD2 = $.insertEntityTool(me.birdFactory, new x({
            codeName: "bird",
            displayName: "Bird",
            category: Ee.CATEGORY_BIOLOGICAL,
            badgeStyle: {
                backgroundColor: "#000"
            }
        }));
        static BUTTERFLY2 = $.insertEntityTool(me.butterflyFactory, new x({
            codeName: "butterfly",
            displayName: "Butterfly",
            category: Ee.CATEGORY_BIOLOGICAL,
            badgeStyle: {
                backgroundColor: "#F00"
            }
        }));
        static FISH2 = $.insertEntityTool(me.fishFactory, new x({
            codeName: "fish",
            displayName: "Fish",
            category: Ee.CATEGORY_BIOLOGICAL,
            badgeStyle: {
                backgroundColor: "#003"
            }
        }));
        static WAY = $.actionTool(((e, t, n) => {
            n.entities().assignWaypoint(e, t)
        }), new x({
            codeName: "entity_waypoint",
            displayName: "Waypoint",
            category: Ee.CATEGORY_BIOLOGICAL,
            badgeStyle: {
                backgroundColor: "#888"
            }
        }));
        static DEFAULT_TOOLS = [this.ERASE, this.MOVE, this.SAND, this.SOIL, this.GRAVEL, this.COAL, this.THERMITE, this.WATER, this.ROCK_TEMPLATES, this.WALL, this.METAL, this.METAL_MOLTEN, this.FIRE, this.METEOR, this.EFFECT_TEMP_MINUS, this.EFFECT_TEMP_PLUS, this.EFFECT_TEMP_PLUS2, this.FISH2, this.BUTTERFLY2,this.BIRD2, this.WAY];
        static BIRD = $.insertEntityTool(me.birdFactory, new x({
            codeName: "bird",
            displayName: "Bird",
            category: Ee.CATEGORY_BIOLOGICAL
        }));
        static BUTTERFLY = $.insertEntityTool(me.butterflyFactory, new x({
            codeName: "butterfly",
            displayName: "Butterfly",
            category: Ee.CATEGORY_BIOLOGICAL
        }));
        static FISH = $.insertEntityTool(me.fishFactory, new x({
            codeName: "fish",
            displayName: "Fish",
            category: Ee.CATEGORY_BIOLOGICAL
        }));
        static TEST_TOOLS = [$.pointBrushTool(ie.GRASS, new x({
            codeName: "grass",
            displayName: "Grass",
            category: Ee.CATEGORY_BIOLOGICAL
        })), $.pointBrushTool(ie.TREE, new x({
            codeName: "tree",
            displayName: "Tree",
            category: Ee.CATEGORY_BIOLOGICAL
        })), Ee.BIRD, Ee.BUTTERFLY, Ee.FISH, $.actionTool(((e, t, n) => {
            n.entities().assignWaypoint(e, t)
        }), new x({
            codeName: "entity_waypoint",
            displayName: "Waypoint",
            category: Ee.CATEGORY_BIOLOGICAL
        })), $.roundBrushTool(ie.EFFECT_BURNT, Ee.DEFAULT_SIZE, new x({
            codeName: "effect_burnt",
            displayName: "Burnt",
            category: Ee.CATEGORY_EFFECTS
        })), $.roundBrushTool(ie.EFFECT_NOISE_SM, Ee.DEFAULT_SIZE, new x({
            codeName: "effect_noise_sm",
            displayName: "Noise SM",
            category: Ee.CATEGORY_EFFECTS
        })), $.roundBrushTool(ie.EFFECT_NOISE_MD, Ee.DEFAULT_SIZE, new x({
            codeName: "effect_noise_md",
            displayName: "Noise MD",
            category: Ee.CATEGORY_EFFECTS
        })), $.roundBrushTool(ie.EFFECT_NOISE_LG, Ee.DEFAULT_SIZE, new x({
            codeName: "effect_noise_lg",
            displayName: "Noise LG",
            category: Ee.CATEGORY_EFFECTS
        })), $.roundBrushTool(ie.EFFECT_TEMP_0, Ee.DEFAULT_SIZE, new x({
            codeName: "effect_temp_0",
            displayName: "Temp 0",
            category: Ee.CATEGORY_EFFECTS
        })), $.roundBrushTool(ie.EFFECT_TEMP_127, Ee.DEFAULT_SIZE, new x({
            codeName: "effect_temp_127",
            displayName: "Temp 127",
            category: Ee.CATEGORY_EFFECTS
        })), $.roundBrushTool(ie.EFFECT_TEMP_200, Ee.DEFAULT_SIZE, new x({
            codeName: "effect_temp_200",
            displayName: "Temp 200",
            category: Ee.CATEGORY_EFFECTS
        })), $.roundBrushTool(ie.EFFECT_TEMP_255, Ee.DEFAULT_SIZE, new x({
            codeName: "effect_temp_255",
            displayName: "Temp 255",
            category: Ee.CATEGORY_EFFECTS
        })), $.roundBrushTool(ie.ASH, Ee.DEFAULT_SIZE, new x({
            codeName: "ash",
            displayName: "Ash",
            category: Ee.CATEGORY_POWDER
        }))];
        static _LIST = {};
        static {
            for (const e of [Ee.NONE, ...Ee.DEFAULT_TOOLS, ...Ee.TEST_TOOLS]) Ee._LIST[e.getInfo().getCodeName()] = e
        }
        static byCodeName(e) {
            const t = Ee._LIST[e];
            return void 0 !== t ? t : null
        }
    }
    class ge {
        static EVENT_NAME = "app_sand_game_js";
        static FEATURE_APP_INITIALIZED = "initialized";
        static FEATURE_SCENARIO_COMPLETED = "s_completed";
        static FEATURE_RENDERER_FALLBACK = "renderer_fallback";
        static FEATURE_PAUSE = "pause";
        static FEATURE_DRAW_PRIMARY = "draw_primary";
        static FEATURE_DRAW_SECONDARY = "draw_secondary";
        static FEATURE_DRAW_TERTIARY = "draw_tertiary";
        static FEATURE_DRAW_LINE = "draw_line";
        static FEATURE_DRAW_RECT = "draw_rect";
        static FEATURE_DRAW_FLOOD = "draw_flood";
        static FEATURE_STATUS_DISPLAYED = "status_displayed";
        static FEATURE_OPTIONS_DISPLAYED = "options_displayed";
        static FEATURE_RENDERER_PIXELATED = "renderer_pixelated";
        static FEATURE_RENDERER_SHOW_CHUNKS = "renderer_show_chunks";
        static FEATURE_RENDERER_SHOW_HEATMAP = "renderer_show_heatmap";
        static FEATURE_CANVAS_SIZE_CHANGE = "canvas_size_change";
        static FEATURE_SWITCH_SCENE = "switch_scene";
        static FEATURE_RESTART_SCENE = "restart_scene";
        static FEATURE_SWITCH_SCALE = "switch_scale";
        static FEATURE_IO_EXPORT = "io_export";
        static FEATURE_IO_IMPORT = "io_import";
        static FEATURE_IO_IMAGE_TEMPLATE = "io_image_template";
        static #Le = new Set;
        static triggerToolUsed(e) {
            let t = e.getInfo().getCodeName();
            if (void 0 === t && (e instanceof k || e instanceof Y ? t = "template" : e instanceof Q && (t = "entity")), void 0 !== t) {
                const e = "brush_" + t;
                ge.triggerFeatureUsed(e)
            }
        }
        static triggerFeatureUsed(e) {
            ge.#Le.has(e) || (ge.#Le.add(e), ge.#ke({
                app_sand_game_js_feature: e
            }))
        }
        static #ke(e) {
            if ("function" == typeof gtag) try {
                gtag("event", ge.EVENT_NAME, e)
            } catch (e) {
                console.warn(e)
            }
        }
    }
    class pe {
        static addContent(e, t) {
            if (null === t);
            else if ("string" == typeof t) e.textContent = t;
            else if (t instanceof Node) e.appendChild(t);
            else {
                if (!Array.isArray(t)) throw "Content type not supported: " + typeof t;
                for (const n of t)
                    if (n instanceof Node) e.appendChild(n);
                    else if ("string" == typeof n) e.insertAdjacentText("beforeend", n);
                else if (null !== n) throw "Content type not supported: " + typeof n
            }
        }
        static setContent(e, t) {
            e.innerHTML = "", pe.addContent(e, t)
        }
        static putAttributes(e, t) {
            for (const n in t) {
                const r = t[n],
                    i = typeof r;
                if ("string" === i || "boolean" === i || "number" === i) e.setAttribute(n, r);
                else if ("style" === n && "object" === i) Object.assign(e.style, r);
                else if (null !== r) throw "Unsupported attribute type: " + typeof r
            }
        }
        static create(e) {
            const t = document.createElement("template");
            return t.innerHTML = e.trim(), t.content.firstElementChild
        }
        static element(e, t = null, n = null) {
            const r = document.createElement(e);
            return pe.putAttributes(r, t), pe.addContent(r, n), r
        }
        static div(e = null, t = null) {
            return pe.element("div", e, t)
        }
        static par(e = null, t = null) {
            return pe.element("p", e, t)
        }
        static span(e = null, t = null) {
            return pe.element("span", t, e)
        }
        static link(e, t = null, n = null) {
            const r = pe.element("a", t, e);
            return null !== n && (r.href = "javascript:void(0)", r.addEventListener("click", n)), r
        }
        static button(e, t = null, n = null) {
            null === t && (t = {}), t.type = "button";
            const r = pe.element("button", t, e);
            return null !== n && r.addEventListener("click", n), r
        }
        static bootstrapAlertInfo(e) {
            const t = pe.div({
                class: "alert alert-info alert-dismissible fade show",
                role: "alert"
            });
            return pe.addContent(t, e), t.append(pe.button(null, {
                type: "button",
                class: "btn-close",
                "data-bs-dismiss": "alert",
                "aria-label": "Close"
            })), t
        }
        static bootstrapCard(e, t, n = null) {
            null === n && (n = {}), void 0 === n.class && (n.class = "card");
            const r = pe.div(n);
            return e && r.append(pe.div({
                class: "card-header"
            }, e)), r.append(pe.div({
                class: "card-body"
            }, t)), r
        }
        static bootstrapCardCollapsable(e, t, n) {
            const r = "collapsable_" + Math.floor(999999999 * Math.random());
            return pe.div({
                class: "card"
            }, [pe.div({
                class: "card-header"
            }, [pe.element("a", {
                class: "card-link",
                "data-bs-toggle": "collapse",
                href: "#" + r
            }, e)]), pe.div({
                id: r,
                class: t ? "collapse" : "collapse show"
            }, [pe.div({
                class: "card-body"
            }, n)])])
        }
        static bootstrapInitTooltip(e, t) {
            if (void 0 === window.bootstrap) return console.error("Bootstrap library not available"), t;
            const n = new window.bootstrap.Tooltip(t);
            return n && n.dispose(), t.setAttribute("data-bs-toggle", "tooltip"), t.setAttribute("data-bs-placement", "top"), "object" == typeof e ? (t.setAttribute("data-bs-html", "true"), t.setAttribute("title", e.innerHTML)) : t.setAttribute("title", e), new window.bootstrap.Tooltip(t), t
        }
        static bootstrapSwitchButton(e, t, n = null) {
            const r = "switch-button_" + Math.floor(999999999 * Math.random()),
                i = pe.element("input", {
                    type: "checkbox",
                    id: r,
                    class: "form-check-input",
                    role: "switch",
                    checked: t
                }),
                s = pe.div({
                    class: "form-check form-switch"
                }, [i, pe.element("label", {
                    class: "form-check-label",
                    for: r
                }, e)]);
            return null !== n && i.addEventListener("click", (() => {
                n(i.checked)
            })), s
        }
        static bootstrapToggleButton(e, t, n, r = null) {
            const i = "toggle-button_" + Math.floor(999999999 * Math.random()),
                s = pe.element("input", {
                    type: "checkbox",
                    class: "btn-check",
                    checked: n,
                    id: i
                }),
                a = pe.element("label", {
                    class: "btn " + t,
                    for: i
                }, e);
            return s.addEventListener("change", (e => {
                null !== r && r(s.checked)
            })), [s, a]
        }
        static bootstrapTableBuilder() {
            return new Ae
        }
        static bootstrapDialogBuilder() {
            return new fe
        }
        static bootstrapToastBuilder() {
            return new Te
        }
        static bootstrapSimpleFormBuilder() {
            return new Ce
        }
    }
    class Ae {
        #Ye = pe.element("tbody");
        addRow(e) {
            this.#Ye.appendChild(e)
        }
        addRowBefore(e) {
            this.#Ye.insertBefore(e, this.#Ye.firstChild)
        }
        createNode() {
            const e = pe.element("table", {
                class: "table table-striped"
            });
            e.appendChild(this.#Ye);
            const t = pe.div({
                class: "table-responsive"
            });
            return t.appendChild(e), t
        }
    }
    class fe {
        #We = !1;
        #Ve = "";
        #Ge = null;
        #ze = null;
        #Ke = [];
        #Xe = null;
        #qe = null;
        setPersistent(e) {
            this.#We = e
        }
        setSizeLarge() {
            this.#Ve = "modal-lg"
        }
        setSizeExtraLarge() {
            this.#Ve = "modal-xl"
        }
        setHeaderContent(e) {
            this.#Ge = "string" == typeof e ? pe.element("strong", null, e) : e
        }
        setBodyContent(e) {
            this.#ze = e
        }
        addCloseButton(e) {
            const t = pe.element("button", {
                type: "button",
                class: "btn btn-secondary",
                "data-bs-dismiss": "modal"
            }, e);
            this.#Ke.push(t)
        }
        addSubmitButton(e, t) {
            const n = pe.element("button", {
                type: "button",
                class: "btn btn-primary",
                "data-bs-dismiss": "modal"
            }, e);
            n.addEventListener("click", t), this.#Ke.push(n)
        }
        addButton(e) {
            this.#Ke.push(e)
        }
        show(e) {
            void 0 !== window.bootstrap ? (null === this.#Xe && (this.#Xe = pe.div({
                class: "modal fade",
                tabindex: "-1",
                role: "dialog",
                "aria-hidden": "true"
            }, [pe.div({
                class: `modal-dialog modal-dialog-centered ${this.#Ve}`
            }, [pe.div({
                class: "modal-content"
            }, [pe.div({
                class: "modal-header"
            }, this.#Ge), pe.div({
                class: "modal-body"
            }, this.#ze), pe.div({
                class: "modal-footer"
            }, this.#Ke)])])]), e.appendChild(this.#Xe)), this.#qe = new window.bootstrap.Modal(this.#Xe), this.#We || this.#Xe.addEventListener("hidden.bs.modal", (() => {
                e.removeChild(this.#Xe)
            })), this.#qe.show()) : console.error("Bootstrap library not available")
        }
        hide() {
            null !== this.#Xe && this.#qe.hide()
        }
    }
    class Te {
        #Ge = null;
        #ze = null;
        #Je = null;
        #je = null;
        #Ze = 36e5;
        setHeaderContent(e) {
            "string" == typeof e && (e = pe.element("strong", e)), this.#Ge = pe.span(e, {
                class: "me-auto"
            })
        }
        setBodyContent(e) {
            this.#ze = e
        }
        setDelay(e) {
            this.#Ze = e
        }
        show(e) {
            if (void 0 === window.bootstrap) return void console.error("Bootstrap library not available");
            const t = {
                    class: "toast hide",
                    role: "alert",
                    "aria-live": "assertive",
                    "aria-atomic": "true",
                    "data-bs-delay": this.#Ze
                },
                n = pe.div({
                    class: "position-fixed bottom-0 right-0 p-3",
                    style: "z-index: 5; right: 0; bottom: 0;"
                }, [this.#Je = pe.div(t, [pe.div({
                    class: "toast-header"
                }, [this.#Ge, pe.button("", {
                    type: "button",
                    class: "btn-close",
                    "data-bs-dismiss": "toast",
                    "aria-label": "Close"
                })]), pe.div({
                    class: "toast-body"
                }, [this.#ze])])]);
            e.append(n), this.#je = new window.bootstrap.Toast(this.#Je), this.#Je.addEventListener("hidden.bs.toast", (() => {
                e.removeChild(n)
            })), this.#je.show()
        }
        hide() {
            null !== this.#Je && this.#je.hide()
        }
    }
    class Ce {
        #Qe = [];
        #$e = null;
        addTextArea(e, t, n = "", r = 8) {
            let i = pe.element("textarea", {
                class: "form-control",
                rows: r
            }, n);
            return this.#Qe.push({
                key: t,
                label: e,
                input: i
            }), i
        }
        addInput(e, t, n = "") {
            let r = pe.element("input", {
                class: "form-control"
            });
            return n && (r.value = n), this.#Qe.push({
                key: t,
                label: e,
                input: r
            }), r
        }
        addSubmitButton(e, t) {
            this.#$e = pe.button(e, {
                class: "btn btn-primary"
            }, (e => {
                t(this.getData())
            }))
        }
        createNode() {
            let e = pe.element("form", {
                action: "javascript:void(0);"
            });
            for (let t of this.#Qe) e.append(pe.div({
                class: "mb-3"
            }, [pe.element("label", null, t.label), t.input]));
            return this.#$e && e.append(this.#$e), e
        }
        getData() {
            let e = {};
            for (let t of this.#Qe) e[t.key] = t.input.value;
            return e
        }
    }
    class Re {
        #et = 0;
        #tt = 0;
        #nt = 0;
        tick(e) {
            this.#et++, e - this.#nt >= 1e3 && (this.#tt = this.#et, this.#et = 0, this.#nt = e)
        }
        getValue() {
            return this.#tt
        }
        clear() {
            this.#tt = 0
        }
    }
    class ye {
        #rt;
        #V;
        #W;
        constructor(e, t, n) {
            this.#V = t, this.#W = n;
            const r = new Map;
            for (const n of e) {
                const e = n.getY() * t + n.getX();
                let i = r.get(e);
                void 0 === i && (i = [], r.set(e, i)), i.push(n)
            }
            this.#rt = r
        }
        getAt(e, t) {
            if (e < 0 || t < 0) return [];
            if (e >= this.#V || t >= this.#W) return [];
            const n = this.#rt.get(t * this.#V + e);
            return void 0 !== n ? n : []
        }
    }
    class Se {
        #it;
        #st = [];
        #at = null;
        constructor(e, t) {
            this.#it = t;
            for (let t of e) this.addSerializedEntity(t, !1)
        }
        addSerializedEntity(e, t = !0) {
            try {
                const n = this.#ot(e);
                return this.#st.push(n), t && n.initialize(), n
            } catch (e) {
                return console.warn("Cannot deserialize entity", e), null
            }
        }
        #ot(e) {
            if ("object" != typeof e) throw "Serialized entity must be an object";
            const t = me.findFactoryByEntityType(e.entity);
            if (null !== t) return t(e, this.#it);
            throw "Entity not recognized"
        }
        performBeforeProcessing() {
            for (let e = 0; e < this.#st.length; e++) {
                this.#st[e].performBeforeProcessing()
            }
            this.#at = null
        }
        performAfterProcessing() {
            let e = null;
            for (let t = 0; t < this.#st.length; t++) {
                const n = this.#st[t];
                let r;
                try {
                    r = n.performAfterProcessing()
                } catch (e) {
                    console.error("Entity error", e), r = !1
                }!1 === r && (null === e && (e = []), e.push())
            }
            if (null !== e)
                for (let t = e.length - 1; t >= 0; t--) {
                    const n = e[t];
                    this.#st.splice(n, 1)
                }
            this.#at = null
        }
        serializeEntities() {
            const e = [];
            for (let t of this.#st) e.push(t.serialize());
            return e
        }
        getAt(e, t) {
            if (null === this.#at) {
                const e = this.#it.elementArea.getWidth(),
                    t = this.#it.elementArea.getHeight();
                this.#at = new ye(this.#st, e, t)
            }
            return this.#at.getAt(e, t)
        }
        countEntities(e) {
            let t = 0;
            for (let n = 0; n < this.#st.length; n++) {
                e === this.#st[n].getType() && t++
            }
            return t
        }
        getEntities() {
            return this.#st
        }
    }
    class we {
        getExtensionsFactory() {
            throw "Not implemented"
        }
        getBrushCollection() {
            throw "Not implemented"
        }
        getDefaultElement() {
            throw "Not implemented"
        }
        getBrushWater() {
            throw "Not implemented"
        }
        getBrushSteam() {
            throw "Not implemented"
        }
        getBrushGrass() {
            throw "Not implemented"
        }
        getBrushTree() {
            throw "Not implemented"
        }
        getBrushTreeWood() {
            throw "Not implemented"
        }
        getBrushTreeWoodDark() {
            throw "Not implemented"
        }
        getBrushTreeRoot() {
            throw "Not implemented"
        }
        getBrushTreeLeaf() {
            throw "Not implemented"
        }
        getBrushTreeLeafDark() {
            throw "Not implemented"
        }
        getBrushFire() {
            throw "Not implemented"
        }
        getBrushAsh() {
            throw "Not implemented"
        }
        getTreeTrunkTemplates() {
            throw "Not implemented"
        }
        getTreeLeafClusterTemplates() {
            throw "Not implemented"
        }
    }
    class ve {
        static #lt = 255;
        static #ht = 254;
        static #ct = 8192;
        static #dt = 32;
        #K;
        #ut;
        #mt;
        #Et;
        #gt;
        constructor(e, t, n) {
            this.#K = e, this.#ut = t, this.#mt = n, this.#Et = new Uint8Array(e.getWidth() * e.getHeight()), this.#gt = new Set, this.#pt = new Uint16Array(e.getWidth())
        }
        onSolidCreated(e, t, n) {
            this.#Et[t + n * this.#K.getWidth()] = ve.#ht
        }
        onNextIteration() {
            this.#Et.fill(0), this.#gt.clear()
        }
        behaviourSolid(e, t, n) {
            const i = r.getTypeModifierSolidBodyId(e),
                s = t + n * this.#K.getWidth(),
                a = this.#Et[s];
            if (a === ve.#ht) return !0;
            if (a === i) return this.#gt.has(i);
            const [o, l, h, c, d] = this.#At(t, n, e, i);
            if (this.#mt.isFallThroughEnabled() && this.#ft(h.shadowClone(), i)) return !0;
            this.#Tt(l, c, i);
            const [u, m] = this.#Ct(h.shadowClone(), i);
            if (d.tree) {
                if (u === m) return this.#Rt(i, h), this.#gt.add(i), !0
            } else {
                if (m / u > .95) return this.#Rt(i, h), this.#gt.add(i), !0;
                if (m / u > .75) return this.#yt(i, h), !1
            }
            return !1
        }
        #St(e, t) {
            const n = this.#K.getWidth();
            let i;
            for (; null !== (i = t.pop());) {
                if (4294967295 === i) continue;
                const t = i % n,
                    s = Math.trunc(i / n);
                let a = 0;
                for (;;) {
                    let i = this.#K.getElementHead(t, s + a);
                    const o = this.#ut.nextInt(100) < 20 ? r.TYPE_POWDER : r.TYPE_POWDER_WET;
                    i = r.setType(i, r.type8Powder(o, 4));
                    let l = this.#K.getElementTail(t, s + a);
                    if (this.#K.setElementHead(t, s + a, i), this.#K.setElementTail(t, s + a, l), !(s + a >= 0)) break;
                    if (this.#Et[t + (s + a - 1) * n] !== e) break;
                    a--
                }
            }
        }
        #Rt(e, t) {
            const n = this.#K.getWidth(),
                i = this.#K.getHeight();
            let s;
            for (; null !== (s = t.pop());) {
                if (4294967295 === s) continue;
                const t = s % n,
                    a = Math.trunc(s / n);
                let o = null,
                    l = null;
                a + 1 < i && (o = this.#K.getElementHead(t, a + 1), l = this.#K.getElementTail(t, a + 1));
                let h = 0;
                for (;;) {
                    const r = a + 1 + h;
                    if (r < i && (this.#K.setElementHead(t, r, this.#K.getElementHead(t, a + h)), this.#K.setElementTail(t, r, this.#K.getElementTail(t, a + h)), this.#Et[t + r * n] = e), !(a + h >= 0)) break;
                    if (this.#Et[t + (a + h - 1) * n] !== e) break;
                    h--
                }
                let c = !1;
                if (null != o) {
                    const e = r.getTypeClass(o);
                    e === r.TYPE_AIR ? c = !0 : e <= r.TYPE_FLUID && (c = this.#wt(Math.abs(h)))
                }
                c ? (this.#K.setElementHead(t, a + h, o), this.#K.setElementTail(t, a + h, l)) : this.#K.setElement(t, a + h, this.#mt.getDefaults().getDefaultElement()), this.triggerPowderElement(t, a + 2)
            }
        }
        #wt(e) {
            let t = 1 - 1 / (1 + Math.exp(-.1 * (e - 50)));
            return this.#ut.next() < t
        }
        #yt(e, t) {
            const n = this.#K.getWidth();
            let r;
            for (; null !== (r = t.pop());) {
                if (4294967295 === r) continue;
                const e = r % n,
                    t = Math.trunc(r / n);
                this.triggerPowderElement(e, t + 1)
            }
        }
        triggerPowderElement(e, t) {
            if (this.#K.isValidPosition(e, t)) {
                const n = this.#K.getElementHead(e, t),
                    i = r.getTypeClass(n);
                if (i === r.TYPE_POWDER || i === r.TYPE_POWDER_WET) {
                    let i = n;
                    i = r.setTypeModifierPowderSliding(i, 1), 0 === this.#ut.nextInt(15) && (i = r.setTypeModifierPowderDirection(i, this.#ut.nextInt(2))), this.#K.setElementHead(e, t, i)
                }
            }
        }
        #Ct(e, t) {
            const n = this.#K.getWidth(),
                i = this.#K.getHeight();
            let s, a = 0,
                o = 0;
            for (; null !== (s = e.pop());) {
                const l = s % n,
                    h = Math.trunc(s / n);
                if (h + 1 < i) {
                    const i = this.#K.getElementHead(l, h + 1);
                    if (this.#Et[l + (h + 1) * n] === t) {
                        e.removePrevious();
                        continue
                    }
                    a++;
                    switch (r.getTypeClass(i)) {
                        case r.TYPE_AIR:
                        case r.TYPE_EFFECT:
                        case r.TYPE_GAS:
                        case r.TYPE_FLUID:
                            o++
                    }
                } else a++
            }
            return [a, o]
        }
        #ft(e, t) {
            const n = this.#K.getWidth(),
                i = this.#K.getHeight();
            let s, a = !1;
            for (; null !== (s = e.pop());) {
                const e = s % n,
                    t = Math.trunc(s / n);
                if (t === i - 1) {
                    let n = this.#K.getElementHead(e, t);
                    n = r.setType(n, r.type8Powder(r.TYPE_POWDER, 5));
                    let i = this.#K.getElementTail(e, t);
                    i = h.setBlurType(i, h.BLUR_TYPE_1), this.#K.setElementHeadAndTail(e, t, n, i), a = !0
                }
            }
            return a
        }
        #Tt(e, t, n) {
            const i = this.#K.getWidth();
            this.#K.getHeight();
            let s, a = 0;
            for (; null !== (s = e.pop());) {
                const e = s % i,
                    o = Math.trunc(s / i),
                    l = t[e];
                if (l >= o) continue;
                let h, c = 0;
                for (;
                    (h = o - (c + 1)) >= 0 && h > l;) {
                    const t = this.#Et[e + h * i];
                    if (t === n) break;
                    if (0 !== t) break;
                    const s = this.#K.getElementHead(e, h);
                    if (!(r.getTypeClass(s) < r.TYPE_STATIC)) break;
                    this.#Et[e + h * i] = n, a++, c++
                }
            }
            return a
        }
        #vt = new Ie;
        #It = new Ie;
        #Ot = new Ie;
        #pt;
        #At(e, t, n, i) {
            const s = 247,
                a = this.#K.getElementHead(e, t) & s,
                o = this.#K.getWidth(),
                l = this.#vt;
            l.reset();
            const h = this.#It;
            h.reset();
            const c = this.#Ot;
            c.reset();
            const d = this.#pt;
            d.fill(65535);
            const u = {
                tree: r.getBehaviour(n) === r.BEHAVIOUR_TREE
            };
            let m = 0,
                E = e + t * o;
            do {
                const e = E % o,
                    t = Math.trunc(E / o);
                this.#Et[E] = i, m++;
                this.#bt(e, t - 1, s, a, l, i, u) && h.push(E), this.#bt(e + 1, t, s, a, l, i, u), this.#bt(e - 1, t, s, a, l, i, u), 0 === r.getTypeModifierSolidNeighbourhoodType(this.#K.getElementHead(e, t)) && (this.#bt(e + 1, t - 1, s, a, l, i, u), this.#bt(e - 1, t - 1, s, a, l, i, u), this.#bt(e + 1, t + 1, s, a, l, i, u), this.#bt(e - 1, t + 1, s, a, l, i, u));
                if (this.#bt(e, t + 1, s, a, l, i, u)) {
                    c.push(E);
                    const n = d[e];
                    d[e] = 65535 === n ? t : Math.min(n, t)
                }
            } while (null != (E = l.pop()));
            return [m, h, c, d, u]
        }
        #bt(e, t, n, i, s, a, o) {
            if (e < 0 || t < 0) return !0;
            const l = this.#K.getWidth(),
                h = this.#K.getHeight();
            if (e >= l || t >= h) return !0;
            const c = e + t * l,
                d = this.#Et[c];
            if (d === ve.#lt) return !1;
            if (d === a) return !1;
            const u = this.#K.getElementHead(e, t);
            return o.tree || r.getBehaviour(u) === r.BEHAVIOUR_TREE && (o.tree = !0), (u & n) !== i || (this.#Et[c] = ve.#lt, s.push(c), !1)
        }
    }
    class Ie {
        static create(e) {
            return new Ie(new Uint32Array(Math.max(1, e)))
        }
        #Ie;
        #T = -1;
        constructor(e = new Uint32Array(1)) {
            this.#Ie = e
        }
        push(e) {
            if (this.#Ie.length === this.#T + 1) {
                const e = new Uint32Array(2 * this.#Ie.length);
                e.set(this.#Ie), this.#Ie = e
            }
            this.#Ie[++this.#T] = e
        }
        pop() {
            return -1 === this.#T ? null : this.#Ie[this.#T--]
        }
        shadowClone() {
            const e = new Ie(this.#Ie);
            return e.#T = this.#T, e
        }
        removePrevious() {
            this.#Ie[this.#T + 1] = 4294967295
        }
        reset() {
            this.#T = -1
        }
    }
    class Oe {
        #K;
        #ut;
        #mt;
        constructor(e, t, n) {
            this.#K = e, this.#ut = t, this.#mt = n
        }
        behaviourEntity(e, t, n) {
            const i = r.getSpecial(e);
            if (i < 5) {
                const s = r.setSpecial(e, i + 1);
                this.#K.setElementHead(t, n, s)
            } else {
                const i = this.#ut.nextInt(100) < 20 ? r.TYPE_POWDER : r.TYPE_POWDER_WET;
                let s = e;
                s = r.setType(s, r.type8Powder(i, 4)), s = r.setBehaviour(s, r.BEHAVIOUR_NONE), s = r.setSpecial(s, 0), this.#K.setElementHead(t, n, s)
            }
        }
    }
    class be {
        static #Mt = 34;
        static createFireElementHead(e) {
            let t = r.of(r.TYPE_EFFECT, r.BEHAVIOUR_FIRE);
            return t = r.setTemperature(t, e), t
        }
        static createFireElementTail(e) {
            let t = h.of(0, 0, 0);
            return t = e > 213 ? h.setColor(t, 249, 219, 30) : e > 170 ? h.setColor(t, 248, 201, 7) : e > 128 ? h.setColor(t, 250, 150, 3) : e > 85 ? h.setColor(t, 255, 111, 0) : e > 80 ? h.setColor(t, 255, 37, 0) : e > 75 ? h.setColor(t, 250, 4, 5) : h.setColor(t, 125, 0, 0), t
        }
        #K;
        #ut;
        #mt;
        constructor(e, t, n) {
            this.#K = e, this.#ut = t, this.#mt = n
        }
        behaviourFire(e, t, n) {
            if (0 !== this.#ut.nextInt(4)) return;
            const i = r.getTemperature(e),
                s = this.#Nt(t, n, i);
            if (s < be.#Mt) return void this.#K.setElement(t, n, this.#mt.getDefaults().getDefaultElement());
            const a = this.#K.getElementHeadOrNull(t, n - 1);
            r.getBehaviour(a) !== r.BEHAVIOUR_WATER ? (null !== a && this.#xt(a) ? (this.#K.setElementHead(t, n - 1, be.createFireElementHead(s)), this.#K.setElementTail(t, n - 1, be.createFireElementTail(s))) : (this.#K.setElementHead(t, n, r.setTemperature(e, s)), this.#K.setElementTail(t, n, be.createFireElementTail(s))), this.#Dt(t + 1, n - 1, s), this.#Dt(t - 1, n - 1, s), this.#Dt(t + 1, n, s), this.#Dt(t - 1, n, s), this.#Dt(t, n + 1, s)) : this.#K.setElement(t, n, this.#mt.getDefaults().getDefaultElement())
        }
        #Nt(e, t, n) {
            let r = n + this.#Bt(e, t + 1) + this.#Bt(e + 1, t + 1) + this.#Bt(e - 1, t + 1);
            return r /= 4, r < 76 ? 0 === this.#ut.nextInt(2) && (r -= this.#ut.nextInt(10)) : 0 === this.#ut.nextInt(2) && (r -= this.#ut.nextInt(50)), r < 0 && (r = 0), r
        }
        #Bt(e, t) {
            const n = this.#K.getElementHeadOrNull(e, t);
            return null !== n ? r.getTemperature(n) : null
        }
        #xt(e) {
            return r.getTypeClass(e) === r.TYPE_AIR
        }
        #Dt(e, t, n) {
            const i = this.#K.getElementHeadOrNull(e, t);
            if (null == i) return;
            if (r.getBehaviour(i) === r.BEHAVIOUR_FIRE) {
                const s = r.getTemperature(i);
                if (s < n) {
                    const r = Math.trunc((n - s) / 2);
                    r > be.#Mt && (this.#K.setElementHead(e, t, be.createFireElementHead(r)), this.#K.setElementTail(e, t, be.createFireElementTail(r)))
                }
                return
            }
            if (r.getTypeClass(i) === r.TYPE_AIR) {
                const r = Math.trunc(.7 * n);
                return void(r > be.#Mt && (this.#K.setElementHead(e, t, be.createFireElementHead(r)), this.#K.setElementTail(e, t, be.createFireElementTail(r))))
            }
            const s = r.getHeatModIndex(i),
                a = r.hmiToFlammableChanceTo10000(s);
            if (0 !== a) {
                if (r.getBehaviour(i) === r.BEHAVIOUR_FIRE_SOURCE) return;
                if (this.#ut.nextInt(1e4) < a) return void this.ignite(i, e, t)
            }
            if (0 === this.#ut.nextInt(5)) {
                if (r.getTemperature(i) < n) {
                    const s = r.setTemperature(i, n);
                    this.#K.setElementHead(e, t, s)
                }
            }
            if (T.isVisualBurnApplicable(i) && 0 === this.#ut.nextInt(10)) {
                const n = this.#K.getElementTail(e, t);
                this.#K.setElementTail(e, t, T.visualBurn(n, 1, 2))
            }
        }
        behaviourFireSource(e, t, n) {
            const i = r.getHeatModIndex(e),
                s = r.hmiToFlameHeat(i),
                a = r.hmiToBurnDownChanceTo10000(i);
            if (this.#ut.nextInt(1e4) < a) {
                if (this.#ut.nextInt(100) < 8) {
                    const i = r.getTemperature(e),
                        s = this.#mt.getDefaults().getBrushAsh().apply(t, n, this.#ut),
                        a = r.setTemperature(s.elementHead, i),
                        o = s.elementTail;
                    this.#K.setElementHeadAndTail(t, n, a, o)
                } else this.#K.setElementHead(t, n, be.createFireElementHead(s)), this.#K.setElementTail(t, n, be.createFireElementTail(s));
                return
            }
            const o = this.#_t(t, n - 1, s) | this.#_t(t, n + 1, s) | this.#_t(t - 1, n, s) | this.#_t(t + 1, n, s);
            if (0 !== o && 0 == (2 & o))
                if (r.getTypeClass(e) === r.TYPE_STATIC && this.#ut.nextInt(1e4) < 2) {
                    const i = r.type8Powder(r.TYPE_POWDER, 5, 1, this.#ut.nextInt(2));
                    this.#K.setElementHead(t, n, r.setType(e, i))
                } else this.#K.setElementHead(t, n, r.setTemperature(e, s));
            else this.#K.setElementHead(t, n, r.setBehaviour(e, r.BEHAVIOUR_NONE))
        }
        #_t(e, t, n) {
            const i = this.#K.getElementHeadOrNull(e, t);
            if (null === i) return 0;
            if (r.getBehaviour(i) === r.BEHAVIOUR_WATER) return 2;
            if (r.getTypeClass(i) <= r.TYPE_EFFECT) {
                const r = this.#ut.nextInt(n);
                return r >= be.#Mt && (this.#K.setElementHead(e, t, be.createFireElementHead(r)), this.#K.setElementTail(e, t, be.createFireElementTail(r))), 1
            }
            if (T.isVisualBurnApplicable(i) && 0 === this.#ut.nextInt(1e3)) {
                const n = this.#K.getElementTail(e, t);
                this.#K.setElementTail(e, t, T.visualBurn(n, 1, 2))
            }
            return 0
        }
        ignite(e, t, n, i) {
            let s = r.setBehaviour(e, r.BEHAVIOUR_FIRE_SOURCE);
            s = r.setTemperature(s, r.hmiToFlameHeat(i)), this.#K.setElementHead(t, n, s);
            const a = this.#K.getElementTail(t, n);
            this.#K.setElementTail(t, n, T.visualBurn(a, 2))
        }
    }
    class Me {
        static BLUEPRINT_3 = ["  333", " 32223", "3211123", "3210123", "3211123", " 32223", "  333"];
        static BLUEPRINT_4 = ["   444   ", "  43334", " 4322234", "432111234", "432101234", "432111234", " 4322234", "  43334", "   444"];
        static BLUEPRINT_9 = ["       99999       ", "     998888899", "   9988777778899", "  998776666677899", "  987665555566789", " 98766554445566789", " 98765543334556789", "9876554322234556789", "9876543211123456789", "9876543210123456789", "9876543211123456789", "9876554322234556789", " 98765543334556789", " 98766554445566789", "  987665555566789", "  998776666677899", "   9988777778899", "     998888899", "       99999"];
        static iterate(e, t) {
            const n = e[0].length,
                r = e.length,
                i = Math.trunc(n / 2),
                s = Math.trunc(r / 2);
            for (let n = 0; n < e.length; n++) {
                const r = e[n];
                for (let e = 0; e < r.length; e++) {
                    const a = r.charAt(e);
                    " " !== a && t(e - i, n - s, +a)
                }
            }
        }
    }
    class Ne {
        static DIRECTION_FROM_TOP = 0;
        static DIRECTION_FROM_LEFT = 1;
        static DIRECTION_FROM_RIGHT = 2;
        static #Ht = 100;
        static #Ut = 255;
        static #Pt = 220;
        static #Ft = 60;
        #K;
        #ut;
        #mt;
        constructor(e, t, n) {
            this.#K = e, this.#ut = t, this.#mt = n
        }
        behaviourMeteor(e, t, n) {
            this.#Lt(e, t, n);
            const i = r.getSpecial(e),
                s = 1 & i;
            let a = i ^ !s;
            if (e = r.setSpecial(e, a), this.#K.setElementHead(t, n, e), !s) return;
            const o = (-2 & i) >> 1;
            let l, h;
            o === Ne.DIRECTION_FROM_TOP ? (h = n + 1, l = t) : o === Ne.DIRECTION_FROM_LEFT ? (h = n + 1, l = t + (h % 4 == 0 ? 1 : 0)) : o === Ne.DIRECTION_FROM_RIGHT ? (h = n + 1, l = t - (h % 4 == 0 ? 1 : 0)) : (h = n + 1, l = t), this.#K.isValidPosition(l, h) ? this.#mt.isFallThroughEnabled() && h === this.#K.getHeight() - 1 ? this.#kt(l, 0) && (this.#K.swap(t, n, l, 0), this.#mt.trigger(l, 0)) : this.#kt(l, h) ? this.#K.swap(t, n, l, h) : this.#Yt(e, t, n) : this.#Yt(e, t, n)
        }
        #kt(e, t) {
            const n = this.#K.getElementHead(e, t),
                i = r.getTypeClass(n);
            if (i <= r.TYPE_GAS || i === r.TYPE_FLUID) return !0;
            const s = r.getBehaviour(n);
            return s === r.BEHAVIOUR_TREE_LEAF || s === r.BEHAVIOUR_GRASS
        }
        #Lt(e, t, n) {
            Me.iterate(Me.BLUEPRINT_4, ((e, i, s) => {
                if (0 === s) return;
                const a = t + e,
                    o = n + i;
                if (this.#K.isValidPosition(a, o)) {
                    let e = this.#K.getElementHead(a, o);
                    if (r.getTypeClass(e) <= r.TYPE_GAS) {
                        const e = this.#mt.getDefaults().getBrushFire();
                        this.#K.setElement(a, o, e.apply(a, o, this.#ut))
                    } else {
                        const t = r.setTemperature(e, Ne.#Ht);
                        this.#K.setElementHead(a, o, t)
                    }
                }
            }))
        }
        #Yt(e, t, n) {
            Me.iterate(Me.BLUEPRINT_9, ((e, i, s) => {
                const a = t + e,
                    o = n + i;
                if (this.#K.isValidPosition(a, o)) {
                    let e = this.#K.getElementHead(a, o);
                    if (0 !== s && r.getBehaviour(e) === r.BEHAVIOUR_METEOR) return;
                    if (s <= 7) {
                        const e = this.#mt.getDefaults().getBrushFire();
                        this.#K.setElement(a, o, e.apply(a, o, this.#ut))
                    } else {
                        const t = (8 === s ? Ne.#Ut : Ne.#Pt) - this.#ut.nextInt(Ne.#Ft);
                        if (e = r.setTemperature(e, t), T.isVisualBurnApplicable(e)) {
                            let e = this.#K.getElementTail(a, o);
                            e = 8 === s ? T.visualBurn(e, 2) : T.visualBurn(e, 1), this.#K.setElementTail(a, o, e)
                        }
                        if (r.getTypeClass(e) === r.TYPE_STATIC && (8 === s || 9 === s && this.#ut.nextInt(10) < 3)) {
                            const t = r.type8Powder(r.TYPE_POWDER, 5);
                            e = r.setType(e, t)
                        }
                        this.#K.setElementHead(a, o, e)
                    }
                }
            }))
        }
    }
    class xe {
        static #Wt = 20;
        static canGrowUpHere(e, t, n) {
            if (t < 0 || n - 1 < 0) return !1;
            if (t >= e.getWidth() || n + 1 >= e.getHeight()) return !1;
            let i = e.getElementHead(t, n);
            if (r.getTypeClass(i) !== r.TYPE_AIR) return !1;
            if (r.getTemperature(i) >= this.#Wt) return !1;
            let s = e.getElementHead(t, n + 1);
            if (r.getBehaviour(s) !== r.BEHAVIOUR_SOIL) return !1;
            if (r.getTemperature(s) >= this.#Wt) return !1;
            let a = e.getElementHead(t, n - 1);
            return r.getTypeClass(a) === r.TYPE_AIR
        }
        static spawnHere(e, t, n, i, s) {
            let a = i.apply(t, n, s),
                o = 0;
            for (let i = r.getSpecial(a.elementHead); i >= 0 && !(n - o < 0); i--) e.setElementHead(t, n - o, r.setSpecial(a.elementHead, i)), e.setElementTail(t, n - o, a.elementTail), o++
        }
        #K;
        #ut;
        #mt;
        constructor(e, t, n) {
            this.#K = e, this.#ut = t, this.#mt = n
        }
        behaviourGrass(e, t, n) {
            if (r.getTemperature(e) > xe.#Wt) {
                this.#K.setElementHead(t, n, r.setBehaviour(e, 0));
                const i = this.#K.getElementTail(t, n),
                    s = this.#ut.nextInt(2) + 1;
                this.#K.setElementTail(t, n, T.visualBurn(i, s))
            }
            let i = this.#ut.nextInt(100);
            if (i < 3) {
                if (n > 0) {
                    let e = this.#K.getElementHead(t, n - 1);
                    if (r.getBehaviour(e) !== r.BEHAVIOUR_GRASS) {
                        let i = r.getTypeClass(e);
                        if (i > r.TYPE_FLUID || i === r.TYPE_FLUID && 0 === this.#ut.nextInt(100)) return void this.#K.setElement(t, n, this.#mt.getDefaults().getDefaultElement())
                    }
                }
                if (0 === i) {
                    let i = r.getSpecial(e);
                    if (0 === i) return void(0 === this.#ut.nextInt(5) && this.#K.setElement(t, n, this.#mt.getDefaults().getDefaultElement()));
                    if (0 === n) return;
                    let s = this.#K.getElementHead(t, n - 1);
                    if (r.getTypeClass(s) !== r.TYPE_AIR) return;
                    if (n > 1) {
                        let e = this.#K.getElementHead(t, n - 2);
                        if (r.getTypeClass(e) !== r.TYPE_AIR) return
                    }
                    this.#K.setElementHead(t, n - 1, r.setSpecial(e, i - 1)), this.#K.setElementTail(t, n - 1, this.#K.getElementTail(t, n))
                } else if (1 === i) {
                    if (xe.canGrowUpHere(this.#K, t + 1, n + 1)) {
                        const e = this.#mt.getDefaults().getBrushGrass();
                        this.#K.setElement(t + 1, n + 1, e.apply(t, n, this.#ut))
                    }
                } else if (2 === i && xe.canGrowUpHere(this.#K, t - 1, n + 1)) {
                    const e = this.#mt.getDefaults().getBrushGrass();
                    this.#K.setElement(t - 1, n + 1, e.apply(t, n, this.#ut))
                }
            }
        }
    }
    class De {
        static TYPE_TRUNK = 1;
        static TYPE_BRANCH = 2;
        static TYPE_LEAF = 3;
        static TYPE_ROOT = 4;
        static #Vt = 100;
        static #Gt = 50;
        static #zt = 40;
        static #Kt = T.visualNoiseProvider(7616891641);
        static #Xt = (e, t, n) => De.#Kt.visualNoise(e, t, n, 10, .5, 1, 68, 77, 40);
        static #qt = (e, t, n) => De.#Kt.visualNoise(e, t, n, 4, .5, .9, 87, 61, 39);
        static spawnHere(e, t, n, i, s, a, o, l = -1) {
            i %= 1 << r.FIELD_SPECIAL_SIZE;
            const h = s.apply(t, n, a);
            h.elementHead = r.setSpecial(h.elementHead, i), e.setElement(t, n, h);
            const c = o.getDefaults().getTreeTrunkTemplates()[i];
            if (void 0 === c) throw "Tree template not found: " + i;
            const d = new De(e, a, o);
            d.#Jt(h.elementHead, t, n, c, l);
            for (let i = 1; i < 10; i++)
                for (let s = 0; s < 9; s++) {
                    const o = t + s - 4,
                        l = n + i;
                    if (!e.isValidPosition(o, l)) continue;
                    const h = e.getElementHead(o, l);
                    if (r.getBehaviour(h) !== r.BEHAVIOUR_TREE_ROOT) continue;
                    const c = r.getSpecial(h);
                    if (0 === c) continue;
                    const u = a.nextInt(10);
                    d.#jt(o, l, h, c, u)
                }
        }
        #K;
        #ut;
        #mt;
        #Zt;
        #Qt;
        constructor(e, t, n) {
            this.#K = e, this.#ut = t, this.#mt = n, this.#Zt = this.#mt.getDefaults().getTreeTrunkTemplates(), this.#Qt = this.#mt.getDefaults().getTreeLeafClusterTemplates()
        }
        behaviourTree(e, t, n) {
            if (r.getTemperature(e) > De.#Vt) return void this.#K.setElementHead(t, n, r.setBehaviour(e, 0));
            if (0 === this.#ut.nextInt(j.OPT_CYCLES_PER_SECOND)) {
                const i = r.getSpecial(e),
                    s = this.#Zt[i];
                if (void 0 === s) throw "Tree template not found: " + i;
                const a = this.#Jt(e, t, n, s, 1);
                this.#$t(t, n, a, s)
            }
        }
        #Jt(e, t, n, s, a = 1) {
            let o = this.#en(t, n - 2),
                l = 0,
                h = 0,
                c = [{
                    entries: s.entries,
                    index: 0,
                    x: 0,
                    y: 0,
                    brush: null
                }],
                d = (e, r, i, s, a) => {
                    let o = i.apply(e, r, this.#ut);
                    if (null === s) this.#K.setElement(e, r, o);
                    else {
                        const i = t - e + 10 * t,
                            a = n - r + 10 * n,
                            l = s(o.elementTail, i, a);
                        this.#K.setElementHeadAndTail(e, r, o.elementHead, l)
                    }
                    this.#mt.trigger(e, r), this.#mt.triggerSolidCreated(o.elementHead, e, r), a && (l++, h++)
                };
            for (; c.length > 0;) {
                const e = c.length;
                let s = !1;
                for (let a = 0; a < e; a++) {
                    const e = c[a];
                    if (e.index >= e.entries.length) {
                        s = !0;
                        continue
                    }
                    const h = e.entries[e.index++],
                        [u, m, E] = h,
                        g = t + u + e.x,
                        p = n - m - e.y;
                    if (this.#K.isValidPosition(g, p)) {
                        const t = this.#K.getElementHead(g, p),
                            n = r.getBehaviour(t);
                        switch (E) {
                            case De.TYPE_LEAF:
                                n === r.BEHAVIOUR_TREE_LEAF ? r.getSpecial(t) < 15 && this.#K.setElementHead(g, p, r.setSpecial(t, 0)) : (n === r.BEHAVIOUR_TREE_TRUNK || r.getTypeClass(t) === r.TYPE_AIR) && d(g, p, e.brush, De.#Xt, !1);
                                break;
                            case De.TYPE_TRUNK:
                                (n === r.BEHAVIOUR_TREE_TRUNK || n === r.BEHAVIOUR_TREE_LEAF) && l++;
                                let s = !1;
                                if ((r.getTypeClass(t) === r.TYPE_AIR || n === r.BEHAVIOUR_SOIL || n === r.BEHAVIOUR_GRASS || m < 5 && r.getTypeClass(t) !== r.TYPE_STATIC) && (s = !0), s) {
                                    d(g, p, m > 0 ? this.#mt.getDefaults().getBrushTreeWood() : this.#mt.getDefaults().getBrushTreeWoodDark(), De.#qt, !0), 2 === m && 0 === u && this.#tn(g, p, o)
                                }
                                break;
                            case De.TYPE_BRANCH:
                                let a = !1;
                                if (n === r.BEHAVIOUR_TREE_LEAF) l++, r.getSpecial(t) < 15 && this.#K.setElementHead(g, p, r.setSpecial(t, 0));
                                else if (n === r.BEHAVIOUR_TREE_TRUNK) l++;
                                else {
                                    if (r.getTypeClass(t) !== r.TYPE_AIR) break;
                                    a = !0
                                }
                                let h = i.next(o + u + m),
                                    A = Math.trunc(h * this.#Qt.length),
                                    f = this.#Qt[A],
                                    T = Math.trunc(1024 * h) % 2 == 0 ? this.#mt.getDefaults().getBrushTreeLeaf() : this.#mt.getDefaults().getBrushTreeLeafDark();
                                c.push({
                                    entries: f.entries,
                                    index: 0,
                                    x: u,
                                    y: m,
                                    brush: T
                                }), a && d(g, p, T, De.#Xt, !0);
                                break;
                            case De.TYPE_ROOT:
                                n === r.BEHAVIOUR_TREE_ROOT ? l++ : d(g, p, this.#mt.getDefaults().getBrushTreeRoot(), null, !0);
                                break;
                            default:
                                throw "Unknown type: " + E
                        }
                    }
                    let A = h.length > 3 ? h[3] : void 0;
                    void 0 !== A && c.push({
                        entries: A,
                        index: 0,
                        x: e.x,
                        y: e.y,
                        brush: e.brush
                    })
                }
                if (-1 !== a && h >= a) break;
                if (s)
                    for (let e = c.length - 1; e >= 0; e--) {
                        let t = c[e];
                        t.index >= t.entries.length && c.splice(e, 1)
                    }
            }
            return l
        }
        #en(e, t) {
            if (this.#K.isValidPosition(e, t)) {
                let n = this.#K.getElementHead(e, t);
                if (r.getBehaviour(n) === r.BEHAVIOUR_TREE_TRUNK) return r.getSpecial(n)
            }
            return this.#ut.nextInt(1 << r.FIELD_SPECIAL_SIZE)
        }
        #tn(e, t, n) {
            let i = this.#K.getElementHead(e, t);
            i = r.setSpecial(i, n), this.#K.setElementHead(e, t, i)
        }
        #$t(e, t, n, i) {
            if (t > 0) {
                let s = this.#K.getElementHead(e, t - 1);
                if (r.getBehaviour(s) === r.BEHAVIOUR_TREE_TRUNK) {
                    const a = 15;
                    let o = r.getSpecial(s),
                        l = Math.trunc(n / i.entriesCount * a);
                    if (o - l > 5) {
                        this.#K.setElementHead(e, t - 1, r.setSpecial(s, 0));
                        const n = this.#mt.getDefaults().getBrushTreeWoodDark();
                        this.#K.setElement(e, t, n.apply(e, t, this.#ut))
                    } else this.#K.setElementHead(e, t - 1, r.setSpecial(s, l))
                }
            }
        }
        behaviourTreeRoot(e, t, n) {
            if (r.getTemperature(e) > De.#Vt) return void this.#K.setElementHead(t, n, r.setBehaviour(e, 0));
            let i = r.getSpecial(e);
            if (0 === i) return void(this.#mt.getIteration() % 1e3 == 0 && this.#nn(t, n));
            let s = this.#ut.nextInt(10 * j.OPT_CYCLES_PER_SECOND);
            s < 10 && this.#jt(t, n, e, i, s)
        }
        #nn(e, t) {
            const n = e + this.#ut.nextInt(3) - 1,
                i = t + this.#ut.nextInt(3) - 1;
            if (this.#K.isValidPosition(n, i)) {
                let e = this.#K.getElementHead(n, i),
                    t = r.getTypeClass(e);
                if (t === r.TYPE_POWDER || t === r.TYPE_POWDER_WET || t === r.TYPE_POWDER_FLOATING) {
                    let t = r.type8(r.type8Solid(r.TYPE_STATIC, 3)),
                        s = r.setType(e, t);
                    this.#K.setElementHead(n, i, s)
                }
            }
        }
        #jt(e, t, n, i, s) {
            let a = (s, a) => {
                this.#K.setElementHead(e, t, r.setSpecial(n, 0));
                let o = this.#mt.getDefaults().getBrushTreeRoot().apply(s, a, this.#ut),
                    l = r.setSpecial(o.elementHead, i - 1);
                this.#K.setElementHead(s, a, l), this.#K.setElementTail(s, a, o.elementTail)
            };
            if (t < this.#K.getHeight() - 1) {
                let n = this.#K.getElementHead(e, t + 1);
                if (r.getTypeClass(n) === r.TYPE_AIR) return void a(e, t + 1)
            }
            let o = e,
                l = t;
            if (9 === s || 8 === s || 7 === s ? (o += 1, l += 1) : 6 === s || 5 === s || 4 === s ? (o += -1, l += 1) : l += 1, this.#K.isValidPosition(o, l)) {
                let e = this.#K.getElementHead(o, l);
                r.getTypeClass(e) !== r.TYPE_STATIC && a(o, l)
            }
        }
        behaviourTreeLeaf(e, t, n) {
            let i = r.getSpecial(e);
            if (i < 15) {
                if (r.getTemperature(e) > De.#zt) return void this.#rn(e, t, n);
                if (this.#mt.getIteration() % 32 == 0 && 0 === this.#ut.nextInt(10)) {
                    if (i++, i >= 15) return void this.#rn(e, t, n);
                    e = r.setSpecial(e, i), this.#K.setElementHead(t, n, e)
                }
            }
            if (this.#mt.getIteration() % 4 == 0 && 0 === this.#ut.nextInt(10)) {
                const e = [
                        [0, -1],
                        [0, -1],
                        [-1, 0],
                        [1, 0],
                        [-1, -1],
                        [1, -1]
                    ],
                    i = e[this.#ut.nextInt(e.length)],
                    s = t + i[0],
                    a = n + i[1],
                    o = this.#K.getElementHeadOrNull(s, a);
                if (null !== o && r.getTypeClass(o) >= r.TYPE_FLUID && r.getTypeClass(o) < r.TYPE_STATIC) {
                    let e = t,
                        i = n;
                    for (let t = 0; t < 25; t++) {
                        e += this.#ut.nextInt(3) - 1, i += 1;
                        const t = this.#K.getElementHeadOrNull(e, i);
                        if (null === t) break;
                        if (r.getBehaviour(t) === r.BEHAVIOUR_TREE_LEAF) continue;
                        if (r.getTypeClass(t) <= r.TYPE_GAS) return void this.#K.swap(s, a, e, i);
                        break
                    }
                    0 === this.#ut.nextInt(20) && this.#K.setElement(t, n, this.#mt.getDefaults().getDefaultElement())
                }
            }
        }
        #rn(e, t, n) {
            const i = this.#K.getElementTail(t, n),
                s = .85,
                a = 255 * (1 - s);
            let o = h.setColor(255 & Math.trunc(1.4 * h.getColorRed(i) * s + a), 255 & Math.trunc(.9 * h.getColorGreen(i) * s + a), 255 & Math.trunc(.8 * h.getColorBlue(i) * s + a));
            const l = r.setSpecial(e, 15);
            this.#K.setElementHeadAndTail(t, n, l, o)
        }
    }
    class Be {
        #K;
        #ut;
        #mt;
        constructor(e, t, n) {
            this.#K = e, this.#ut = t, this.#mt = n
        }
        behaviourWater(e, t, n) {
            const i = r.getTypeClass(e),
                s = r.getTemperature(e);
            if (i === r.TYPE_FLUID) {
                if (s > 20) {
                    const e = this.#mt.getDefaults().getBrushSteam().apply(t, n, this.#ut),
                        i = r.setTemperature(e.elementHead, s);
                    return this.#K.setElementHeadAndTail(t, n, i, e.elementTail), !0
                }
            } else if (i === r.TYPE_GAS && s < 10) {
                const e = this.#mt.getDefaults().getBrushWater().apply(t, n, this.#ut),
                    i = r.setTemperature(e.elementHead, s);
                return this.#K.setElementHeadAndTail(t, n, i, e.elementTail), !0
            }
            return !1
        }
    }
    class _e extends j {
        #K;
        #V;
        #W;
        #in;
        #sn;
        #an;
        #on;
        #ln;
        #hn;
        #cn = 0;
        #ut;
        #dn = !1;
        #un = !1;
        #mn;
        static RANDOM_DATA_COUNT = 32;
        #En = [];
        #gn = [];
        #pn = [];
        #An;
        #fn;
        #Tn;
        #Cn;
        #Rn;
        #yn;
        #Sn;
        #wn = [];
        constructor(e, t, n, r, s) {
            if (super(), this.#K = e, this.#V = e.getWidth(), this.#W = e.getHeight(), this.#in = t, this.#in > 255) throw "Chunk size limit: 255";
            this.#sn = Math.ceil(this.#V / this.#in), this.#an = Math.ceil(this.#W / this.#in), this.#on = new Array(this.#sn * this.#an).fill(!0), this.#ln = new Array(this.#sn * this.#an).fill(!0), this.#hn = new Array(this.#sn * this.#an).fill(-1);
            let a = new i(0);
            this.#En = _e.#vn(_e.RANDOM_DATA_COUNT, this.#sn, a), this.#gn = _e.#In(_e.RANDOM_DATA_COUNT, this.#in, this.#in, a), this.#pn = _e.#vn(_e.RANDOM_DATA_COUNT, this.#in, a), this.#ut = n, this.#mn = r, this.#An = new ve(e, n, this), this.#fn = new Oe(e, n, this), this.#Tn = new Be(e, n, this), this.#Cn = new be(e, n, this), this.#Rn = new Ne(e, n, this), this.#yn = new xe(e, n, this), this.#Sn = new De(e, n, this), s && (this.#cn = s.iteration, this.#dn = s.fallThroughEnabled, this.#un = s.erasingEnabled)
        }
        static #On(e, t, n) {
            for (let r = 0; r < t; r++) {
                let t = n.nextInt(e.length),
                    r = n.nextInt(e.length);
                [e[t], e[r]] = [e[r], e[t]]
            }
        }
        static #vn(e, t, n) {
            let r = _e.#bn(t);
            _e.#On(r, e, n);
            let i = Array(e);
            for (let t = 0; t < e; t++) _e.#On(r, Math.ceil(e / 4), n), i[t] = new Uint8Array(r);
            return i
        }
        static #bn(e) {
            let t = new Uint8Array(e);
            for (let n = 0; n < e; n++) t[n] = n;
            return t
        }
        static #In(e, t, n, r) {
            let i = Array(e);
            for (let s = 0; s < e; s++) i[s] = _e.#Mn(t, n, r);
            return i
        }
        static #Mn(e, t, n) {
            let r = new Uint8Array(e);
            for (let i = 0; i < e; i++) r[i] = n.nextInt(t);
            return r
        }
        getIteration() {
            return this.#cn
        }
        getDefaults() {
            return this.#mn
        }
        setFallThroughEnabled(e) {
            this.#dn = e
        }
        setErasingEnabled(e) {
            this.#un = e
        }
        isFallThroughEnabled() {
            return this.#dn
        }
        isErasingEnabled() {
            return this.#un
        }
        addExtension(e) {
            this.#wn.push(e)
        }
        trigger(e, t) {
            const n = Math.floor(e / this.#in),
                r = Math.floor(t / this.#in) * this.#sn + n;
            this.#on[r] = !0
        }
        triggerSolidCreated(e, t, n) {
            this.#An.onSolidCreated(e, t, n)
        }
        getActiveChunks() {
            return this.#on
        }
        getChangedChunks() {
            return this.#ln
        }
        cleanChangedChunks() {
            this.#ln.fill(!1)
        }
        next() {
            this.#An.onNextIteration();
            const e = Array.from(this.#on);
            this.#on.fill(!1);
            const t = this.#cn % 9,
                n = Math.trunc(t / 3),
                r = t % 3;
            for (let t = this.#an - 1; t >= 0; t--) {
                const i = t * this.#in,
                    s = Math.min((t + 1) * this.#in - 1, this.#W - 1),
                    a = this.#En[this.#ut.nextInt(_e.RANDOM_DATA_COUNT)],
                    o = 0 === this.#ut.nextInt(2),
                    l = new Uint16Array(this.#sn);
                for (let h = s; h >= i; h--)
                    for (let i = 0; i < this.#sn; i++) {
                        const s = a[i],
                            c = t * this.#sn + s,
                            d = this.#ut.nextInt(_e.RANDOM_DATA_COUNT),
                            u = o ? this.#pn[d] : this.#gn[d];
                        if (e[c]) {
                            let e = l[s];
                            for (let t = 0; t < this.#in; t++) {
                                let i = s * this.#in + u[t];
                                if (i < this.#V) {
                                    const t = i % 3 === r && h % 3 === n;
                                    this.#Nn(i, h, t) && e++
                                }
                            }
                            l[s] = e
                        }
                    }
                for (let n = 0; n < this.#sn; n++) {
                    const r = t * this.#sn + n;
                    e[r] || this.#xn(n, t, e) && (e[r] = !0, l[n] = 1)
                }
                if (o)
                    for (let n = 0; n < this.#sn; n++) {
                        const r = t * this.#sn + n;
                        if (e[r] && 0 === l[n]) {
                            const i = this.#hn[r];
                            (-1 === i || this.#cn - i >= 10) && (this.#Dn(n, t) || (e[r] = !1, this.#ln[r] = !0, this.#hn[r] = this.#cn))
                        }
                    }
            }
            if (this.#un) {
                const e = this.#mn.getDefaultElement();
                for (let t = 0; t < this.#V; t++) this.#K.setElement(t, 0, e), this.#K.setElement(t, this.#W - 1, e);
                for (let t = 1; t < this.#W - 1; t++) this.#K.setElement(0, t, e), this.#K.setElement(this.#V - 1, t, e)
            }
            for (let t = 0; t < this.#sn * this.#an; t++) {
                e[t] && (this.#on[t] = !0, this.#ln[t] = !0)
            }
            for (let e of this.#wn) e.run();
            this.#cn++
        }
        #xn(e, t, n) {
            if (e > 0 && n[t * this.#sn + e - 1]) {
                const n = e * this.#in,
                    r = Math.min((t + 1) * this.#in, this.#W);
                for (let e = t * this.#in; e < r; e++)
                    if (this.#Bn(n, e)) return !0
            }
            if (e < this.#sn - 1 && n[t * this.#sn + e + 1]) {
                const n = Math.min((e + 1) * this.#in - 1, this.#V - 1),
                    r = Math.min((t + 1) * this.#in, this.#W);
                for (let e = t * this.#in; e < r; e++)
                    if (this.#Bn(n, e)) return !0
            }
            if (t > 0 && n[(t - 1) * this.#sn + e] || this.#dn && 0 === t && n[(this.#an - 1) * this.#sn + e]) {
                const n = t * this.#in,
                    r = Math.min((e + 1) * this.#in, this.#V);
                for (let t = e * this.#in; t < r; t++)
                    if (this.#Bn(t, n)) return !0
            }
            if (t < this.#an - 1 && n[(t + 1) * this.#sn + e]) {
                const n = (t + 1) * this.#in - 1,
                    r = Math.min((e + 1) * this.#in, this.#V);
                for (let t = e * this.#in; t < r; t++)
                    if (this.#Bn(t, n)) return !0
            }
        }
        #Dn(e, t) {
            const n = Math.min((e + 1) * this.#in, this.#V),
                r = Math.min((t + 1) * this.#in, this.#W);
            for (let i = t * this.#in; i < r; i++)
                for (let t = e * this.#in; t < n; t++)
                    if (this.#Bn(t, i)) return !0;
            return !1
        }
        #Bn(e, t) {
            const n = this.#K.getElementHead(e, t);
            if (r.getTemperature(n) > 0) return !0;
            if (this.#_n(n, e, t)) return !0;
            switch (r.getBehaviour(n)) {
                case r.BEHAVIOUR_NONE:
                case r.BEHAVIOUR_SOIL:
                case r.BEHAVIOUR_TREE_TRUNK:
                    return !1;
                default:
                    return !0
            }
        }
        #_n(e, t, n) {
            const i = r.getTypeClass(e);
            switch (i) {
                case r.TYPE_AIR:
                    return !1;
                case r.TYPE_POWDER:
                case r.TYPE_POWDER_FLOATING:
                case r.TYPE_POWDER_WET:
                    return !!r.getTypeModifierPowderSliding(e) || this.#Hn(e, t, n, t, n + 1);
                case r.TYPE_FLUID:
                    return this.#Hn(e, t, n, t, n + 1) || this.#Hn(e, t, n, t + 1, n) || this.#Hn(e, t, n, t - 1, n);
                case r.TYPE_GAS:
                    return this.#Hn(e, t, n, t, n - 1) || this.#Hn(e, t, n, t + 1, n) || this.#Hn(e, t, n, t - 1, n);
                case r.TYPE_STATIC:
                    return 0 !== r.getTypeModifierSolidBodyId(e);
                default:
                    return !0
            }
            throw "Unknown element type: " + i
        }
        #Hn(e, t, n, r, i) {
            if (!this.#K.isValidPosition(r, i)) {
                if (!this.#dn || n !== this.#W - 1) return !1;
                if (i = 0, !this.#K.isValidPosition(r, i)) return !1
            }
            let s = this.#K.getElementHead(r, i);
            return this.#kt(e, s)
        }
        #Nn(e, t, n) {
            const i = this.#K.getElementHead(e, t);
            if (this.#Un(i, e, t)) return !0;
            const s = r.getBehaviour(i);
            let a = !1;
            switch (s) {
                case r.BEHAVIOUR_NONE:
                case r.BEHAVIOUR_SOIL:
                    break;
                case r.BEHAVIOUR_WATER:
                    this.#Tn.behaviourWater(i, e, t) && (a = r.getTemperature(i) > 0, n = !1);
                    break;
                case r.BEHAVIOUR_FIRE:
                    this.#Cn.behaviourFire(i, e, t), a = !0, n = !1;
                    break;
                case r.BEHAVIOUR_GRASS:
                    this.#yn.behaviourGrass(i, e, t), a = !0;
                    break;
                case r.BEHAVIOUR_TREE:
                    this.#Sn.behaviourTree(i, e, t), a = !0;
                    break;
                case r.BEHAVIOUR_TREE_LEAF:
                    this.#Sn.behaviourTreeLeaf(i, e, t), a = !0;
                    break;
                case r.BEHAVIOUR_TREE_TRUNK:
                    break;
                case r.BEHAVIOUR_TREE_ROOT:
                    this.#Sn.behaviourTreeRoot(i, e, t), a = !0;
                    break;
                case r.BEHAVIOUR_FIRE_SOURCE:
                    this.#Cn.behaviourFireSource(i, e, t), a = !0, n = !1;
                    break;
                case r.BEHAVIOUR_METEOR:
                    this.#Rn.behaviourMeteor(i, e, t), a = !0, n = !1;
                    break;
                case r.BEHAVIOUR_ENTITY:
                    this.#fn.behaviourEntity(i, e, t), n = !0, a = !0;
                    break;
                default:
                    throw "Unknown element behaviour: " + s
            }
            if (n) {
                const n = this.#Pn(i, e, t);
                return a || n
            }
            return a
        }
        #Pn(e, t, n) {
            const i = r.getTemperature(e);
            if (0 === i) {
                const s = r.getHeatModIndex(e);
                return i < r.hmiToHardeningTemperature(s) && (this.#Fn(e, t, n, s), !0)
            }
            let s = t,
                a = n;
            switch (this.#ut.nextInt(4)) {
                case 0:
                    a--;
                    break;
                case 1:
                    s++;
                    break;
                case 2:
                    a++;
                    break;
                case 3:
                    s--
            }
            const o = r.getHeatModIndex(e),
                l = this.#ut.nextInt(1e4) < r.hmiToHeatLossChanceTo10000(o);
            let c;
            if (this.#K.isValidPosition(s, a)) {
                const h = this.#K.getElementHead(s, a),
                    d = r.getTemperature(h);
                if (i + d > 1) {
                    const e = r.hmiToConductiveIndex(o);
                    c = Math.trunc(e * d + (1 - e) * i)
                }
                if (i - c != 0) {
                    let o;
                    l && c--, c = Math.max(c, 0), o = d - c > 10 ? d - 10 : d + (i - c), o = Math.max(o, 0), this.#K.setElementHead(s, a, r.setTemperature(h, o)), this.trigger(s, a), i - c > 10 && (c = i - 10), e = r.setTemperature(e, c), this.#K.setElementHead(t, n, e)
                }
            } else l && (c = Math.max(i - 1, 0), e = r.setTemperature(e, c), this.#K.setElementHead(t, n, e));
            const d = r.hmiToSelfIgnitionChanceTo10000(o);
            if (c > 100 && d > 0)
                if (r.getBehaviour(e) === r.BEHAVIOUR_FIRE_SOURCE);
                else if (this.#ut.nextInt(1e4) < d) return this.#Cn.ignite(e, t, n, o), !0;
            if (c > r.hmiToMeltingTemperature(o)) {
                e = r.setType(e, r.TYPE_FLUID), e = r.setHeatModIndex(e, r.hmiToMeltingHMI(o));
                let i = this.#K.getElementTail(t, n);
                return i = h.setBlurType(i, h.BLUR_TYPE_1), this.#K.setElementHeadAndTail(t, n, e, i), !0
            }
            return c < r.hmiToHardeningTemperature(o) && this.#Fn(e, t, n, o), !0
        }
        #Fn(e, t, n, i) {
            if (this.#Ln(t, n)) {
                e = r.setType(e, r.type8Solid(r.TYPE_STATIC, 2)), e = r.setHeatModIndex(e, r.hmiToHardeningHMI(i));
                let s = this.#K.getElementTail(t, n);
                s = h.setBlurType(s, h.BLUR_TYPE_NONE), this.#K.setElementHeadAndTail(t, n, e, s)
            }
        }
        #Ln(e, t) {
            if (t !== this.#W - 1) {
                if (this.#kn(this.#K.getElementHead(e, t + 1))) return !0
            } else if (!this.#dn && !this.#un) return !0;
            return !(!this.#K.isValidPosition(e - 1, t) || !this.#kn(this.#K.getElementHead(e - 1, t))) || !(!this.#K.isValidPosition(e + 1, t) || !this.#kn(this.#K.getElementHead(e + 1, t)))
        }
        #kn(e) {
            return r.getTypeClass(e) > r.TYPE_FLUID
        }
        #Un(e, t, n) {
            const i = r.getTypeClass(e);
            switch (i) {
                case r.TYPE_AIR:
                    return !1;
                case r.TYPE_POWDER:
                case r.TYPE_POWDER_WET:
                case r.TYPE_POWDER_FLOATING:
                    if (this.#Yn(e, t, n, t, n + 1)) return n % 2 == 0 ? this.#Wn(t - 1, n + 1, 0) : this.#Wn(t + 1, n + 1, 1), this.#Wn(t, n + 1, n % 2), n % 2 == 0 ? this.#Wn(t + 1, n, 0) : this.#Wn(t - 1, n, 1), !0;
                    if (1 === r.getTypeModifierPowderSliding(e)) {
                        const i = r.getTypeModifierPowderMomentum(e);
                        if (this.#ut.nextInt(1e6) > _e.#Vn(i)) return this.#K.setElementHead(t, n, r.setTypeModifierPowderSliding(e, 0)), !1;
                        const s = r.getTypeModifierPowderDirection(e);
                        this.#Wn(t, n + 1, s);
                        const a = 0 === s ? -1 : 1;
                        return this.#Yn(e, t, n, t + a, n) ? (this.#Wn(t + a, n + 1, s), this.#Wn(t - a, n, s), !0) : (this.#Wn(t + a, n + 1, s), this.#K.setElementHead(t, n, r.setTypeModifierPowderSliding(e, 0)), !1)
                    }
                    return !1;
                case r.TYPE_FLUID:
                    if (!this.#Yn(e, t, n, t, n + 1)) {
                        return 0 === this.#ut.nextInt(2) ? !!this.#Yn(e, t, n, t + 1, n) && (this.#Wn(t + 1, n + 1, 1), this.#Yn(e, t + 1, n, t + 2, n) && (this.#Yn(e, t + 2, n, t + 3, n) ? this.trigger(t + 3, n) : this.trigger(t + 2, n)), !0) : !!this.#Yn(e, t, n, t - 1, n) && (this.#Wn(t - 1, n + 1, 0), this.#Yn(e, t - 1, n, t - 2, n) && (this.#Yn(e, t - 2, n, t - 3, n) ? this.trigger(t - 3, n) : this.trigger(t - 2, n)), !0)
                    }
                    return !0;
                case r.TYPE_GAS:
                    let i = this.#ut.nextInt(8);
                    return 0 !== i && 2 !== i || !this.#Yn(e, t, n, t, n - 1) ? 3 === i && this.#Yn(e, t, n, t + 1, n) ? (this.trigger(t + 1, n), !0) : !(4 !== i || !this.#Yn(e, t, n, t - 1, n)) && (this.trigger(t - 1, n), !0) : (this.trigger(t, n - 1), !0);
                case r.TYPE_STATIC:
                    return 0 !== r.getTypeModifierSolidBodyId(e) && this.#An.behaviourSolid(e, t, n);
                case r.TYPE_EFFECT:
                    return !1
            }
            throw "Unknown element type: " + i
        }
        #Yn(e, t, n, i, s) {
            if (!this.#K.isValidPosition(i, s)) {
                if (!this.#dn || n !== this.#W - 1) return !1;
                if (s = 0, !this.#K.isValidPosition(i, s)) return !1
            }
            const a = this.#K.getElementHead(i, s),
                o = r.getTypeClass(a);
            if (o === r.TYPE_POWDER_FLOATING || o === r.TYPE_POWDER) return !1;
            const l = r.getTypeClass(e);
            if (l > o) {
                if (l === r.TYPE_POWDER && o === r.TYPE_FLUID) {
                    const o = r.setTypeClass(e, r.TYPE_POWDER_WET),
                        l = this.#K.getElementTail(t, n);
                    if (this.#ut.nextInt(100) > 9) this.#K.setElement(t, n, this.#mn.getDefaultElement());
                    else {
                        const e = this.#K.getElementTail(i, s);
                        this.#K.setElementHead(t, n, a), this.#K.setElementTail(t, n, e)
                    }
                    this.#K.setElementHead(i, s, o), this.#K.setElementTail(i, s, l)
                } else {
                    const r = this.#K.getElementTail(t, n),
                        o = this.#K.getElementTail(i, s);
                    this.#K.setElementHead(i, s, e), this.#K.setElementHead(t, n, a), this.#K.setElementTail(i, s, r), this.#K.setElementTail(t, n, o)
                }
                return !0
            }
            return !1
        }
        #kt(e, t) {
            const n = r.getTypeClass(t);
            if (n === r.TYPE_POWDER_FLOATING || n === r.TYPE_POWDER) return !1;
            return r.getTypeClass(e) > n
        }
        #Wn(e, t, n) {
            if (this.#K.isValidPosition(e, t)) {
                let i = this.#K.getElementHead(e, t);
                const s = r.getTypeClass(i);
                if (s === r.TYPE_POWDER || s === r.TYPE_POWDER_WET || s === r.TYPE_POWDER_FLOATING) {
                    const s = r.getTypeModifierPowderMomentum(i);
                    if (0 === s) return;
                    const a = 0 === n ? -1 : 1;
                    if (this.#K.isValidPosition(e + a, t)) {
                        const n = this.#K.getElementHead(e + a, t);
                        if (!this.#kt(i, n)) return
                    }
                    if (this.#ut.nextInt(1e6) > _e.#Gn(s)) return;
                    i = r.setTypeModifierPowderSliding(i, 1), i = r.setTypeModifierPowderDirection(i, n), this.#K.setElementHead(e, t, i)
                }
            }
        }
        static #Vn(e) {
            return [0, 4e5, 6e5, 7e5, 7e5, 8e5, 95e4, 95e4][e]
        }
        static #Gn(e) {
            return [0, 4e5, 4e5, 4e5, 6e5, 6e5, 85e4, 9e5][e]
        }
    }
    class He {
        trigger(e, t) {
            throw "Not implemented"
        }
        render(e) {
            throw "Not implemented"
        }
    }
    class Ue {
        apply(e, t, n, r) {
            throw "Not implemented"
        }
    }
    class Pe extends He {
        static renderPreview(e, t, n = 255) {
            const r = e.getWidth(),
                i = e.getHeight(),
                s = t.createImageData(r, i),
                a = s.data;
            for (let t = 0; t < r; t++)
                for (let s = 0; s < i; s++) {
                    const i = 4 * (r * s + t),
                        o = e.getElementTail(t, s);
                    o === F.TRANSPARENT_ELEMENT.elementTail && e.getElementHead(t, s) === F.TRANSPARENT_ELEMENT.elementHead ? a[i + 3] = 0 : (a[i] = h.getColorRed(o), a[i + 1] = h.getColorGreen(o), a[i + 2] = h.getColorBlue(o), a[i + 3] = n)
                }
            t.putImageData(s, 0, 0, 0, 0, r, i)
        }
        #zn;
        #Kn = null;
        #K;
        #V;
        #W;
        #in;
        #sn;
        #an;
        #Xn;
        #qn;
        #Jn;
        #jn;
        constructor(e, t, n) {
            super(), this.#zn = n, this.#K = e, this.#V = e.getWidth(), this.#W = e.getHeight(), this.#in = t, this.#sn = Math.ceil(this.#V / this.#in), this.#an = Math.ceil(this.#W / this.#in), this.#Xn = new Array(this.#sn * this.#an).fill(!0), this.#qn = this.#zn.createImageData(this.#V, this.#W);
            const r = this.#qn.data;
            for (let e = 0; e < this.#W; e++)
                for (let t = 0; t < this.#V; t++) {
                    r[4 * (this.#V * e + t) + 3] = 255
                }
            this.#Jn = new Array(this.#V * this.#W).fill(!1), this.#jn = new Array(this.#V * this.#W).fill(!1)
        }
        trigger(e, t) {
            const n = Math.trunc(e / this.#in),
                r = Math.trunc(t / this.#in) * this.#sn + n;
            this.#Xn[r] = !0
        }
        triggerChunk(e, t) {
            const n = t * this.#sn + e;
            this.#Xn[n] = !0
        }
        triggerChunks(e) {
            if (e.length !== this.#Xn.length) throw "Array must be of the same size";
            for (let t = 0; t < e.length; t++) {
                const n = e[t];
                n && (this.#Xn[t] = n)
            }
        }
        setMode(e) {
            this.#Kn = e, this.#Xn.fill(!0), this.#Jn.fill(!1), this.#jn.fill(!1)
        }
        render(e) {
            for (let t = 0; t < this.#an; t++)
                for (let n = 0; n < this.#sn; n++) {
                    const r = t * this.#sn + n,
                        i = this.#Xn[r];
                    i && (this.#Xn[r] = !1);
                    const s = e[r];
                    if (s && (this.#Xn[r] = !0), i || s) {
                        let r = !1;
                        if (t + 1 < this.#sn) {
                            const i = (t + 1) * this.#sn + n;
                            this.#Xn[i] || e[i] || (r = !0)
                        }
                        this.#Zn(n, t, r)
                    }
                }
            this.#zn.putImageData(this.#qn, 0, 0, 0, 0, this.#V, this.#W)
        }
        #Zn(e, t, n) {
            const r = Math.min((e + 1) * this.#in, this.#V),
                i = Math.min((t + 1) * this.#in + (n ? 1 : 0), this.#W);
            for (let n = t * this.#in; n < i; n++)
                for (let t = e * this.#in; t < r; t++) this.#Qn(t, n, this.#qn.data)
        }
        #Qn(e, t, n) {
            const r = this.#K.getElementTail(e, t),
                i = this.#V * t + e,
                s = 4 * i,
                a = h.getBlurType(r);
            if (a === h.BLUR_TYPE_BACKGROUND && (this.#jn[i] && Pe.#$n(r) && (this.#Jn[i] = !0, this.#jn[i] = !1), this.#Jn[i])) {
                const r = n[s],
                    a = n[s + 1],
                    o = n[s + 2],
                    l = .1 * Math.random() - .05 + .875,
                    h = 255 * (1 - l),
                    c = Math.trunc(r * l + h),
                    d = Math.trunc(a * l + h),
                    u = Math.trunc(o * l + h);
                r === c && a === d && o === u ? (this.#Jn[i] = !1, n[s] = 255, n[s + 1] = 255, n[s + 2] = 255) : (n[s] = c, n[s + 1] = d, n[s + 2] = u, this.trigger(e, t))
            } else if (null === this.#Kn) n[s] = h.getColorRed(r), n[s + 1] = h.getColorGreen(r), n[s + 2] = h.getColorBlue(r), this.#jn[i] = a === h.BLUR_TYPE_1, this.#Jn[i] = !1;
            else {
                let i = this.#K.getElementHead(e, t);
                this.#Kn.apply(n, s, i, r)
            }
        }
        static #$n(e) {
            return 255 === h.getColorRed(e) && 255 === h.getColorGreen(e) && 255 === h.getColorBlue(e)
        }
    }
    class Fe extends Ue {
        #er = null;
        constructor() {
            super(), u.asImageData("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfQAAAABCAIAAACnnMvDAAAACXBIWXMAAAsTAAALEwEAmpwYAAABTUlEQVQ4T22QUZIjMQhDHzhH32PHYj/UZoiTLlcXloQQfsE/AF6QsM6/i4CABa9T5Kj5RPqfkL9s29y2l6e75lBff33Nx2h6AcfGxxP6ykjU+Exkw5m3YxqfbnPRucfPSFev1+p64rbqrm9NAif2xfYiPc5UCz5sixRLZLF2poDMylSmcilcLxkBMhShpBIlCirZiwoEGDz4U/tqxPqg1oMrqcEqkak2sW2g9WlrK2DiBsfQJ1JQi90ZAuLIEnmdwbrwXg+42ImggvpK8mQ+UTvMh//Fdh6D/Xrt1uITqc77/C2SUlRFKaVUpSpFbFKECAEgEGwo2CCog3Bwawy6qNNrZOJumV3XiIu98I4xRztMt7Smz1zkW3YtcmnMXtTPqK35yZ4RJd4bQELiLarYG4m9nwltsMe61/COY6rgfWa+x8xmO1FbWd91P5Lr/2afRpQBYZvbAAAAAElFTkSuQmCC").then((e => this.#er = e))
        }
        apply(e, t, n, i) {
            if (null !== this.#er)
                if (0 === n) e[t] = 0, e[t + 1] = 0, e[t + 2] = 0;
                else {
                    const i = r.getTemperature(n),
                        s = 4 * Math.trunc(i / (1 << r.FIELD_TEMPERATURE_SIZE) * this.#er.width);
                    e[t] = this.#er.data[s], e[t + 1] = this.#er.data[s + 1], e[t + 2] = this.#er.data[s + 2]
                }
        }
    }
    class Le extends Ue {
        constructor() {
            super()
        }
        #tr(e) {
            switch (r.getTypeClass(e)) {
                case r.TYPE_AIR:
                    return [255, 255, 255];
                case r.TYPE_STATIC:
                    return [0, 0, 0];
                case r.TYPE_FLUID:
                    return [0, 0, 255];
                case r.TYPE_POWDER:
                case r.TYPE_POWDER_WET:
                case r.TYPE_POWDER_FLOATING:
                    if (1 === r.getTypeModifierPowderSliding(e)) return 1 === r.getTypeModifierPowderDirection(e) ? [232, 137, 70] : [255, 0, 0];
                    switch (r.getTypeClass(e)) {
                        case r.TYPE_POWDER:
                            return [36, 163, 57];
                        case r.TYPE_POWDER_WET:
                            return [44, 122, 57];
                        case r.TYPE_POWDER_FLOATING:
                            return [16, 194, 45]
                    }
                default:
                    return [255, 0, 125]
            }
        }
        apply(e, t, n, r) {
            const [i, s, a] = this.#tr(n);
            return e[t] = i, e[t + 1] = s, e[t + 2] = a, !1
        }
    }
    class ke extends He {
        #zn;
        #K;
        #V;
        #W;
        #nr;
        constructor(e, t, n) {
            super(), this.#zn = n, this.#K = e, this.#V = e.getWidth(), this.#W = e.getHeight();
            const r = this.#zn,
                i = this.#N("255,51,0\n255,69,0\n255,82,0\n255,93,0\n255,102,0\n255,111,0\n255,118,0\n255,124,0\n255,130,0\n255,135,0\n255,141,11\n255,146,29\n255,152,41\n255,157,51\n255,162,60\n255,166,69\n255,170,77\n255,174,84\n255,178,91\n255,182,98\n255,185,105\n255,189,111\n255,192,118\n255,195,124\n255,198,130\n255,201,135\n255,203,141\n255,206,146\n255,208,151\n255,211,156\n255,213,161\n255,215,166\n255,217,171\n255,219,175\n255,221,180\n255,223,184\n255,225,188\n255,226,192\n255,228,196\n255,229,200\n255,231,204\n255,232,208\n255,234,211\n255,235,215\n255,237,218\n255,238,222\n255,239,225\n255,240,228\n255,241,231\n255,243,234\n255,244,237\n255,245,240\n255,246,243\n255,247,245\n255,248,248\n255,249,251\n255,249,253\n254,250,255\n252,248,255\n250,247,255\n247,245,255\n245,244,255\n243,243,255\n241,241,255\n239,240,255\n238,239,255\n236,238,255\n234,237,255\n233,236,255\n231,234,255\n229,233,255\n228,233,255\n227,232,255\n225,231,255\n224,230,255\n223,229,255\n221,228,255\n220,227,255\n219,226,255\n218,226,255\n217,225,255\n216,224,255\n215,223,255\n214,223,255\n213,222,255\n212,221,255\n211,221,255\n210,220,255\n209,220,255\n208,219,255\n207,218,255"),
                s = i.byteLength / 4,
                a = `\n            float countTemperaturePaletteIndex(float c) {\n                float k = c + 273.0;  // 0 C = 273 K\n                if (k < 1000.0) {\n                    return 0.0;\n                } else {\n                    return floor(k / 100.0 - 10.0);\n                }\n            }\n            \n            void applyTemperature(float temperature, int heatType, inout float r, inout float g, inout float b) {\n                float tFactor;\n                float aFactor = 0.001;\n                if (heatType == 0x01) {\n                    tFactor = 0.5;\n                } else if (heatType == 0x02) {\n                    tFactor = 1.0;\n                } else {  // heatType == 0x03\n                    tFactor = 1.45;\n                }\n                \n                float sTemp = (temperature * 255.0 * 10.0) * tFactor;\n                float i = countTemperaturePaletteIndex(sTemp);\n                vec4 color = texture(u_temperature_palette, vec2((i + 0.5) / ${s}.0, 0.5));\n                float cr = color[0];\n                float cg = color[1];\n                float cb = color[2];\n                \n                float alpha = 1.0 - sTemp * aFactor;\n                \n                // alpha blending\n                r = (r * alpha) + (cr * (1.0 - alpha));\n                g = (g * alpha) + (cg * (1.0 - alpha));\n                b = (b * alpha) + (cb * (1.0 - alpha));\n            }\n        `,
                o = `#version 300 es\n            precision mediump float;\n            \n            in vec2 v_texcoord;\n            out vec4 v_color;\n            \n            uniform sampler2D u_element_heads;\n            uniform sampler2D u_element_tails;\n            uniform sampler2D u_blur;\n            uniform sampler2D u_temperature_palette;\n            \n            ${a}\n\n            float rand(vec2 co) {\n                return fract(sin(dot(co.xy, vec2(12.9898,78.233))) * 43758.5453);\n            }\n\n            void main() {\n                vec4 elementTail = texture(u_element_tails, v_texcoord);\n                int flags = int(floor(elementTail[3] * 255.0 + 0.5));\n                int blurType = (flags & 0x3);\n            \n                if (blurType == 0x0) {  // == BLUR_TYPE_NONE\n                    // do not render non-blurrable elements\n                    v_color = vec4(1.0, 1.0, 1.0, 1.0);\n                    \n                } else if (blurType == 0x1) {  // == BLUR_TYPE_BACKGROUND\n                    // fade out... using alpha blending with white background\n                    \n                    vec4 oldPixel = texture(u_blur, v_texcoord);\n                    float r = oldPixel[0];  // 0..1\n                    float g = oldPixel[1];\n                    float b = oldPixel[2];\n                    \n                    float alpha;  // dynamic alpha\n                    float m = max(r, max(g, b));\n                    if (m > 0.9) {\n                        alpha = 0.875 + (rand(v_texcoord.xy) * 0.1 - 0.05);\n                    } else {\n                        alpha = 0.775 + (rand(v_texcoord.xy) * 0.04 - 0.02);\n                    }\n                    float whiteBackground = 1.0 - alpha;\n                    \n                    float nr = (r * alpha) + whiteBackground;\n                    float ng = (g * alpha) + whiteBackground;\n                    float nb = (b * alpha) + whiteBackground;\n                    \n                    if (int(nr * 255.0) == int(r * 255.0)\n                            && int(ng * 255.0) == int(g * 255.0)\n                            && int(nb * 255.0) == int(b * 255.0)) {\n                            \n                        // no change - delete blur (otherwise there could be visible remains)\n                        v_color = vec4(1.0, 1.0, 1.0, 1.0);\n                        \n                    } else {\n                        v_color = vec4(nr, ng, nb, 1.0);\n                    }\n                    \n                } else {  // == BLUR_TYPE_1\n                    // render element\n                    float r = elementTail[2];  // 0..1\n                    float g = elementTail[1];\n                    float b = elementTail[0];\n                    \n                    // apply temperature\n                    int heatType = (flags >> 4) & 0x3;\n                    if (heatType > 0) {\n                        vec4 elementHead = texture(u_element_heads, v_texcoord);\n                        float temperature = elementHead[3];  // 0..1\n                        \n                        if (temperature >= 0.001) {\n                            applyTemperature(temperature, heatType, r, g, b);\n                        }\n                    }\n                    \n                    v_color = vec4(r, g, b, 1.0);\n                }\n            }\n        `,
                l = this.#rr(r, "#version 300 es\n            in vec4 a_position;\n            \n            out vec2 v_texcoord;\n            \n            void main() {\n              gl_Position = a_position;\n              v_texcoord = a_position.xy * vec2(0.5, 0.5) + 0.5;\n            }\n        ", o),
                h = r.getUniformLocation(l, "u_element_heads"),
                c = r.getUniformLocation(l, "u_element_tails"),
                d = r.getUniformLocation(l, "u_blur"),
                u = r.getUniformLocation(l, "u_temperature_palette"),
                m = `#version 300 es\n            precision mediump float;\n            \n            in vec2 v_texcoord;\n            out vec4 v_color;\n            \n            uniform sampler2D u_element_heads;\n            uniform sampler2D u_element_tails;\n            uniform sampler2D u_blur;\n            uniform sampler2D u_temperature_palette;\n            \n            ${a}\n            \n            void main() {\n                vec4 elementTail = texture(u_element_tails, v_texcoord);\n                int flags = int(floor(elementTail[3] * 255.0 + 0.5));\n                int blurType = (flags & 0x3);\n                \n                if (blurType == 0x00) {  // == BLUR_TYPE_NONE\n                    // render element\n                    float r = elementTail[2];  // 0..1\n                    float g = elementTail[1];\n                    float b = elementTail[0];\n                    \n                    // apply temperature\n                    int heatType = (flags >> 4) & 0x3;\n                    if (heatType > 0) {\n                        vec4 elementHead = texture(u_element_heads, v_texcoord);\n                        float temperature = elementHead[3];  // 0..1\n                        \n                        if (temperature >= 0.001) {\n                            applyTemperature(temperature, heatType, r, g, b);\n                        }\n                    }\n                    \n                    v_color = vec4(r, g, b, 1.0);\n                \n                } else {\n                    v_color = texture(u_blur, v_texcoord);\n                }\n            }\n        `,
                E = this.#rr(r, "#version 300 es\n            in vec4 a_position;\n            \n            out vec2 v_texcoord;\n            \n            void main() {\n              gl_Position = a_position;\n\n              // Flip Y though so we get the top at 0\n              v_texcoord = a_position.xy * vec2(0.5, -0.5) + 0.5;\n            }\n        ", m),
                g = r.getUniformLocation(E, "u_element_heads"),
                p = r.getUniformLocation(E, "u_element_tails"),
                A = r.getUniformLocation(E, "u_blur"),
                f = r.getUniformLocation(E, "u_temperature_palette"),
                T = [1, 1, -1, 1, -1, -1, 1, 1, -1, -1, 1, -1],
                C = r.createBuffer();
            r.bindBuffer(r.ARRAY_BUFFER, C), r.bufferData(r.ARRAY_BUFFER, new Float32Array(T), r.STATIC_DRAW), r.enableVertexAttribArray(0), r.vertexAttribPointer(0, 2, r.FLOAT, !1, 0, 0);
            const R = e => {
                    const t = new Uint8Array(this.#K.getDataTails().byteLength).fill(255),
                        n = r.createTexture();
                    r.activeTexture(e), r.bindTexture(r.TEXTURE_2D, n), r.texParameteri(r.TEXTURE_2D, r.TEXTURE_WRAP_S, r.CLAMP_TO_EDGE), r.texParameteri(r.TEXTURE_2D, r.TEXTURE_WRAP_T, r.CLAMP_TO_EDGE), r.texParameteri(r.TEXTURE_2D, r.TEXTURE_MIN_FILTER, r.NEAREST), r.texParameteri(r.TEXTURE_2D, r.TEXTURE_MAG_FILTER, r.NEAREST), r.texImage2D(r.TEXTURE_2D, 0, r.RGBA, this.#V, this.#W, 0, r.RGBA, r.UNSIGNED_BYTE, t);
                    const i = r.createFramebuffer();
                    return r.bindFramebuffer(r.FRAMEBUFFER, i), r.framebufferTexture2D(r.FRAMEBUFFER, r.COLOR_ATTACHMENT0, r.TEXTURE_2D, n, 0), i
                },
                y = R(r.TEXTURE2),
                S = R(r.TEXTURE3),
                w = r.createTexture();
            r.activeTexture(r.TEXTURE0), r.bindTexture(r.TEXTURE_2D, w), r.texParameteri(r.TEXTURE_2D, r.TEXTURE_WRAP_S, r.CLAMP_TO_EDGE), r.texParameteri(r.TEXTURE_2D, r.TEXTURE_WRAP_T, r.CLAMP_TO_EDGE), r.texParameteri(r.TEXTURE_2D, r.TEXTURE_MIN_FILTER, r.NEAREST), r.texParameteri(r.TEXTURE_2D, r.TEXTURE_MAG_FILTER, r.NEAREST);
            const v = r.createTexture();
            r.activeTexture(r.TEXTURE1), r.bindTexture(r.TEXTURE_2D, v), r.texParameteri(r.TEXTURE_2D, r.TEXTURE_WRAP_S, r.CLAMP_TO_EDGE), r.texParameteri(r.TEXTURE_2D, r.TEXTURE_WRAP_T, r.CLAMP_TO_EDGE), r.texParameteri(r.TEXTURE_2D, r.TEXTURE_MIN_FILTER, r.NEAREST), r.texParameteri(r.TEXTURE_2D, r.TEXTURE_MAG_FILTER, r.NEAREST);
            const I = r.createTexture();
            r.activeTexture(r.TEXTURE4), r.bindTexture(r.TEXTURE_2D, I), r.texParameteri(r.TEXTURE_2D, r.TEXTURE_WRAP_S, r.CLAMP_TO_EDGE), r.texParameteri(r.TEXTURE_2D, r.TEXTURE_WRAP_T, r.CLAMP_TO_EDGE), r.texParameteri(r.TEXTURE_2D, r.TEXTURE_MIN_FILTER, r.NEAREST), r.texParameteri(r.TEXTURE_2D, r.TEXTURE_MAG_FILTER, r.NEAREST);
            let O = 2;
            this.#nr = () => {
                const e = new Uint8Array(this.#K.getDataHeads());
                r.bindTexture(r.TEXTURE_2D, w), r.texImage2D(r.TEXTURE_2D, 0, r.RGBA, this.#V, this.#W, 0, r.RGBA, r.UNSIGNED_BYTE, e);
                const t = new Uint8Array(this.#K.getDataTails());
                r.bindTexture(r.TEXTURE_2D, v), r.texImage2D(r.TEXTURE_2D, 0, r.RGBA, this.#V, this.#W, 0, r.RGBA, r.UNSIGNED_BYTE, t), r.bindTexture(r.TEXTURE_2D, I), r.texImage2D(r.TEXTURE_2D, 0, r.RGBA, s, 1, 0, r.RGBA, r.UNSIGNED_BYTE, i), r.bindFramebuffer(r.FRAMEBUFFER, 2 === O ? y : S), r.useProgram(l), r.uniform1i(h, 0), r.uniform1i(c, 1), r.uniform1i(d, 2 === O ? 3 : 2), r.uniform1i(u, 4), r.drawArrays(r.TRIANGLES, 0, T.length / 2), r.bindFramebuffer(r.FRAMEBUFFER, null), r.useProgram(E), r.uniform1i(g, 0), r.uniform1i(p, 1), r.uniform1i(A, O), r.uniform1i(f, 4), r.drawArrays(r.TRIANGLES, 0, T.length / 2), O = 2 === O ? 3 : 2
            }
        }
        trigger(e, t) {}
        render(e) {
            this.#nr()
        }
        #rr(e, t, n) {
            const r = e.createProgram();
            if (e.attachShader(r, this.#ir(e, t, e.VERTEX_SHADER)), e.bindAttribLocation(r, 0, "a_position"), e.attachShader(r, this.#ir(e, n, e.FRAGMENT_SHADER)), e.linkProgram(r), !e.getProgramParameter(r, e.LINK_STATUS) && !e.isContextLost()) {
                throw `Error in program linking: ${e.getProgramInfoLog(r)}`
            }
            return r
        }
        #ir(e, t, n) {
            const r = e.createShader(n);
            if (null === r) throw "Error compiling shader: cannot create shader";
            if (e.shaderSource(r, t), e.compileShader(r), !e.getShaderParameter(r, e.COMPILE_STATUS) && !e.isContextLost()) {
                throw `Error compiling shader: ${e.getShaderInfoLog(r)}`
            }
            return r
        }
        #N(e) {
            const t = e.split("\n").map((e => e.split(",").map(Number))),
                n = new Uint8Array(4 * t.length);
            for (let e = 0; e < t.length; e++) {
                const r = t[e];
                n[4 * e] = r[0], n[4 * e + 1] = r[1], n[4 * e + 2] = r[2]
            }
            return n
        }
    }
    class Ye extends He {
        constructor() {
            super()
        }
        trigger(e, t) {}
        render(e) {}
    }
    class We {
        #sr;
        constructor(e) {
            this.#sr = e
        }
        getError() {
            return this.#sr
        }
    }
    class Ve {
        getContextType() {
            throw "Not implemented"
        }
        initialize(e, t, n) {
            throw "Not implemented"
        }
        static canvas2d() {
            return new Ge(null)
        }
        static canvas2dHeatmap() {
            return new Ge(new Fe)
        }
        static canvas2dElementType() {
            return new Ge(new Le)
        }
        static canvasWebGL() {
            return new ze
        }
        static nullRenderer() {
            return new Ke
        }
    }
    class Ge extends Ve {
        #Kn;
        constructor(e) {
            super(), this.#Kn = e
        }
        getContextType() {
            return "2d"
        }
        initialize(e, t, n) {
            let r = new Pe(e, t, n);
            return null !== this.#Kn && r.setMode(this.#Kn), r
        }
    }
    class ze extends Ve {
        getContextType() {
            return "webgl2"
        }
        initialize(e, t, n) {
            try {
                return new ke(e, t, n)
            } catch (e) {
                throw new We(e)
            }
        }
    }
    class Ke extends Ve {
        constructor() {
            super()
        }
        getContextType() {
            return "2d"
        }
        initialize(e, t, n) {
            return new Ye
        }
    }
    class Xe {
        #ar;
        #or;
        #lr;
        #hr;
        #cr;
        #dr = !0;
        #ur = [];
        constructor(e, t, n, r, i) {
            this.#ar = e, this.#or = t, this.#lr = n, this.#hr = r, this.#cr = i, this.#dr = !0 === i.visible
        }
        getPosition() {
            return [this.#ar, this.#or, this.#lr, this.#hr]
        }
        getConfig() {
            return this.#cr
        }
        isVisible() {
            return this.#dr
        }
        setVisible(e) {
            if (this.#dr !== e) {
                this.#dr = e;
                for (let t of this.#ur) t(e)
            }
        }
        addOnVisibleChanged(e) {
            this.#ur.push(e)
        }
    }
    class qe {
        #K;
        #st;
        #ut;
        #mn;
        #mr;
        constructor(e, t, n, r, i) {
            this.#K = e, this.#st = t, this.#ut = n, this.#mn = r, this.#mr = i
        }
        swap(e, t, n, r) {
            e = Math.trunc(e), t = Math.trunc(t), n = Math.trunc(n), r = Math.trunc(r), this.#K.isValidPosition(e, t) && this.#K.isValidPosition(n, r) && (this.#K.swap(e, t, n, r), this.#mr(e, t), this.#mr(n, r))
        }
        draw(e, t, r) {
            if (e = Math.trunc(e), t = Math.trunc(t), this.#K.isValidPosition(e, t))
                if (null === r) this.#K.setElement(e, t, this.#mn.getDefaultElement()), this.#mr(e, t);
                else if (r instanceof n) this.#K.setElement(e, t, r), this.#mr(e, t);
            else {
                if (!(r instanceof s)) throw "Brush or Element expected";
                {
                    let n = this.#K.getElement(e, t),
                        i = r.apply(e, t, this.#ut, n);
                    this.#K.setElement(e, t, i), this.#mr(e, t)
                }
            }
        }
        drawRectangle(e, t, r, i, a, o = !1) {
            if (!(a instanceof s || a instanceof n)) throw "Brush expected";
            e = Math.trunc(e), t = Math.trunc(t), r = Math.trunc(r), i = Math.trunc(i), o && (e = e >= 0 ? e : this.getWidth() + e + 1, r = r >= 0 ? r : this.getWidth() + r + 1, t = t >= 0 ? t : this.getHeight() + t + 1, i = i >= 0 ? i : this.getHeight() + i + 1), e = Math.max(Math.min(e, this.getWidth()), 0), r = Math.max(Math.min(r, this.getWidth()), 0), t = Math.max(Math.min(t, this.getHeight()), 0), i = Math.max(Math.min(i, this.getHeight()), 0);
            for (let n = t; n < i; n++)
                for (let t = e; t < r; t++) this.draw(t, n, a)
        }
        drawRectangleWH(e, t, n, r, i) {
            this.drawRectangle(e, t, e + n, t + r, i, !1)
        }
        drawLine(e, t, r, i, a, o, l = !1) {
            if (!(o instanceof s || o instanceof n)) throw "Brush expected";
            let h;
            if (e = Math.trunc(e), t = Math.trunc(t), r = Math.trunc(r), i = Math.trunc(i), l) {
                let e, t = Math.trunc(a / 2);
                e = t <= 3 ? Me.BLUEPRINT_3 : 4 === t ? Me.BLUEPRINT_4 : Me.BLUEPRINT_9, h = (n, r) => {
                    Me.iterate(e, ((e, i, s) => {
                        s <= t && this.draw(n + e, r + i, o)
                    }))
                }
            } else {
                const e = Math.ceil(a / 2);
                h = (t, n) => {
                    this.drawRectangle(t - e, n - e, t + e, n + e, o)
                }
            }
            qe.#Er(e, t, r, i, h)
        }
        static #Er(e, t, n, r, i) {
            if (i(e, t), e !== n || t !== r) {
                const s = e < n ? 1 : -1,
                    a = t < r ? 1 : -1,
                    o = Math.abs(n - e),
                    l = Math.abs(r - t);
                let h = o - l;
                for (; e !== n || t !== r;) {
                    const n = 2 * h;
                    n > -l && (h -= l, e += s), n < o && (h += o, t += a), i(e, t)
                }
            }
        }
        drawShape(e, t) {
            if (!(e instanceof Xe)) throw "Shape not supported";
            {
                const [n, r, i, s] = e.getPosition();
                this.drawRectangle(n, r, i, s, t, !1)
            }
        }
        fill(e) {
            this.drawRectangle(0, 0, this.#K.getWidth(), this.#K.getHeight(), e)
        }
        floodFill(e, t, n, r) {
            e = Math.trunc(e), t = Math.trunc(t), new G(this.#K, r, this).paint(e, t, n)
        }
        replace(e, t) {
            const n = this.getWidth(),
                r = this.getHeight();
            for (let i = 0; i < r; i++)
                for (let r = 0; r < n; r++) {
                    const n = this.#K.getElement(r, i);
                    n.elementHead === e.elementHead && n.elementTail === e.elementTail && this.#K.setElement(r, i, t)
                }
        }
        flipVertically() {
            const e = this.getWidth(),
                t = this.getHeight(),
                n = Math.trunc(t / 2);
            for (let r = 0; r < e; r++)
                for (let e = 0; e < n; e++) this.swap(r, e, r, t - e - 1)
        }
        insertElementArea(e, t = 0, n = 0) {
            for (let r = 0; r < e.getHeight(); r++)
                for (let i = 0; i < e.getWidth(); i++)
                    if (this.#K.isValidPosition(i + t, r + n)) {
                        const s = e.getElementHead(i, r),
                            a = e.getElementTail(i, r);
                        this.#K.setElementHeadAndTail(i + t, r + n, s, a), this.#mr(i + t, r + n)
                    }
        }
        getWidth() {
            return this.#K.getWidth()
        }
        getHeight() {
            return this.#K.getHeight()
        }
        entities() {
            return this.#st
        }
        getDefaults() {
            return this.#mn
        }
    }
    class Je {
        #V;
        #W;
        #gr;
        #mr;
        constructor(e, t, n, r) {
            this.#V = e, this.#W = t, this.#gr = n, this.#mr = r
        }
        insertEntity(e) {
            if (e instanceof he) throw "Entity instance not supported here";
            "number" == typeof e.y && (e.y < 0 || e.y >= this.#W) || "number" == typeof e.x && (e.x < 0 || e.x >= this.#V) || (this.#gr.addSerializedEntity(e), "number" == typeof e.x && "number" == typeof e.y && this.#mr(e.x, e.y))
        }
        getAt(e, t) {
            return this.#gr.getAt(e, t)
        }
        assignWaypoint(e, t) {
            for (const n of this.#gr.getEntities()) "function" == typeof n.assignWaypoint && n.assignWaypoint(e, t)
        }
    }
    class je {
        #V;
        #W;
        #pr = [];
        #Ar = [];
        constructor(e, t) {
            this.#V = e, this.#W = t
        }
        createRectangle(e, t, n, r, i, s = !1) {
            e = Math.trunc(e), t = Math.trunc(t), n = Math.trunc(n), r = Math.trunc(r), s && (e = e >= 0 ? e : this.#V + e + 1, n = n >= 0 ? n : this.#V + n + 1, t = t >= 0 ? t : this.#W + t + 1, r = r >= 0 ? r : this.#W + r + 1), e = Math.max(Math.min(e, this.#V - 1), 0), n = Math.max(Math.min(n, this.#V - 1), 0), t = Math.max(Math.min(t, this.#W - 1), 0), r = Math.max(Math.min(r, this.#W - 1), 0);
            const a = new Xe(e, t, n, r, i);
            this.#pr.push(a);
            for (let e of this.#Ar) e(a);
            return a
        }
        createRectangleWH(e, t, n, r, i) {
            return this.createRectangle(e, t, e + n, t + r, i)
        }
        getMarkers() {
            return [...this.#pr]
        }
        addOnMarkerAdded(e) {
            this.#Ar.push(e)
        }
        getWidth() {
            return this.#V
        }
        getHeight() {
            return this.#W
        }
    }
    class Ze {
        #cr;
        #dr;
        #ur = [];
        constructor(e) {
            this.#cr = e, this.#dr = !0 === e.visible
        }
        getConfig() {
            return this.#cr
        }
        isVisible() {
            return this.#dr
        }
        setVisible(e) {
            if (this.#dr !== e) {
                this.#dr = e;
                for (let t of this.#ur) t(e)
            }
        }
        addOnVisibleChanged(e) {
            this.#ur.push(e)
        }
    }
    class Qe {
        #cr;
        #dr;
        #ur = [];
        #fr;
        #Tr = [];
        #Cr = !1;
        #Rr = [];
        constructor(e) {
            this.#cr = e, this.#dr = !0 === e.visible, this.#fr = !0 === e.active
        }
        getConfig() {
            return this.#cr
        }
        isVisible() {
            return this.#dr
        }
        setVisible(e) {
            if (this.#dr !== e) {
                this.#dr = e;
                for (let t of this.#ur) t(e)
            }
        }
        addOnVisibleChanged(e) {
            this.#ur.push(e)
        }
        isActive() {
            return this.#fr
        }
        setActive(e) {
            if (this.#fr !== e) {
                this.#fr = e;
                for (let t of this.#Tr) t(e)
            }
        }
        addOnActiveChanged(e) {
            this.#Tr.push(e)
        }
        isCompleted() {
            return this.#Cr
        }
        setCompleted(e) {
            if (this.#Cr !== e) {
                this.#Cr = e;
                for (let t of this.#Rr) t(e)
            }
        }
        addOnCompleted(e) {
            this.#Rr.push(e)
        }
    }
    class $e {
        #yr = [];
        #Sr = [];
        #wr = [];
        #vr = [];
        #Ir = !1;
        #Or = [];
        constructor() {}
        createSplash(e) {
            const t = new Ze(e);
            this.#yr.push(t);
            for (let e of this.#Sr) e(t);
            return t
        }
        getSplashes() {
            return [...this.#yr]
        }
        addOnSplashAdded(e) {
            this.#Sr.push(e)
        }
        createObjective(e) {
            const t = new Qe(e);
            this.#wr.push(t);
            for (let e of this.#vr) e(t);
            return t
        }
        getObjectives() {
            return [...this.#wr]
        }
        addOnObjectiveAdded(e) {
            this.#vr.push(e)
        }
        setCompleted() {
            if (!this.#Ir) {
                this.#Ir = !0, ge.triggerFeatureUsed(ge.FEATURE_SCENARIO_COMPLETED);
                for (let e of this.#Or) e()
            }
        }
        addOnStatusCompleted(e) {
            this.#Or.push(e)
        }
    }
    class et {
        metadata;
        dataHeads;
        dataTails;
        serializedEntities
    }
    class tt {
        static CURRENT_FORMAT_VERSION = 7;
        formatVersion;
        appVersion;
        created;
        width;
        height;
        scale;
        random;
        iteration;
        fallThroughEnabled;
        erasingEnabled
    }
    class nt {
        #$;
        #br = null;
        #Mr = null;
        #Nr = Number.MAX_SAFE_INTEGER;
        #xr = "bottom";
        constructor(e) {
            this.#$ = e
        }
        withBlueprint(e) {
            return this.#br = e, this
        }
        withBrushes(e) {
            return this.#Mr = e, this
        }
        withMaxHeight(e, t = "bottom") {
            return this.#Nr = e, this.#xr = t, this
        }
        paint() {
            if (null === this.#br || 0 === this.#br.length) throw "Blueprint not set";
            if (null === this.#Mr) throw "Brushes not set";
            const e = "string" == typeof this.#br ? this.#br.split("\n") : this.#br,
                t = e[0].length,
                n = e.length,
                r = Math.ceil(this.#$.getWidth() / t),
                i = Math.ceil(Math.min(this.#$.getHeight(), this.#Nr) / n),
                s = "bottom" === this.#xr ? this.#$.getHeight() - i * n : 0;
            for (let a = 0; a < n; a++) {
                const n = e[a];
                for (let e = 0; e < Math.min(t, n.length); e++) {
                    const t = n.charAt(e);
                    let o = this.#Mr[t];
                    if (void 0 === o) {
                        if (" " === t) continue;
                        throw "Brush not found: " + t
                    }
                    this.#$.drawRectangle(e * r, s + a * i, e * r + r + 1, s + a * i + i + 1, o)
                }
            }
        }
    }
    var rt = "undefined" != typeof globalThis ? globalThis : "undefined" != typeof window ? window : "undefined" != typeof global ? global : "undefined" != typeof self ? self : {};

    function it(e, t, n) {
        let r = e[t];
        e[t] = e[n], e[n] = r
    }
    class st {
        #K;
        #$;
        #ut;
        #mt;
        #Dr;
        constructor(e, t, n, r) {
            this.#K = e, this.#$ = t, this.#ut = n, this.#mt = r, this.#Dr = new Array(e.getWidth()).fill(0)
        }
        layer(e, t, n, r = 0) {
            return this.layerFunction((function(t) {
                return Math.trunc(e)
            }), t, n, r), this
        }
        layerSpline(e, t, n, r = 0) {
            const i = new Array(e.length),
                s = new Array(e.length);
            for (let t = 0; t < e.length; t++) i[t] = e[t][0], s[t] = e[t][1];
            const a = new class {
                constructor(e, t) {
                    this.xs = e, this.ys = t, this.ks = this.getNaturalKs(new Float64Array(this.xs.length))
                }
                getNaturalKs(e) {
                    const t = this.xs.length - 1,
                        n = function(e, t) {
                            const n = [];
                            for (let r = 0; r < e; r++) n.push(new Float64Array(t));
                            return n
                        }(t + 1, t + 2);
                    for (let e = 1; e < t; e++) n[e][e - 1] = 1 / (this.xs[e] - this.xs[e - 1]), n[e][e] = 2 * (1 / (this.xs[e] - this.xs[e - 1]) + 1 / (this.xs[e + 1] - this.xs[e])), n[e][e + 1] = 1 / (this.xs[e + 1] - this.xs[e]), n[e][t + 1] = 3 * ((this.ys[e] - this.ys[e - 1]) / ((this.xs[e] - this.xs[e - 1]) * (this.xs[e] - this.xs[e - 1])) + (this.ys[e + 1] - this.ys[e]) / ((this.xs[e + 1] - this.xs[e]) * (this.xs[e + 1] - this.xs[e])));
                    return n[0][0] = 2 / (this.xs[1] - this.xs[0]), n[0][1] = 1 / (this.xs[1] - this.xs[0]), n[0][t + 1] = 3 * (this.ys[1] - this.ys[0]) / ((this.xs[1] - this.xs[0]) * (this.xs[1] - this.xs[0])), n[t][t - 1] = 1 / (this.xs[t] - this.xs[t - 1]), n[t][t] = 2 / (this.xs[t] - this.xs[t - 1]), n[t][t + 1] = 3 * (this.ys[t] - this.ys[t - 1]) / ((this.xs[t] - this.xs[t - 1]) * (this.xs[t] - this.xs[t - 1])),
                        function(e, t) {
                            const n = e.length;
                            let r = 0,
                                i = 0;
                            for (; r < n && i <= n;) {
                                let t = 0,
                                    s = -1 / 0;
                                for (let a = r; a < n; a++) {
                                    const n = Math.abs(e[a][i]);
                                    n > s && (t = a, s = n)
                                }
                                if (0 === e[t][i]) i++;
                                else {
                                    it(e, r, t);
                                    for (let t = r + 1; t < n; t++) {
                                        const s = e[t][i] / e[r][i];
                                        e[t][i] = 0;
                                        for (let a = i + 1; a <= n; a++) e[t][a] -= e[r][a] * s
                                    }
                                    r++, i++
                                }
                            }
                            for (let r = n - 1; r >= 0; r--) {
                                var s = 0;
                                e[r][r] && (s = e[r][n] / e[r][r]), t[r] = s;
                                for (let t = r - 1; t >= 0; t--) e[t][n] -= e[t][r] * s, e[t][r] = 0
                            }
                            return t
                        }(n, e)
                }
                getIndexBefore(e) {
                    let t = 0,
                        n = this.xs.length,
                        r = 0;
                    for (; t < n;) r = Math.floor((t + n) / 2), this.xs[r] < e && r !== t ? t = r : n = this.xs[r] >= e && r !== n ? r : t;
                    return t + 1
                }
                at(e) {
                    let t = this.getIndexBefore(e);
                    const n = (e - this.xs[t - 1]) / (this.xs[t] - this.xs[t - 1]),
                        r = this.ks[t - 1] * (this.xs[t] - this.xs[t - 1]) - (this.ys[t] - this.ys[t - 1]),
                        i = -this.ks[t] * (this.xs[t] - this.xs[t - 1]) + (this.ys[t] - this.ys[t - 1]);
                    return (1 - n) * this.ys[t - 1] + n * this.ys[t] + n * (1 - n) * (r * (1 - n) + i * n)
                }
            }(i, s);
            return this.layerFunction((function(e) {
                return Math.max(Math.trunc(a.at(e)), 0)
            }), t, n, r), this
        }
        layerPerlin(e, t, n, r = 0) {
            const s = [];
            for (let t of e) {
                if (void 0 === t.seed && (i.DEFAULT.next(), t.seed = i.DEFAULT.getState()), void 0 === t.factor) throw "factor not defined";
                if (void 0 === t.threshold) throw "threshold not defined";
                if (void 0 === t.force) throw "force not defined";
                const e = new i(t.seed),
                    n = f((() => e.next()));
                s.push({
                    instance: n,
                    levelConfig: t
                })
            }
            return this.layerFunction((function(e) {
                let t = 0;
                for (const {
                        instance: n,
                        levelConfig: r
                    }
                    of s) {
                    const {
                        factor: i,
                        threshold: s,
                        force: a
                    } = r;
                    let o = (n(e / i, 0) + 1) / 2;
                    o < s && (o = 0), o = 1 / (1 - s) * (o - s), o *= a, t += o
                }
                return Math.trunc(t)
            }), t, n, r), this
        }
        layerFunction(e, t, n, r = 0) {
            for (let i = 0; i < this.#K.getWidth(); i++) {
                const s = this.#Dr[i],
                    a = t ? s + e(i) : e(i);
                if (s < a) {
                    let e = 0;
                    for (let t = s; t < a && t < this.#K.getHeight(); t++) {
                        let r = this.#K.getHeight() - 1 - t;
                        this.#$.draw(i, r, n), e++
                    }
                    if (r > 0 && e > 0)
                        for (let t = 0; t < r; t++) {
                            const t = Math.min(Math.trunc(e / 2), 10);
                            if (t > 1) {
                                const e = this.#ut.nextInt(Math.ceil(t)) - Math.trunc(t / 2),
                                    n = this.#K.getHeight() - 1 - s + e,
                                    r = this.#K.getHeight() - 1 - s + e + 1;
                                n < this.#K.getHeight() && r < this.#K.getHeight() && this.#K.swap(i, n, i, r)
                            }
                        }
                    this.#Dr[i] = a
                }
            }
            return this
        }
        grass(e = 0, t = -1) {
            -1 === t && (t = this.#K.getWidth());
            for (let n = e; n < t; n++) {
                const e = this.#Dr[n],
                    t = this.#K.getHeight() - 1 - e;
                if (xe.canGrowUpHere(this.#K, n, t)) {
                    const e = this.#mt.getDefaults().getBrushGrass();
                    xe.spawnHere(this.#K, n, t, e, this.#ut)
                }
            }
            return this
        }
        tree(e, t = void 0, n = void 0, i = !1) {
            if (e <= 5 || e >= this.#K.getWidth() - 5) return this;
            const s = this.#Dr[e],
                a = this.#K.getHeight() - 1 - s,
                o = this.#mt.getDefaults().getBrushTree();
            if (!this.#K.isValidPosition(e, a + 1)) return this;
            if (!i) {
                const t = this.#K.getElementHead(e, a + 1);
                if (r.getBehaviour(t) !== r.BEHAVIOUR_SOIL) return this
            }
            return void 0 === t && (t = this.#ut.nextInt(8)), De.spawnHere(this.#K, e, a, t, o, this.#ut, this.#mt, n), this
        }
        tool(e, t, n) {
            if (e < 0 || e >= this.#K.getWidth()) return this;
            const r = this.#Dr[e],
                i = this.#K.getHeight() - t - r;
            return i < 0 || i >= this.#K.getHeight() || n.applyPoint(e, i, this.#$, !1), this
        }
    }
    class at {
        #K;
        #V;
        #W;
        #gr;
        #ut;
        #Br;
        #_r;
        #Hr;
        #Ur;
        #Pr = null;
        #Fr = null;
        #Lr = [];
        #kr = [];
        #Yr = [];
        #$;
        #st;
        #Wr;
        #Vr;
        constructor(e, t, n, r, s, a) {
            this.#ut = new i(n ? n.random : 0), this.#K = e, this.#V = e.getWidth(), this.#W = e.getHeight(), this.#Br = new Re, this.#_r = new Re, this.#Hr = new _e(this.#K, 16, this.#ut, r, n), this.#Ur = a.initialize(this.#K, 16, s), this.#gr = new Se(t, new Z(e, this.#ut, this.#Hr, null));
            const o = (e, t) => {
                this.#Hr.trigger(e, t), this.#Ur.trigger(e, t)
            };
            this.#st = new Je(e.getWidth(), e.getHeight(), this.#gr, o), this.#$ = new qe(this.#K, this.#st, this.#ut, r, o), this.#Wr = new je(e.getWidth(), e.getHeight()), this.#Vr = new $e, this.#Gr(r), this.#zr()
        }
        #zr() {
            let e = [];
            const t = () => {
                e = this.#Vr.getObjectives().filter((e => e.isActive() && "function" == typeof e.getConfig().checkHandler))
            };
            this.#Vr.addOnObjectiveAdded((e => {
                t(), e.addOnActiveChanged((() => t())), e.addOnCompleted((() => t()))
            })), this.#Yr.push((() => {
                for (let t of e) t.getConfig().checkHandler(this.#Hr.getIteration() - 1)
            }))
        }
        #Gr(e) {
            const t = new Z(this.#K, this.#ut, this.#Hr, this.#gr),
                n = e.getExtensionsFactory()(t);
            for (const e of n) this.#Hr.addExtension(e)
        }
        getBrushCollection() {
            return this.#Hr.getDefaults().getBrushCollection()
        }
        startProcessing() {
            if (null === this.#Pr) {
                const e = Math.trunc(1e3 / _e.OPT_CYCLES_PER_SECOND);
                this.#Pr = setInterval((() => this.doProcessing()), e)
            }
        }
        startRendering() {
            if (null === this.#Fr) {
                const e = Math.trunc(1e3 / _e.OPT_FRAMES_PER_SECOND);
                this.#Fr = setInterval((() => this.doRendering()), e)
            }
        }
        stopProcessing() {
            null !== this.#Pr && (clearInterval(this.#Pr), this.#Pr = null), this.#_r.clear()
        }
        stopRendering() {
            null !== this.#Fr && (clearInterval(this.#Fr), this.#Fr = null), this.#Br.clear()
        }
        doProcessing() {
            this.#gr.performBeforeProcessing(), this.#Hr.next(), this.#gr.performAfterProcessing();
            const e = Date.now();
            this.#_r.tick(e);
            for (let e of this.#Yr) e(this.#Hr.getIteration())
        }
        doRendering() {
            const e = this.#Hr.getChangedChunks();
            try {
                this.#Ur.render(e)
            } catch (e) {
                this.stopRendering();
                for (let t of this.#kr) t(e);
                return
            }
            const t = Date.now();
            this.#Br.tick(t);
            for (let t of this.#Lr) t(e);
            this.#Hr.cleanChangedChunks()
        }
        graphics() {
            return this.#$
        }
        entities() {
            return this.#st
        }
        overlay() {
            return this.#Wr
        }
        scenario() {
            return this.#Vr
        }
        blockTemplate() {
            return new nt(this.graphics())
        }
        layeredTemplate() {
            return new st(this.#K, this.graphics(), this.#ut, this.#Hr)
        }
        setBoxedMode() {
            this.#Hr.setFallThroughEnabled(!1), this.#Hr.setErasingEnabled(!1)
        }
        setFallThroughMode() {
            this.#Hr.setFallThroughEnabled(!0), this.#Hr.setErasingEnabled(!1)
        }
        setErasingMode() {
            this.#Hr.setFallThroughEnabled(!1), this.#Hr.setErasingEnabled(!0)
        }
        addOnProcessed(e) {
            this.#Yr.push(e)
        }
        addOnRendered(e) {
            this.#Lr.push(e)
        }
        addOnRenderingFailed(e) {
            this.#kr.push(e)
        }
        getFramesPerSecond() {
            return this.#Br.getValue()
        }
        getIterationsPerSecond() {
            return this.#_r.getValue()
        }
        getWidth() {
            return this.#V
        }
        getHeight() {
            return this.#W
        }
        getChunkSize() {
            return 16
        }
        createSnapshot() {
            let e = new tt;
            e.formatVersion = tt.CURRENT_FORMAT_VERSION, e.created = (new Date).getTime(), e.width = this.#V, e.height = this.#W, e.random = this.#ut.getState(), e.iteration = this.#Hr.getIteration(), e.fallThroughEnabled = this.#Hr.isFallThroughEnabled(), e.erasingEnabled = this.#Hr.isErasingEnabled();
            let t = new et;
            return t.metadata = e, t.dataHeads = this.#K.getDataHeads(), t.dataTails = this.#K.getDataTails(), t.serializedEntities = this.#gr.serializeEntities(), t
        }
        debugElementAt(e, t) {
            if (!this.#K.isValidPosition(e, t)) return "Out of bounds";
            const n = this.#K.getElementHead(e, t),
                i = this.#K.getElementTail(e, t);

            function s(e) {
                return "0x" + e.toString(16).padStart(8, "0")
            }
            let a = s(n) + " " + s(i);
            const o = {
                type: {
                    class: r.getTypeClass(n)
                },
                behaviour: {
                    type: r.getBehaviour(n),
                    special: r.getSpecial(n)
                },
                heatModIndex: r.getHeatModIndex(n),
                temperature: r.getTemperature(n),
                color: [h.getColorRed(i), h.getColorGreen(i), h.getColorBlue(i)],
                blurType: h.getBlurType(i),
                burntLevel: h.getBurntLevel(i),
                heatEffect: h.getHeatEffect(i)
            };
            o.type.class === r.TYPE_STATIC && (o.type.neighbourhood = r.getTypeModifierSolidNeighbourhoodType(n), o.type.body = r.getTypeModifierSolidBodyId(n));
            let l = JSON.stringify(o).replaceAll('"', "").replaceAll(",", ", ").replaceAll(":", "=");
            return l = l.substring(1, l.length - 1), a + "\n" + l
        }
    }
    class ot {
        countSize(e, t) {
            throw "Not implemented"
        }
        createSandGame(e, t, n, r, i) {
            throw "Not implemented"
        }
        createElementArea(e, t, n) {
            throw "Not implemented"
        }
        createEntities() {
            return null
        }
    }
    class lt extends ot {
        #Kr;
        constructor(e) {
            super(), this.#Kr = e
        }
        countSize(e, t) {
            return [e, t]
        }
        async createSandGame(e, t, n, r, i) {
            const s = this.#Kr.metadata.width,
                a = this.#Kr.metadata.height,
                o = this.#Kr.metadata,
                l = F.from(s, a, this.#Kr.dataHeads, this.#Kr.dataTails),
                h = this.#Kr.serializedEntities,
                c = this.createElementArea(e, t, n.getDefaultElement()),
                d = new at(c, [], o, n, r, i);
            let u;
            u = t === a ? 0 : t > a ? t - a : -(a - t), d.graphics().insertElementArea(l, 0, u);
            for (let e of h) {
                const t = Object.assign({}, e);
                0 !== u && "number" == typeof t.y && (t.y += u), d.entities().insertEntity(t)
            }
            return d
        }
        createElementArea(e, t, n) {
            return F.create(e, t, n)
        }
    }
    class ht {
        #Xr;
        #qr;
        #Jr;
        #jr = [];
        #Zr;
        #Qr = [];
        constructor(e, t, n) {
            this.#Xr = e, this.#qr = t, this.#Jr = n
        }
        setPrimaryTool(e) {
            this.#Xr = e;
            for (let t of this.#jr) t(e)
        }
        setSecondaryTool(e) {
            this.#qr = e
        }
        setTertiaryTool(e) {
            this.#Jr = e
        }
        getPrimaryTool() {
            return this.#Xr
        }
        getSecondaryTool() {
            return this.#qr
        }
        getTertiaryTool() {
            return this.#Jr
        }
        addOnPrimaryToolChanged(e) {
            this.#jr.push(e)
        }
        isInputDisabled() {
            return this.#Zr
        }
        addOnInputDisabledChanged(e) {
            this.#Qr.push(e)
        }
        setInputDisabled(e) {
            if (this.#Zr !== e) {
                this.#Zr = e;
                for (let t of this.#Qr) t(e)
            }
        }
        createRevertAction() {
            const e = this.getPrimaryTool(),
                t = this.getSecondaryTool(),
                n = this.getTertiaryTool();
            return () => {
                this.setPrimaryTool(e), this.setSecondaryTool(t), this.setTertiaryTool(n)
            }
        }
    }
    class ct extends ot {
        #Kr;
        constructor(e) {
            super(), this.#Kr = e
        }
        countSize(e, t) {
            return [this.#Kr.metadata.width, this.#Kr.metadata.height]
        }
        async createSandGame(e, t, n, r, i) {
            const s = this.createElementArea(e, t, n.getDefaultElement()),
                a = this.createEntities(),
                o = this.#Kr.metadata;
            return new at(s, a, o, n, r, i)
        }
        createElementArea(e, t, n) {
            return F.from(this.#Kr.metadata.width, this.#Kr.metadata.height, this.#Kr.dataHeads, this.#Kr.dataTails)
        }
        createEntities() {
            return this.#Kr.serializedEntities
        }
    }
    var dt = Uint8Array,
        ut = Uint16Array,
        mt = Uint32Array,
        Et = new dt([0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5, 0, 0, 0, 0]),
        gt = new dt([0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10, 11, 11, 12, 12, 13, 13, 0, 0]),
        pt = new dt([16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15]),
        At = function(e, t) {
            for (var n = new ut(31), r = 0; r < 31; ++r) n[r] = t += 1 << e[r - 1];
            var i = new mt(n[30]);
            for (r = 1; r < 30; ++r)
                for (var s = n[r]; s < n[r + 1]; ++s) i[s] = s - n[r] << 5 | r;
            return [n, i]
        },
        ft = At(Et, 2),
        Tt = ft[0],
        Ct = ft[1];
    Tt[28] = 258, Ct[258] = 28;
    for (var Rt = At(gt, 0), yt = Rt[0], St = Rt[1], wt = new ut(32768), vt = 0; vt < 32768; ++vt) {
        var It = (43690 & vt) >>> 1 | (21845 & vt) << 1;
        It = (61680 & (It = (52428 & It) >>> 2 | (13107 & It) << 2)) >>> 4 | (3855 & It) << 4, wt[vt] = ((65280 & It) >>> 8 | (255 & It) << 8) >>> 1
    }
    var Ot = function(e, t, n) {
            for (var r = e.length, i = 0, s = new ut(t); i < r; ++i) e[i] && ++s[e[i] - 1];
            var a, o = new ut(t);
            for (i = 0; i < t; ++i) o[i] = o[i - 1] + s[i - 1] << 1;
            if (n) {
                a = new ut(1 << t);
                var l = 15 - t;
                for (i = 0; i < r; ++i)
                    if (e[i])
                        for (var h = i << 4 | e[i], c = t - e[i], d = o[e[i] - 1]++ << c, u = d | (1 << c) - 1; d <= u; ++d) a[wt[d] >>> l] = h
            } else
                for (a = new ut(r), i = 0; i < r; ++i) e[i] && (a[i] = wt[o[e[i] - 1]++] >>> 15 - e[i]);
            return a
        },
        bt = new dt(288);
    for (vt = 0; vt < 144; ++vt) bt[vt] = 8;
    for (vt = 144; vt < 256; ++vt) bt[vt] = 9;
    for (vt = 256; vt < 280; ++vt) bt[vt] = 7;
    for (vt = 280; vt < 288; ++vt) bt[vt] = 8;
    var Mt = new dt(32);
    for (vt = 0; vt < 32; ++vt) Mt[vt] = 5;
    var Nt = Ot(bt, 9, 0),
        xt = Ot(bt, 9, 1),
        Dt = Ot(Mt, 5, 0),
        Bt = Ot(Mt, 5, 1),
        _t = function(e) {
            for (var t = e[0], n = 1; n < e.length; ++n) e[n] > t && (t = e[n]);
            return t
        },
        Ht = function(e, t, n) {
            var r = t / 8 | 0;
            return (e[r] | e[r + 1] << 8) >> (7 & t) & n
        },
        Ut = function(e, t) {
            var n = t / 8 | 0;
            return (e[n] | e[n + 1] << 8 | e[n + 2] << 16) >> (7 & t)
        },
        Pt = function(e) {
            return (e + 7) / 8 | 0
        },
        Ft = function(e, t, n) {
            (null == t || t < 0) && (t = 0), (null == n || n > e.length) && (n = e.length);
            var r = new(2 == e.BYTES_PER_ELEMENT ? ut : 4 == e.BYTES_PER_ELEMENT ? mt : dt)(n - t);
            return r.set(e.subarray(t, n)), r
        },
        Lt = ["unexpected EOF", "invalid block type", "invalid length/literal", "invalid distance", "stream finished", "no stream handler", , "no callback", "invalid UTF-8 data", "extra field too long", "date not in range 1980-2099", "filename too long", "stream finishing", "invalid zip data"],
        kt = function(e, t, n) {
            var r = new Error(t || Lt[e]);
            if (r.code = e, Error.captureStackTrace && Error.captureStackTrace(r, kt), !n) throw r;
            return r
        },
        Yt = function(e, t, n) {
            var r = e.length;
            if (!r || n && n.f && !n.l) return t || new dt(0);
            var i = !t || n,
                s = !n || n.i;
            n || (n = {}), t || (t = new dt(3 * r));
            var a = function(e) {
                    var n = t.length;
                    if (e > n) {
                        var r = new dt(Math.max(2 * n, e));
                        r.set(t), t = r
                    }
                },
                o = n.f || 0,
                l = n.p || 0,
                h = n.b || 0,
                c = n.l,
                d = n.d,
                u = n.m,
                m = n.n,
                E = 8 * r;
            do {
                if (!c) {
                    o = Ht(e, l, 1);
                    var g = Ht(e, l + 1, 3);
                    if (l += 3, !g) {
                        var p = e[(O = Pt(l) + 4) - 4] | e[O - 3] << 8,
                            A = O + p;
                        if (A > r) {
                            s && kt(0);
                            break
                        }
                        i && a(h + p), t.set(e.subarray(O, A), h), n.b = h += p, n.p = l = 8 * A, n.f = o;
                        continue
                    }
                    if (1 == g) c = xt, d = Bt, u = 9, m = 5;
                    else if (2 == g) {
                        var f = Ht(e, l, 31) + 257,
                            T = Ht(e, l + 10, 15) + 4,
                            C = f + Ht(e, l + 5, 31) + 1;
                        l += 14;
                        for (var R = new dt(C), y = new dt(19), S = 0; S < T; ++S) y[pt[S]] = Ht(e, l + 3 * S, 7);
                        l += 3 * T;
                        var w = _t(y),
                            v = (1 << w) - 1,
                            I = Ot(y, w, 1);
                        for (S = 0; S < C;) {
                            var O, b = I[Ht(e, l, v)];
                            if (l += 15 & b, (O = b >>> 4) < 16) R[S++] = O;
                            else {
                                var M = 0,
                                    N = 0;
                                for (16 == O ? (N = 3 + Ht(e, l, 3), l += 2, M = R[S - 1]) : 17 == O ? (N = 3 + Ht(e, l, 7), l += 3) : 18 == O && (N = 11 + Ht(e, l, 127), l += 7); N--;) R[S++] = M
                            }
                        }
                        var x = R.subarray(0, f),
                            D = R.subarray(f);
                        u = _t(x), m = _t(D), c = Ot(x, u, 1), d = Ot(D, m, 1)
                    } else kt(1);
                    if (l > E) {
                        s && kt(0);
                        break
                    }
                }
                i && a(h + 131072);
                for (var B = (1 << u) - 1, _ = (1 << m) - 1, H = l;; H = l) {
                    var U = (M = c[Ut(e, l) & B]) >>> 4;
                    if ((l += 15 & M) > E) {
                        s && kt(0);
                        break
                    }
                    if (M || kt(2), U < 256) t[h++] = U;
                    else {
                        if (256 == U) {
                            H = l, c = null;
                            break
                        }
                        var P = U - 254;
                        if (U > 264) {
                            var F = Et[S = U - 257];
                            P = Ht(e, l, (1 << F) - 1) + Tt[S], l += F
                        }
                        var L = d[Ut(e, l) & _],
                            k = L >>> 4;
                        L || kt(3), l += 15 & L;
                        D = yt[k];
                        if (k > 3) {
                            F = gt[k];
                            D += Ut(e, l) & (1 << F) - 1, l += F
                        }
                        if (l > E) {
                            s && kt(0);
                            break
                        }
                        i && a(h + 131072);
                        for (var Y = h + P; h < Y; h += 4) t[h] = t[h - D], t[h + 1] = t[h + 1 - D], t[h + 2] = t[h + 2 - D], t[h + 3] = t[h + 3 - D];
                        h = Y
                    }
                }
                n.l = c, n.p = H, n.b = h, n.f = o, c && (o = 1, n.m = u, n.d = d, n.n = m)
            } while (!o);
            return h == t.length ? t : Ft(t, 0, h)
        },
        Wt = function(e, t, n) {
            n <<= 7 & t;
            var r = t / 8 | 0;
            e[r] |= n, e[r + 1] |= n >>> 8
        },
        Vt = function(e, t, n) {
            n <<= 7 & t;
            var r = t / 8 | 0;
            e[r] |= n, e[r + 1] |= n >>> 8, e[r + 2] |= n >>> 16
        },
        Gt = function(e, t) {
            for (var n = [], r = 0; r < e.length; ++r) e[r] && n.push({
                s: r,
                f: e[r]
            });
            var i = n.length,
                s = n.slice();
            if (!i) return [Zt, 0];
            if (1 == i) {
                var a = new dt(n[0].s + 1);
                return a[n[0].s] = 1, [a, 1]
            }
            n.sort((function(e, t) {
                return e.f - t.f
            })), n.push({
                s: -1,
                f: 25001
            });
            var o = n[0],
                l = n[1],
                h = 0,
                c = 1,
                d = 2;
            for (n[0] = {
                    s: -1,
                    f: o.f + l.f,
                    l: o,
                    r: l
                }; c != i - 1;) o = n[n[h].f < n[d].f ? h++ : d++], l = n[h != c && n[h].f < n[d].f ? h++ : d++], n[c++] = {
                s: -1,
                f: o.f + l.f,
                l: o,
                r: l
            };
            var u = s[0].s;
            for (r = 1; r < i; ++r) s[r].s > u && (u = s[r].s);
            var m = new ut(u + 1),
                E = zt(n[c - 1], m, 0);
            if (E > t) {
                r = 0;
                var g = 0,
                    p = E - t,
                    A = 1 << p;
                for (s.sort((function(e, t) {
                        return m[t.s] - m[e.s] || e.f - t.f
                    })); r < i; ++r) {
                    var f = s[r].s;
                    if (!(m[f] > t)) break;
                    g += A - (1 << E - m[f]), m[f] = t
                }
                for (g >>>= p; g > 0;) {
                    var T = s[r].s;
                    m[T] < t ? g -= 1 << t - m[T]++ - 1 : ++r
                }
                for (; r >= 0 && g; --r) {
                    var C = s[r].s;
                    m[C] == t && (--m[C], ++g)
                }
                E = t
            }
            return [new dt(m), E]
        },
        zt = function(e, t, n) {
            return -1 == e.s ? Math.max(zt(e.l, t, n + 1), zt(e.r, t, n + 1)) : t[e.s] = n
        },
        Kt = function(e) {
            for (var t = e.length; t && !e[--t];);
            for (var n = new ut(++t), r = 0, i = e[0], s = 1, a = function(e) {
                    n[r++] = e
                }, o = 1; o <= t; ++o)
                if (e[o] == i && o != t) ++s;
                else {
                    if (!i && s > 2) {
                        for (; s > 138; s -= 138) a(32754);
                        s > 2 && (a(s > 10 ? s - 11 << 5 | 28690 : s - 3 << 5 | 12305), s = 0)
                    } else if (s > 3) {
                        for (a(i), --s; s > 6; s -= 6) a(8304);
                        s > 2 && (a(s - 3 << 5 | 8208), s = 0)
                    }
                    for (; s--;) a(i);
                    s = 1, i = e[o]
                } return [n.subarray(0, r), t]
        },
        Xt = function(e, t) {
            for (var n = 0, r = 0; r < t.length; ++r) n += e[r] * t[r];
            return n
        },
        qt = function(e, t, n) {
            var r = n.length,
                i = Pt(t + 2);
            e[i] = 255 & r, e[i + 1] = r >>> 8, e[i + 2] = 255 ^ e[i], e[i + 3] = 255 ^ e[i + 1];
            for (var s = 0; s < r; ++s) e[i + s + 4] = n[s];
            return 8 * (i + 4 + r)
        },
        Jt = function(e, t, n, r, i, s, a, o, l, h, c) {
            Wt(t, c++, n), ++i[256];
            for (var d = Gt(i, 15), u = d[0], m = d[1], E = Gt(s, 15), g = E[0], p = E[1], A = Kt(u), f = A[0], T = A[1], C = Kt(g), R = C[0], y = C[1], S = new ut(19), w = 0; w < f.length; ++w) S[31 & f[w]]++;
            for (w = 0; w < R.length; ++w) S[31 & R[w]]++;
            for (var v = Gt(S, 7), I = v[0], O = v[1], b = 19; b > 4 && !I[pt[b - 1]]; --b);
            var M, N, x, D, B = h + 5 << 3,
                _ = Xt(i, bt) + Xt(s, Mt) + a,
                H = Xt(i, u) + Xt(s, g) + a + 14 + 3 * b + Xt(S, I) + (2 * S[16] + 3 * S[17] + 7 * S[18]);
            if (B <= _ && B <= H) return qt(t, c, e.subarray(l, l + h));
            if (Wt(t, c, 1 + (H < _)), c += 2, H < _) {
                M = Ot(u, m, 0), N = u, x = Ot(g, p, 0), D = g;
                var U = Ot(I, O, 0);
                Wt(t, c, T - 257), Wt(t, c + 5, y - 1), Wt(t, c + 10, b - 4), c += 14;
                for (w = 0; w < b; ++w) Wt(t, c + 3 * w, I[pt[w]]);
                c += 3 * b;
                for (var P = [f, R], F = 0; F < 2; ++F) {
                    var L = P[F];
                    for (w = 0; w < L.length; ++w) {
                        var k = 31 & L[w];
                        Wt(t, c, U[k]), c += I[k], k > 15 && (Wt(t, c, L[w] >>> 5 & 127), c += L[w] >>> 12)
                    }
                }
            } else M = Nt, N = bt, x = Dt, D = Mt;
            for (w = 0; w < o; ++w)
                if (r[w] > 255) {
                    k = r[w] >>> 18 & 31;
                    Vt(t, c, M[k + 257]), c += N[k + 257], k > 7 && (Wt(t, c, r[w] >>> 23 & 31), c += Et[k]);
                    var Y = 31 & r[w];
                    Vt(t, c, x[Y]), c += D[Y], Y > 3 && (Vt(t, c, r[w] >>> 5 & 8191), c += gt[Y])
                } else Vt(t, c, M[r[w]]), c += N[r[w]];
            return Vt(t, c, M[256]), c + N[256]
        },
        jt = new mt([65540, 131080, 131088, 131104, 262176, 1048704, 1048832, 2114560, 2117632]),
        Zt = new dt(0),
        Qt = function() {
            for (var e = new Int32Array(256), t = 0; t < 256; ++t) {
                for (var n = t, r = 9; --r;) n = (1 & n && -306674912) ^ n >>> 1;
                e[t] = n
            }
            return e
        }(),
        $t = function() {
            var e = -1;
            return {
                p: function(t) {
                    for (var n = e, r = 0; r < t.length; ++r) n = Qt[255 & n ^ t[r]] ^ n >>> 8;
                    e = n
                },
                d: function() {
                    return ~e
                }
            }
        },
        en = function(e, t, n, r, i) {
            return function(e, t, n, r, i, s) {
                var a = e.length,
                    o = new dt(r + a + 5 * (1 + Math.ceil(a / 7e3)) + i),
                    l = o.subarray(r, o.length - i),
                    h = 0;
                if (!t || a < 8)
                    for (var c = 0; c <= a; c += 65535) {
                        var d = c + 65535;
                        d >= a && (l[h >> 3] = s), h = qt(l, h + 1, e.subarray(c, d))
                    } else {
                        for (var u = jt[t - 1], m = u >>> 13, E = 8191 & u, g = (1 << n) - 1, p = new ut(32768), A = new ut(g + 1), f = Math.ceil(n / 3), T = 2 * f, C = function(t) {
                                return (e[t] ^ e[t + 1] << f ^ e[t + 2] << T) & g
                            }, R = new mt(25e3), y = new ut(288), S = new ut(32), w = 0, v = 0, I = (c = 0, 0), O = 0, b = 0; c < a; ++c) {
                            var M = C(c),
                                N = 32767 & c,
                                x = A[M];
                            if (p[N] = x, A[M] = N, O <= c) {
                                var D = a - c;
                                if ((w > 7e3 || I > 24576) && D > 423) {
                                    h = Jt(e, l, 0, R, y, S, v, I, b, c - b, h), I = w = v = 0, b = c;
                                    for (var B = 0; B < 286; ++B) y[B] = 0;
                                    for (B = 0; B < 30; ++B) S[B] = 0
                                }
                                var _ = 2,
                                    H = 0,
                                    U = E,
                                    P = N - x & 32767;
                                if (D > 2 && M == C(c - P))
                                    for (var F = Math.min(m, D) - 1, L = Math.min(32767, c), k = Math.min(258, D); P <= L && --U && N != x;) {
                                        if (e[c + _] == e[c + _ - P]) {
                                            for (var Y = 0; Y < k && e[c + Y] == e[c + Y - P]; ++Y);
                                            if (Y > _) {
                                                if (_ = Y, H = P, Y > F) break;
                                                var W = Math.min(P, Y - 2),
                                                    V = 0;
                                                for (B = 0; B < W; ++B) {
                                                    var G = c - P + B + 32768 & 32767,
                                                        z = G - p[G] + 32768 & 32767;
                                                    z > V && (V = z, x = G)
                                                }
                                            }
                                        }
                                        P += (N = x) - (x = p[N]) + 32768 & 32767
                                    }
                                if (H) {
                                    R[I++] = 268435456 | Ct[_] << 18 | St[H];
                                    var K = 31 & Ct[_],
                                        X = 31 & St[H];
                                    v += Et[K] + gt[X], ++y[257 + K], ++S[X], O = c + _, ++w
                                } else R[I++] = e[c], ++y[e[c]]
                            }
                        }
                        h = Jt(e, l, s, R, y, S, v, I, b, c - b, h), !s && 7 & h && (h = qt(l, h + 1, Zt))
                    }
                return Ft(o, 0, r + Pt(h) + i)
            }(e, null == t.level ? 6 : t.level, null == t.mem ? Math.ceil(1.5 * Math.max(8, Math.min(13, Math.log(e.length)))) : 12 + t.mem, n, r, !i)
        },
        tn = function(e, t) {
            var n = {};
            for (var r in e) n[r] = e[r];
            for (var r in t) n[r] = t[r];
            return n
        },
        nn = function(e, t) {
            return e[t] | e[t + 1] << 8
        },
        rn = function(e, t) {
            return (e[t] | e[t + 1] << 8 | e[t + 2] << 16 | e[t + 3] << 24) >>> 0
        },
        sn = function(e, t) {
            return rn(e, t) + 4294967296 * rn(e, t + 4)
        },
        an = function(e, t, n) {
            for (; n; ++t) e[t] = n, n >>>= 8
        };

    function on(e, t) {
        return en(e, t || {}, 0, 0)
    }

    function ln(e, t) {
        return Yt(e, t)
    }
    var hn = function(e, t, n, r) {
            for (var i in e) {
                var s = e[i],
                    a = t + i,
                    o = r;
                Array.isArray(s) && (o = tn(r, s[1]), s = s[0]), s instanceof dt ? n[a] = [s, o] : (n[a += "/"] = [new dt(0), o], hn(s, a, n, r))
            }
        },
        cn = "undefined" != typeof TextEncoder && new TextEncoder,
        dn = "undefined" != typeof TextDecoder && new TextDecoder;
    try {
        dn.decode(Zt, {
            stream: !0
        }), 1
    } catch (e) {}

    function un(e, t) {
        if (t) {
            for (var n = new dt(e.length), r = 0; r < e.length; ++r) n[r] = e.charCodeAt(r);
            return n
        }
        if (cn) return cn.encode(e);
        var i = e.length,
            s = new dt(e.length + (e.length >> 1)),
            a = 0,
            o = function(e) {
                s[a++] = e
            };
        for (r = 0; r < i; ++r) {
            if (a + 5 > s.length) {
                var l = new dt(a + 8 + (i - r << 1));
                l.set(s), s = l
            }
            var h = e.charCodeAt(r);
            h < 128 || t ? o(h) : h < 2048 ? (o(192 | h >> 6), o(128 | 63 & h)) : h > 55295 && h < 57344 ? (o(240 | (h = 65536 + (1047552 & h) | 1023 & e.charCodeAt(++r)) >> 18), o(128 | h >> 12 & 63), o(128 | h >> 6 & 63), o(128 | 63 & h)) : (o(224 | h >> 12), o(128 | h >> 6 & 63), o(128 | 63 & h))
        }
        return Ft(s, 0, a)
    }

    function mn(e, t) {
        if (t) {
            for (var n = "", r = 0; r < e.length; r += 16384) n += String.fromCharCode.apply(null, e.subarray(r, r + 16384));
            return n
        }
        if (dn) return dn.decode(e);
        var i = function(e) {
                for (var t = "", n = 0;;) {
                    var r = e[n++],
                        i = (r > 127) + (r > 223) + (r > 239);
                    if (n + i > e.length) return [t, Ft(e, n - 1)];
                    i ? 3 == i ? (r = ((15 & r) << 18 | (63 & e[n++]) << 12 | (63 & e[n++]) << 6 | 63 & e[n++]) - 65536, t += String.fromCharCode(55296 | r >> 10, 56320 | 1023 & r)) : t += 1 & i ? String.fromCharCode((31 & r) << 6 | 63 & e[n++]) : String.fromCharCode((15 & r) << 12 | (63 & e[n++]) << 6 | 63 & e[n++]) : t += String.fromCharCode(r)
                }
            }(e),
            s = i[0];
        return i[1].length && kt(8), s
    }
    var En = function(e, t) {
            return t + 30 + nn(e, t + 26) + nn(e, t + 28)
        },
        gn = function(e, t, n) {
            var r = nn(e, t + 28),
                i = mn(e.subarray(t + 46, t + 46 + r), !(2048 & nn(e, t + 8))),
                s = t + 46 + r,
                a = rn(e, t + 20),
                o = n && 4294967295 == a ? pn(e, s) : [a, rn(e, t + 24), rn(e, t + 42)],
                l = o[0],
                h = o[1],
                c = o[2];
            return [nn(e, t + 10), l, h, i, s + nn(e, t + 30) + nn(e, t + 32), c]
        },
        pn = function(e, t) {
            for (; 1 != nn(e, t); t += 4 + nn(e, t + 2));
            return [sn(e, t + 12), sn(e, t + 4), sn(e, t + 20)]
        },
        An = function(e) {
            var t = 0;
            if (e)
                for (var n in e) {
                    var r = e[n].length;
                    r > 65535 && kt(9), t += r + 4
                }
            return t
        },
        fn = function(e, t, n, r, i, s, a, o) {
            var l = r.length,
                h = n.extra,
                c = o && o.length,
                d = An(h);
            an(e, t, null != a ? 33639248 : 67324752), t += 4, null != a && (e[t++] = 20, e[t++] = n.os), e[t] = 20, t += 2, e[t++] = n.flag << 1 | (s < 0 && 8), e[t++] = i && 8, e[t++] = 255 & n.compression, e[t++] = n.compression >> 8;
            var u = new Date(null == n.mtime ? Date.now() : n.mtime),
                m = u.getFullYear() - 1980;
            if ((m < 0 || m > 119) && kt(10), an(e, t, m << 25 | u.getMonth() + 1 << 21 | u.getDate() << 16 | u.getHours() << 11 | u.getMinutes() << 5 | u.getSeconds() >>> 1), t += 4, -1 != s && (an(e, t, n.crc), an(e, t + 4, s < 0 ? -s - 2 : s), an(e, t + 8, n.size)), an(e, t + 12, l), an(e, t + 14, d), t += 16, null != a && (an(e, t, c), an(e, t + 6, n.attrs), an(e, t + 10, a), t += 14), e.set(r, t), t += l, d)
                for (var E in h) {
                    var g = h[E],
                        p = g.length;
                    an(e, t, +E), an(e, t + 2, p), e.set(g, t + 4), t += 4 + p
                }
            return c && (e.set(o, t), t += c), t
        };

    function Tn(e, t) {
        t || (t = {});
        var n = {},
            r = [];
        hn(e, "", n, t);
        var i = 0,
            s = 0;
        for (var a in n) {
            var o = n[a],
                l = o[0],
                h = o[1],
                c = 0 == h.level ? 0 : 8,
                d = (S = un(a)).length,
                u = h.comment,
                m = u && un(u),
                E = m && m.length,
                g = An(h.extra);
            d > 65535 && kt(11);
            var p = c ? on(l, h) : l,
                A = p.length,
                f = $t();
            f.p(l), r.push(tn(h, {
                size: l.length,
                crc: f.d(),
                c: p,
                f: S,
                m: m,
                u: d != a.length || m && u.length != E,
                o: i,
                compression: c
            })), i += 30 + d + g + A, s += 76 + 2 * (d + g) + (E || 0) + A
        }
        for (var T = new dt(s + 22), C = i, R = s - i, y = 0; y < r.length; ++y) {
            var S = r[y];
            fn(T, S.o, S, S.f, S.u, S.c.length);
            var w = 30 + S.f.length + An(S.extra);
            T.set(S.c, S.o + w), fn(T, i, S, S.f, S.u, S.c.length, S.o, S.m), i += 16 + w + (S.m ? S.m.length : 0)
        }
        return function(e, t, n, r, i) {
            an(e, t, 101010256), an(e, t + 8, n), an(e, t + 10, n), an(e, t + 12, r), an(e, t + 16, i)
        }(T, i, r.length, R, C), T
    }
    class Cn {
        static METADATA_JSON_NAME = "snapshot.json";
        static LEGACY_METADATA_JSON_NAME = "metadata.json";
        static createZip(e) {
            const t = un(JSON.stringify(e.metadata, null, 2)),
                n = un(JSON.stringify(e.serializedEntities, null, 2));
            return Tn({
                "snapshot.json": t,
                "data-heads.bin": new Uint8Array(e.dataHeads),
                "data-tails.bin": new Uint8Array(e.dataTails),
                "data-entities.json": n
            }, {
                level: 9
            })
        }
        static parse(e) {
            function t(t) {
                return JSON.parse(mn(e[t]))
            }
            let n;
            if (e[Cn.METADATA_JSON_NAME]) n = t(Cn.METADATA_JSON_NAME);
            else {
                if (!e[Cn.LEGACY_METADATA_JSON_NAME]) throw "Metadata not found";
                n = t(Cn.LEGACY_METADATA_JSON_NAME)
            }
            let r = new et;
            if (r.metadata = Object.assign(new tt, n), "number" != typeof r.metadata.width) throw "Metadata property wrong format: width";
            if ("number" != typeof r.metadata.height) throw "Metadata property wrong format: height";
            if (r.metadata.formatVersion < 3) {
                const t = e["data.bin"];
                if (!t) throw "data.bin not found";
                {
                    if (t.byteLength % 8 != 0) throw "Buffer length is not divisible by 8";
                    const e = t.byteLength / 8,
                        n = new Uint8Array(new ArrayBuffer(4 * e)),
                        i = new Uint8Array(new ArrayBuffer(4 * e));
                    for (let r = 0; r < e; r++)
                        for (let e = 0; e < 4; e++) n[4 * r + e] = t[8 * r + e], i[4 * r + e] = t[8 * r + e + 4];
                    r.dataHeads = n.buffer, r.dataTails = i.buffer
                }
            } else {
                const t = e["data-heads.bin"];
                if (!t) throw "data-heads.bin not found";
                r.dataHeads = t.buffer;
                const n = e["data-tails.bin"];
                if (!n) throw "data-tails.bin not found";
                r.dataTails = n.buffer
            }
            if (r.metadata.formatVersion > 6) {
                if (r.serializedEntities = t("data-entities.json"), !Array.isArray(r.serializedEntities)) throw "Entities corrupted"
            } else r.serializedEntities = [];
            return 1 === r.metadata.formatVersion && (Cn.#$r(r), r.metadata.formatVersion = 2), 2 === r.metadata.formatVersion && (r.metadata.formatVersion = 3), 3 === r.metadata.formatVersion && (Cn.#ei(r), r.metadata.formatVersion = 4), 4 === r.metadata.formatVersion && (Cn.#ti(r), r.metadata.formatVersion = 5), 5 === r.metadata.formatVersion && (Cn.#ni(r), r.metadata.formatVersion = 6), 6 === r.metadata.formatVersion && (Cn.#ri(r), r.metadata.formatVersion = 7), r
        }
        static #$r(e) {
            const t = F.from(e.metadata.width, e.metadata.height, e.dataHeads, e.dataTails);
            for (let n = 0; n < e.metadata.height; n++)
                for (let i = 0; i < e.metadata.width; i++) {
                    let e = t.getElementHead(i, n),
                        s = 7 & e;
                    0 === s && 0 === (e >> 4 & 15) || (0 === s ? t.setElementHead(i, n, r.setType(e, 7)) : 1 === s ? t.setElementHead(i, n, r.setType(e, 5)) : 2 === s ? t.setElementHead(i, n, r.setType(e, 133)) : 3 === s ? t.setElementHead(i, n, r.setType(e, 197)) : 4 !== s && 5 !== s || t.setElementHead(i, n, r.setType(e, 3)))
                }
            e.dataHeads = t.getDataHeads(), e.dataTails = t.getDataTails()
        }
        static #ei(e) {
            const t = F.from(e.metadata.width, e.metadata.height, e.dataHeads, e.dataTails);
            for (let n = 0; n < e.metadata.height; n++)
                for (let r = 0; r < e.metadata.width; r++) {
                    let e = t.getElementHead(r, n),
                        i = t.getElementTail(r, n),
                        s = 7 & e;
                    switch (s > 1 && s < 7 && (s++, e = 4294967288 & e | s), s) {
                        case 5:
                        case 6:
                        case 7:
                            e |= 4194304, i |= 268435456
                    }
                    4 === s && (e = 4294963455 & e | 3072), t.setElementHead(r, n, e), t.setElementTail(r, n, i)
                }
            e.dataHeads = t.getDataHeads(), e.dataTails = t.getDataTails()
        }
        static #ti(e) {
            const t = F.from(e.metadata.width, e.metadata.height, e.dataHeads, e.dataTails);
            for (let n = 0; n < e.metadata.height; n++)
                for (let r = 0; r < e.metadata.width; r++) {
                    let e = t.getElementHead(r, n),
                        i = e >> 8 & 15;
                    5 !== i && 8 !== i || (e &= 4294902015), t.setElementHead(r, n, e)
                }
            e.dataHeads = t.getDataHeads(), e.dataTails = t.getDataTails()
        }
        static #ni(e) {
            const t = F.from(e.metadata.width, e.metadata.height, e.dataHeads, e.dataTails);
            for (let n = 0; n < e.metadata.height; n++)
                for (let r = 0; r < e.metadata.width; r++) {
                    const e = t.getElementHead(r, n),
                        i = e >> 16 & 3,
                        s = e >> 18 & 3,
                        a = e >> 20 & 3,
                        o = e >> 22 & 3;
                    let l = 0;
                    0 === i && 0 === s && 0 === a && 0 === o ? l = 0 : 0 === i && 0 === s && 0 === a && 1 === o ? l = 1 : 0 === i && 0 === s && 0 === a && 2 === o ? l = 2 : 0 === i && 0 === s && 0 === a && 3 === o ? l = 3 : 2 === i && 1 === s && 3 === a && 0 === o ? l = 4 : 1 === i && 1 === s && 1 === a && 0 === o ? l = 5 : 2 === i && 1 === s && 2 === a && 0 === o && (l = 6);
                    const h = 4278255615 & e | l << 16;
                    t.setElementHead(r, n, h)
                }
            e.dataHeads = t.getDataHeads(), e.dataTails = t.getDataTails()
        }
        static #ri(e) {
            const t = F.from(e.metadata.width, e.metadata.height, e.dataHeads, e.dataTails);
            for (let n = 0; n < e.metadata.height; n++)
                for (let r = 0; r < e.metadata.width; r++) {
                    let i = t.getElementHead(r, n),
                        s = i >> 8 & 15;
                    3 === s && e.serializedEntities.push({
                        entity: "fish",
                        x: r,
                        y: n
                    }), 3 !== s && 4 !== s || (i = 4294902015 & i | 3328), t.setElementHead(r, n, i)
                }
            e.dataHeads = t.getDataHeads(), e.dataTails = t.getDataTails()
        }
    }
    class Rn extends ot {
        #ii;
        #si;
        #ai;
        constructor(e, t, n) {
            super(), this.#ii = e, this.#si = t, this.#ai = n
        }
        countSize(e, t) {
            this.#ii.countSize(e, t)
        }
        async createSandGame(e, t, n, r, i) {
            let s = this.createElementArea(e, t, n.getDefaultElement());
            return new at(s, [], null, n, r, i)
        }
        createElementArea(e, t, n) {
            const r = this.#ii.createElementArea(e, t, n),
                i = r.getWidth(),
                s = r.getHeight();
            if (this.#si)
                for (let e = 0; e < s; e++)
                    for (let t = 0; t < Math.trunc(i / 2); t++) r.swap(t, e, i - 1 - t, e);
            if (this.#ai)
                for (let e = 0; e < Math.trunc(s / 2); e++)
                    for (let t = 0; t < i; t++) r.swap(t, e, t, s - 1 - e);
            return r
        }
    }
    class yn extends ot {
        #K;
        constructor(e) {
            super(), this.#K = e
        }
        countSize(e, t) {
            return [this.#K.getWidth(), this.#K.getHeight()]
        }
        async createSandGame(e, t, n, r, i) {
            let s = this.createElementArea(e, t, n.getDefaultElement());
            return new at(s, [], null, n, r, i)
        }
        createElementArea(e, t, n) {
            return F.from(this.#K.getWidth(), this.#K.getHeight(), this.#K.getDataHeads(), this.#K.getDataTails())
        }
    }
    class Sn {
        static loadImageData(e, t, n) {
            return u.asImageData(e, t, n)
        }
        static asObjectUrl(e, t = "image/png") {
            const n = new Uint8Array(e),
                r = new Blob([n], {
                    type: t
                });
            return (window.URL || window.webkitURL).createObjectURL(r)
        }
        static createSceneFromImageTemplate(e, t, n, r) {
            const s = e.width,
                a = e.height,
                o = F.create(s, a, n),
                l = new i(0);
            for (let n = 0; n < a; n++)
                for (let i = 0; i < s; i++) {
                    const a = 4 * (n * s + i);
                    let c = e.data[a],
                        d = e.data[a + 1],
                        u = e.data[a + 2];
                    const m = e.data[a + 3];
                    if (255 !== m && (c = Math.trunc(c * m / 255) + 255 - m, d = Math.trunc(d * m / 255) + 255 - m, u = Math.trunc(u * m / 255) + 255 - m), c > 255 - r && d > 255 - r && u > 255 - r) continue;
                    const E = t.apply(i, n, l),
                        g = E.elementHead,
                        p = h.setColor(E.elementTail, c, d, u);
                    o.setElementHeadAndTail(i, n, g, p)
                }
            return new yn(o)
        }
        static getImageTypeOrNull(e) {
            return (e = e.toLowerCase()).endsWith(".png") ? "image/png" : e.endsWith(".jpg") || e.endsWith(".jpeg") ? "image/jpg" : e.endsWith(".bmp") ? "image/bmp" : e.endsWith(".gif") ? "image/gif" : null
        }
    }
    class wn {
        static METADATA_JSON_NAME = "tool.json";
        static async parse(e, t) {
            const n = e.info,
                r = e.action;
            if (void 0 === n) throw "Tool definition: info not set";
            const i = new x(n);
            if (void 0 === r) throw "Tool definition: action not set";
            return wn.#oi(i, r, t)
        }
        static async #oi(e, t, n) {
            const r = t.type;
            if ("image-template" === r) {
                const r = await this.parseImageTemplate(t, n);
                return $.insertScenesTool(r, void 0, e)
            }
            if ("random-template" === r) {
                const r = await this.parseRandomTemplate(t, n);
                return $.insertScenesTool(r, void 0, e)
            }
            throw "Tool action not supported: " + r
        }
        static async parseRandomTemplate(e, t) {
            const n = e.actions;
            if (void 0 === n || void 0 === n.length || 0 === n.length) throw "Image template: actions not set";
            let r = [];
            for (let e = 0; e < n.length; e++) {
                const i = n[e],
                    s = i.type;
                if ("image-template" !== s) throw "Tool action not supported: " + s;
                {
                    const e = await this.parseImageTemplate(i, t);
                    r.push(...e)
                }
            }
            return r
        }
        static async parseImageTemplate(e, t) {
            let n = await this.#li(e, t);
            const r = e.threshold;
            if (void 0 === r) throw "Image template: threshold not set";
            const i = parseInt(r),
                a = e.brush;
            if (void 0 === a) throw "Image template: brush not set";
            let o = null;
            if ("string" == typeof a ? o = ie.byCodeName(a) : "object" == typeof a && a instanceof s && (o = a), null === o) throw "Image template: brush not found: " + a;
            const l = F.TRANSPARENT_ELEMENT,
                h = Sn.createSceneFromImageTemplate(n, o, l, i),
                c = [h];
            e.randomFlipHorizontally && c.push(new Rn(h, !0, !1));
            if (e.randomFlipVertically)
                for (const e of [...c]) c.push(new Rn(e, !1, !0));
            return c
        }
        static async #li(e, t) {
            const n = e.imageData;
            if (void 0 !== n) return await Sn.loadImageData(n, void 0, void 0);
            const r = e.imageFile;
            if (void 0 !== r && null !== t && t[r]) {
                if (null !== Sn.getImageTypeOrNull(r)) {
                    const e = Sn.asObjectUrl(t[r].buffer);
                    return Sn.loadImageData(e, void 0, void 0)
                }
            }
            throw "Image template: imageData/imageFile not set"
        }
    }
    class vn {
        static JSON_RESOURCE_TYPE_FIELD = "resourceType";
        static createResourceFromSnapshot(e) {
            return Cn.createZip(e)
        }
        static async parseZipResource(e) {
            const t = function(e, t) {
                for (var n = {}, r = e.length - 22; 101010256 != rn(e, r); --r)(!r || e.length - r > 65558) && kt(13);
                var i = nn(e, r + 8);
                if (!i) return {};
                var s = rn(e, r + 16),
                    a = 4294967295 == s || 65535 == i;
                if (a) {
                    var o = rn(e, r - 12);
                    (a = 101075792 == rn(e, o)) && (i = rn(e, o + 32), s = rn(e, o + 48))
                }
                for (var l = t && t.filter, h = 0; h < i; ++h) {
                    var c = gn(e, s, a),
                        d = c[0],
                        u = c[1],
                        m = c[2],
                        E = c[3],
                        g = c[4],
                        p = c[5],
                        A = En(e, p);
                    s = g, l && !l({
                        name: E,
                        size: u,
                        originalSize: m,
                        compression: d
                    }) || (d ? 8 == d ? n[E] = ln(e.subarray(A, A + u), new dt(m)) : kt(14, "unknown compression type " + d) : n[E] = Ft(e, A, A + u))
                }
                return n
            }(new Uint8Array(e));
            if (t[Cn.METADATA_JSON_NAME] || t[Cn.LEGACY_METADATA_JSON_NAME]) {
                const e = Cn.parse(t);
                return new ct(e)
            }
            if (t[wn.METADATA_JSON_NAME]) {
                const e = (n = wn.METADATA_JSON_NAME, JSON.parse(mn(t[n])));
                return await wn.parse(e, t)
            }
            var n;
            throw "Wrong format"
        }
        static async parseJsonResource(e) {
            const t = mn(new Uint8Array(e)),
                n = JSON.parse(t);
            if ("tool" === n[vn.JSON_RESOURCE_TYPE_FIELD]) return await wn.parse(n, null);
            throw "Wrong json format"
        }
        static async parseToolDefinition(e) {
            return wn.parse(e, null)
        }
    }
    class In {
        createNode(e) {
            throw "Not implemented"
        }
    }
    class On extends In {
        #hi = 50;
        #ci = 300;
        #Nr = 200;
        #di = "sand";
        #ui = ie.SAND;
        createNode() {
            return pe.element("form", null, [pe.element("fieldset", {
                class: "mb-3 row"
            }, [pe.element("legend", {
                class: "col-form-label col-sm-3 float-sm-left pt-0"
            }, "Material"), pe.div({
                class: "col-sm-9",
                style: "column-count: 2;"
            }, [this.#mi(ie.SAND, Ee.SAND.getInfo()), this.#mi(ie.SOIL, Ee.SOIL.getInfo()), this.#mi(ie.THERMITE, Ee.THERMITE.getInfo()), this.#mi(ie.WALL, Ee.WALL.getInfo()), this.#mi(ie.METAL, Ee.METAL.getInfo()), this.#mi(ie.TREE_WOOD, Ee.WOOD.getInfo())])]), pe.element("fieldset", {
                class: "mb-3 row"
            }, [pe.element("legend", {
                class: "col-form-label col-sm-3 float-sm-left pt-0"
            }, "Background threshold"), pe.div({
                class: "col-sm-9"
            }, [this.#Ei()])]), pe.element("fieldset", {
                class: "mb-3 row"
            }, [pe.element("legend", {
                class: "col-form-label col-sm-3 float-sm-left pt-0"
            }, "Max size"), pe.div({
                class: "col-sm-9"
            }, [this.#gi(), this.#pi()])])])
        }
        #Ei() {
            const e = "image-template_threshold-slider",
                t = pe.element("label", {
                    for: e
                }, "Value: " + this.#hi),
                n = pe.element("input", {
                    id: e,
                    class: "form-range",
                    type: "range",
                    min: 0,
                    max: 255,
                    value: this.#hi
                });
            return n.addEventListener("input", (e => {
                this.#hi = e.target.value, t.textContent = "Value: " + this.#hi
            })), pe.div({
                class: "mb-3"
            }, [n, pe.element("small", null, t)])
        }
        #gi() {
            const e = "image-template_max-width",
                t = pe.element("label", {
                    for: e
                }, "Width: " + this.#ci),
                n = pe.element("input", {
                    id: e,
                    class: "form-range",
                    type: "range",
                    min: 25,
                    max: 800,
                    value: this.#ci
                });
            return n.addEventListener("input", (e => {
                this.#ci = e.target.value, t.textContent = "Width: " + this.#ci
            })), pe.div({
                class: "mb-3"
            }, [n, pe.element("small", null, t)])
        }
        #pi() {
            const e = "image-template_max-height",
                t = pe.element("label", {
                    for: e
                }, "Height: " + this.#Nr),
                n = pe.element("input", {
                    id: e,
                    class: "form-range",
                    type: "range",
                    min: 25,
                    max: 800,
                    value: this.#Nr
                });
            return n.addEventListener("input", (e => {
                this.#Nr = e.target.value, t.textContent = "Height: " + this.#Nr
            })), pe.div({
                class: "mb-3"
            }, [n, pe.element("small", null, t)])
        }
        #mi(e, t) {
            const n = t.getCodeName(),
                r = this.#di === n,
                i = "image-template_checkbox-material-" + n,
                s = pe.element("input", {
                    class: "form-check-input",
                    type: "radio",
                    name: "template-material",
                    id: i,
                    value: n,
                    checked: r || null
                });
            s.addEventListener("click", (() => {
                this.#ui = e, this.#di = n
            }));
            const a = {
                class: "form-check-label btn btn-secondary btn-sand-game-tool " + n,
                for: i,
                style: t.getBadgeStyle()
            };
            return pe.div({
                class: "form-check"
            }, [s, pe.element("label", a, t.getDisplayName())])
        }
        getThresholdValue() {
            return this.#hi
        }
        getMaterialBrush() {
            return this.#ui
        }
        getMaxWidth() {
            return this.#ci
        }
        getMaxHeight() {
            return this.#Nr
        }
    }
    class bn {
        #Ai;
        #fi;
        constructor(e) {
            this.#Ai = e, this.#fi = new On
        }
        initFileDragAndDrop(e) {
            ["dragenter", "dragover"].forEach((t => {
                e.addEventListener(t, (t => {
                    t.preventDefault(), t.stopPropagation(), e.classList.add("drag-and-drop-highlight")
                }))
            })), e.addEventListener("dragleave", (t => {
                t.preventDefault(), t.stopPropagation(), e.classList.remove("drag-and-drop-highlight")
            })), e.addEventListener("drop", (t => {
                t.preventDefault(), t.stopPropagation(), e.classList.remove("drag-and-drop-highlight"), this.loadFromFiles(t.dataTransfer.files)
            }))
        }
        loadFromFiles(e) {
            if (!e) return;
            let t = e[0],
                n = new FileReader;
            n.onload = e => {
                let n = e.target.result;
                this.loadFromArrayBuffer(n, t.name)
            }, n.readAsArrayBuffer(t)
        }
        loadFromArrayBuffer(e, t) {
            try {
                let n = Sn.getImageTypeOrNull(t);
                null !== n ? this.#Ti(e, n) : t.endsWith(".json") ? vn.parseJsonResource(e).then((e => this.#Ci(e))).catch((e => this.#Ri(e))) : vn.parseZipResource(e).then((e => this.#Ci(e))).catch((e => this.#Ri(e)))
            } catch (e) {
                this.#Ri(e)
            }
        }
        #Ti(e, t) {
            const n = (n, r, i, s) => {
                const a = Sn.asObjectUrl(e, t),
                    o = F.TRANSPARENT_ELEMENT;
                Sn.loadImageData(a, i, s).then((e => {
                    try {
                        const t = Sn.createSceneFromImageTemplate(e, n, o, r);
                        this.#yi(t)
                    } catch (e) {
                        this.#Ri(e)
                    }
                })).catch((e => this.#Ri(e)))
            };
            let r = pe.bootstrapDialogBuilder();
            r.setHeaderContent("Image template"), r.setBodyContent(this.#fi.createNode()), r.addSubmitButton("Place", (() => {
                let e = this.#fi.getMaterialBrush(),
                    t = this.#fi.getThresholdValue(),
                    r = this.#fi.getMaxWidth(),
                    i = this.#fi.getMaxHeight();
                n(e, t, r, i)
            })), r.addCloseButton("Close"), r.show(this.#Ai.getDialogAnchor())
        }
        #yi(e) {
            this.#Ai.pasteScene(e), ge.triggerFeatureUsed(ge.FEATURE_IO_IMAGE_TEMPLATE)
        }
        #Ci(e) {
            if (e instanceof ot) this.#Si(e);
            else if (e instanceof B) {
                const t = e,
                    n = this.#Ai.getToolManager();
                if (t instanceof k || t instanceof Y) {
                    const e = n.createRevertAction();
                    n.setPrimaryTool(t), n.setSecondaryTool($.actionTool(e))
                } else n.setPrimaryTool(t)
            } else this.#Ri("Unknown resource type")
        }
        #Si(e) {
            try {
                let t = pe.bootstrapDialogBuilder();
                t.setHeaderContent("Import scene"), t.setBodyContent([pe.par(null, "The imported scene can be opened or placed on the current scene.")]), t.addSubmitButton("Open", (() => (ge.triggerFeatureUsed(ge.FEATURE_IO_IMPORT), this.#Ai.openScene(e)))), t.addSubmitButton("Place", (() => (ge.triggerFeatureUsed(ge.FEATURE_IO_IMPORT), this.#Ai.pasteScene(e)))), t.addCloseButton("Close"), t.show(this.#Ai.getDialogAnchor())
            } catch (e) {
                this.#Ri(e)
            }
        }
        #Ri(e) {
            let t = pe.bootstrapDialogBuilder();
            t.setHeaderContent("Error"), t.setBodyContent([pe.par(null, "Error while loading resource:"), pe.element("code", null, "" + e)]), t.addCloseButton("Close"), t.show(this.#Ai.getDialogAnchor())
        }
    }
    class Mn {
        getExtraBrushes() {
            throw "Not implemented"
        }
        byCodeName(e) {
            throw "Not implemented"
        }
    }
    class Nn extends Mn {
        #wi;
        constructor(e) {
            super(), this.#wi = e
        }
        getExtraBrushes() {
            return {
                ...this.#wi
            }
        }
        byCodeName(e) {
            const t = this.#wi[e];
            return void 0 !== t ? t : ie.byCodeName(e)
        }
    }
    class xn extends we {
        #vi;
        #Ii;
        #Oi;
        #bi;
        #Mi;
        #Ni;
        #xi;
        #Di;
        #Bi;
        #_i;
        #Hi;
        #Ui;
        #Pi;
        #Fi;
        constructor(e = {}, t = (() => [])) {
            function n(t) {
                const n = e[t];
                if (null == n) {
                    const e = ie.byCodeName(t);
                    if (null === e) throw `Brush '${t}' not found`;
                    return e
                }
                if (n instanceof s) return n;
                throw `Provided brush '${t}' is not instance of Brush`
            }
            super(), this.#vi = t, this.#Ii = new Nn(e), this.#Oi = n("air").apply(0, 0, void 0), this.#bi = n("water"), this.#Mi = n("steam"), this.#Ni = n("grass"), this.#xi = n("tree"), this.#Di = n("tree_wood"), this.#Bi = n("tree_wood_dark"), this.#_i = n("tree_leaf"), this.#Hi = n("tree_leaf_dark"), this.#Ui = n("tree_root"), this.#Pi = n("fire"), this.#Fi = n("ash")
        }
        getExtensionsFactory() {
            return this.#vi
        }
        getBrushCollection() {
            return this.#Ii
        }
        getDefaultElement() {
            return this.#Oi
        }
        getBrushWater() {
            return this.#bi
        }
        getBrushSteam() {
            return this.#Mi
        }
        getBrushGrass() {
            return this.#Ni
        }
        getBrushTree() {
            return this.#xi
        }
        getBrushTreeLeaf() {
            return this.#_i
        }
        getBrushTreeLeafDark() {
            return this.#Hi
        }
        getBrushTreeWood() {
            return this.#Di
        }
        getBrushTreeWoodDark() {
            return this.#Bi
        }
        getBrushTreeRoot() {
            return this.#Ui
        }
        getBrushFire() {
            return this.#Pi
        }
        getBrushAsh() {
            return this.#Fi
        }
        getTreeTrunkTemplates() {
            return ne.TREE_TRUNK_TEMPLATES
        }
        getTreeLeafClusterTemplates() {
            return ne.TREE_CLUSTER_TEMPLATES
        }
    }
    class Dn {
        #Li = {
            scale: .5,
            canvasWidthPx: 700,
            canvasHeightPx: 400,
            scene: "empty"
        };
        #ki;
        #Yi;
        #Wi;
        #Vi = null;
        #Gi;
        #zi = "pixelated";
        #Ki = [];
        #Xi = !1;
        #qi = !1;
        #Ji = Ve.canvasWebGL();
        #ji = null;
        #Zi;
        #Qi = new bn(this);
        #$i;
        #es = null;
        constructor(e, t, n, r) {
            e && (this.#Li = e), this.#$i = t, this.#Zi = n, this.#Gi = r, this.#ki = Math.trunc(this.#Li.canvasWidthPx * this.#Li.scale), this.#Yi = Math.trunc(this.#Li.canvasHeightPx * this.#Li.scale), this.#Wi = this.#Li.scale
        }
        getVersion() {
            return this.#Li.version
        }
        registerCanvasProvider(e) {
            this.#es = e
        }
        getInitialScene() {
            return this.#ji
        }
        setInitialScene(e) {
            this.#ji = e
        }
        setup(e) {
            this.setInitialScene(e), this.#ts(e)
        }
        #ts(e) {
            if (null == this.#es) throw "Illegal state: canvas provider not registered!";
            if (null == this.#$i) throw "Illegal state: dialog anchor not registered!";
            const [t, n] = e.countSize(this.#ki, this.#Yi);
            t === this.#ki && n === this.#Yi || (this.#ki = t, this.#Yi = n, this.#Wi = +(t / this.#Li.canvasWidthPx).toFixed(3));
            const r = this.#ns();
            let i;
            this.#Vi = null;
            try {
                i = e.createSandGame(t, n, this.#Gi, r, this.#Ji)
            } catch (e) {
                return void this.#rs("Initialization failed", e)
            }
            i.then((e => {
                this.#Vi = e, this.#Vi.graphics().replace(F.TRANSPARENT_ELEMENT, this.#Gi.getDefaultElement()), this.#is.forEach((e => e(this.#Vi))), this.#Vi.addOnRenderingFailed((e => {
                    this.#rs("Rendering failure", e)
                })), this.#Vi.startRendering(), this.#Xi && (this.#Vi.startProcessing(), this.#ss.forEach((e => e())))
            })).catch((t => {
                t instanceof We ? setTimeout((() => {
                    const n = "WebGL renderer initialization failed (" + t.getError() + "). Using fallback renderer; game performance and visuals will be affected!";
                    this.#as(n, e)
                }), 100) : this.#rs("Initialization failed", t)
            }))
        }
        #ns() {
            const e = this.#es.initialize();
            let t = this.#Ji.getContextType(),
                n = this.#os(e, t);
            return "webgl2" === t && null == n && (this.#ls("Unable to get WebGL context. Using fallback renderer; game performance and visual will be affected"), this.#Ji = Ve.canvas2d(), t = this.#Ji.getContextType(), n = this.#os(e, t), ge.triggerFeatureUsed(ge.FEATURE_RENDERER_FALLBACK)), n
        }
        #os(e, t) {
            if ("webgl2" === t) {
                let t = !1;
                e.addEventListener("webglcontextlost", (e => {
                    if (null !== this.#Vi && this.#Vi.stopRendering(), t) return;
                    t = !0;
                    e.preventDefault(), setTimeout((() => {
                        this.#hs("WebGL context loss detected. Using fallback renderer; game performance and visuals will be affected")
                    }), 2e3)
                }), !1)
            }
            return e.getContext(t)
        }
        close() {
            null !== this.#Vi && (this.#Vi.stopProcessing(), this.#Vi.stopRendering());
            for (let e of this.#cs) e()
        }
        enableGlobalShortcuts() {
            document.onkeydown = e => {
                if (!e.ctrlKey || e.altKey || e.shiftKey || "Enter" !== e.key || (e.preventDefault(), this.switchStartStop()), !e.ctrlKey || e.altKey || e.shiftKey || " " !== e.key || (e.preventDefault(), null !== this.#Vi && this.#Vi.doProcessing()), e.ctrlKey && !e.altKey && e.shiftKey && " " === e.key && (e.preventDefault(), null !== this.#Vi)) {
                    const e = prompt("Enter the number of iterations to run", "10000"),
                        t = Math.abs(parseInt(e)),
                        n = new Date;
                    for (let e = 0; e < t; e++) this.#Vi.doProcessing(), e % 2500 == 0 && console.log(`Performed ${e} of ${t} iterations`);
                    const r = (new Date).getTime() - n.getTime();
                    console.log(`Performed ${t} iterations in ${r} ms`)
                }
            }
        }
        getSandGame() {
            return this.#Vi
        }
        getCanvas() {
            return null !== this.#es ? this.#es.getCanvasNode() : null
        }
        #is = [];
        #cs = [];
        #ds = [];
        #ss = [];
        #us = [];
        #ms = [];
        addOnInitialized(e) {
            this.#is.push(e)
        }
        addOnBeforeNewSceneLoaded(e) {
            this.#ds.push(e)
        }
        addOnBeforeClosed(e) {
            this.#cs.push(e)
        }
        addOnStarted(e) {
            this.#ss.push(e)
        }
        addOnStopped(e) {
            this.#us.push(e)
        }
        addOnFailure(e) {
            this.#ms.push(e)
        }
        #as(e, t) {
            this.#ls(e), this.#Ji = Ve.canvas2d(), this.#ts(t), ge.triggerFeatureUsed(ge.FEATURE_RENDERER_FALLBACK)
        }
        #hs(e) {
            this.#ls(e);
            const t = this.createSnapshot();
            this.#Ji = Ve.canvas2d(), this.openScene(new ct(t)), ge.triggerFeatureUsed(ge.FEATURE_RENDERER_FALLBACK)
        }
        #ls(e) {
            console.warn(e);
            for (let t of this.#ms) t("rendering-warning", e);
            let t = pe.bootstrapToastBuilder();
            t.setHeaderContent(pe.element("strong", {
                style: "color: orange;"
            }, "Warning")), t.setBodyContent(pe.par(null, e)), t.setDelay(6e4), t.show(this.#$i)
        }
        #rs(e, t) {
            console.error(e, t), t instanceof We && (t = t.getError()), "object" == typeof t && (t = void 0 !== t.message ? "" + t.message : JSON.stringify(t));
            const n = e + ": " + t;
            for (let e of this.#ms) e("serious", n);
            let r = pe.bootstrapToastBuilder();
            r.setHeaderContent(pe.element("strong", {
                style: "color: red;"
            }, "Error")), r.setBodyContent(pe.par(null, n)), r.show(this.#$i)
        }
        start() {
            null !== this.#Vi && (this.#Xi || (this.#Vi.startProcessing(), this.#ss.forEach((e => e())))), this.#Xi = !0
        }
        switchStartStop() {
            this.#Xi = !this.#Xi, null !== this.#Vi && (this.#Xi ? (this.#Xi = !0, this.#Vi.startProcessing(), this.#ss.forEach((e => e()))) : (this.#Vi.stopProcessing(), this.#us.forEach((e => e()))))
        }
        createSnapshot() {
            if (null !== this.#Vi) {
                let e = this.#Vi.createSnapshot();
                return e.metadata.scale = this.getCurrentScale(), void 0 !== this.#Li.version && (e.metadata.appVersion = this.#Li.version), e
            }
            return null
        }
        openScene(e) {
            for (let t of this.#ds) t(e);
            this.close(), this.#ts(e)
        }
        pasteScene(e) {
            const t = this.getToolManager(),
                n = t.createRevertAction();
            t.setPrimaryTool($.insertScenesTool([e], n)), t.setSecondaryTool($.actionTool(n))
        }
        getCurrentWidthPoints() {
            return this.#ki
        }
        getCurrentHeightPoints() {
            return this.#Yi
        }
        getCurrentScale() {
            return this.#Wi
        }
        changeCanvasSize(e, t, n) {
            if ("number" != typeof e || !(e > 0 && e < 2048)) throw "Incorrect width";
            if ("number" != typeof t || !(t > 0 && t < 2048)) throw "Incorrect height";
            if ("number" != typeof n || !(n > 0 && n <= 1)) throw "Incorrect scale";
            this.close(), this.#ki = e, this.#Yi = t, this.#Wi = n, this.#ts(new lt(this.#Vi.createSnapshot()))
        }
        setShowActiveChunks(e) {
            this.#qi = e
        }
        isShowActiveChunks() {
            return this.#qi
        }
        setRendererInitializer(e) {
            this.#Ji = e, this.#Vi && (this.close(), this.#ts(new ct(this.#Vi.createSnapshot())))
        }
        getRendererInitializer() {
            return this.#Ji
        }
        setCanvasImageRenderingStyle(e) {
            this.#zi = e;
            for (let t of this.#Ki) t(e)
        }
        getCanvasImageRenderingStyle() {
            return this.#zi
        }
        addOnImageRenderingStyleChanged(e) {
            this.#Ki.push(e)
        }
        getToolManager() {
            return this.#Zi
        }
        getIOManager() {
            return this.#Qi
        }
        getDialogAnchor() {
            return this.#$i
        }
    }
    class Bn extends ot {
        name;
        description;
        #Es;
        constructor({
            name: e,
            description: t,
            apply: n
        }) {
            super(), this.#Es = n, this.name = e, this.description = t
        }
        countSize(e, t) {
            return [e, t]
        }
        async createSandGame(e, t, n, r, i) {
            let s = this.createElementArea(e, t, n.getDefaultElement()),
                a = new at(s, [], null, n, r, i);
            return await this.#Es(a), a
        }
        createElementArea(e, t, n) {
            return F.create(e, t, n)
        }
    }
    class _n {
        static custom(e, t) {
            return new Bn({
                name: e,
                apply: t
            })
        }
    }
    class Hn {
        static SCENE_EMPTY = new Bn({
            name: "Empty",
            description: "Boxed mode",
            apply: function(e) {
                e.setBoxedMode()
            }
        });
        static SCENE_LANDSCAPE_1 = new Bn({
            name: "Landscape 1",
            description: "Boxed mode",
            apply: async function(e) {
                e.setBoxedMode();
                const t = e.getBrushCollection().byCodeName("soil"),
                    n = e.getBrushCollection().byCodeName("sand"),
                    r = e.getBrushCollection().byCodeName("water");
                let i = e.layeredTemplate().layerSpline([
                    [0, 35],
                    [60, 35],
                    [80, 40],
                    [100, 50],
                    [120, 40],
                    [240, 20],
                    [440, 20],
                    [1040, 20]
                ], !0, N.concat(t, ie.EFFECT_NOISE_LG)).layerSpline([
                    [0, 0],
                    [130, 0],
                    [150, 10],
                    [190, 10],
                    [290, 0]
                ], !0, n, 2).tool(30, 17, await vn.parseToolDefinition(se.CABIN)).tool(160, 5, await vn.parseToolDefinition(se.SAND_CASTLE)).tree(100, 1, 200).tree(70, 5).grass(60, 80).grass(90, 110);
                e.getWidth() / e.getHeight() > 1.5 ? e.blockTemplate().withMaxHeight(120).withBlueprint(["          ", "        ww", "          ", "       1  ", "     111111", "          ", "          ", "          ", "          "]).withBrushes({
                    w: N.withIntensity(.5, r),
                    1: n
                }).paint() : i.layer(26, !1, r).layer(27, !1, N.withIntensity(.33, r)), i.tool(65, 45, Ee.BIRD), i.tool(70, 70, Ee.BIRD), i.tool(71, 75, Ee.BIRD), i.tool(125, 55, Ee.BIRD), i.tool(130, 50, Ee.BIRD)
            }
        });
        static SCENE_LANDSCAPE_2 = new Bn({
            name: "Landscape 2",
            description: "Boxed mode",
            apply: function(e) {
                e.setBoxedMode();
                const t = e.getBrushCollection().byCodeName("water"),
                    n = e.getBrushCollection().byCodeName("sand"),
                    r = e.getBrushCollection().byCodeName("soil"),
                    i = e.getBrushCollection().byCodeName("gravel");
                e.layeredTemplate().layerSpline([
                    [0, 20],
                    [50, 15],
                    [100, 10],
                    [150, 10],
                    [200, 10],
                    [250, 10],
                    [1250, 10]
                ], !0, N.concat(i, ie.EFFECT_NOISE_LG)).layerSpline([
                    [0, 30],
                    [25, 31],
                    [50, 27],
                    [100, 15],
                    [150, 0],
                    [200, 5],
                    [220, 15],
                    [300, 35],
                    [330, 37],
                    [370, 50],
                    [400, 45],
                    [500, 40],
                    [1250, 40]
                ], !0, N.concat(r, ie.EFFECT_NOISE_LG), 30).layerSpline([
                    [0, 0],
                    [50, 0],
                    [100, 10],
                    [150, 10],
                    [200, 9],
                    [275, 0],
                    [1250, 0]
                ], !0, n, 5).layer(35, !1, t).layer(36, !1, N.withIntensity(.33, t)).tool(150, -8, Ee.FISH).tool(270, 20, Ee.BUTTERFLY).tool(280, 15, Ee.BUTTERFLY).grass().tree(16, 6).tree(28, 3, 70).tree(45, 5).tree(309, 1).tree(336, 4).tree(361, 0)
            }
        });
        static SCENE_FALLTHROUGH = new Bn({
            name: "Fall-through",
            description: "Fall-through mode",
            apply: function(e) {
                e.setFallThroughMode();
                const t = e.getBrushCollection().byCodeName("wall"),
                    n = e.getBrushCollection().byCodeName("water"),
                    r = e.getBrushCollection().byCodeName("sand"),
                    i = e.graphics(),
                    s = Math.trunc((e.getWidth() - 150) / 2 - 15),
                    a = Math.trunc((e.getHeight() - 150) / 2);
                i.drawRectangle(40 + s, 20 + a, 60 + s, 40 + a, n), i.drawLine(30 + s, 30 + a, 30 + s, 50 + a, 5, t, !0), i.drawLine(30 + s, 50 + a, 70 + s, 80 + a, 5, t, !0), i.drawLine(65 + s, 90 + a, 100 + s, 100 + a, 5, t, !0), i.drawLine(55 + s, 140 + a, 125 + s, 140 + a, 10, t, !1), i.drawLine(55 + s, 130 + a, 55 + s, 140 + a, 10, t, !1), i.drawLine(70 + s, 125 + a, 90 + s, 125 + a, 10, r, !1), i.draw(120 + s, 130 + a, r), i.drawLine(150 + s, 10 + a, 80 + s, 35 + a, 5, t, !0), i.drawLine(80 + s, 35 + a, 80 + s, 15 + a, 5, t, !0)
            }
        });
        static SCENE_PLATFORM = new Bn({
            name: "Platform",
            description: "Erasing mode",
            apply: function(e) {
                e.setErasingMode();
                const t = e.getBrushCollection().byCodeName("sand"),
                    n = e.getBrushCollection().byCodeName("wall");
                e.blockTemplate().withBlueprint(["          ", "          ", "        w ", "        w ", "          ", "          ", " ssssssss ", "          ", "          "]).withBrushes({
                    w: t,
                    s: n
                }).paint()
            }
        });
        static SCENES = {
            empty: Hn.SCENE_EMPTY,
            landscape_1: Hn.SCENE_LANDSCAPE_1,
            landscape_2: Hn.SCENE_LANDSCAPE_2,
            fallthrough: Hn.SCENE_FALLTHROUGH,
            platform: Hn.SCENE_PLATFORM
        }
    }
    class Un {
        static bird(e = void 0, t = void 0) {
            return {
                entity: "bird",
                x: e,
                y: t
            }
        }
        static butterfly(e = void 0, t = void 0) {
            return {
                entity: "butterfly",
                x: e,
                y: t
            }
        }
        static fish(e = void 0, t = void 0) {
            return {
                entity: "fish",
                x: e,
                y: t
            }
        }
    }
    class Pn {
        performAction(e) {
            throw "Not implemented"
        }
        static create(e) {
            return new Fn(e)
        }
        static createToggle(e, t) {
            let n = e;
            return new Fn((function(e) {
                n = !n, t(e, n)
            }))
        }
    }
    class Fn extends Pn {
        #S;
        constructor(e) {
            super(), this.#S = e
        }
        performAction(e) {
            this.#S(e)
        }
    }
    class Ln extends In {
        #ue;
        constructor(e) {
            super(), this.#ue = e
        }
        createNode(e) {
            let t = [];
            for (const n of this.#ue) {
                const r = n.info.displayName;
                let i = null,
                    s = pe.button(r, {
                        class: "btn btn-light template-button",
                        "data-bs-dismiss": "modal"
                    }, (() => {
                        if (null !== i) {
                            const t = e.getToolManager(),
                                n = t.createRevertAction();
                            t.setPrimaryTool(i), t.setSecondaryTool($.actionTool(n))
                        }
                    }));
                void 0 !== n.info.icon && (s.style.backgroundImage = `url(${n.info.icon.imageData})`), t.push(s), vn.parseToolDefinition(n).then((e => {
                    i = e
                })).catch((e => {
                    console.warn("Template loading failed: " + e)
                }))
            }
            return pe.div({
                class: "sand-game-templates"
            }, t)
        }
    }
    class kn extends Pn {
        #ue;
        #gs;
        constructor(e, t = null) {
            super(), this.#ue = e, this.#gs = t
        }
        performAction(e) {
            let t = new Ln(this.#ue),
                n = pe.bootstrapDialogBuilder();
            n.setHeaderContent("Templates"), n.setBodyContent(pe.div({
                class: "sand-game-component"
            }, [pe.par(null, "Select a template"), t.createNode(e), this.#gs])), n.addCloseButton("Close"), n.show(e.getDialogAnchor())
        }
    }
    class Yn extends In {
        #de;
        #ps;
        #As;
        constructor(e, t = !1, n = !1) {
            super(), this.#de = e, this.#ps = t, this.#As = n
        }
        createNode(e) {
            let t = [];
            const n = this.#As ? " btn-sand-game-tool-big" : " btn-sand-game-tool",
                r = (t, n) => {
                    t.addEventListener("click", (() => {
                        this.#fs(n, e)
                    })), e.getToolManager().addOnPrimaryToolChanged((e => {
                        e === n ? t.classList.add("selected") : t.classList.remove("selected")
                    })), n === e.getToolManager().getPrimaryTool() && t.classList.add("selected"), e.getToolManager().addOnInputDisabledChanged((e => {
                        t.disabled = e
                    }))
                };
            for (let e of this.#de) {
                let i = e.getInfo().getCodeName(),
                    s = e.getInfo().getDisplayName(),
                    a = e.getInfo().getBadgeStyle();
                if (e instanceof X) {
                    const o = [];
                    for (const t of e.getTools()) {
                        t.getInfo().getCodeName();
                        let e = t.getInfo().getDisplayName(),
                            s = t.getInfo().getBadgeStyle();
                        const a = pe.span(e, {
                                class: "btn btn-secondary" + n + " " + i,
                                style: s
                            }),
                            l = {
                                class: "dropdown-item"
                            },
                            h = pe.button(a, l);
                        r(h, t), o.push(pe.element("li", null, h))
                    }
                    const l = pe.div({
                        class: "btn-group"
                    }, [pe.button(s, {
                        class: "btn btn-secondary dropdown-toggle " + n + " " + i,
                        style: a,
                        "data-bs-toggle": "dropdown",
                        "aria-expanded": "false"
                    }), pe.element("ul", {
                        class: "dropdown-menu"
                    }, o)]);
                    t.push(l)
                } else {
                    const o = {
                            class: "btn btn-secondary " + n + " " + i,
                            style: a
                        },
                        l = pe.button(s, o);
                    r(l, e), t.push(l)
                }
            }
            return pe.div({
                class: "sand-game-tools"
            }, t)
        }
        #fs(e, t) {
            if (e instanceof q) {
                let n = null;
                this.#ps && (n = pe.div(null, [pe.par(null, ""), pe.par(null, "You can also create your own template using an image. See the Import button.")]));
                new kn(e.getTemplateDefinitions(), n).performAction(t)
            } else if (e instanceof J) {
                const n = e.getHandler(),
                    r = t.getSandGame();
                null !== r && n(r)
            } else t.getToolManager().setPrimaryTool(e), t.getToolManager().setSecondaryTool(Ee.ERASE)
        }
    }
    class Wn extends In {
        #Ai;
        #Ts;
        #Cs = null;
        #Rs = null;
        #ys;
        #Ss;
        #ws;
        constructor(e, t, n, r) {
            super(), this.#ys = e, this.#Ss = t, this.#ws = n;
            const i = e / n,
                s = t / n;
            this.#Ts = pe.div({
                style: {
                    display: "none",
                    position: "absolute",
                    left: "0",
                    top: "0",
                    width: `${i}px`,
                    height: `${s}px`
                },
                class: "sand-game-canvas-overlay",
                width: e + "px",
                height: t + "px"
            }), this.#Ai = r
        }
        highlightChunks(e) {
            null !== e ? (null === this.#Rs && this.#Li(), this.#Ts.style.display = "unset", this.#vs(e)) : null !== this.#Rs && (this.#Ts.style.display = "none")
        }
        #vs(e) {
            const t = this.#Ai.getSandGame(),
                n = t.getChunkSize(),
                r = Math.ceil(t.getWidth() / n),
                i = Math.ceil(t.getHeight() / n);
            let s = 0;
            for (let t = 0; t < i; t++)
                for (let n = 0; n < r; n++) {
                    const i = t * r + n,
                        a = this.#Rs[i];
                    e[i] ? (s++, a.style.display = "initial") : a.style.display = "none"
                }
            const a = r * i,
                o = Math.trunc(s / a * 100);
            this.#Cs.textContent = `${s}/${a} (${o}%)`
        }
        #Li() {
            const e = this.#Ai.getSandGame(),
                t = e.getChunkSize(),
                n = Math.ceil(e.getWidth() / t),
                r = Math.ceil(e.getHeight() / t),
                i = Array(r * n);
            for (let e = 0; e < r; e++)
                for (let r = 0; r < n; r++) {
                    i[e * n + r] = this.#Is(r, e, t)
                }
            this.#Rs = i, this.#Ts.append(...i), this.#Cs = this.#Os(0, 0), this.#Ts.append(this.#Cs)
        }
        #Os(e, t) {
            const n = e / this.#ws,
                r = t / this.#ws;
            return pe.span("", {
                style: {
                    left: n + "px",
                    top: r + "px",
                    position: "absolute",
                    color: "rgb(0, 255, 0)"
                }
            })
        }
        #Is(e, t, n) {
            const r = this.#ys / this.#ws,
                i = this.#Ss / this.#ws,
                s = e * n / this.#ws,
                a = t * n / this.#ws,
                o = n / this.#ws,
                l = n / this.#ws,
                h = pe.div({
                    style: {
                        left: s + "px",
                        top: a + "px",
                        width: o + "px",
                        height: l + "px",
                        position: "absolute",
                        outline: "rgb(0, 255, 0) 1px solid"
                    }
                });
            if (s + o >= r || a + l >= i) {
                const e = -1,
                    t = e,
                    c = s + o >= r ? s + o - r : e,
                    d = a + n >= i ? a + l - i : e,
                    u = e;
                h.style.clipPath = `inset(${t}px ${c}px ${d}px ${u}px)`
            }
            return h
        }
        createNode(e) {
            return this.#Ts
        }
    }
    class Vn extends In {
        #Ai;
        #Ts;
        #ys;
        #Ss;
        #ws;
        constructor(e, t, n, r) {
            super(), this.#ys = e, this.#Ss = t, this.#ws = n;
            const i = e / n,
                s = t / n;
            this.#Ts = pe.div({
                style: {
                    display: "none",
                    position: "absolute",
                    left: "0",
                    top: "0",
                    width: `${i}px`,
                    height: `${s}px`
                },
                class: "sand-game-canvas-overlay",
                width: e + "px",
                height: t + "px"
            }), this.#Ai = r
        }
        register(e) {
            const t = e.getMarkers();
            if (t.length > 0) {
                for (const e of t) this.#Ts.append(this.#bs(e));
                this.#Ts.style.display = "initial"
            }
            e.addOnMarkerAdded((e => {
                this.#Ts.append(this.#bs(e)), this.#Ts.style.display = "initial"
            }))
        }
        #bs(e) {
            const t = e.getConfig(),
                [n, r, i, s] = e.getPosition(),
                a = this.#Is(n, r, i, s, t.label);
            if ("object" == typeof t.style)
                for (const [e, n] of Object.entries(t.style)) a.style[e] = n;
            return e.isVisible() || (a.style.display = "none"), e.addOnVisibleChanged((e => {
                a.style.display = e ? "initial" : "none"
            })), a
        }
        #Is(e, t, n, r, i = null) {
            const s = {
                class: "sand-game-marker",
                style: {
                    left: e / this.#ws + "px",
                    top: t / this.#ws + "px",
                    width: (n - e) / this.#ws + "px",
                    height: (r - t) / this.#ws + "px",
                    position: "absolute"
                }
            };
            return pe.div(s, i)
        }
        createNode(e) {
            return this.#Ts
        }
    }
    class Gn extends In {
        #Ai;
        #Ts;
        #Ms = null;
        constructor(e, t, n, r) {
            super();
            const i = e / n,
                s = t / n;
            this.#Ts = pe.div({
                style: {
                    position: "absolute",
                    left: "0",
                    top: "0",
                    width: `${i}px`,
                    height: `${s}px`
                },
                class: "sand-game-canvas-overlay",
                width: e + "px",
                height: t + "px"
            }), this.#Ai = r
        }
        createNode(e) {
            return this.#Ts
        }
        hideCursors() {
            this.#Ts.innerHTML = "", this.#Ms = null
        }
        repaintRectangleSelection(e, t, n, r, i) {
            this.#Ts.innerHTML = "";
            let s = Math.min(e, n) / i,
                a = Math.min(t, r) / i,
                o = Math.abs(n - e) / i,
                l = Math.abs(r - t) / i;
            const h = pe.div({
                style: {
                    left: s + "px",
                    top: a + "px",
                    width: o + "px",
                    height: l + "px",
                    position: "absolute",
                    outline: "black 1px solid",
                    pointerEvents: "none"
                }
            });
            this.#Ts.append(h)
        }
        repaintLineSelection(e, t, n, r, i) {
            this.#Ts.innerHTML = "";
            const s = this.#Ai.getCurrentWidthPoints(),
                a = this.#Ai.getCurrentHeightPoints(),
                o = pe.create(`\n            <svg viewBox="0 0 ${s} ${a}" xmlns="http://www.w3.org/2000/svg">\n              <line x1="${e}" y1="${t}" x2="${n}" y2="${r}" stroke="black" />\n            </svg>\n        `);
            o.style.pointerEvents = "none", this.#Ts.append(o)
        }
        showCursor(e, t, n, r) {
            if (r instanceof L) {
                {
                    const e = Math.trunc(r.getWidth() / n),
                        t = Math.trunc(r.getHeight() / n),
                        i = pe.element("canvas", {
                            width: r.getWidth() + "px",
                            height: r.getHeight() + "px",
                            style: {
                                width: `${e}px`,
                                height: `${t}px`,
                                outline: "black 1px solid"
                            }
                        });
                    i.style.imageRendering = "pixelated", Pe.renderPreview(r.getElementArea(), i.getContext("2d"), 187), this.#Ms = {
                        width: e,
                        height: t,
                        node: i
                    }
                }
                this.#Ms.node.style.position = "absolute", this.#Ms.node.style.pointerEvents = "none", this.moveCursor(e, t, n)
            }
        }
        hasCursor() {
            return null !== this.#Ms
        }
        moveCursor(e, t, n) {
            const r = this.#Ms,
                i = this.#Ai.getCurrentWidthPoints() / n,
                s = this.#Ai.getCurrentHeightPoints() / n,
                a = t / n - Math.trunc(r.height / 2),
                o = e / n - Math.trunc(r.width / 2),
                l = a < 0 ? -a : -1,
                h = o + r.width >= i ? o + r.width - i : -1,
                c = a + r.height >= s ? a + r.height - s : -1,
                d = o < 0 ? -o : -1;
            r.node.style.top = a + "px", r.node.style.left = o + "px", r.node.style.clipPath = `inset(${l}px ${h}px ${c}px ${d}px)`, this.#Ts.innerHTML = "", this.#Ts.append(r.node)
        }
    }
    class zn extends In {
        #Ai;
        #Ts;
        #ys;
        #Ss;
        #ws;
        constructor(e, t, n, r) {
            super(), this.#ys = e, this.#Ss = t, this.#ws = n;
            const i = e / n,
                s = t / n;
            this.#Ts = pe.div({
                style: {
                    display: "none",
                    position: "absolute",
                    left: "0",
                    top: "0",
                    width: `${i}px`,
                    height: `${s}px`,
                    pointerEvents: "none"
                },
                class: "sand-game-canvas-overlay",
                width: e + "px",
                height: t + "px"
            }), this.#Ai = r
        }
        register(e) {
            let t = !1;
            const n = e => {
                this.#Ts.append(e), t || (t = !0, this.#Ts.style.display = null)
            };
            for (const t of e.getSplashes()) n(this.#Ns(t));
            e.addOnSplashAdded((e => {
                n(this.#Ns(e))
            }));
            let r = null,
                i = 0;
            const s = e => {
                const t = this.#xs(e);
                null === r && (e.isVisible() && i++, r = this.#Ds(), r.style.display = i > 0 ? null : "none", n(r)), r.append(t), e.addOnVisibleChanged((e => {
                    i += e ? 1 : -1, r.style.display = i > 0 ? null : "none"
                }))
            };
            for (const t of e.getObjectives()) s(t);
            e.addOnObjectiveAdded((e => {
                s(e)
            }))
        }
        #Ns(e) {
            let t = e.getConfig(),
                n = {
                    class: "sand-game-splash",
                    style: {
                        display: e.isVisible() ? null : "none"
                    }
                };
            Object.assign(n.style, t.style);
            let r = pe.div(n, [pe.div({
                class: "sand-game-splash-content"
            }, t.content), pe.div({
                class: "sand-game-splash-footer"
            }, t.buttons.filter((e => null !== e)).map((t => {
                let n;
                if ("string" == typeof t.action) n = pe.element("a", {
                    href: t.action,
                    class: t.class
                }, t.title);
                else {
                    if ("function" != typeof t.action) throw "Button action type not supported: " + typeof t.action;
                    n = pe.button(t.title, {
                        class: t.class
                    }, (() => t.action(e)))
                }
                return t.focus && setTimeout((() => {
                    n.focus({
                        preventScroll: !0
                    })
                }), 0), n
            })))]);
            return e.addOnVisibleChanged((e => {
                r.style.display = e ? null : "none"
            })), r
        }
        #Ds() {
            return pe.div({
                class: "sand-game-objectives-list"
            }, null)
        }
        #xs(e) {
            const t = pe.span(null, {
                class: "sand-game-objective-icon"
            });
            e.isVisible() && pe.setContent(t, this.#Bs(e));
            const n = {
                    style: {
                        display: e.isVisible() ? null : "none"
                    }
                },
                r = pe.div(n, [t, e.getConfig().name]);
            return e.addOnVisibleChanged((n => {
                r.style.display = n ? null : "none", n && pe.setContent(t, this.#Bs(e))
            })), e.addOnActiveChanged((n => {
                e.isVisible() && pe.setContent(t, this.#Bs(e))
            })), e.addOnCompleted((() => {
                e.isVisible() && pe.setContent(t, this.#Bs(e))
            })), r
        }
        #Bs(e) {
            return e.isCompleted() ? pe.create('<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-check-square-fill" viewBox="0 0 16 16">\n    <path d="M2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2zm10.03 4.97a.75.75 0 0 1 .011 1.05l-3.992 4.99a.75.75 0 0 1-1.08.02L4.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093 3.473-4.425a.75.75 0 0 1 1.08-.022z"/>\n</svg>') : e.isActive() ? pe.create('<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-square" viewBox="0 0 16 16">\n    <path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2z"/>\n</svg>') : pe.create('<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-square-dotted" viewBox="0 0 16 16">\n    <path d="m2.5 0q-.25 0-.487.048l.194.98a1.5 1.5 0 01.293-.028h.458v-1zm2.292 0h-.917v1h.917zm1.833 0h-.917v1h.917zm1.833 0h-.916v1h.916zm1.834 0h-.917v1h.917zm1.833 0h-.917v1h.917zm1.375 0h-.458v1h.458q.151 0 .293.029l.194-.981a2.5 2.5 0 00-.487-.048m2.079 1.11a2.5 2.5 0 00-.69-.689l-.556.831q.248.167.415.415l.83-.556zm-14.469-.689a2.5 2.5 0 00-.689.69l.831.556c.11-.164.251-.305.415-.415zm14.89 2.079q0-.25-.048-.487l-.98.194q.027.141.028.293v.458h1zm-15.952-.487a2.5 2.5 0 00-.048.487v.458h1v-.458q0-.151.029-.293zm-.048 1.862v.917h1v-.917zm16 .917v-.917h-1v.917zm-16 .916v.917h1v-.917zm16 .917v-.917h-1v.917zm-16 .917v.916h1v-.916zm15 .916h1v-.916h-1zm-15 .917v.917h1v-.917zm16 .917v-.917h-1v.917zm-16 .916v.917h1v-.917zm16 .917v-.917h-1v.917zm-16 .917v.458q0 .25.048.487l.98-.194a1.5 1.5 0 01-.028-.293v-.458zm16 .458v-.458h-1v.458q0 .151-.029.293l.981.194q.048-.237.048-.487m-15.579 1.39c.183.272.417.506.69.689l.556-.831a1.5 1.5 0 01-.415-.415zm14.469.689c.272-.183.506-.417.689-.69l-.831-.556c-.11.164-.251.305-.415.415l.556.83zm-12.877.373q.237.048.487.048h.458v-1h-.458q-.151 0-.293-.029zm11.487.048q.25 0 .487-.048l-.194-.98a1.5 1.5 0 01-.293.028h-.458v1zm-9.625 0h.917v-1h-.917zm1.833 0h.917v-1h-.917zm1.834 0h.916v-1h-.916zm1.833 0h.917v-1h-.917zm1.833 0h.917v-1h-.917z"/>\n</svg>')
        }
        createNode(e) {
            return this.#Ts
        }
    }
    class Kn extends In {
        #Ai;
        #_s;
        #Hs;
        #Us;
        #Ps;
        #Fs;
        #Ls;
        #ks;
        #Ys;
        #Ws;
        constructor(e) {
            super(), this.#Ai = e;
            const t = this.#Ai.getCurrentWidthPoints(),
                n = this.#Ai.getCurrentHeightPoints(),
                r = this.#Ai.getCurrentScale();
            this.#_s = this.#Vs(t, n, r), this.#Hs = new Wn(t, n, r, e), this.#Us = this.#Hs.createNode(), this.#Ps = new Vn(t, n, r, e), this.#Fs = this.#Ps.createNode(), this.#Ls = new Gn(t, n, r, e), this.#ks = this.#Ls.createNode(), this.#Ys = new zn(t, n, r, e), this.#Ws = this.#Ys.createNode()
        }
        #Vs(e, t, n) {
            const r = e / n,
                i = t / n,
                s = pe.element("canvas", {
                    style: `position: relative; width: ${r}px; height: ${i}px;`,
                    class: "sand-game-canvas",
                    width: e + "px",
                    height: t + "px"
                });
            return s.style.imageRendering = this.#Ai.getCanvasImageRenderingStyle(), s
        }
        createNode(e) {
            return pe.div({
                style: "position: relative;",
                class: "sand-game-canvas-component"
            }, [this.#_s, this.#Us, this.#Fs, this.#ks, this.#Ws])
        }
        register(e) {
            this.#Ps.register(e.overlay()), this.#Ys.register(e.scenario()), e.addOnRendered((e => {
                this.#Ai.isShowActiveChunks() ? this.#Hs.highlightChunks(e) : this.#Hs.highlightChunks(null)
            })), this.#Gs(e)
        }
        #Gs(e) {
            const t = this.#ks,
                n = this.#Ai.getCurrentScale(),
                r = this.#Ai.getToolManager();
            let i, s, a = e => {
                    const r = t.getBoundingClientRect();
                    return [Math.max(0, Math.trunc((e.clientX - r.left) * n)), Math.max(0, Math.trunc((e.clientY - r.top) * n))]
                },
                o = null,
                l = !1,
                h = !1,
                c = !1,
                d = null;
            const u = (t, n, r) => {
                    o.isRepeatingEnabled() && (d = setInterval((() => {
                        o.applyPoint(t, n, e.graphics(), r)
                    }), 80))
                },
                m = () => {
                    null !== d && (clearInterval(d), d = null)
                };
            this.#ks.addEventListener("contextmenu", (e => (e.preventDefault(), !1))), t.addEventListener("mousedown", (t => {
                if (r.isInputDisabled()) return;
                const [d, E] = a(t);
                if (i = d, s = E, o = null, l = !1, h = !1, c = !1, 1 === t.buttons) o = r.getPrimaryTool(), ge.triggerFeatureUsed(ge.FEATURE_DRAW_PRIMARY);
                else {
                    if (2 !== t.buttons) {
                        if (4 === t.buttons) {
                            if (t.preventDefault(), t.altKey || t.ctrlKey || t.shiftKey) t.altKey && t.ctrlKey && t.shiftKey && console.log(d + "x" + E + ": " + e.debugElementAt(d, E));
                            else {
                                const t = r.getTertiaryTool();
                                t.applyPoint(d, E, e.graphics(), !1), ge.triggerFeatureUsed(ge.FEATURE_DRAW_TERTIARY), ge.triggerToolUsed(t)
                            }
                            return
                        }
                        return
                    } {
                        let n = r.getPrimaryTool();
                        if (n.isSecondaryActionEnabled()) return n.applySecondaryAction(d, E, e.graphics(), t.altKey), this.#Ls.hideCursors(), void m();
                        o = r.getSecondaryTool(), ge.triggerFeatureUsed(ge.FEATURE_DRAW_SECONDARY)
                    }
                }
                if (t.ctrlKey || t.shiftKey) t.ctrlKey && t.shiftKey ? (o.applySpecial(d, E, e.graphics(), t.altKey), ge.triggerFeatureUsed(ge.FEATURE_DRAW_FLOOD), ge.triggerToolUsed(o), o = null) : (t.ctrlKey && o.isAreaModeEnabled() && (h = t.ctrlKey), t.shiftKey && o.isLineModeEnabled() && (c = t.shiftKey));
                else {
                    o.applyPoint(d, E, e.graphics(), t.altKey), ge.triggerToolUsed(o), u(d, E, t.altKey), this.#Ls.hideCursors();
                    const i = r.getPrimaryTool().createCursor();
                    null !== i && this.#Ls.showCursor(d, E, n, i)
                }
            })), t.addEventListener("mousemove", (t => {
                if (m(), r.isInputDisabled()) return o = null, void this.#Ls.hideCursors();
                if (!h && !c) {
                    if (this.#Ls.hasCursor()) {
                        const [e, r] = a(t);
                        this.#Ls.moveCursor(e, r, n)
                    } else {
                        const e = r.getPrimaryTool().createCursor();
                        if (null !== e) {
                            const [r, i] = a(t);
                            this.#Ls.showCursor(r, i, n, e)
                        }
                    }
                    if (null === o) return;
                    const [h, c] = a(t);
                    return l || (o.onDragStart(i, s, e.graphics(), t.altKey), l = !0), o.applyStroke(i, s, h, c, e.graphics(), t.altKey), ge.triggerToolUsed(o), u(h, c, t.altKey), i = h, void(s = c)
                }
                if (!(null === o || h && c))
                    if (h) {
                        const [e, r] = a(t);
                        this.#Ls.repaintRectangleSelection(i, s, e, r, n)
                    } else if (c) {
                    const [e, r] = a(t);
                    this.#Ls.repaintLineSelection(i, s, e, r, n)
                } else;
            })), t.addEventListener("mouseup", (t => {
                if (m(), !r.isInputDisabled() && null !== o) {
                    if (l) o.onDragEnd(i, s, e.graphics(), t.altKey), l = !1, o.hasCursor() || this.#Ls.hideCursors();
                    else if (h) {
                        const [n, r] = a(t);
                        let l = Math.min(i, n),
                            h = Math.min(s, r),
                            c = Math.max(i, n),
                            d = Math.max(s, r);
                        o.applyArea(l, h, c, d, e.graphics(), t.altKey), this.#Ls.hideCursors(), ge.triggerFeatureUsed(ge.FEATURE_DRAW_RECT), ge.triggerToolUsed(o)
                    } else if (c) {
                        const [n, r] = a(t);
                        o.applyStroke(i, s, n, r, e.graphics(), t.altKey), this.#Ls.hideCursors(), ge.triggerFeatureUsed(ge.FEATURE_DRAW_LINE), ge.triggerToolUsed(o)
                    }
                    o = null, h = !1, c = !1
                }
            })), t.addEventListener("mouseout", (e => {
                m(), this.#Ls.hideCursors()
            })), t.addEventListener("mouseenter", (e => {
                null !== o && 0 === e.buttons && (o = null, this.#Ls.hideCursors(), e.preventDefault())
            }));
            let E = e => {
                let t = e.touches[0];
                return a(t)
            };
            t.addEventListener("touchstart", (t => {
                if (r.isInputDisabled()) return;
                const [n, a] = E(t);
                i = n, s = a, o = r.getPrimaryTool(), o.applyPoint(n, a, e.graphics(), !1), ge.triggerFeatureUsed(ge.FEATURE_DRAW_PRIMARY), ge.triggerToolUsed(o), t.preventDefault()
            })), t.addEventListener("touchmove", (t => {
                if (r.isInputDisabled()) return void(o = null);
                if (null === o) return;
                const [n, a] = E(t);
                o.applyStroke(i, s, n, a, e.graphics(), !1), ge.triggerToolUsed(o), i = n, s = a, t.preventDefault()
            })), t.addEventListener("touchend", (e => {
                o = null, e.preventDefault()
            }))
        }
        getCanvasNode() {
            return this.#_s
        }
        setImageRenderingStyle(e) {
            this.#_s.style.imageRendering = e
        }
        onInputDisabledChanged(e) {
            this.#ks.style.cursor = e ? "not-allowed" : null
        }
    }
    class Xn extends In {
        #zs = pe.div({
            class: "sand-game-canvas-holder"
        });
        #Ks = null;
        createNode(e) {
            return e.registerCanvasProvider({
                initialize: () => (this.#zs.innerHTML = "", this.#Ks = new Kn(e), this.#zs.append(this.#Ks.createNode(e)), this.#Ks.getCanvasNode()),
                getCanvasNode: () => null !== this.#Ks ? this.#Ks.getCanvasNode() : null
            }), e.addOnImageRenderingStyleChanged((e => {
                null !== this.#Ks && this.#Ks.setImageRenderingStyle(e)
            })), e.addOnInitialized((e => {
                if (null === this.#Ks) throw "Illegal state: canvas is not initialized";
                this.#Ks.register(e)
            })), e.addOnBeforeClosed((() => {
                this.#Ks = null, this.#zs.innerHTML = ""
            })), e.getToolManager().addOnInputDisabledChanged((e => {
                null !== this.#Ks && this.#Ks.onInputDisabledChanged(e)
            })), this.#zs
        }
    }
    class qn extends Pn {
        performAction(e) {
            let t = pe.bootstrapSimpleFormBuilder();
            t.addInput("Width", "width", "" + e.getCurrentWidthPoints()), t.addInput("Height", "height", "" + e.getCurrentHeightPoints()), t.addInput("Scale", "scale", "" + e.getCurrentScale());
            let n = pe.bootstrapDialogBuilder();
            n.setHeaderContent("Change canvas size manually"), n.setBodyContent(t.createNode()), n.addSubmitButton("Submit", (() => {
                let n = t.getData(),
                    r = Number.parseInt(n.width),
                    i = Number.parseInt(n.height),
                    s = Number.parseFloat(n.scale);
                e.changeCanvasSize(r, i, s), ge.triggerFeatureUsed(ge.FEATURE_CANVAS_SIZE_CHANGE)
            })), n.addCloseButton("Close"), n.show(e.getDialogAnchor())
        }
    }
    class Jn extends In {
        static CLASS_SELECTED = "selected-size";
        static SIZES = [{
            scale: .75,
            image: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHgAAABQCAYAAADSm7GJAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACHUlEQVR4Xu3WQW6EMBBEUSJx3jkMF55s4ogQG2zTxeDi/10ijdxTb5HME1k3b39BXgFsHsDmAWwewOYBbB7A5gFsHsDmAWwewOYBbB7A5gFsHsDmAWwewOYBbB7A5gFsHsCrlmV5r39+vV5f659HDOCftrjpd6MjAzzlcVOjIz8eeA83NTLyo4FrcFOjIj8WuAU3NSLyI4F7cFOjIT8O+AxuaiTkRwFH4KZGQX4McCRuagTkjwGvB1ePpMBN3R35I8DbwZUjbd9SpLz/bJcDlwZXjFR6S5Hi/oguBT4aPHKko7cURd4f1WXAtYNHjFT7lqKI+yO7BLh18DMjtb6l6Mz90cmBewfvGan3LUU99yuSAp8dvGWks28parlflQw4avCakaLeUlRzvzIJcPTgeyNFv6Vo73514cCqwXMjqd5SlLu/1Pp71X6mVCiwevD1SOq3FNUgb79XzWf2CgPeHqbqqndU7YGVvtveZ44KAS4dRvlyYEcb5j5T02ngo8MoX8+fmx7kU8C1h1G+nv1akbuBe46jmFqQu4DB/Xy1yM3A4N6nGuQmYHDv1xFyNTC4920PuQoY3PtXQj4EBneccsi7wOCO1xa5CAzuuK2Rs8Dgjl9C/gcMrk/Lsrz/AIPr1y8wuJ7N0wSuczO43v37J4u8Atg8gM0D2DyAzQPYPIDNA9g8gM0D2DyAzQPYPIDNA9g8gM0D2DyAzQPYvG9K/XJS29iPWwAAAABJRU5ErkJggg==",
            description: "Very small elements"
        }, {
            scale: .5,
            image: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHgAAABQCAYAAADSm7GJAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABSElEQVR4Xu3WQQ6EIBAFUUw8L4fxwjN78xedQBDLeksiYbAysc8mtPO+IBYDwxkYzsBwBoYzMJyB4QwMZ2A4A8MZGM7AcAaGMzCcgeEMDGdgOAPDGRjOwK2167p+97Wk937c13ZnYDgDwxkYzsBwnwtcHaiStHf3wetzgb/GwHAGhjMw3JLAaThJZg8s1XNHpDNm32PEksB6joHhDAxnYLjpgdPQUZX2VgeWtPcp6bdU7zHb9MDai4HhDAxnYLihwGmYmG3FGSuke6TBq/pc1VBg7c/AcAaGMzBcOXD6+GtM9Z2m56qDVzmw3snAcAaGMzBcDJw+6tpLapQGrxhYHAaGMzCcgeHO9LHWO6WW/oPhDAxnYDgDwxkYzsBwBoYzMJyB4QwMZ2A4A8MZGM7AcAaGMzCcgeEMDGdgOAPDGRjOwHAGhjMw3B/1T0cI5HMokgAAAABJRU5ErkJggg==",
            description: "Small elements"
        }, {
            scale: .375,
            image: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHgAAABQCAYAAADSm7GJAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABGklEQVR4Xu3YMU7EMBQAUZBy3hwmF4Y+BforGcNO3itdOFZGLvyPD9KO+wItAscJHCdwnMBxAscJHCdwnMBxAscJHCdwnMBxAscJHCdwnMBxjw58XdfXfe3uPM/P+9o7eXTgJxA4TuA4geMEjhM4TuA4geO2Bt45WJh8a2Kyz6oz/4atgdlP4DiB4wSOEzhO4DiB4wSOWxZ4MhCYWLXPTpMz/9UwZFlg/ieB4wSOEzhO4DiB4wSOEzhuFHjykOdnq/7hqwOTUWDel8BxAscJHCdwnMBxAscJHHeseoCzx6u93OA4geMEjhM4TuA4geMEjhM4TuA4geMEjhM4TuA4geMEjhM4TuA4geMEjhM4TuA4geMEjhM4TuC4b6YQJX8pLssnAAAAAElFTkSuQmCC",
            description: "Medium elements"
        }, {
            scale: .25,
            image: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHgAAABQCAYAAADSm7GJAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA+ElEQVR4Xu3ZsQ3DMAwAwRjwvBpGCye9KgMq7LzvSnbiQxXPD2nnOqBF4DiB4wSOEzhO4DiB4wSOEzhO4DiB4wSOEzhO4LjXBZ5zftfZVWOMY5093esCv43AcQLHCRwncJzAcQLHCRwncJzAcQLHCRwncJzAcVuBd05v/2jnvXedGrcC83wCxwkcJ3CcwHECxwkcJ3CcwHECxwkcJ3CcwHECx507JzCuu2vPfnCcwHECxwkcJ3CcwHECxwkcJ3CcwHECxwkcJ3CcwHECxwkcJ3CcwHECxwkcJ3CcwHECxwkcJ3CcwHECxwkcJ3CcwHECxwkcJ3CcwHE/D68RYAgtpF0AAAAASUVORK5CYII=",
            description: "Big elements"
        }];
        #Xs = [];
        #qs = null;
        #Js = null;
        createNode(e) {
            for (let t of Jn.SIZES) {
                let n = this.#js(t.scale, t.image, t.description);
                t.scale === e.getCurrentScale() && this.#Zs(n, t.scale), n.addEventListener("click", (r => {
                    this.#Qs(n, t.scale, e)
                })), this.#Xs.push(n)
            }
            return pe.div(null, [pe.par(null, "Increasing the size of the elements will result in the top and right parts of the canvas being clipped."), pe.par(null, "Reducing the size of the elements will result in an expansion of the canvas in the upper and right parts."), pe.par(null, "Only the scale of the current scene and the initial setting for new scenes will be changed. Scene can be regenerated by clicking on the scene card."), pe.div({
                class: "element-size-options"
            }, this.#Xs)])
        }
        #Qs(e, t, n) {
            if (this.#Js === t) return;
            this.#qs && this.#qs.classList.remove(Jn.CLASS_SELECTED), this.#Zs(e, t);
            let r = Math.trunc(n.getCurrentWidthPoints() / n.getCurrentScale() * t),
                i = Math.trunc(n.getCurrentHeightPoints() / n.getCurrentScale() * t);
            n.changeCanvasSize(r, i, t), ge.triggerFeatureUsed(ge.FEATURE_SWITCH_SCALE)
        }
        #Zs(e, t) {
            e.classList.add(Jn.CLASS_SELECTED), this.#qs = e, this.#Js = t
        }
        #js(e, t, n) {
            return pe.div({
                class: "card"
            }, [pe.element("img", {
                src: t,
                alt: n
            })])
        }
    }
    class jn extends Pn {
        performAction(e) {
            let t = new Jn,
                n = pe.bootstrapDialogBuilder();
            n.setHeaderContent("Adjust Scale"), n.setBodyContent(pe.div({
                class: "sand-game-component"
            }, [t.createNode(e)])), n.addSubmitButton("Set size manually", (() => {
                (new qn).performAction(e)
            })), n.addCloseButton("Close"), n.show(e.getDialogAnchor())
        }
    }
    class Zn extends In {
        createNode(e) {
            return pe.button(pe.create('\x3c!-- @author Patrik Harag --\x3e\n<svg width="64" height="64" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg">\n <g>\n  <rect stroke="#505050" stroke-width="4" id="svg_1" height="24" width="24" y="35.5" x="4.5" fill="none"/>\n  <rect stroke="#505050" stroke-width="2" stroke-dasharray="3,5" id="svg_2" height="54" width="54" y="4.5" x="4.5" fill="none"/>\n  <line stroke="#505050" id="svg_3" y2="10.65089" x2="51.9999" y1="27.9524" x1="34.38094" stroke-width="4" fill="none"/>\n  <line stroke="#505050" id="svg_4" y2="11.28581" x2="50.73007" y1="13.98421" x1="37.87298" stroke-width="4" fill="none"/>\n  <line stroke="#505050" id="svg_5" y2="11.762" x2="51.36499" y1="23.82543" x1="48.82531" stroke-width="4" fill="none"/>\n </g>\n</svg>'), {
                class: "btn btn-outline-secondary adjust-scale",
                "aria-label": "Adjust scale"
            }, (() => {
                (new jn).performAction(e)
            }))
        }
    }
    class Qn extends In {
        static CLASS_SELECTED = "selected-scene";
        static CLASS_VISITED = "visited-scene";
        #Ai;
        #$s = !1;
        #J;
        #ea;
        #qs = null;
        #ta = null;
        #na = new Map;
        constructor(e, t, n) {
            super(), this.#Ai = e, this.#J = t, this.#ea = n, this.#Ai.addOnBeforeNewSceneLoaded((() => {
                this.#$s || (this.#ra(), this.#ia())
            }))
        }
        createNode(e) {
            let t = pe.div({
                class: "scenes"
            }, []);
            for (const [e, n] of Object.entries(this.#J)) {
                let r = pe.element("span", {
                        class: "scene-title"
                    }, n.name),
                    i = pe.button(r, {
                        class: "btn btn-outline-secondary scene"
                    }, (() => {
                        this.#sa(e, i, n)
                    }));
                e === this.#ea && (this.#qs = i, this.#ta = e, i.classList.add(Qn.CLASS_SELECTED), i.classList.add(Qn.CLASS_VISITED)), t.append(i)
            }
            return t
        }
        #sa(e, t, n) {
            this.#qs ? this.#ta === e ? this.#aa((() => {
                this.#Qs(t, e, n), ge.triggerFeatureUsed(ge.FEATURE_RESTART_SCENE)
            })) : (this.#ra(), this.#Qs(t, e, n), ge.triggerFeatureUsed(ge.FEATURE_SWITCH_SCENE)) : (this.#Qs(t, e, n), ge.triggerFeatureUsed(ge.FEATURE_SWITCH_SCENE))
        }
        #aa(e) {
            let t = pe.bootstrapDialogBuilder();
            t.setHeaderContent("Restart scene"), t.setBodyContent([pe.par(null, "Do you want to restart the scene?")]), t.addSubmitButton("Confirm", e), t.addCloseButton("Close"), t.show(this.#Ai.getDialogAnchor())
        }
        #Qs(e, t, n) {
            this.#ia(), this.#qs = e, this.#ta = t, e.classList.add(Qn.CLASS_SELECTED), e.classList.add(Qn.CLASS_VISITED);
            let r = this.#na.get(t);
            r ? (this.#na.delete(t), this.#$s = !0, this.#Ai.openScene(new ct(r)), this.#$s = !1) : (this.#$s = !0, this.#Ai.openScene(n), this.#$s = !1)
        }
        #ia() {
            this.#qs && this.#qs.classList.remove(Qn.CLASS_SELECTED), this.#qs = null, this.#ta = null
        }
        #ra() {
            this.#qs && this.#na.set(this.#ta, this.#Ai.createSnapshot())
        }
    }
    class $n {
        static ALL_MATERIALS = function(e) {
            let t = e.getSandGame();
            if (null === t) return;
            const n = ["ash", "sand", "soil", "gravel", "wall", "rock", "metal", "wood", "water"];
            let r = Math.ceil(t.getWidth() / n.length);
            for (let e = 0; e < n.length; e++) {
                const i = ie.byCodeName(n[e]);
                t.graphics().drawRectangle(e * r, 0, (e + 1) * r, -1, i, !0)
            }
        };
        static TREE_SPAWN_TEST = function(e) {
            let t = e.getSandGame();
            null !== t && (t.graphics().fill(ie.AIR), t.layeredTemplate().layer(Math.trunc(t.getHeight() / 2), !1, ie.AIR).layer(1, !0, ie.WALL).layer(10, !0, ie.SOIL).grass(), t.layeredTemplate().layer(1, !0, ie.WALL).layer(10, !0, ie.SOIL).grass())
        };
        static treeGrowTest(e = -1) {
            return function(t) {
                let n = t.getSandGame();
                if (null === n) return;
                n.graphics().fill(ie.AIR);
                let r = ne.TREE_TRUNK_TEMPLATES.length,
                    i = Math.trunc(n.getWidth() / 8);
                const s = n.layeredTemplate();
                s.layer(Math.trunc(n.getHeight() / 2), !1, ie.AIR), s.layer(1, !0, ie.WALL), s.layer(10, !0, ie.SOIL);
                for (let t = 0; t < 8; t++) s.tree(Math.trunc((t + .5) * i), t % r, e);
                s.grass();
                const a = n.layeredTemplate();
                a.layer(1, !0, ie.WALL), a.layer(10, !0, ie.SOIL);
                for (let t = 0; t < 8; t++) a.tree(Math.trunc((t + .5) * i), (t + 8) % r, e);
                a.grass()
            }
        }
    }
    var er = {};
    ! function(e, t) {
        ! function() {
            function t(e, t) {
                return void 0 === t ? t = {
                    autoBom: !1
                } : "object" != typeof t && (console.warn("Deprecated: Expected third argument to be a object"), t = {
                    autoBom: !t
                }), t.autoBom && /^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type) ? new Blob(["\ufeff", e], {
                    type: e.type
                }) : e
            }

            function n(e, t, n) {
                var r = new XMLHttpRequest;
                r.open("GET", e), r.responseType = "blob", r.onload = function() {
                    o(r.response, t, n)
                }, r.onerror = function() {
                    console.error("could not download file")
                }, r.send()
            }

            function r(e) {
                var t = new XMLHttpRequest;
                t.open("HEAD", e, !1);
                try {
                    t.send()
                } catch (e) {}
                return 200 <= t.status && 299 >= t.status
            }

            function i(e) {
                try {
                    e.dispatchEvent(new MouseEvent("click"))
                } catch (n) {
                    var t = document.createEvent("MouseEvents");
                    t.initMouseEvent("click", !0, !0, window, 0, 0, 0, 80, 20, !1, !1, !1, !1, 0, null), e.dispatchEvent(t)
                }
            }
            var s = "object" == typeof window && window.window === window ? window : "object" == typeof self && self.self === self ? self : "object" == typeof rt && rt.global === rt ? rt : void 0,
                a = s.navigator && /Macintosh/.test(navigator.userAgent) && /AppleWebKit/.test(navigator.userAgent) && !/Safari/.test(navigator.userAgent),
                o = s.saveAs || ("object" != typeof window || window !== s ? function() {} : "download" in HTMLAnchorElement.prototype && !a ? function(e, t, a) {
                    var o = s.URL || s.webkitURL,
                        l = document.createElement("a");
                    t = t || e.name || "download", l.download = t, l.rel = "noopener", "string" == typeof e ? (l.href = e, l.origin === location.origin ? i(l) : r(l.href) ? n(e, t, a) : i(l, l.target = "_blank")) : (l.href = o.createObjectURL(e), setTimeout((function() {
                        o.revokeObjectURL(l.href)
                    }), 4e4), setTimeout((function() {
                        i(l)
                    }), 0))
                } : "msSaveOrOpenBlob" in navigator ? function(e, s, a) {
                    if (s = s || e.name || "download", "string" != typeof e) navigator.msSaveOrOpenBlob(t(e, a), s);
                    else if (r(e)) n(e, s, a);
                    else {
                        var o = document.createElement("a");
                        o.href = e, o.target = "_blank", setTimeout((function() {
                            i(o)
                        }))
                    }
                } : function(e, t, r, i) {
                    if ((i = i || open("", "_blank")) && (i.document.title = i.document.body.innerText = "downloading..."), "string" == typeof e) return n(e, t, r);
                    var o = "application/octet-stream" === e.type,
                        l = /constructor/i.test(s.HTMLElement) || s.safari,
                        h = /CriOS\/[\d]+/.test(navigator.userAgent);
                    if ((h || o && l || a) && "undefined" != typeof FileReader) {
                        var c = new FileReader;
                        c.onloadend = function() {
                            var e = c.result;
                            e = h ? e : e.replace(/^data:[^;]*;/, "data:attachment/file;"), i ? i.location.href = e : location = e, i = null
                        }, c.readAsDataURL(e)
                    } else {
                        var d = s.URL || s.webkitURL,
                            u = d.createObjectURL(e);
                        i ? i.location = u : location.href = u, i = null, setTimeout((function() {
                            d.revokeObjectURL(u)
                        }), 4e4)
                    }
                });
            s.saveAs = o.saveAs = o, e.exports = o
        }()
    }({
        get exports() {
            return er
        },
        set exports(e) {
            er = e
        }
    });
    var tr = er;
    class nr extends Pn {
        performAction(e) {
            new rr(e, (t => {
                let n = pe.bootstrapDialogBuilder();
                n.setHeaderContent("Benchmark results"), n.setBodyContent([pe.par(null, "IPS AVG: " + t.ipsAvg.toFixed(2)), pe.par(null, "IPS MIN: " + t.ipsMin)]), n.addCloseButton("Close"), n.addButton(pe.button("Download results", {
                    type: "button",
                    class: "btn btn-primary"
                }, (e => {
                    const n = JSON.stringify(t, null, "  "),
                        r = new Blob([n], {
                            type: "application/json;charset=utf-8"
                        }),
                        i = this.#oa(new Date);
                    tr.saveAs(r, `${i}.benchmark.json`)
                }))), n.show(e.getDialogAnchor())
            })).start()
        }
        #oa(e) {
            let t = String(e.getDate()).padStart(2, "0"),
                n = String(e.getMonth() + 1).padStart(2, "0");
            return `${e.getFullYear()}-${n}-${t}_${String(e.getHours()).padStart(2,"0")}-${String(e.getMinutes()).padStart(2,"0")}`
        }
    }
    class rr {
        static WAITING_GAP = 300;
        #Ai;
        #la;
        constructor(e, t) {
            this.#Ai = e, this.#la = t
        }
        start() {
            let e = new Bn({
                apply: e => this.#ha(e)
            });
            this.#Ai.openScene(e), this.#Ai.start()
        }
        #ha(e) {
            const t = [],
                n = [...rr.BENCHMARKS];
            let r = 0,
                i = rr.WAITING_GAP,
                s = 0,
                a = Number.MAX_SAFE_INTEGER;
            e.addOnProcessed((() => {
                if (i > 0) return void i--;
                if (0 === n.length) return;
                const o = n[0];
                0 === r && console.log("Running benchmark: " + o.name), o.nextIteration(e, r), r++;
                const l = e.getIterationsPerSecond();
                if (s += l, a = Math.min(a, l), o.iterations === r) {
                    const l = s / o.iterations;
                    t.push({
                        name: o.name,
                        ipsAvg: l,
                        ipsMin: a
                    }), n.shift(), r = 0, s = 0, a = Number.MAX_SAFE_INTEGER, i = rr.WAITING_GAP, e.graphics().fill(ie.AIR), 0 === n.length && this.#la(this.#ca(e, t))
                }
            }))
        }
        #ca(e, t) {
            const n = t.map((e => e.ipsAvg)).reduce(((e, t) => e + t), 0) / t.length,
                r = t.map((e => e.ipsMin)).reduce(((e, t) => Math.min(e, t)), Number.MAX_SAFE_INTEGER);
            return {
                version: 1,
                date: (new Date).toString(),
                ipsAvg: n,
                ipsMin: r,
                benchmarks: t,
                scene: {
                    width: e.getWidth(),
                    height: e.getHeight()
                }
            }
        }
        static #da(e, t, n) {
            if (t <= 0) throw "Number of iterations must be a positive number";
            return {
                name: e,
                iterations: t,
                nextIteration: n
            }
        }
        static BENCHMARKS = [rr.#da("sand-fall-q", 500, (function(e, t) {
            e.graphics().drawRectangle(0, 0, -1, 1, ie.SAND, !0)
        })), rr.#da("sand-fall-s", 2e3, (function(e, t) {
            t % 10 == 0 && e.graphics().drawRectangle(0, 0, -1, 1, ie.SAND, !0)
        })), rr.#da("sand-fill", 1e3, (function(e, t) {
            0 === t && e.graphics().drawRectangle(0, 0, -1, -1, ie.SAND, !0)
        })), rr.#da("soil-fall-q", 500, (function(e, t) {
            e.graphics().drawRectangle(0, 0, -1, 1, ie.SOIL, !0)
        })), rr.#da("soil-fall-s", 2e3, (function(e, t) {
            t % 10 == 0 && e.graphics().drawRectangle(0, 0, -1, 1, ie.SOIL, !0)
        })), rr.#da("soil-fill", 1e3, (function(e, t) {
            0 === t && e.graphics().drawRectangle(0, 0, -1, -1, ie.SOIL, !0)
        })), rr.#da("water-fall-q", 500, (function(e, t) {
            e.graphics().drawRectangle(0, 0, -1, 1, ie.WATER, !0)
        })), rr.#da("water-fall-s", 2e3, (function(e, t) {
            t % 10 == 0 && e.graphics().drawRectangle(0, 0, -1, 1, ie.WATER, !0)
        })), rr.#da("water-fill", 1e3, (function(e, t) {
            0 === t && e.graphics().drawRectangle(0, 0, -1, -1, ie.WATER, !0)
        })), rr.#da("sand-into-water", 1e3, (function(e, t) {
            0 === t && (e.graphics().drawRectangle(0, 0, -1, 31, ie.SAND, !0), e.graphics().drawRectangle(0, 60, -1, -1, ie.WATER, !0))
        })), rr.#da("soil-into-water", 1e3, (function(e, t) {
            0 === t && (e.graphics().drawRectangle(0, 0, -1, 31, ie.SOIL, !0), e.graphics().drawRectangle(0, 60, -1, -1, ie.WATER, !0))
        }))]
    }
    class ir extends In {
        static CLASS_PRIMARY = "btn-primary";
        static CLASS_SECONDARY = "btn-secondary";
        static CLASS_INFO = "btn-info";
        static CLASS_SUCCESS = "btn-success";
        static CLASS_WARNING = "btn-warning";
        static CLASS_LIGHT = "btn-light";
        static CLASS_OUTLINE_PRIMARY = "btn-outline-primary";
        static CLASS_OUTLINE_SECONDARY = "btn-outline-secondary";
        static CLASS_OUTLINE_INFO = "btn-outline-info";
        static CLASS_OUTLINE_SUCCESS = "btn-outline-success";
        static CLASS_OUTLINE_WARNING = "btn-outline-warning";
        static CLASS_OUTLINE_LIGHT = "btn-outline-light";
        #ua;
        #ma;
        #Ea;
        constructor(e, t, n) {
            super(), this.#ua = e, this.#ma = "function" == typeof n ? Pn.create(n) : n, this.#Ea = null == t ? ir.CLASS_PRIMARY : t
        }
        createNode(e) {
            return pe.button(this.#ua, {
                class: "btn " + this.#Ea
            }, (t => {
                this.#ma.performAction(e)
            }))
        }
    }
    class sr extends Pn {
        performAction(e) {
            const t = e.getCanvas();
            null !== t && t.toBlob((e => {
                tr.saveAs(e, this.#oa(new Date) + ".png")
            }))
        }
        #oa(e) {
            let t = String(e.getDate()).padStart(2, "0"),
                n = String(e.getMonth() + 1).padStart(2, "0");
            return `${e.getFullYear()}-${n}-${t}_${String(e.getHours()).padStart(2,"0")}-${String(e.getMinutes()).padStart(2,"0")}`
        }
    }
    class ar extends Pn {
        #ga = !1;
        #pa = !1;
        #Aa = null;
        performAction(e) {
            if (this.#ga || (e.addOnBeforeClosed((() => {
                    null !== this.#Aa && this.#fa()
                })), e.addOnInitialized((e => {
                    this.#pa = !1
                })), this.#ga = !0), null === this.#Aa) {
                if (this.#Aa = {}, !this.#pa) {
                    let t = !1,
                        n = 0,
                        r = !1;
                    e.getSandGame().addOnProcessed((e => {
                        t = !0, n = e
                    })), e.getSandGame().addOnRendered((() => {
                        null !== this.#Aa && t && !r && (r = !0, this.#Ta(e, n, (() => r = !1)), t = !1)
                    })), this.#pa = !0
                }
            } else this.#fa()
        }
        #Ta(e, t, n) {
            const r = e.getCanvas();
            null !== r && r.toBlob((e => {
                e.arrayBuffer().then((e => {
                    const n = new Uint8Array(e);
                    null !== this.#Aa && (this.#Aa[`iteration_${String(t).padStart(6,"0")}.png`] = n)
                })).finally((() => {
                    n()
                }))
            }))
        }
        #fa() {
            this.#Ca(this.#Aa, "frames.zip"), this.#Aa = null
        }
        #Ca(e, t) {
            const n = Tn(e, {
                level: 0
            });
            tr.saveAs(new Blob([n]), t)
        }
    }
    class or extends Pn {
        performAction(e) {
            const t = e.getSandGame();
            if (null === t) return;
            const n = e.getToolManager().getPrimaryTool();
            n.isAreaModeEnabled() && n.applyArea(0, 0, t.getWidth(), t.getHeight(), t.graphics(), !1)
        }
    }
    class lr extends In {
        static #Ra = ir.CLASS_OUTLINE_SECONDARY;
        static #ya = ir.CLASS_OUTLINE_INFO;
        static #Sa = ir.CLASS_OUTLINE_PRIMARY;
        static #wa = ir.CLASS_OUTLINE_SUCCESS;
        static COMPONENTS = [new ir("All materials", lr.#Ra, $n.ALL_MATERIALS), new ir("Tree spawn", lr.#Ra, $n.TREE_SPAWN_TEST), new ir("Tree grow", lr.#Ra, $n.treeGrowTest(0)), new ir("Tree grown", lr.#Ra, $n.treeGrowTest(-1)), new ir("Fill", lr.#Ra, new or), new ir("Benchmark", lr.#Sa, new nr), new ir("Screenshot", lr.#Sa, new sr), new ir("Record (start/stop)", lr.#Sa, new ar), new ir("Chunks", lr.#ya, Pn.createToggle(!1, ((e, t) => e.setShowActiveChunks(t)))), new ir("M/webgl", lr.#ya, Pn.create((e => e.setRendererInitializer(Ve.canvasWebGL())))), new ir("M/classic", lr.#ya, Pn.create((e => e.setRendererInitializer(Ve.canvas2d())))), new ir("M/heatmap", lr.#ya, Pn.create((e => e.setRendererInitializer(Ve.canvas2dHeatmap())))), new ir("M/type", lr.#ya, Pn.create((e => e.setRendererInitializer(Ve.canvas2dElementType())))), new ir("M/null", lr.#ya, Pn.create((e => e.setRendererInitializer(Ve.nullRenderer())))), new ir("Pixelated", lr.#ya, Pn.createToggle(!0, ((e, t) => e.setCanvasImageRenderingStyle(t ? "pixelated" : "auto"))))];
        createNode(e) {
            let t = pe.div({
                    class: "test-tools"
                }, []),
                n = [...lr.COMPONENTS];
            for (let e of Ee.TEST_TOOLS) {
                let t = Pn.create((t => t.getToolManager().setPrimaryTool(e)));
                n.push(new ir(e.getInfo().getDisplayName(), lr.#wa, t))
            }
            for (let r of n) t.append(r.createNode(e));
            return t
        }
    }
    class hr extends In {
        #Ea;
        #va;
        constructor(e, t) {
            super(), this.#Ea = e, this.#va = t
        }
        createNode(e) {
            const t = pe.div({
                class: this.#Ea
            }, []);
            for (let n of this.#va) null !== n && t.append(n.createNode(e));
            return t
        }
    }
    class cr extends In {
        #Ia;
        constructor(e) {
            super(), this.#Ia = e
        }
        createNode(e) {
            return this.#Ia
        }
    }
    var dr = '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-play-fill" viewBox="0 0 16 16">\n    <path d="m11.596 8.697-6.363 3.692c-.54.313-1.233-.066-1.233-.697V4.308c0-.63.692-1.01 1.233-.696l6.363 3.692a.802.802 0 0 1 0 1.393z"/>\n</svg>';
    class ur extends ir {
        constructor(e) {
            super("", e, Pn.create((e => {
                e.switchStartStop(), ge.triggerFeatureUsed(ge.FEATURE_PAUSE)
            })))
        }
        createNode(e) {
            const t = super.createNode(e);
            return pe.setContent(t, [pe.create(dr), "Start"]), e.addOnStarted((() => {
                pe.setContent(t, [pe.create('<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-pause-fill" viewBox="0 0 16 16">\n    <path d="M5.5 3.5A1.5 1.5 0 0 1 7 5v6a1.5 1.5 0 0 1-3 0V5a1.5 1.5 0 0 1 1.5-1.5zm5 0A1.5 1.5 0 0 1 12 5v6a1.5 1.5 0 0 1-3 0V5a1.5 1.5 0 0 1 1.5-1.5z"/>\n</svg>'), "Pause"])
            })), e.addOnStopped((() => {
                pe.setContent(t, [pe.create(dr), "Start"])
            })), t
        }
    }
    class mr extends In {
        #gs;
        constructor(e = null) {
            super(), this.#gs = e
        }
        createNode(e) {
            let t = "";
            const n = pe.span(""),
                r = [pe.span("Performance: ", {
                    class: "visible-on-big-screen-only"
                }), n],
                i = pe.div({
                    class: "btn-group"
                }, [pe.element("button", {
                    type: "button",
                    class: "btn btn-link dropdown-toggle",
                    "data-bs-toggle": "dropdown",
                    "aria-expanded": "false"
                }, r), pe.element("form", {
                    class: "dropdown-menu p-2"
                }, this.#Oa(e))]);
            i.addEventListener("show.bs.dropdown", (function() {
                ge.triggerFeatureUsed(ge.FEATURE_STATUS_DISPLAYED)
            }));
            let s = (e, r) => {
                r !== t && (n.textContent = r.toUpperCase(), n.classList.remove("status-" + t), n.classList.add("status-" + r), t = r)
            };
            return e.addOnStopped((() => s(0, "stopped"))), e.addOnStarted((() => s(0, "started"))), e.addOnInitialized((t => {
                t.addOnRendered((() => {
                    const t = e.getSandGame().getIterationsPerSecond();
                    s(0, 0 !== t ? t > 105 ? "best" : t > 80 ? "good" : t > 50 ? "medium" : t > 40 ? "low" : "poor" : "stopped")
                }))
            })), i
        }
        #Oa(e) {
            const t = pe.span(),
                n = pe.span();
            e.addOnInitialized((r => {
                r.addOnRendered((() => {
                    const r = e.getSandGame().getFramesPerSecond(),
                        i = e.getSandGame().getIterationsPerSecond();
                    n.textContent = " = " + r, t.textContent = " = " + i
                }))
            }));
            const r = pe.span(),
                i = () => {
                    const t = e.getCurrentWidthPoints(),
                        n = e.getCurrentHeightPoints();
                    r.textContent = ` = ${t.toLocaleString()}×${n.toLocaleString()} = ${(t*n).toLocaleString()}`
                };
            return e.addOnInitialized((() => {
                i()
            })), i(), [pe.span("Sand Game JS " + e.getVersion(), {
                style: "font-weight: bold;"
            }), pe.element("br"), pe.span("Simulated elements"), r, pe.element("br"), pe.span("Simulation iterations /s"), t, pe.span(" (target: " + _e.OPT_CYCLES_PER_SECOND + ")", {
                style: "color: lightgray;"
            }), pe.element("br"), pe.span("Rendered frames /s"), n, pe.span(" (target: " + _e.OPT_FRAMES_PER_SECOND + ")", {
                style: "color: lightgray;"
            }), pe.element("br"), this.#gs]
        }
    }
    class Er extends Pn {
        performAction(e) {
            let t = pe.bootstrapDialogBuilder();
            t.setHeaderContent("Restart"), t.setBodyContent([pe.par(null, "Are you sure?")]), t.addSubmitButton("Restart", (() => {
                const t = e.getInitialScene();
                e.openScene(t), ge.triggerFeatureUsed(ge.FEATURE_RESTART_SCENE)
            })), t.addCloseButton("Close"), t.show(e.getDialogAnchor())
        }
    }
    class gr extends ir {
        constructor(e) {
            super("", e, new Er)
        }
        createNode(e) {
            const t = super.createNode(e);
            return pe.setContent(t, [pe.create('<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-clockwise" viewBox="0 0 16 16">\n    <path fill-rule="evenodd" d="M8 3.5a4.5 4.5 0 104.546 2.914.5.5 0 011.454-.414A6 6 0 118 2z"/>\n    <path d="M8 6V0l5 3L8 6"/>\n</svg>'), "Restart"]), t
        }
    }
    class pr extends Pn {
        performAction(e) {
            let t = document.createElement("input");
            t.type = "file", t.onchange = t => {
                e.getIOManager().loadFromFiles(t.target.files)
            }, t.click()
        }
    }
    class Ar extends Pn {
        performAction(e) {
            const t = e.createSnapshot(),
                n = vn.createResourceFromSnapshot(t);
            tr.saveAs(new Blob([n]), this.#ba()), ge.triggerFeatureUsed(ge.FEATURE_IO_EXPORT)
        }
        #ba() {
            return `sand-game-js_${(new Date).toISOString().slice(0,10)}.sgjs`
        }
    }
    class fr extends Pn {
        #Q;
        constructor(e) {
            super(), this.#Q = e
        }
        performAction(e) {
            let t = pe.bootstrapSimpleFormBuilder();
            t.addTextArea("Message", "message");
            let n = pe.bootstrapDialogBuilder();
            n.setHeaderContent("Report a problem"), n.setBodyContent(t.createNode()), n.addSubmitButton("Submit", (() => {
                let n = t.getData().message;
                "" !== n.trim() && this.#Q("user", n, e)
            })), n.addCloseButton("Close"), n.show(e.getDialogAnchor())
        }
    }
    class Tr extends ir {
        constructor(e, t) {
            super(["Report", pe.span(" a problem", {
                class: "visible-on-big-screen-only"
            })], e, new fr(t))
        }
    }
    class Cr {
        run() {
            throw "Not implemented"
        }
    }
    class Rr extends Cr {
        #K;
        #ut;
        #mt;
        constructor(e) {
            super(), this.#K = e.elementArea, this.#ut = e.random, this.#mt = e.processorContext
        }
        run() {
            if (this.#mt.getIteration() % 3 == 0) {
                const e = this.#ut.nextInt(this.#K.getWidth()),
                    t = this.#ut.nextInt(this.#K.getHeight() - 3) + 2;
                if (xe.canGrowUpHere(this.#K, e, t)) {
                    const n = this.#mt.getDefaults().getBrushGrass();
                    this.#K.setElement(e, t, n.apply(e, t, this.#ut)), this.#mt.trigger(e, t)
                }
            }
        }
    }
    class yr extends Cr {
        #K;
        #ut;
        #mt;
        #gr;
        constructor(e) {
            super(), this.#K = e.elementArea, this.#ut = e.random, this.#mt = e.processorContext, this.#gr = e.entityManager
        }
        run() {
            if ((this.#mt.getIteration() + 200) % 1e3 == 0) {
                if (this.#gr.countEntities("fish") > 5) return;
                const e = this.#ut.nextInt(this.#K.getWidth() - 20) + 10,
                    t = this.#Ma(this.#K, e);
                null !== t && (this.#gr.addSerializedEntity(Un.fish(e, t)), this.#mt.trigger(e, t))
            }
        }
        #Ma(e, t) {
            let n = 0;
            for (let i = 0; i < e.getHeight(); i++) {
                const s = e.getElementHead(t, i),
                    a = r.getTypeClass(s);
                if (a === r.TYPE_AIR) n = 0;
                else if (a === r.TYPE_FLUID) n++;
                else if (a === r.TYPE_POWDER || a === r.TYPE_POWDER_WET) {
                    if (n > 7 && this.#Na(t, i - 1)) return i - 1;
                    break
                }
            }
            return null
        }
        #Na(e, t) {
            for (let n = 0; n < 6; n++)
                for (let i = -(n + 1); i < n + 1; i++) {
                    const s = e + i,
                        a = t - n,
                        o = this.#K.getElementHeadOrNull(s, a);
                    if (null === o) return !1;
                    if (r.getTypeClass(o) !== r.TYPE_FLUID) return !1;
                    if (r.getTemperature(o) > 0) return !1
                }
            return !0
        }
    }
    class Sr extends Cr {
        #K;
        #ut;
        #mt;
        constructor(e) {
            super(), this.#K = e.elementArea, this.#ut = e.random, this.#mt = e.processorContext
        }
        run() {
            const e = this.#mt.getIteration();
            if (e > 1e3 && e % 4 == 0) {
                const e = this.#ut.nextInt(this.#K.getWidth() - 12) + 6,
                    t = this.#ut.nextInt(this.#K.getHeight() - 16) + 15;
                if (Sr.couldGrowUpHere(this.#K, e, t)) {
                    const n = this.#mt.getDefaults().getBrushTree();
                    this.#K.setElement(e, t, n.apply(e, t, this.#ut)), this.#mt.trigger(e, t)
                }
            }
        }
        static couldGrowUpHere(e, t, n) {
            if (t < 0 || n < 12) return !1;
            if (t > e.getWidth() - 5 || n > e.getHeight() - 2) return !1;
            let i = e.getElementHead(t, n);
            if (r.getBehaviour(i) !== r.BEHAVIOUR_GRASS) return !1;
            if (r.getTemperature(i) > 0) return !1;
            let s = e.getElementHead(t, n + 1);
            if (r.getBehaviour(s) !== r.BEHAVIOUR_SOIL) return !1;
            if (r.getTemperature(s) > 0) return !1;
            for (let r = 1; r < 18; r++)
                if (!Sr.#xa(e, t, n - r)) return !1;
            for (let r = -15; r < 15; r++)
                if (Sr.#Da(e, t + r, n - 4)) return !1;
            for (let r = 10; r < 15; r++) {
                if (!Sr.#xa(e, t - 8, n - r)) return !1;
                if (!Sr.#xa(e, t + 8, n - r)) return !1
            }
            return !0
        }
        static #xa(e, t, n) {
            let i = e.getElementHead(t, n);
            return r.getTypeClass(i) === r.TYPE_AIR || r.getBehaviour(i) === r.BEHAVIOUR_GRASS
        }
        static #Da(e, t, n) {
            let i = e.getElementHead(t, n),
                s = r.getBehaviour(i);
            return s === r.BEHAVIOUR_TREE_TRUNK || s === r.BEHAVIOUR_TREE
        }
    }
    class wr extends Cr {
        #K;
        #ut;
        #mt;
        #gr;
        constructor(e) {
            super(), this.#K = e.elementArea, this.#ut = e.random, this.#mt = e.processorContext, this.#gr = e.entityManager
        }
        run() {
            if ((this.#mt.getIteration() + 500) % 1e3 == 0) {
                if (this.#gr.countEntities("butterfly") > 3) return;
                const e = this.#ut.nextInt(this.#K.getWidth() - 20) + 10,
                    t = this.#Ma(this.#K, e);
                null !== t && (this.#gr.addSerializedEntity(Un.butterfly(e, t)), this.#mt.trigger(e, t))
            }
        }
        #Ma(e, t) {
            let n = 0;
            for (let i = 0; i < e.getHeight(); i++) {
                const s = e.getElementHead(t, i);
                if (r.getTypeClass(s) === r.TYPE_AIR) n++;
                else {
                    if (r.getBehaviour(s) === r.BEHAVIOUR_GRASS) {
                        if (n >= 15 && this.#Na(t, i - 4)) return i - 4;
                        break
                    }
                    n = 0
                }
            }
            return null
        }
        #Na(e, t) {
            for (let n = -5; n <= 2; n++)
                for (let i = -5; i <= 5; i++) {
                    const s = e + i,
                        a = t + n,
                        o = this.#K.getElementHeadOrNull(s, a);
                    if (null === o) return !1;
                    if (r.getTypeClass(o) !== r.TYPE_AIR) return !1;
                    if (r.getTemperature(o) > 0) return !1
                }
            return !0
        }
    }
    class vr extends Cr {
        #K;
        #ut;
        #mt;
        #gr;
        constructor(e) {
            super(), this.#K = e.elementArea, this.#ut = e.random, this.#mt = e.processorContext, this.#gr = e.entityManager
        }
        run() {
            if ((this.#mt.getIteration() + 700) % 1e3 == 0) {
                if (this.#gr.countEntities("bird") > 4) return;
                const e = this.#ut.nextInt(this.#K.getWidth() - 20) + 10,
                    t = this.#Ma(this.#K, e);
                null !== t && (this.#gr.addSerializedEntity(Un.bird(e, t)), this.#mt.trigger(e, t))
            }
        }
        #Ma(e, t) {
            let n = 0;
            for (let i = 0; i < e.getHeight(); i++) {
                const s = e.getElementHead(t, i);
                if (r.getTypeClass(s) === r.TYPE_AIR) n++;
                else {
                    if (r.getBehaviour(s) === r.BEHAVIOUR_TREE_LEAF) {
                        if (n >= 15 && this.#Na(t, i - 5)) return i - 5;
                        break
                    }
                    n = 0
                }
            }
            return null
        }
        #Na(e, t) {
            for (let n = -6; n <= 2; n++)
                for (let i = -5; i <= 5; i++) {
                    const s = e + i,
                        a = t + n,
                        o = this.#K.getElementHeadOrNull(s, a);
                    if (null === o) return !1;
                    if (r.getTypeClass(o) !== r.TYPE_AIR) return !1;
                    if (r.getTemperature(o) > 0) return !1
                }
            return !0
        }
    }
    const Ir = ie._LIST,
        Or = Ee._LIST;
    e.BrushDefs = ie, e.Brushes = N, e.Entities = Un, e.PredicateDefs = I, e.Resources = vn, e.SceneDefs = Hn, e.Scenes = _n, e.ToolDefs = Ee, e.Tools = $, e.brushes = Ir, e.init = function(e, n) {
        let r;
        void 0 === n && (n = {});
        const {
            width: i,
            height: s,
            scale: a
        } = t.determineOptimalSizes(e, n.canvas), o = {
            scale: a,
            canvasWidthPx: i,
            canvasHeightPx: s,
            version: n.version
        }, l = !0 === n.debug, h = void 0 === n.autoStart || !0 === n.autoStart, c = !(!0 === n.disableRestart), d = !(!0 === n.disableStartStop), u = !(!0 === n.disableImport), m = !(!0 === n.disableExport), E = !(!0 === n.disableSizeChange), g = !(!0 === n.disableSceneSelection), p = !(!0 === n.disableGlobalShortcuts), A = void 0 !== n.errorReporter, f = void 0 === n.disableBigButtons || !1 === n.disableBigButtons, T = n.errorReporter;
        let C, R;
        if ("object" == typeof n.brushes) C = n.brushes;
        else {
            if (void 0 !== n.brushes) throw "config.brushes - wrong type, expected object";
            C = void 0
        }
        if ("object" == typeof n.extensions) R = n.extensions;
        else {
            if (void 0 !== n.extensions) throw "config.extensions - wrong type, expected object";
            R = {
                spawnFish: !0,
                spawnGrass: !0,
                spawnTrees: !0,
                spawnButterflies: !0,
                spawnBirds: !0
            }
        }
        const y = new xn(C, (e => {
            const t = [];
            return !0 === R.spawnFish && t.push(new yr(e)), !0 === R.spawnGrass && t.push(new Rr(e)), !0 === R.spawnTrees && t.push(new Sr(e)), !0 === R.spawnButterflies && t.push(new wr(e)), !0 === R.spawnBirds && t.push(new vr(e)), t
        }));
        let S, w, v, I, O, b, M, N;
        if (Array.isArray(n.scenes)) {
            S = {};
            for (let e = 0; e < n.scenes.length; e++) S["scene_" + e] = n.scenes[e];
            w = !0
        } else "object" == typeof n.scenes ? (S = n.scenes, w = !0) : (S = Hn.SCENES, w = !1);
        if ("string" == typeof n.scene) {
            if (I = n.scene, v = S[I], void 0 === v) throw "Scene not found: " + I
        } else if ("object" == typeof n.scene) {
            I = "n/a";
            const e = "function" == typeof n.scene.init ? e => n.scene.init(e, r) : () => {};
            v = _n.custom("n/a", e)
        } else w ? (I = Object.keys(S)[0], v = Object.values(S)[0]) : (I = l || Math.random() > .1 ? "landscape_1" : "landscape_2", v = S[I]);

        function x(e, t = null) {
            if ("string" == typeof e) {
                let n = Ee.byCodeName(e);
                if (null !== n) return n;
                if (l) throw "Tool not found: " + e;
                return t
            }
            if ("object" == typeof e && e instanceof B) return e;
            if (l) throw "Unexpected tool type";
            return t
        }
        if (Array.isArray(n.tools)) {
            O = [];
            for (let e of n.tools) {
                let t = x(e, null);
                null !== t && O.push(t)
            }
        } else O = Ee.DEFAULT_TOOLS;
        O = $.grouping(Ee.DEFAULT_TOOLS, Ee.DEFAULT_CATEGORY_DEFINITIONS), void 0 !== n.primaryTool && null !== (b = x(n.primaryTool)) || (b = Ee.SAND), void 0 !== n.secondaryTool && null !== (M = x(n.secondaryTool)) || (M = Ee.ERASE), void 0 !== n.tertiaryTool && null !== (N = x(n.tertiaryTool)) || (N = Ee.METEOR);
        const D = pe.div({
            class: "sand-game-dialog-anchor sand-game-component"
        });
        document.body.prepend(D);
        const _ = new ht(b, M, N);
        r = new Dn(o, D, _, y), void 0 !== T && r.addOnFailure(((e, t) => T(e, t, r)));
        const H = new hr("sand-game-component", [new Yn(O, u, f), new Xn, new hr("sand-game-options", [new hr("sand-game-options-left", [u ? new ir("Import", ir.CLASS_LIGHT, new pr) : null, m ? new ir("Export", ir.CLASS_LIGHT, new Ar) : null, c && !g ? new gr(ir.CLASS_LIGHT) : null, d ? new ur(ir.CLASS_LIGHT) : null, new mr(E ? pe.element("span", null, [pe.element("br"), "Tip: adjust scale if needed"]) : null)]), new hr("sand-game-options-right", [A ? new Tr(ir.CLASS_LIGHT, T) : null])]), new hr("sand-game-views", [E || g ? new hr(null, [E ? new Zn : null, g ? new cr(pe.span("Scenes", {
            class: "scenes-label"
        })) : null, g ? new Qn(r, S, I) : null]) : null, l ? new lr : null])]).createNode(r);
        return e.innerHTML = "", e.append(H), r.setup(v), u && r.getIOManager().initFileDragAndDrop(H), p && r.enableGlobalShortcuts(), h && r.start(), ge.triggerFeatureUsed(ge.FEATURE_APP_INITIALIZED), r
    }, e.tools = Or, Object.defineProperty(e, "__esModule", {
        value: !0
    })
}));
//# sourceMappingURL=sand-game-js.umd.min.js.map
</script>
  <link rel="stylesheet" type="text/css" href="https://files.harag.cz/www/app/sand-game-js/dev/latest/sand-game-js.css" />
  <script>
      // global variables, accessible from browser console
      var sandGame = null;
      var brushes = null;

      document.addEventListener('DOMContentLoaded', () => {
          if (window.SandGameJS !== undefined) {
              const root = document.getElementById('sand-game-root');

              const config = { version: 'dev', debug: true };
              const controller = window.SandGameJS.init(root, config);
              sandGame = controller.getSandGame();
              controller.addOnInitialized(s => {
                  sandGame = s;
              });
              brushes = window.SandGameJS.brushes;
              console.log('Globals:');
              console.log('  sandGame, brushes');
              console.log('Examples:');
              console.log('  sandGame.graphics().drawLine(10, 10, 300, 150, 2, brushes.sand);');
              console.log('  sandGame.graphics().draw(100, 20, brushes.meteor);');
          } else {
              const placeholder = document.getElementById('sand-game-placeholder-content');
              placeholder.innerHTML = '<span style="color: red; font-weight: bold;">' +
                  'Failed to load the game. Possible reasons:<br>' +
                  '&bull; Your browser may not support modern JavaScript<br>' +
                  '&bull; Internet connection<br>' +
                  '&bull; A server side problem' +
                  '</span>';
          }
      });
  </script>
</head>
<body>
<main role="main" class="container"><div class="row"><div class="col-12">
  <h1>Sand Game JS</h1>
  <div id="sand-game-root">
    <!-- Sand Game JS placeholder -->
    <div style="user-select: none;">
      <div>
        <button disabled class="btn" type="button" style="min-width: 4em; line-height: 2; padding: 0 0.4em 0 0.4em; font-size: 75%; border: none; background-color: rgb(230, 230, 230); color: black;">&nbsp;</button>
      </div>
      <div style="height: 70vh; display: flex; align-items: center; justify-content: center; margin-top: 4pt; padding: 2em; outline: 1px solid #b7b7b7;">
        <div id="sand-game-placeholder-content">
          Loading...
        </div>
      </div>
      <div style="height: 20vh"></div>
    </div>
  </div>
</div></div></main>
<footer class="container" style="font-size: small"><div class="row"><div class="col-12">
  <p>
    <a href="https://github.com/Hartrik/sand-game-js">https://github.com/Hartrik/sand-game-js</a>
  </p>
</div></div></footer>
</body>
</html>